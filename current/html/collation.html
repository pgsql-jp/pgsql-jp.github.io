<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>24.2. 照合順序サポート</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="locale.html" title="24.1. ロケールのサポート" /><link rel="next" href="multibyte.html" title="24.3. 文字セットサポート" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /></head><body id="docContent" class="container-fluid col-10"><div class="other_version"><a href="https://www.postgresql.jp/document/">バージョンごとのドキュメント一覧</a></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 16.3文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="charset.html" title="第24章 ローカライゼーション">第24章 ローカライゼーション</a></td><td width="20%" align="right"><div class="actions"><a class="issue" title="github" href="https://github.com/pgsql-jp/jpug-doc/issues/new?template=bug_report.yml&amp;what-happened=version 16.3 : collation.html">誤訳等の報告
                    </a></div></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="locale.html" title="24.1. ロケールのサポート">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="charset.html" title="第24章 ローカライゼーション">上へ</a></td><td width="60%" align="center">24.2. 照合順序サポート</td><td width="20%" align="right"> <a accesskey="n" href="multibyte.html" title="24.3. 文字セットサポート">次へ</a></td></tr></table><hr /></div><div class="sect1" id="COLLATION"><div class="titlepage"><div><div><h2 class="title" style="clear: both">24.2. 照合順序サポート <a href="#COLLATION" class="id_link">#</a></h2></div></div></div><span class="original">
  &lt;title&gt;Collation Support&lt;/title&gt;
</span><a id="id-1.6.11.4.2" class="indexterm"></a><p>
<span class="original">
   The collation feature allows specifying the sort order and character
   classification behavior of data per-column, or even per-operation.
   This alleviates the restriction that the
   &lt;symbol&gt;LC_COLLATE&lt;/symbol&gt; and &lt;symbol&gt;LC_CTYPE&lt;/symbol&gt; settings
   of a database cannot be changed after its creation.
</span>
照合順序機能は、ソート順番と列ごともしくは操作ごとのデータの文字区別の振る舞いを指定することを可能にします。
これにより、作成後のデータベースの<code class="symbol">LC_COLLATE</code>と<code class="symbol">LC_CTYPE</code>の設定を変更できない制限が緩和されます。
  </p><div class="sect2" id="COLLATION-CONCEPTS"><div class="titlepage"><div><div><h3 class="title">24.2.1. 概念 <a href="#COLLATION-CONCEPTS" class="id_link">#</a></h3></div></div></div><span class="original">
   &lt;title&gt;Concepts&lt;/title&gt;
</span><p>
<span class="original">
    Conceptually, every expression of a collatable data type has a
    collation.  (The built-in collatable data types are
    &lt;type&gt;text&lt;/type&gt;, &lt;type&gt;varchar&lt;/type&gt;, and &lt;type&gt;char&lt;/type&gt;.
    User-defined base types can also be marked collatable, and of course
    a &lt;glossterm linkend="glossary-domain"&gt;domain&lt;/glossterm&gt; over a
    collatable data type is collatable.)  If the
    expression is a column reference, the collation of the expression is the
    defined collation of the column.  If the expression is a constant, the
    collation is the default collation of the data type of the
    constant.  The collation of a more complex expression is derived
    from the collations of its inputs, as described below.
</span>
概念的に照合可能なデータ型のそれぞれの式は、照合順序を保持しています
（組み込みの照合可能なデータ型は<code class="type">text</code>、<code class="type">varchar</code>、 <code class="type">char</code>です。
ユーザ定義の基本型は照合可能とマーキングできます。もちろん照合可能なデータ型上の<a class="glossterm" href="glossary.html#GLOSSARY-DOMAIN"><em class="glossterm"><a class="glossterm" href="glossary.html#GLOSSARY-DOMAIN" title="Domain【ドメイン】">ドメイン</a></em></a>は照合可能となります）。
もし、式が列参照である場合は、式の照合順序は列の定義された照合順序となります。
もし、式が定数である場合は、照合順序は定数のデータ型のデフォルトの照合順序となります。
より複雑な式の照合順序は、下記に示すように、その入力の照合順序から引き出されます。
   </p><p>
<span class="original">
    The collation of an expression can be the &lt;quote&gt;default&lt;/quote&gt;
    collation, which means the locale settings defined for the
    database.  It is also possible for an expression's collation to be
    indeterminate.  In such cases, ordering operations and other
    operations that need to know the collation will fail.
</span>
式の照合順序は、<span class="quote">「<span class="quote">default</span>」</span>照合順序となります。これはデータベースに対して定義されたロケール設定を意味しています。
式の照合順序は非決定となることもあります。そのような場合に、照合順序が必要となるような順序操作や他の操作は失敗するでしょう。
   </p><p>
<span class="original">
    When the database system has to perform an ordering or a character
    classification, it uses the collation of the input expression.  This
    happens, for example, with &lt;literal&gt;ORDER BY&lt;/literal&gt; clauses
    and function or operator calls such as &lt;literal&gt;&amp;lt;&lt;/literal&gt;.
    The collation to apply for an &lt;literal&gt;ORDER BY&lt;/literal&gt; clause
    is simply the collation of the sort key.  The collation to apply for a
    function or operator call is derived from the arguments, as described
    below.  In addition to comparison operators, collations are taken into
    account by functions that convert between lower and upper case
    letters, such as &lt;function&gt;lower&lt;/function&gt;, &lt;function&gt;upper&lt;/function&gt;, and
    &lt;function&gt;initcap&lt;/function&gt;; by pattern matching operators; and by
    &lt;function&gt;to_char&lt;/function&gt; and related functions.
</span>
データベースシステムが並べ替えや文字区別を行う場合、データベースは入力の照合順序を使用します。
これは、たとえば<code class="literal">ORDER BY</code>句や <code class="literal">&lt;</code> 演算子や関数を使用する際に発生します。
<code class="literal">ORDER BY</code>句に適用する照合順序は、単純にソートキーの照合順序です。
関数や演算子の呼び出しに対して適用される照合順序は、以下に述べるように引数により決まります。
比較演算子に加えて、照合順序は<code class="function">lower</code>、<code class="function">upper</code>、<code class="function">initcap</code>といった小文字と大文字を変換する関数やパターンマッチングの演算子、<code class="function">to_char</code>関連の関数で考慮されています。
   </p><p>
<span class="original">
    For a function or operator call, the collation that is derived by
    examining the argument collations is used at run time for performing
    the specified operation.  If the result of the function or operator
    call is of a collatable data type, the collation is also used at parse
    time as the defined collation of the function or operator expression,
    in case there is a surrounding expression that requires knowledge of
    its collation.
</span>
関数や演算子の呼び出しに対して、引数の照合順序検査により得られた照合順序は実行時に特定の操作を行うために使用されます。
もし関数や演算子の呼び出しの結果が照合順序可能なデータ型であった場合、照合順序は関数もしくは演算子式の定義済みの照合順序として
解析時にも試用されます。このとき照合順序の知識が必要となるような囲み式があります。
   </p><p>
<span class="original">
    The &lt;firstterm&gt;collation derivation&lt;/firstterm&gt; of an expression can be
    implicit or explicit.  This distinction affects how collations are
    combined when multiple different collations appear in an
    expression.  An explicit collation derivation occurs when a
    &lt;literal&gt;COLLATE&lt;/literal&gt; clause is used; all other collation
    derivations are implicit.  When multiple collations need to be
    combined, for example in a function call, the following rules are
    used:
</span>
式の<em class="firstterm">照合順序の導出</em>は暗黙でも明示的にでも可能です。
この区別は、複数の異なる照合順序が式中に現れるときに照合順序がどのように組み合わされるか、に影響を与えます。
明示的な照合順序の導出は、<code class="literal">COLLATE</code>句が使用されたときに発生します。
他の全ての照合順序は暗黙となります。例えば関数呼び出しの中では、次の規則が用いられます。

    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
<span class="original">
       If any input expression has an explicit collation derivation, then
       all explicitly derived collations among the input expressions must be
       the same, otherwise an error is raised.  If any explicitly
       derived collation is present, that is the result of the
       collation combination.
</span>
入力式に明示的な照合順序の導出がある場合、入力式の中の明示的に導出された全ての照合順序が同一でなくてはなりません。
そうでない場合はエラーが発生します。もし明示的に導出された照合順序がある場合は、それは照合順序の組み合わせの結果となります。
      </p></li><li class="listitem"><p>
<span class="original">
       Otherwise, all input expressions must have the same implicit
       collation derivation or the default collation.  If any non-default
       collation is present, that is the result of the collation combination.
       Otherwise, the result is the default collation.
</span>
そうでない場合は、全ての入力式は同一の暗黙の照合順序の導出またはデフォルトの照合順序を持たなくてはなりません。
もしデフォルトではない照合順序がある場合は、それは照合順序の組み合わせの結果となります。
もしそうでない場合は、結果はデフォルトの照合順序となります。
      </p></li><li class="listitem"><p>
<span class="original">
       If there are conflicting non-default implicit collations among the
       input expressions, then the combination is deemed to have indeterminate
       collation.  This is not an error condition unless the particular
       function being invoked requires knowledge of the collation it should
       apply.  If it does, an error will be raised at run-time.
</span>
入力式内でデフォルトではない暗黙の照合順序が衝突している場合、決定不能な照合順序であるとみなされます。
これは、もし呼び出された特定の関数が適用するべき照合順序を知っておく必要がないかぎりエラーの条件ではありません。
もし知っておく必要がある場合は、実行時にエラーとなります。
      </p></li></ol></div><p>

<span class="original">
    For example, consider this table definition:
</span>
例えば、このテーブル定義を考えてみます。
</p><pre class="programlisting">
CREATE TABLE test1 (
    a text COLLATE "de_DE",
    b text COLLATE "es_ES",
    ...
);
</pre><p>

<span class="original">
    Then in
</span>
このとき
</p><pre class="programlisting">
SELECT a &lt; 'foo' FROM test1;
</pre><p>
<span class="original">
    the &lt;literal&gt;&amp;lt;&lt;/literal&gt; comparison is performed according to
    &lt;literal&gt;de_DE&lt;/literal&gt; rules, because the expression combines an
    implicitly derived collation with the default collation.  But in
</span>
<code class="literal">&lt;</code> の比較は<code class="literal">de_DE</code>の規則により実行されます。
というのも式は暗黙的に導出されたデフォルトの照合順序と組み合わせます。しかし、
</p><pre class="programlisting">
SELECT a &lt; ('foo' COLLATE "fr_FR") FROM test1;
</pre><p>
<span class="original">
    the comparison is performed using &lt;literal&gt;fr_FR&lt;/literal&gt; rules,
    because the explicit collation derivation overrides the implicit one.
    Furthermore, given
</span>
このとき比較は、明示的な照合順序の導出は暗黙の照合順序をオーバーライドするため<code class="literal">fr_FR</code>規則が用いられます。
さらに、次の例では
</p><pre class="programlisting">
SELECT a &lt; b FROM test1;
</pre><p>
<span class="original">
    the parser cannot determine which collation to apply, since the
    &lt;structfield&gt;a&lt;/structfield&gt; and &lt;structfield&gt;b&lt;/structfield&gt; columns have conflicting
    implicit collations.  Since the &lt;literal&gt;&amp;lt;&lt;/literal&gt; operator
    does need to know which collation to use, this will result in an
    error.  The error can be resolved by attaching an explicit collation
    specifier to either input expression, thus:
</span>
パーサはどの照合順序を適用するか決定できません。というのも<code class="structfield">a</code>と<code class="structfield">b</code>列は暗黙の衝突する照合順序を持つためです。
<code class="literal">&lt;</code> 演算子がどちらの照合順序を使用するか知る必要があるため、エラーとなります。
このエラーは、どちらかの入力式に明示的な照合順序の指定を付加することで解決できます。
つまり、以下のようになります。
</p><pre class="programlisting">
SELECT a &lt; b COLLATE "de_DE" FROM test1;
</pre><p>
<span class="original">
    or equivalently
</span>
もしくは以下でも同じです。
</p><pre class="programlisting">
SELECT a COLLATE "de_DE" &lt; b FROM test1;
</pre><p>
<span class="original">
    On the other hand, the structurally similar case
</span>
一方で、以下のように構造的に似たケースとして
</p><pre class="programlisting">
SELECT a || b FROM test1;
</pre><p>
<span class="original">
    does not result in an error, because the &lt;literal&gt;||&lt;/literal&gt; operator
    does not care about collations: its result is the same regardless
    of the collation.
</span>
これはエラーとなりません。というのも <code class="literal">||</code> 演算子は、照合順序には関係がないためです。
この結果は照合順序と関係なく同じになります。
   </p><p>
<span class="original">
    The collation assigned to a function or operator's combined input
    expressions is also considered to apply to the function or operator's
    result, if the function or operator delivers a result of a collatable
    data type.  So, in
</span>
もし関数や演算子が照合順序可能なデータ型の結果を出力する場合は、関数に割り当てられた照合順序、もしくは演算子の組み合わされた入力式は、関数もしくは演算子の結果に対しても
適用されると考えられます。よって、以下の例では
</p><pre class="programlisting">
SELECT * FROM test1 ORDER BY a || 'foo';
</pre><p>
<span class="original">
    the ordering will be done according to &lt;literal&gt;de_DE&lt;/literal&gt; rules.
    But this query:
</span>
順序は<code class="literal">de_DE</code>規則に基づき実行されますが、以下の問い合わせでは
</p><pre class="programlisting">
SELECT * FROM test1 ORDER BY a || b;
</pre><p>
<span class="original">
    results in an error, because even though the &lt;literal&gt;||&lt;/literal&gt; operator
    doesn't need to know a collation, the &lt;literal&gt;ORDER BY&lt;/literal&gt; clause does.
    As before, the conflict can be resolved with an explicit collation
    specifier:
</span>
エラーとなります。というのも <code class="literal">||</code> 演算子が照合順序を知る必要がなかったとしても
<code class="literal">ORDER BY</code>句が照合順序を知る必要があるためです。
以前と同様、この衝突は明示的に照合順序を指定することにより解決できます。
</p><pre class="programlisting">
SELECT * FROM test1 ORDER BY a || b COLLATE "fr_FR";
</pre><p>
   </p></div><div class="sect2" id="COLLATION-MANAGING"><div class="titlepage"><div><div><h3 class="title">24.2.2. 照合順序の管理 <a href="#COLLATION-MANAGING" class="id_link">#</a></h3></div></div></div><span class="original">
   &lt;title&gt;Managing Collations&lt;/title&gt;
</span><p>
<span class="original">
    A collation is an SQL schema object that maps an SQL name to locales
    provided by libraries installed in the operating system.  A collation
    definition has a &lt;firstterm&gt;provider&lt;/firstterm&gt; that specifies which
    library supplies the locale data.  One standard provider name
    is &lt;literal&gt;libc&lt;/literal&gt;, which uses the locales provided by the
    operating system C library.  These are the locales used by most tools
    provided by the operating system.  Another provider
    is &lt;literal&gt;icu&lt;/literal&gt;, which uses the external
    ICU&lt;indexterm&gt;&lt;primary&gt;ICU&lt;/primary&gt;&lt;/indexterm&gt; library.  ICU locales can only be
    used if support for ICU was configured when PostgreSQL was built.
</span>
照合順序は、SQL名称を、オペレーティングシステム中にインストールされたライブラリによって提供されるロケールにマッピングするSQLスキーマオブジェクトです。
照合順序の定義には、ロケールデータを提供するライブラリを指定する<em class="firstterm">プロバイダ</em>(provider)が含まれます。
標準プロバイダの一つは<code class="literal">libc</code>で、オペレーティングシステムのCライブラリが提供するロケールを使用します。
オペレーティングシステムが提供するほとんどのツールが、このロケールを使用します。
他のプロバイダとしては<code class="literal">icu</code>があり、外部のICU<a id="id-1.6.11.4.5.2.4" class="indexterm"></a>ライブラリを使います。
ICUロケールは、PostgreSQLがビルドされた際にICUサポートが設定されていた場合にのみ利用可能です。
   </p><p>
<span class="original">
    A collation object provided by &lt;literal&gt;libc&lt;/literal&gt; maps to a
    combination of &lt;symbol&gt;LC_COLLATE&lt;/symbol&gt; and &lt;symbol&gt;LC_CTYPE&lt;/symbol&gt;
    settings, as accepted by the &lt;literal&gt;setlocale()&lt;/literal&gt; system library call.  (As
    the name would suggest, the main purpose of a collation is to set
    &lt;symbol&gt;LC_COLLATE&lt;/symbol&gt;, which controls the sort order.  But
    it is rarely necessary in practice to have an
    &lt;symbol&gt;LC_CTYPE&lt;/symbol&gt; setting that is different from
    &lt;symbol&gt;LC_COLLATE&lt;/symbol&gt;, so it is more convenient to collect
    these under one concept than to create another infrastructure for
    setting &lt;symbol&gt;LC_CTYPE&lt;/symbol&gt; per expression.)  Also,
    a &lt;literal&gt;libc&lt;/literal&gt; collation
    is tied to a character set encoding (see &lt;xref linkend="multibyte"/&gt;).
    The same collation name may exist for different encodings.
</span>
<code class="literal">libc</code>が提供する照合順序は、<code class="literal">setlocale()</code>システムライブラリの呼び出しが許可する<code class="symbol">LC_COLLATE</code>と<code class="symbol">LC_CTYPE</code>の組み合わせ設定にマッピングします。
(名称から推測されるように、照合順序の主な目的はソート順序を制御する<code class="symbol">LC_COLLATE</code>を設定することです。
しかし実際には<code class="symbol">LC_CTYPE</code>の設定を<code class="symbol">LC_COLLATE</code>と異なるようにする必要はほとんどありません。
そのため、式ごとに<code class="symbol">LC_CTYPE</code>を設定するような別の機構を作成するより、これらの設定を収集する方が、より便利です。)
また、<code class="literal">libc</code>の照合順序は文字エンコーディングと結びついています(<a class="xref" href="multibyte.html" title="24.3. 文字セットサポート">24.3</a>を参照してください)。
同一の照合順序名称が異なるエンコーディングに対して存在しています。
   </p><p>
<span class="original">
    A collation object provided by &lt;literal&gt;icu&lt;/literal&gt; maps to a named
    collator provided by the ICU library.  ICU does not support
    separate &lt;quote&gt;collate&lt;/quote&gt; and &lt;quote&gt;ctype&lt;/quote&gt; settings, so
    they are always the same.  Also, ICU collations are independent of the
    encoding, so there is always only one ICU collation of a given name in
    a database.
</span>
<code class="literal">icu</code>が提供する照合順序オブジェクトは、ICUライブラリが提供する照合順序機能(collator)にマップします。
ICUは<span class="quote">「<span class="quote">collate</span>」</span>と<span class="quote">「<span class="quote">ctype</span>」</span>を別々に設定する機能を提供しないので、それら常に同じものになります。
また、ICUの照合順序はエンコーディングからは独立しています。
ですから、データベース中のある名前のICU照合順序は、常にただひとつだけです。
   </p><div class="sect3" id="COLLATION-MANAGING-STANDARD"><div class="titlepage"><div><div><h4 class="title">24.2.2.1. 標準の照合順序 <a href="#COLLATION-MANAGING-STANDARD" class="id_link">#</a></h4></div></div></div><span class="original">
    &lt;title&gt;Standard Collations&lt;/title&gt;
</span><p>
<span class="original">
    On all platforms, the collations named &lt;literal&gt;default&lt;/literal&gt;,
    &lt;literal&gt;C&lt;/literal&gt;, and &lt;literal&gt;POSIX&lt;/literal&gt; are available.  Additional
    collations may be available depending on operating system support.
    The &lt;literal&gt;default&lt;/literal&gt; collation selects the &lt;symbol&gt;LC_COLLATE&lt;/symbol&gt;
    and &lt;symbol&gt;LC_CTYPE&lt;/symbol&gt; values specified at database creation time.
    The &lt;literal&gt;C&lt;/literal&gt; and &lt;literal&gt;POSIX&lt;/literal&gt; collations both specify
    &lt;quote&gt;traditional C&lt;/quote&gt; behavior, in which only the ASCII letters
    &lt;quote&gt;&lt;literal&gt;A&lt;/literal&gt;&lt;/quote&gt; through &lt;quote&gt;&lt;literal&gt;Z&lt;/literal&gt;&lt;/quote&gt;
    are treated as letters, and sorting is done strictly by character
    code byte values.
</span>
すべてのプラットフォーム上で<code class="literal">default</code>、<code class="literal">C</code>そして<code class="literal">POSIX</code>という名称の照合順序が
利用できます。
オペレーティングシステムによっては追加の照合順序が利用可能な場合もあります。
<code class="literal">default</code>照合順序は、データベース作成時に<code class="symbol">LC_COLLATE</code>値と<code class="symbol">LC_CTYPE</code>値を
選択します。<code class="literal">C</code>と<code class="literal">POSIX</code>照合順序は共に<span class="quote">「<span class="quote">traditional C</span>」</span>の動作を指定します。
これはASCII文字の<span class="quote">「<span class="quote"><code class="literal">A</code></span>」</span>から<span class="quote">「<span class="quote"><code class="literal">Z</code></span>」</span>を文字として扱い、ソート順は厳密な文字コードのバイト値によります。
   </p><div class="note"><h3 class="title">注記</h3><p>
<span class="original">
     The &lt;literal&gt;C&lt;/literal&gt; and &lt;literal&gt;POSIX&lt;/literal&gt; locales may behave
     differently depending on the database encoding.
</span>
<code class="literal">C</code>ロケールと<code class="literal">POSIX</code>ロケールは、データベースエンコーディングによって動作が異なる場合があります。
    </p></div><p>
<span class="original">
    Additionally, two SQL standard collation names are available:
</span>
さらに、次の2つのSQL標準照合順序名を使用できます。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">unicode</code></span></dt><dd><p>
<span class="original">
        This collation sorts using the Unicode Collation Algorithm with the
        Default Unicode Collation Element Table.  It is available in all
        encodings.  ICU support is required to use this collation.  (This
        collation has the same behavior as the ICU root locale; see &lt;xref
        linkend="collation-managing-predefined-icu-und-x-icu"/&gt;.)
</span>
この照合順序は、デフォルトUnicode照合基本テーブルを使用してUnicode照合アルゴリズムで並べ替えます。
すべてのエンコーディングで使用できます。
この照合順序を使用するにはICUサポートが必要です。
（この照合順序は、ICU rootロケールと同じ動作をします。
<a class="xref" href="collation.html#COLLATION-MANAGING-PREDEFINED-ICU-UND-X-ICU"><code class="literal">und-x-icu</code> (<span class="quote">「<span class="quote">undefined</span>」</span>用)</a>を参照してください。）
       </p></dd><dt><span class="term"><code class="literal">ucs_basic</code></span></dt><dd><p>
<span class="original">
        This collation sorts by Unicode code point.  It is only available for
        encoding &lt;literal&gt;UTF8&lt;/literal&gt;.  (This collation has the same
        behavior as the libc locale specification &lt;literal&gt;C&lt;/literal&gt; in
        &lt;literal&gt;UTF8&lt;/literal&gt; encoding.)
</span>
この照合順序はUnicodeコードポイントで並べ替えます。
エンコーディング<code class="literal">UTF8</code>でのみ使用できます。
（この照合順序は、<code class="literal">UTF8</code>エンコーディングのlibcロケール指定<code class="literal">C</code>と同じ動作をします。）
       </p></dd></dl></div><p>
   </p></div><div class="sect3" id="COLLATION-MANAGING-PREDEFINED"><div class="titlepage"><div><div><h4 class="title">24.2.2.2. 定義済みの照合順序 <a href="#COLLATION-MANAGING-PREDEFINED" class="id_link">#</a></h4></div></div></div><span class="original">
   &lt;title&gt;Predefined Collations&lt;/title&gt;
</span><p>
<span class="original">
    If the operating system provides support for using multiple locales
    within a single program (&lt;function&gt;newlocale&lt;/function&gt; and related functions),
    or if support for ICU is configured,
    then when a database cluster is initialized, &lt;command&gt;initdb&lt;/command&gt;
    populates the system catalog &lt;literal&gt;pg_collation&lt;/literal&gt; with
    collations based on all the locales it finds in the operating
    system at the time.
</span>
オペレーティングシステムが単一のプログラム内(<code class="function">newlocale</code>や関連する関数)で複数のロケールを使用することをサポートしているか、ICUサポートが組み込み済みの場合、データベースクラスタが初期化されると<code class="command">initdb</code>は、オペレーティングシステム上で見つけた全てのロケールに基づく照合順序をシステムカタログの<code class="literal">pg_collation</code>に書き込みます。
   </p><p>
<span class="original">
    To inspect the currently available locales, use the query &lt;literal&gt;SELECT
    * FROM pg_collation&lt;/literal&gt;, or the command &lt;command&gt;\dOS+&lt;/command&gt;
    in &lt;application&gt;psql&lt;/application&gt;.
</span>
現在利用可能なロケールを調べるには、<code class="literal">SELECT * FROM pg_collation</code>という問合せを使うか、<span class="application">psql</span>内で<code class="command">\dOS+</code>コマンドを使用します。
   </p><div class="sect4" id="COLLATION-MANAGING-PREDEFINED-LIBC"><div class="titlepage"><div><div><h5 class="title">24.2.2.2.1. libc照合順序 <a href="#COLLATION-MANAGING-PREDEFINED-LIBC" class="id_link">#</a></h5></div></div></div><span class="original">
   &lt;title&gt;libc Collations&lt;/title&gt;
</span><p>
<span class="original">
    For example, the operating system might
    provide a locale named &lt;literal&gt;de_DE.utf8&lt;/literal&gt;.
    &lt;command&gt;initdb&lt;/command&gt; would then create a collation named
    &lt;literal&gt;de_DE.utf8&lt;/literal&gt; for encoding &lt;literal&gt;UTF8&lt;/literal&gt;
    that has both &lt;symbol&gt;LC_COLLATE&lt;/symbol&gt; and
    &lt;symbol&gt;LC_CTYPE&lt;/symbol&gt; set to &lt;literal&gt;de_DE.utf8&lt;/literal&gt;.
    It will also create a collation with the &lt;literal&gt;.utf8&lt;/literal&gt;
    tag stripped off the name.  So you could also use the collation
    under the name &lt;literal&gt;de_DE&lt;/literal&gt;, which is less cumbersome
    to write and makes the name less encoding-dependent.  Note that,
    nevertheless, the initial set of collation names is
    platform-dependent.
</span>
例えば、オペレーティングシステムが<code class="literal">de_DE.utf8</code>という名称のロケールを提供するとします。
<code class="command">initdb</code>は、<code class="literal">de_DE.utf8</code>に設定された<code class="symbol">LC_COLLATE</code>と<code class="symbol">LC_CTYPE</code>の両方を持つ<code class="literal">UTF8</code>エンコーディングの<code class="literal">de_DE.utf8</code>という名称の照合順序を作成します。
同時に照合順序の名称から<code class="literal">.utf8</code>タグを削除した照合順序も作成します。
そのため、<code class="literal">de_DE</code>という名前の照合を使用することもできます。
これは手間を省き、名称がエンコーディングに依存しにくいようになります。
それにもかかわらず、照合順序名称の初期値はプラットフォーム依存となることに気をつけてください。
   </p><p>
<span class="original">
    The default set of collations provided by &lt;literal&gt;libc&lt;/literal&gt; map
    directly to the locales installed in the operating system, which can be
    listed using the command &lt;literal&gt;locale -a&lt;/literal&gt;.  In case
    a &lt;literal&gt;libc&lt;/literal&gt; collation is needed that has different values
    for &lt;symbol&gt;LC_COLLATE&lt;/symbol&gt; and &lt;symbol&gt;LC_CTYPE&lt;/symbol&gt;, or if new
    locales are installed in the operating system after the database system
    was initialized, then a new collation may be created using
    the &lt;xref linkend="sql-createcollation"/&gt; command.
    New operating system locales can also be imported en masse using
    the &lt;link linkend="functions-admin-collation"&gt;&lt;function&gt;pg_import_system_collations()&lt;/function&gt;&lt;/link&gt; function.
</span>
<code class="literal">libc</code>が提供するデフォルトの照合順序の集合は、直接オペレーティングシステム内にインストールされたロケールにマップされ、コマンド<code class="literal">locale -a</code>で参照できます。
<code class="symbol">LC_COLLATE</code>と<code class="symbol">LC_CTYPE</code>で違う値を持つ<code class="literal">libc</code>照合順序が必要な場合、あるいはデータベースシステムが初期化された後に新しいロケールがインストールされた場合は、新しい照合順序を<a class="xref" href="sql-createcollation.html" title="CREATE COLLATION"><span class="refentrytitle">CREATE COLLATION</span></a>コマンドで作成できます。
また、新しいオペレーティングシステムロケールは、<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-COLLATION" title="表9.98 照合順序管理関数"><code class="function">pg_import_system_collations()</code></a>関数でインポートできます。
   </p><p>
<span class="original">
    Within any particular database, only collations that use that
    database's encoding are of interest.  Other entries in
    &lt;literal&gt;pg_collation&lt;/literal&gt; are ignored.  Thus, a stripped collation
    name such as &lt;literal&gt;de_DE&lt;/literal&gt; can be considered unique
    within a given database even though it would not be unique globally.
    Use of the stripped collation names is recommended, since it will
    make one fewer thing you need to change if you decide to change to
    another database encoding.  Note however that the &lt;literal&gt;default&lt;/literal&gt;,
    &lt;literal&gt;C&lt;/literal&gt;, and &lt;literal&gt;POSIX&lt;/literal&gt; collations can be used regardless of
    the database encoding.
</span>
どのようなデータベース内でも、データベースのエンコーディングを使用している照合順序のみが興味の対象となります。
<code class="literal">pg_collation</code>内の他のエントリは無視されます。
よって<code class="literal">de_DE</code>といったようなエンコーディング名が省かれた照合順序は、一般的には一意でなくてもデータベース内では一意であるとみなされます。
エンコーディング名が省かれた照合順序を使用することを推奨します。
というのも、データベースのエンコーディングを変更するときに、変えなければならないものを１つ減らせるからです。
しかし、<code class="literal">default</code>、<code class="literal">C</code>そして<code class="literal">POSIX</code>照合順序は、データベースのエンコーディングに関係なく使用可能であることに注意してください。
   </p><p>
<span class="original">
    &lt;productname&gt;PostgreSQL&lt;/productname&gt; considers distinct collation
    objects to be incompatible even when they have identical properties.
    Thus for example,
</span>
<span class="productname">PostgreSQL</span>は、異なる照合順序オブジェクトは、それらが同じプロパティを持っていても互換性がないものとみなします。
例えば、
</p><pre class="programlisting">
SELECT a COLLATE "C" &lt; b COLLATE "POSIX" FROM test1;
</pre><p>
<span class="original">
    will draw an error even though the &lt;literal&gt;C&lt;/literal&gt; and &lt;literal&gt;POSIX&lt;/literal&gt;
    collations have identical behaviors.  Mixing stripped and non-stripped
    collation names is therefore not recommended.
</span>
は、<code class="literal">C</code>と<code class="literal">POSIX</code>照合順序が同じ動作であってもエラーとなります。
よってエンコーディング名が省かれた照合順序を混ぜて使用することは推奨されません。
   </p></div><div class="sect4" id="COLLATION-MANAGING-PREDEFINED-ICU"><div class="titlepage"><div><div><h5 class="title">24.2.2.2.2. ICU照合順序 <a href="#COLLATION-MANAGING-PREDEFINED-ICU" class="id_link">#</a></h5></div></div></div><span class="original">
   &lt;title&gt;ICU Collations&lt;/title&gt;
</span><p>
<span class="original">
    With ICU, it is not sensible to enumerate all possible locale names.  ICU
    uses a particular naming system for locales, but there are many more ways
    to name a locale than there are actually distinct locales.
    &lt;command&gt;initdb&lt;/command&gt; uses the ICU APIs to extract a set of distinct
    locales to populate the initial set of collations.  Collations provided by
    ICU are created in the SQL environment with names in BCP 47 language tag
    format, with a &lt;quote&gt;private use&lt;/quote&gt;
    extension &lt;literal&gt;-x-icu&lt;/literal&gt; appended, to distinguish them from
    libc locales.
</span>
ICUにおいては、すべての可能なロケール名を列挙するのは賢明ではありません。
ICUはロケールの固有の名前付けシステムを使っています。
しかし、実際の個別のロケール名以上の名前を付ける多くの方法があります。
<code class="command">initdb</code>はICUのAPIを使い、照合順序の初期集合を入力するための
個別のロケールの集合を取り出します。
ICUが提供する照合順序は、libcロケールと区別するために、SQL環境において、<span class="quote">「<span class="quote">私的利用</span>」</span>拡張<code class="literal">-x-icu</code>を追加したBCP 47言語タグ形式の名前で作成されます。
   </p><p>
<span class="original">
    Here are some example collations that might be created:
</span>
以下は作成されるかもしれない照合順序の例です。

    </p><div class="variablelist"><dl class="variablelist"><dt id="COLLATION-MANAGING-PREDEFINED-ICU-DE-X-ICU"><span class="term"><code class="literal">de-x-icu</code></span> <a href="#COLLATION-MANAGING-PREDEFINED-ICU-DE-X-ICU" class="id_link">#</a></dt><dd><span class="original">
       &lt;para&gt;German collation, default variant&lt;/para&gt;
</span><p>ドイツ語照合順序、デフォルトの異型</p></dd><dt id="COLLATION-MANAGING-PREDEFINED-ICU-DE-AT-X-ICU"><span class="term"><code class="literal">de-AT-x-icu</code></span> <a href="#COLLATION-MANAGING-PREDEFINED-ICU-DE-AT-X-ICU" class="id_link">#</a></dt><dd><span class="original">
       &lt;para&gt;German collation for Austria, default variant&lt;/para&gt;
</span><p>オーストリアのドイツ語照合順序、デフォルトの異型</p><p>
<span class="original">
        (There are also, say, &lt;literal&gt;de-DE-x-icu&lt;/literal&gt;
        or &lt;literal&gt;de-CH-x-icu&lt;/literal&gt;, but as of this writing, they are
        equivalent to &lt;literal&gt;de-x-icu&lt;/literal&gt;.)
</span>
（他に、<code class="literal">de-DE-x-icu</code>あるいは<code class="literal">de-CH-x-icu</code>というのがあります。
しかし、本稿執筆時点では、それらは<code class="literal">de-x-icu</code>と同じです。）
       </p></dd><dt id="COLLATION-MANAGING-PREDEFINED-ICU-UND-X-ICU"><span class="term"><code class="literal">und-x-icu</code> (<span class="quote">「<span class="quote">undefined</span>」</span>用)</span> <a href="#COLLATION-MANAGING-PREDEFINED-ICU-UND-X-ICU" class="id_link">#</a></dt><dd><p>
<span class="original">
        ICU &lt;quote&gt;root&lt;/quote&gt; collation.  Use this to get a reasonable
        language-agnostic sort order.
</span>
ICU<span class="quote">「<span class="quote">root</span>」</span>照合順序。
言語に依存しない適当なソート順を得るために使用してください。
       </p></dd></dl></div><p>
   </p><p>
<span class="original">
    Some (less frequently used) encodings are not supported by ICU.  When the
    database encoding is one of these, ICU collation entries
    in &lt;literal&gt;pg_collation&lt;/literal&gt; are ignored.  Attempting to use one
    will draw an error along the lines of &lt;quote&gt;collation "de-x-icu" for
    encoding "WIN874" does not exist&lt;/quote&gt;.
</span>
ある種の（利用頻度が低い）エンコーディングをICUはサポートしません。
データベースエンコーディングがこのようなものであった場合、<code class="literal">pg_collation</code>中のICU照合順序は無視されます。
このようなものを使おうとすると、<span class="quote">「<span class="quote">collation "de-x-icu" for encoding "WIN874" does not exist</span>」</span>というメッセージを伴ったエラーが発生します。
   </p></div></div><div class="sect3" id="COLLATION-CREATE"><div class="titlepage"><div><div><h4 class="title">24.2.2.3. 新しい照合順序オブジェクの作成 <a href="#COLLATION-CREATE" class="id_link">#</a></h4></div></div></div><span class="original">
   &lt;title&gt;Creating New Collation Objects&lt;/title&gt;
</span><p>
<span class="original">
    If the standard and predefined collations are not sufficient, users can
    create their own collation objects using the SQL
    command &lt;xref linkend="sql-createcollation"/&gt;.
</span>
標準の定義済み照合順序が十分でない場合は、ユーザはSQLコマンド<a class="xref" href="sql-createcollation.html" title="CREATE COLLATION"><span class="refentrytitle">CREATE COLLATION</span></a>で照合順序オブジェクトを作成できます。
   </p><p>
<span class="original">
    The standard and predefined collations are in the
    schema &lt;literal&gt;pg_catalog&lt;/literal&gt;, like all predefined objects.
    User-defined collations should be created in user schemas.  This also
    ensures that they are saved by &lt;command&gt;pg_dump&lt;/command&gt;.
</span>
すべての定義済みオブジェクト同様、標準の定義済み照合順序は<code class="literal">pg_catalog</code>スキーマにあります。
これはまた、<code class="command">pg_dump</code>の保存対象になることを確実にします。
   </p><div class="sect4" id="COLLATION-MANAGING-CREATE-LIBC"><div class="titlepage"><div><div><h5 class="title">24.2.2.3.1. libc照合順序 <a href="#COLLATION-MANAGING-CREATE-LIBC" class="id_link">#</a></h5></div></div></div><span class="original">
    &lt;title&gt;libc Collations&lt;/title&gt;
</span><p>
<span class="original">
     New libc collations can be created like this:
</span>
以下のようにして新しいlibc照合順序を作成できます。
</p><pre class="programlisting">
CREATE COLLATION german (provider = libc, locale = 'de_DE');
</pre><p>
<span class="original">
     The exact values that are acceptable for the &lt;literal&gt;locale&lt;/literal&gt;
     clause in this command depend on the operating system.  On Unix-like
     systems, the command &lt;literal&gt;locale -a&lt;/literal&gt; will show a list.
</span>
コマンド中の<code class="literal">locale</code>句に使用できる正確な値は、オペレーティングシステムに依存します。
Unix系のシステムでは、<code class="literal">locale -a</code>コマンドでこのリストを表示できるでしょう。
    </p><p>
<span class="original">
     Since the predefined libc collations already include all collations
     defined in the operating system when the database instance is
     initialized, it is not often necessary to manually create new ones.
     Reasons might be if a different naming system is desired (in which case
     see also &lt;xref linkend="collation-copy"/&gt;) or if the operating system has
     been upgraded to provide new locale definitions (in which case see
     also &lt;link linkend="functions-admin-collation"&gt;&lt;function&gt;pg_import_system_collations()&lt;/function&gt;&lt;/link&gt;).
</span>
定義済みのlibc照合順序は、データベースインスタンスが初期化された際に、オペレーティングシステムで定義されたすべての照合順序をすでに含んでいるので、新しいものを手動で作る必要はあまりないでしょう。
そうしたことをする理由があるとすれば、異なる命名規則が必要である（この場合は、<a class="xref" href="collation.html#COLLATION-COPY" title="24.2.2.3.3. 照合順序の複製">24.2.2.3.3</a>も参照してください）、あるいはオペレーティングシステムが更新されて、新しい照合順序の定義が提供されるようになった場合です。（この場合は<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-COLLATION" title="表9.98 照合順序管理関数"><code class="function">pg_import_system_collations()</code></a>も参照してください。）
    </p></div><div class="sect4" id="COLLATION-MANAGING-CREATE-ICU"><div class="titlepage"><div><div><h5 class="title">24.2.2.3.2. ICU照合順序 <a href="#COLLATION-MANAGING-CREATE-ICU" class="id_link">#</a></h5></div></div></div><span class="original">
    &lt;title&gt;ICU Collations&lt;/title&gt;
</span><p>
<span class="original">
     ICU collations can be created like:
</span>
ICU照合順序は次のように作成できます。

</p><pre class="programlisting">
CREATE COLLATION german (provider = icu, locale = 'de-DE');
</pre><p>

<span class="original">
     ICU locales are specified as a BCP 47 &lt;link
     linkend="icu-language-tag"&gt;Language Tag&lt;/link&gt;, but can also accept most
     libc-style locale names. If possible, libc-style locale names are
     transformed into language tags.
</span>
ICUロケールはBCP 47<a class="link" href="locale.html#ICU-LANGUAGE-TAG" title="24.1.5.3. 言語タグ">言語タグ</a>として指定されますが、ほとんどのlibcスタイルのロケール名も受け入れます。
可能な場合、libcスタイルのロケール名は言語タグに変換されます。
    </p><p>
<span class="original">
     New ICU collations can customize collation behavior extensively by
     including collation attributes in the language tag. See &lt;xref
     linkend="icu-custom-collations"/&gt; for details and examples.
</span>
新しいカスタマイズICU照合順序では、照合順序タグに照合順序属性を含めることで、言語の動作を広範囲にICU化できます。
詳細と例については、<a class="xref" href="collation.html#ICU-CUSTOM-COLLATIONS" title="24.2.3. ICU照合順序カスタム">24.2.3</a>を参照してください。
    </p></div><div class="sect4" id="COLLATION-COPY"><div class="titlepage"><div><div><h5 class="title">24.2.2.3.3. 照合順序の複製 <a href="#COLLATION-COPY" class="id_link">#</a></h5></div></div></div><span class="original">
   &lt;title&gt;Copying Collations&lt;/title&gt;
</span><p>
<span class="original">
    The command &lt;xref linkend="sql-createcollation"/&gt; can also be used to
    create a new collation from an existing collation, which can be useful to
    be able to use operating-system-independent collation names in
    applications, create compatibility names, or use an ICU-provided collation
    under a more readable name.  For example:
</span>
コマンド<a class="xref" href="sql-createcollation.html" title="CREATE COLLATION"><span class="refentrytitle">CREATE COLLATION</span></a>は、既存の照合順序から新しい照合順序を作る際にも利用できます。
これは、オペレーティングシステムから独立した照合順序名をアプリケーションで使用可能にしたり、互換性のある名称を作成したり、ICUが提供する照合順序を、よりわかりやすい名称で利用するのに役立ちます。
例を示します。
</p><pre class="programlisting">
CREATE COLLATION german FROM "de_DE";
CREATE COLLATION french FROM "fr-x-icu";
</pre><p>
   </p></div></div><div class="sect3" id="COLLATION-NONDETERMINISTIC"><div class="titlepage"><div><div><h4 class="title">24.2.2.4. 非決定論的な照合順序 <a href="#COLLATION-NONDETERMINISTIC" class="id_link">#</a></h4></div></div></div><span class="original">
    &lt;title&gt;Nondeterministic Collations&lt;/title&gt;
</span><p>
<span class="original">
     A collation is either &lt;firstterm&gt;deterministic&lt;/firstterm&gt; or
     &lt;firstterm&gt;nondeterministic&lt;/firstterm&gt;.  A deterministic collation uses
     deterministic comparisons, which means that it considers strings to be
     equal only if they consist of the same byte sequence.  Nondeterministic
     comparison may determine strings to be equal even if they consist of
     different bytes.  Typical situations include case-insensitive comparison,
     accent-insensitive comparison, as well as comparison of strings in
     different Unicode normal forms.  It is up to the collation provider to
     actually implement such insensitive comparisons; the deterministic flag
     only determines whether ties are to be broken using bytewise comparison.
     See also &lt;ulink url="https://www.unicode.org/reports/tr10"&gt;Unicode Technical
     Standard 10&lt;/ulink&gt; for more information on the terminology.
</span>
照合順序は<em class="firstterm">決定論的</em>もしくは<em class="firstterm">非決定論的</em>のどちらかです。
決定論的な照合順序は決定論的な比較を使用します。
つまり、同じバイト列で構成される場合に限り等しい文字列とみなします。
非決定論的な比較は、異なるバイト値で構成される文字列の場合でさえ文字列が等しいと判定するかもしれません。
一般的な状況では、大文字小文字を区別しない比較、アクセントを区別しない比較および異なるUnicode正規化形式による文字列の比較が含まれます。
このような区別しない比較を実際に実装するかは照合順序のプロパイダ次第です。
deterministicフラグはバイト単位の比較を用いて分解されるかどうかのみを決定します。
用語の詳細については、<a class="ulink" href="https://www.unicode.org/reports/tr10" target="_top">Unicode Technical Standard 10</a>を参照してください。
    </p><p>
<span class="original">
     To create a nondeterministic collation, specify the property
     &lt;literal&gt;deterministic = false&lt;/literal&gt; to &lt;command&gt;CREATE
     COLLATION&lt;/command&gt;, for example:
</span>
非決定論的な照合順序を作るためには<code class="command">CREATE COLLATION</code>に<code class="literal">deterministic = false</code>プロパティを指定します。
以下に例を示します。
</p><pre class="programlisting">
CREATE COLLATION ndcoll (provider = icu, locale = 'und', deterministic = false);
</pre><p>
<span class="original">
     This example would use the standard Unicode collation in a
     nondeterministic way.  In particular, this would allow strings in
     different normal forms to be compared correctly.  More interesting
     examples make use of the ICU customization facilities explained above.
     For example:
</span>
この例では非決定論的な方法で標準のUnicode照合順序を使えます。
具体的には、これは異なる正規形の文字列を正しく比較できるでしょう。
より興味深い例は上述したICUカスタマイズ機能を用いた場合です。
以下に例を示します。
</p><pre class="programlisting">
CREATE COLLATION case_insensitive (provider = icu, locale = 'und-u-ks-level2', deterministic = false);
CREATE COLLATION ignore_accents (provider = icu, locale = 'und-u-ks-level1-kc-true', deterministic = false);
</pre><p>
    </p><p>
<span class="original">
     All standard and predefined collations are deterministic, all
     user-defined collations are deterministic by default.  While
     nondeterministic collations give a more &lt;quote&gt;correct&lt;/quote&gt; behavior,
     especially when considering the full power of Unicode and its many
     special cases, they also have some drawbacks.  Foremost, their use leads
     to a performance penalty.  Note, in particular, that B-tree cannot use
     deduplication with indexes that use a nondeterministic collation.  Also,
     certain operations are not possible with nondeterministic collations,
     such as pattern matching operations.  Therefore, they should be used
     only in cases where they are specifically wanted.
</span>
すべての標準および事前に定義された照合順序は決定論的であり、すべてのユーザ定義の照合順序はデフォルトで決定論的です。
特にUnicodeの全機能およびその特別な場合を考えた際、非決定論的な照合順序はより多くの<span class="quote">「<span class="quote">正しい</span>」</span>振る舞いを与えると同時に、いくつかの欠点もあります。
第一にそれらを使用するとパフォーマンスが低下します。
B-treeは非決定的照合順序を使用したインデックスでは重複排除には使用できないことに特に注意してください。
また、パターンマッチング操作などで非決定論的な照合順序による操作ができないことも避けられません。
したがって、これらは明確に必要とされる場合のみに使用されるべきです。
    </p><div class="tip"><h3 class="title">ヒント</h3><p>
<span class="original">
      To deal with text in different Unicode normalization forms, it is also
      an option to use the functions/expressions
      &lt;function&gt;normalize&lt;/function&gt; and &lt;literal&gt;is normalized&lt;/literal&gt; to
      preprocess or check the strings, instead of using nondeterministic
      collations.  There are different trade-offs for each approach.
</span>
異なるUnicode正規化形式のテキストを処理する場合、非決定論的な照合を使用する代わりに<code class="function">normalize</code>および<code class="literal">is normalized</code>関数もしくは式を使用して文字列の前処理もしくはチェックをするオプションもあります。
それぞれのアプローチで異なるトレードオフがあります。
     </p></div></div></div><div class="sect2" id="ICU-CUSTOM-COLLATIONS"><div class="titlepage"><div><div><h3 class="title">24.2.3. ICU照合順序カスタム <a href="#ICU-CUSTOM-COLLATIONS" class="id_link">#</a></h3></div></div></div><span class="original">
   &lt;title&gt;ICU Custom Collations&lt;/title&gt;
</span><p>
<span class="original">
    ICU allows extensive control over collation behavior by defining new
    collations with collation settings as a part of the language tag. These
    settings can modify the collation order to suit a variety of needs. For
    instance:
</span>
ICUは、言語タグの一部として照合順序設定を持つ新しい照合順序を定義することで、照合順序の動作を広範囲に制御することができます。
これらの設定は、さまざまなニーズに合わせて照合順序順序を変更できます。
インスタンスの場合:

</p><pre class="programlisting">
-- ignore differences in accents and case
CREATE COLLATION ignore_accent_case (provider = icu, deterministic = false, locale = 'und-u-ks-level1');
SELECT 'Å' = 'A' COLLATE ignore_accent_case; -- true
SELECT 'z' = 'Z' COLLATE ignore_accent_case; -- true

-- upper case letters sort before lower case.
CREATE COLLATION upper_first (provider = icu, locale = 'und-u-kf-upper');
SELECT 'B' &lt; 'b' COLLATE upper_first; -- true

-- treat digits numerically and ignore punctuation
CREATE COLLATION num_ignore_punct (provider = icu, deterministic = false, locale = 'und-u-ka-shifted-kn');
SELECT 'id-45' &lt; 'id-123' COLLATE num_ignore_punct; -- true
SELECT 'w;x*y-z' = 'wxyz' COLLATE num_ignore_punct; -- true
</pre><p>

<span class="original">
    Many of the available options are described in &lt;xref
    linkend="icu-collation-settings"/&gt;, or see &lt;xref
    linkend="icu-external-references"/&gt; for more details.
</span>
利用可能なオプションの多くは<a class="xref" href="collation.html#ICU-COLLATION-SETTINGS" title="24.2.3.2. ICUロケールの照合順序設定">24.2.3.2</a>で説明されています。
詳細は<a class="xref" href="collation.html#ICU-EXTERNAL-REFERENCES" title="24.2.3.5. ICUの外部参照">24.2.3.5</a>を参照してください。
   </p><div class="sect3" id="ICU-COLLATION-COMPARISON-LEVELS"><div class="titlepage"><div><div><h4 class="title">24.2.3.1. ICU比較レベル <a href="#ICU-COLLATION-COMPARISON-LEVELS" class="id_link">#</a></h4></div></div></div><span class="original">
    &lt;title&gt;ICU Comparison Levels&lt;/title&gt;
</span><p>
<span class="original">
     Comparison of two strings (collation) in ICU is determined by a
     multi-level process, where textual features are grouped into
     "levels". Treatment of each level is controlled by the &lt;link
     linkend="icu-collation-settings-table"&gt;collation settings&lt;/link&gt;. Higher
     levels correspond to finer textual features.
</span>
ICUでの2つの文字列の比較（照合）は、テキストの特徴が「レベル」にグループ化される多段階プロセスによって決定されます。
各レベルの処理は、<a class="link" href="collation.html#ICU-COLLATION-SETTINGS-TABLE" title="表24.2 ICU照合順序設定">照合設定</a>によって制御されます。
高いレベルは、より細かいテキストの特徴に対応します。
    </p><p>
<span class="original">
     &lt;xref linkend="icu-collation-levels"/&gt; shows which textual feature
     differences are considered significant when determining equality at the
     given level. The Unicode character &lt;literal&gt;U+2063&lt;/literal&gt; is an
     invisible separator, and as seen in the table, is ignored for at all
     levels of comparison less than &lt;literal&gt;identic&lt;/literal&gt;.
</span>
<a class="xref" href="collation.html#ICU-COLLATION-LEVELS" title="表24.1 ICU照合順序レベル">表 24.1</a>は、指定されたレベルで等しいかどうかを決定する際に重要とされるテキスト特徴の違いを示しています。
Unicode文字<code class="literal">U+2063</code>は不可視のセパレータであり、表に示されているように、<code class="literal">identic</code>未満のすべての比較レベルで無視されます。
    </p><div class="table" id="ICU-COLLATION-LEVELS"><p class="title"><strong>表24.1 ICU照合順序レベル</strong></p><div class="table-contents"><span class="original">
      &lt;title&gt;ICU Collation Levels&lt;/title&gt;
</span><table class="table" summary="ICU照合順序レベル" border="1"><colgroup><col class="col1" /><col class="col2" /><col class="col3" /><col class="col4" /><col class="col5" /><col class="col6" /><col class="col7" /><col class="col8" /></colgroup><thead><tr><th>レベル</th><th>説明</th><th><code class="literal">'f' = 'f'</code></th><th><code class="literal">'ab' = U&amp;'a\2063b'</code></th><th><code class="literal">'x-y' = 'x_y'</code></th><th><code class="literal">'g' = 'G'</code></th><th><code class="literal">'n' = 'ñ'</code></th><th><code class="literal">'y' = 'z'</code></th></tr></thead><tbody><tr><td>level1</td><td>基本文字</td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">false</code></td></tr><tr><td>level2</td><td>アクセント</td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td></tr><tr><td>level3</td><td>大文字小文字／異型</td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td></tr><tr><td>level4</td><td>句読点</td><td><code class="literal">true</code></td><td><code class="literal">true</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td></tr><tr><td>identic</td><td>すべて</td><td><code class="literal">true</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td><td><code class="literal">false</code></td></tr></tbody></table></div></div><br class="table-break" /><p>
<span class="original">
     At every level, even with full normalization off, basic normalization is
     performed. For example, &lt;literal&gt;'á'&lt;/literal&gt; may be composed of the
     code points &lt;literal&gt;U&amp;amp;'\0061\0301'&lt;/literal&gt; or the single code
     point &lt;literal&gt;U&amp;amp;'\00E1'&lt;/literal&gt;, and those sequences will be
     considered equal even at the &lt;literal&gt;identic&lt;/literal&gt; level. To treat
     any difference in code point representation as distinct, use a collation
     created with &lt;symbol&gt;deterministic&lt;/symbol&gt; set to
     &lt;literal&gt;true&lt;/literal&gt;.
</span>
すべてのレベルで、完全正規化が無効であっても基本正規化は行われます。
例の場合、<code class="literal">'á'</code>はコードポイント<code class="literal">U&amp;'\0061\0301'</code>または単一コードポイント<code class="literal">U&amp;'\00E1'</code>で構成され、これらのシーケンスは<code class="literal">identic</code>レベルでも等しいとみなされます。
コードポイント表現形式内の差を個別として扱うには、<code class="symbol">deterministic</code>を<code class="literal">true</code>に設定して作成された照合順序を使用します。
    </p><div class="sect4" id="ICU-COLLATION-LEVEL-EXAMPLES"><div class="titlepage"><div><div><h5 class="title">24.2.3.1.1. 照合順序レベルの例 <a href="#ICU-COLLATION-LEVEL-EXAMPLES" class="id_link">#</a></h5></div></div></div><span class="original">
     &lt;title&gt;Collation Level Examples&lt;/title&gt;
</span><pre class="programlisting">
CREATE COLLATION level3 (provider = icu, deterministic = false, locale = 'und-u-ka-shifted-ks-level3');
CREATE COLLATION level4 (provider = icu, deterministic = false, locale = 'und-u-ka-shifted-ks-level4');
CREATE COLLATION identic (provider = icu, deterministic = false, locale = 'und-u-ka-shifted-ks-identic');

-- invisible separator ignored at all levels except identic
SELECT 'ab' = U&amp;'a\2063b' COLLATE level4; -- true
SELECT 'ab' = U&amp;'a\2063b' COLLATE identic; -- false

-- punctuation ignored at level3 but not at level 4
SELECT 'x-y' = 'x_y' COLLATE level3; -- true
SELECT 'x-y' = 'x_y' COLLATE level4; -- false
</pre></div></div><div class="sect3" id="ICU-COLLATION-SETTINGS"><div class="titlepage"><div><div><h4 class="title">24.2.3.2. ICUロケールの照合順序設定 <a href="#ICU-COLLATION-SETTINGS" class="id_link">#</a></h4></div></div></div><span class="original">
    &lt;title&gt;Collation Settings for an ICU Locale&lt;/title&gt;
</span><p>
<span class="original">
     &lt;xref linkend="icu-collation-settings-table"/&gt; shows the available
     collation settings, which can be used as part of a language tag to
     customize a collation.
</span>
<a class="xref" href="collation.html#ICU-COLLATION-SETTINGS-TABLE" title="表24.2 ICU照合順序設定">表 24.2</a>には、利用可能な照合順序設定が表示されます。
これらは言語タグの一部として使用して照合順序をカスタマイズすることができます。
    </p><div class="table" id="ICU-COLLATION-SETTINGS-TABLE"><p class="title"><strong>表24.2 ICU照合順序設定</strong></p><div class="table-contents"><span class="original">
      &lt;title&gt;ICU Collation Settings&lt;/title&gt;
</span><table class="table" summary="ICU照合順序設定" border="1"><colgroup><col class="col1" /><col class="col2" /><col class="col3" /><col class="col4" /></colgroup><thead><tr><th>キー</th><th>値</th><th>デフォルト</th><th>説明</th></tr></thead><tbody><tr><td><code class="literal">co</code></td><td><code class="literal">emoji</code>, <code class="literal">phonebk</code>, <code class="literal">standard</code>, <em class="replaceable"><code>...</code></em></td><td><code class="literal">standard</code></td><td>
<span class="original">
          Collation type. See &lt;xref linkend="icu-external-references"/&gt; for additional options and details.
</span>
照合順序タイプ。追加のオプションと詳細については<a class="xref" href="collation.html#ICU-EXTERNAL-REFERENCES" title="24.2.3.5. ICUの外部参照">24.2.3.5</a>を参照してください。
         </td></tr><tr><td><code class="literal">ka</code></td><td><code class="literal">noignore</code>, <code class="literal">shifted</code></td><td><code class="literal">noignore</code></td><td>
<span class="original">
          If set to &lt;literal&gt;shifted&lt;/literal&gt;, causes some characters
          (e.g. punctuation or space) to be ignored in comparison. Key
          &lt;literal&gt;ks&lt;/literal&gt; must be set to &lt;literal&gt;level3&lt;/literal&gt; or
          lower to take effect. Set key &lt;literal&gt;kv&lt;/literal&gt; to control which
          character classes are ignored.
</span>
<code class="literal">shifted</code>に設定されている場合、いくつかの文字（例：句読点やスペース）が比較で無視されるようになります。
効果を発揮するには、キー<code class="literal">ks</code>を<code class="literal">level3</code>以下に設定する必要があります。
どの文字クラスが無視されるかを制御するためにキー<code class="literal">kv</code>を設定します。
         </td></tr><tr><td><code class="literal">kb</code></td><td><code class="literal">true</code>, <code class="literal">false</code></td><td><code class="literal">false</code></td><td>
<span class="original">
          Backwards comparison for the level 2 differences. For example,
          locale &lt;literal&gt;und-u-kb&lt;/literal&gt; sorts &lt;literal&gt;'àe'&lt;/literal&gt;
          before &lt;literal&gt;'aé'&lt;/literal&gt;.
</span>
レベル2の差異の逆比較。
例えば、ロケール<code class="literal">und-u-kb</code>は<code class="literal">'àe'</code>を<code class="literal">'aé'</code>よりも前に並べます。
         </td></tr><tr><td><code class="literal">kc</code></td><td><code class="literal">true</code>, <code class="literal">false</code></td><td><code class="literal">false</code></td><td>
          <p>
<span class="original">
           Separates case into a "level 2.5" that falls between accents and
           other level 3 features.
</span>
大文字小文字をアクセントと他のレベル3の特徴の間に「レベル2.5」として分離します。
          </p>
          <p>
<span class="original">
           If set to &lt;literal&gt;true&lt;/literal&gt; and &lt;literal&gt;ks&lt;/literal&gt; is set
           to &lt;literal&gt;level1&lt;/literal&gt;, will ignore accents but take case
           into account.
</span>
<code class="literal">true</code>に設定されており、<code class="literal">ks</code>が<code class="literal">level1</code>に設定されている場合、アクセントを無視しますが、大文字小文字を考慮します。
          </p>
         </td></tr><tr><td><code class="literal">kf</code></td><td>
          <code class="literal">upper</code>, <code class="literal">lower</code>,
          <code class="literal">false</code>
         </td><td><code class="literal">false</code></td><td>
<span class="original">
          If set to &lt;literal&gt;upper&lt;/literal&gt;, upper case sorts before lower
          case. If set to &lt;literal&gt;lower&lt;/literal&gt;, lower case sorts before
          upper case. If set to &lt;literal&gt;false&lt;/literal&gt;, the sort depends on
          the rules of the locale.
</span>
<code class="literal">upper</code>に設定されている場合、大文字が小文字よりも前に並べられます。
<code class="literal">lower</code>に設定されている場合、小文字が大文字よりも前に並べられます。
<code class="literal">false</code>に設定されている場合、並べ替えはロケールの規則に依存します。
         </td></tr><tr><td><code class="literal">kn</code></td><td><code class="literal">true</code>, <code class="literal">false</code></td><td><code class="literal">false</code></td><td>
<span class="original">
          If set to &lt;literal&gt;true&lt;/literal&gt;, numbers within a string are
          treated as a single numeric value rather than a sequence of
          digits. For example, &lt;literal&gt;'id-45'&lt;/literal&gt; sorts before
          &lt;literal&gt;'id-123'&lt;/literal&gt;.
</span>
<code class="literal">true</code>に設定されている場合、文字列内の数字は、数字のシーケンスではなく単一の数値として扱われます。
例えば、<code class="literal">'id-45'</code>は<code class="literal">'id-123'</code>よりも前に並べられます。
         </td></tr><tr><td><code class="literal">kk</code></td><td><code class="literal">true</code>, <code class="literal">false</code></td><td><code class="literal">false</code></td><td>
          <p>
<span class="original">
           Enable full normalization; may affect performance. Basic
           normalization is performed even when set to
           &lt;literal&gt;false&lt;/literal&gt;. Locales for languages that require full
           normalization typically enable it by default.
</span>
完全正規化を有効にします。
パフォーマンスに影響する場合があります。
基本正規化は、<code class="literal">false</code>に設定されている場合でも実行されます。
完全正規化を必要とする言語のロケールでは、通常、デフォルトによって有効にされます。
          </p>
          <p>
<span class="original">
           Full normalization is important in some cases, such as when
           multiple accents are applied to a single character. For example,
           the code point sequences &lt;literal&gt;U&amp;amp;'\0065\0323\0302'&lt;/literal&gt;
           and &lt;literal&gt;U&amp;amp;'\0065\0302\0323'&lt;/literal&gt; represent
           an &lt;literal&gt;e&lt;/literal&gt; with circumflex and dot-below accents
           applied in different orders. With full normalization
           on, these code point sequences are treated as equal; otherwise they
           are unequal.
</span>
複数のアクセントが単一の文字に適用される場合など、完全正規化が重要な場合があります。
例えば、コードポイントシーケンス<code class="literal">U&amp;'\0065\0323\0302'</code>と<code class="literal">U&amp;'\0065\0302\0323'</code>は、異なる順序で適用されたサーカムフレックスと下ドットのアクセントを持つ<code class="literal">e</code>を表します。
完全正規化が有効の場合、これらのコードポイントシーケンスは等しいものとして扱われます。
それ以外の場合は等しくありません。
          </p>
         </td></tr><tr><td><code class="literal">kr</code></td><td>
          <code class="literal">space</code>, <code class="literal">punct</code>,
          <code class="literal">symbol</code>, <code class="literal">currency</code>,
          <code class="literal">digit</code>, <em class="replaceable"><code>script-id</code></em>
         </td><td> </td><td>
          <p>
<span class="original">
           Set to one or more of the valid values, or any BCP 47
           &lt;replaceable&gt;script-id&lt;/replaceable&gt;, e.g. &lt;literal&gt;latn&lt;/literal&gt;
           ("Latin") or &lt;literal&gt;grek&lt;/literal&gt; ("Greek"). Multiple values are
           separated by "&lt;literal&gt;-&lt;/literal&gt;".
</span>
1つ以上の有効な値、または任意のBCP 47<em class="replaceable"><code>script-id</code></em>に設定します。
たとえば、<code class="literal">latn</code>("ラテン")または<code class="literal">grek</code>("ギリシャ")です。
複数の値は"<code class="literal">-</code>"で区切ります。
          </p>
          <p>
<span class="original">
           Redefines the ordering of classes of characters; those characters
           belonging to a class earlier in the list sort before characters
           belonging to a class later in the list. For instance, the value
           &lt;literal&gt;digit-currency-space&lt;/literal&gt; (as part of a language tag
           like &lt;literal&gt;und-u-kr-digit-currency-space&lt;/literal&gt;) sorts
           punctuation before digits and spaces.
</span>
文字クラスの順序を再定義します。
リストの後の文字クラスに属する文字は、リストの後の文字クラスに属する文字よりも前に並べられます。
たとえば、値<code class="literal">digit-currency-space</code>（言語タグの一部として<code class="literal">und-u-kr-digit-currency-space</code>）は、句読点を数字とスペースの前に並べます。
          </p>
         </td></tr><tr><td><code class="literal">ks</code></td><td><code class="literal">level1</code>, <code class="literal">level2</code>, <code class="literal">level3</code>, <code class="literal">level4</code>, <code class="literal">identic</code></td><td><code class="literal">level3</code></td><td>
<span class="original">
          Sensitivity (or "strength") when determining equality, with
          &lt;literal&gt;level1&lt;/literal&gt; the least sensitive to differences and
          &lt;literal&gt;identic&lt;/literal&gt; the most sensitive to differences. See
          &lt;xref linkend="icu-collation-levels"/&gt; for details.
</span>
等価性を決定する際の感度（または「強度」）で、<code class="literal">level1</code>は差異に対して最も感度が低く、<code class="literal">identic</code>は差異に対して最も感度が高いです。
詳細は<a class="xref" href="collation.html#ICU-COLLATION-LEVELS" title="表24.1 ICU照合順序レベル">表 24.1</a>を参照してください。
         </td></tr><tr><td><code class="literal">kv</code></td><td>
          <code class="literal">space</code>, <code class="literal">punct</code>,
          <code class="literal">symbol</code>, <code class="literal">currency</code>
         </td><td><code class="literal">punct</code></td><td>
<span class="original">
          Classes of characters ignored during comparison at level 3. Setting
          to a later value includes earlier values;
          e.g. &lt;literal&gt;symbol&lt;/literal&gt; also includes
          &lt;literal&gt;punct&lt;/literal&gt; and &lt;literal&gt;space&lt;/literal&gt; in the
          characters to be ignored. Key &lt;literal&gt;ka&lt;/literal&gt; must be set to
          &lt;literal&gt;shifted&lt;/literal&gt; and key &lt;literal&gt;ks&lt;/literal&gt; must be set
          to &lt;literal&gt;level3&lt;/literal&gt; or lower to take effect.
</span>
レベル3での比較中に無視される文字クラス。
後の値に設定すると、前の値も含まれます。
たとえば、<code class="literal">symbol</code>は<code class="literal">punct</code>および<code class="literal">space</code>も含みます。
無視される文字を含む文字にキー<code class="literal">ka</code>を<code class="literal">shifted</code>に設定し、キー<code class="literal">ks</code>を<code class="literal">level3</code>以下に設定する必要があります。
         </td></tr></tbody></table></div></div><br class="table-break" /><p>
<span class="original">
     Defaults may depend on locale. The above table is not meant to be
     complete. See &lt;xref linkend="icu-external-references"/&gt; for additional
     options and details.
</span>
デフォルトはロケールによって異なります。
上記のテーブルは完全なものではありません。
追加のオプションと詳細については<a class="xref" href="collation.html#ICU-EXTERNAL-REFERENCES" title="24.2.3.5. ICUの外部参照">24.2.3.5</a>を参照してください。
    </p><div class="note"><h3 class="title">注記</h3><p>
<span class="original">
      For many collation settings, you must create the collation with
      &lt;option&gt;deterministic&lt;/option&gt; set to &lt;literal&gt;false&lt;/literal&gt; for the
      setting to have the desired effect (see &lt;xref
      linkend="collation-nondeterministic"/&gt;). Additionally, some settings
      only take effect when the key &lt;literal&gt;ka&lt;/literal&gt; is set to
      &lt;literal&gt;shifted&lt;/literal&gt; (see &lt;xref
      linkend="icu-collation-settings-table"/&gt;).
</span>
多くの照合順序設定では、目的の効果を得るために、<code class="option">deterministic</code>を<code class="literal">false</code>に設定した<code class="literal">照合順序</code>を作成する必要があります（<a class="xref" href="collation.html#COLLATION-NONDETERMINISTIC" title="24.2.2.4. 非決定論的な照合順序">24.2.2.4</a>を参照）。
また、キー<code class="literal">ka</code>が<code class="literal">shifted</code>に設定されている場合にのみ有効になる設定もあります（<a class="xref" href="collation.html#ICU-COLLATION-SETTINGS-TABLE" title="表24.2 ICU照合順序設定">表 24.2</a>を参照）。
     </p></div></div><div class="sect3" id="ICU-LOCALE-EXAMPLES"><div class="titlepage"><div><div><h4 class="title">24.2.3.3. 照合順序設定の例 <a href="#ICU-LOCALE-EXAMPLES" class="id_link">#</a></h4></div></div></div><span class="original">
    &lt;title&gt;Collation Settings Examples&lt;/title&gt;
</span><div class="variablelist"><dl class="variablelist"><dt id="COLLATION-MANAGING-CREATE-ICU-DE-U-CO-PHONEBK-X-ICU"><span class="term"><code class="literal">CREATE COLLATION "de-u-co-phonebk-x-icu" (provider = icu, locale = 'de-u-co-phonebk');</code></span> <a href="#COLLATION-MANAGING-CREATE-ICU-DE-U-CO-PHONEBK-X-ICU" class="id_link">#</a></dt><dd><span class="original">
        &lt;para&gt;German collation with phone book collation type&lt;/para&gt;
</span><p>電話帳照合順形式を伴うドイツ語の照合順序</p></dd><dt id="COLLATION-MANAGING-CREATE-ICU-UND-U-CO-EMOJI-X-ICU"><span class="term"><code class="literal">CREATE COLLATION "und-u-co-emoji-x-icu" (provider = icu, locale = 'und-u-co-emoji');</code></span> <a href="#COLLATION-MANAGING-CREATE-ICU-UND-U-CO-EMOJI-X-ICU" class="id_link">#</a></dt><dd><p>
<span class="original">
         Root collation with Emoji collation type, per Unicode Technical Standard #51
</span>
絵文字照合順序型を伴うroot照合順序。Unicode Technical Standard #51による。
        </p></dd><dt id="COLLATION-MANAGING-CREATE-ICU-EN-U-KR-GREK-LATN"><span class="term"><code class="literal">CREATE COLLATION latinlast (provider = icu, locale = 'en-u-kr-grek-latn');</code></span> <a href="#COLLATION-MANAGING-CREATE-ICU-EN-U-KR-GREK-LATN" class="id_link">#</a></dt><dd><p>
<span class="original">
         Sort Greek letters before Latin ones.  (The default is Latin before Greek.)
</span>
ラテン文字の前にギリシャ文字が来るように並べます。（デフォルトではギリシャ文字の前にラテン文字が来ます。）
        </p></dd><dt id="COLLATION-MANAGING-CREATE-ICU-EN-U-KF-UPPER"><span class="term"><code class="literal">CREATE COLLATION upperfirst (provider = icu, locale = 'en-u-kf-upper');</code></span> <a href="#COLLATION-MANAGING-CREATE-ICU-EN-U-KF-UPPER" class="id_link">#</a></dt><dd><p>
<span class="original">
         Sort upper-case letters before lower-case letters.  (The default is
         lower-case letters first.)
</span>
小文字の前に大文字が来るように並べます。（デフォルトでは最初に小文字が来ます。）
        </p></dd><dt id="COLLATION-MANAGING-CREATE-ICU-EN-U-KF-UPPER-KR-GREK-LATN"><span class="term"><code class="literal">CREATE COLLATION special (provider = icu, locale = 'en-u-kf-upper-kr-grek-latn');</code></span> <a href="#COLLATION-MANAGING-CREATE-ICU-EN-U-KF-UPPER-KR-GREK-LATN" class="id_link">#</a></dt><dd><p>
<span class="original">
         Combines both of the above options.
</span>
上記のオプションを組み合わせます。
        </p></dd></dl></div></div><div class="sect3" id="ICU-TAILORING-RULES"><div class="titlepage"><div><div><h4 class="title">24.2.3.4. ICU適合化規則 <a href="#ICU-TAILORING-RULES" class="id_link">#</a></h4></div></div></div><span class="original">
    &lt;title&gt;ICU Tailoring Rules&lt;/title&gt;
</span><p>
<span class="original">
     If the options provided by the collation settings shown above are not
     sufficient, the order of collation elements can be changed with tailoring
     rules, whose syntax is detailed at &lt;ulink
     url="https://unicode-org.github.io/icu/userguide/collation/customization/"&gt;&lt;/ulink&gt;.
</span>
上記のオプション設定によって提供される照合順序が十分でない場合は、照合順序要素のオーダーを適合化規則を使用して変更できます。
適合化規則の構文は<a class="ulink" href="https://unicode-org.github.io/icu/userguide/collation/customization/" target="_top">で詳しく説明されています。
</a>
    </p><p>
<span class="original">
     This small example creates a collation based on the root locale with a
     tailoring rule:
</span>
この小さな例は、rootロケールをベースにした照合順序を作成し、ルールを調整します。
</p><pre class="programlisting">
CREATE COLLATION custom (provider = icu, locale = 'und', rules = '&amp;V &lt;&lt; w &lt;&lt;&lt; W');
</pre><p>
<span class="original">
     With this rule, the letter &lt;quote&gt;W&lt;/quote&gt; is sorted after
     &lt;quote&gt;V&lt;/quote&gt;, but is treated as a secondary difference similar to an
     accent.  Rules like this are contained in the locale definitions of some
     languages.  (Of course, if a locale definition already contains the
     desired rules, then they don't need to be specified again explicitly.)
</span>
このルールでは、文字<span class="quote">「<span class="quote">W</span>」</span>は<span class="quote">「<span class="quote">V</span>」</span>の後にソートされますが、アクセントと同様に二次的な差として扱われます。
このようなルールは、一部の言語のロケール定義に含まれています。
（もちろん、ロケール定義がすでに目的のルールを包含している場合は、明示的に再指定する必要はありません。）
    </p><p>
<span class="original">
     Here is a more complex example.  The following statement sets up a
     collation named &lt;literal&gt;ebcdic&lt;/literal&gt; with rules to sort US-ASCII
     characters in the order of the EBCDIC encoding.
</span>
ここに、より複雑な例があります。
次のステートメントは、EBCDIC記名的のオーダーにUS-ASCII文字をソートするためのルールを使用して、照合順序エンコーディング<code class="literal">ebcdic</code>を設定します。

</p><pre class="programlisting">
CREATE COLLATION ebcdic (provider = icu, locale = 'und',
rules = $$
&amp; ' ' &lt; '.' &lt; '&lt;' &lt; '(' &lt; '+' &lt; \|
&lt; '&amp;' &lt; '!' &lt; '$' &lt; '*' &lt; ')' &lt; ';'
&lt; '-' &lt; '/' &lt; ',' &lt; '%' &lt; '_' &lt; '&gt;' &lt; '?'
&lt; '`' &lt; ':' &lt; '#' &lt; '@' &lt; \' &lt; '=' &lt; '"'
&lt;*a-r &lt; '~' &lt;*s-z &lt; '^' &lt; '[' &lt; ']'
&lt; '{' &lt;*A-I &lt; '}' &lt;*J-R &lt; '\' &lt;*S-Z &lt;*0-9
$$);

SELECT c
FROM (VALUES ('a'), ('b'), ('A'), ('B'), ('1'), ('2'), ('!'), ('^')) AS x(c)
ORDER BY c COLLATE ebcdic;
 c
---
 !
 a
 b
 ^
 A
 B
 1
 2
</pre><p>
    </p></div><div class="sect3" id="ICU-EXTERNAL-REFERENCES"><div class="titlepage"><div><div><h4 class="title">24.2.3.5. ICUの外部参照 <a href="#ICU-EXTERNAL-REFERENCES" class="id_link">#</a></h4></div></div></div><span class="original">
    &lt;title&gt;External References for ICU&lt;/title&gt;
</span><p>
<span class="original">
     This section (&lt;xref linkend="icu-custom-collations"/&gt;) is only a brief
     overview of ICU behavior and language tags. Refer to the following
     documents for technical details, additional options, and new behavior:
</span>
この節(<a class="xref" href="collation.html#ICU-CUSTOM-COLLATIONS" title="24.2.3. ICU照合順序カスタム">24.2.3</a>)は、概要の動作と言語タグの簡単なオプションです。
技術的な詳細、追加のICU、および新しい動作については、次のドキュメントを参照してください。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
       <a class="ulink" href="https://www.unicode.org/reports/tr35/tr35-collation.html" target="_top">Unicode Technical Standard #35</a>
      </p></li><li class="listitem"><p>
       <a class="ulink" href="https://www.rfc-editor.org/info/bcp47" target="_top">BCP 47</a>
      </p></li><li class="listitem"><p>
       <a class="ulink" href="https://github.com/unicode-org/cldr/blob/master/common/bcp47/collation.xml" target="_top">CLDR repository</a>
      </p></li><li class="listitem"><p>
       <a class="ulink" href="https://unicode-org.github.io/icu/userguide/locale/" target="_top">https://unicode-org.github.io/icu/userguide/locale/</a>
      </p></li><li class="listitem"><p>
       <a class="ulink" href="https://unicode-org.github.io/icu/userguide/collation/" target="_top">https://unicode-org.github.io/icu/userguide/collation/</a>
      </p></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="locale.html" title="24.1. ロケールのサポート">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="charset.html" title="第24章 ローカライゼーション">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="multibyte.html" title="24.3. 文字セットサポート">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">24.1. ロケールのサポート </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 16.3文書">ホーム</a></td><td width="40%" align="right" valign="top"> 24.3. 文字セットサポート</td></tr></table></div></body></html>