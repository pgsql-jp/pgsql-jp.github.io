<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.26. システム管理関数</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="functions-info.html" title="9.25. システム情報関数" /><link rel="next" href="functions-trigger.html" title="9.27. トリガ関数" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">9.26. システム管理関数</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-info.html" title="9.25. システム情報関数">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="第9章 関数と演算子">上へ</a></td><th width="60%" align="center">第9章 関数と演算子</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.0文書">ホーム</a></td><td width="10%" align="right"> <a accesskey="n" href="functions-trigger.html" title="9.27. トリガ関数">次へ</a></td></tr></table><hr></hr></div><div class="sect1" id="functions-admin"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.26. システム管理関数</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="functions-admin.html#functions-admin-set">9.26.1. 構成設定関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-admin-signal">9.26.2. サーバシグナル送信関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-admin-backup">9.26.3. バックアップ制御関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-recovery-control">9.26.4. リカバリ制御関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-snapshot-synchronization">9.26.5. スナップショット同期関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-replication">9.26.6. レプリケーション関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-admin-dbobject">9.26.7. データベースオブジェクト管理関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-admin-index">9.26.8. インデックス保守関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-admin-genfile">9.26.9. 汎用ファイルアクセス関数</a></span></dt><dt><span class="sect2"><a href="functions-admin.html#functions-advisory-locks">9.26.10. 勧告的ロック用関数</a></span></dt></dl></div><!--
   <title>System Administration Functions</title>
--><p><!--
    The functions described in this section are used to control and
    monitor a <productname>PostgreSQL</> installation.
-->本節で説明する関数は、<span class="productname">PostgreSQL</span>インストレーションの制御と監視を行うために使用されます。
   </p><div class="sect2" id="functions-admin-set"><div class="titlepage"><div><div><h3 class="title">9.26.1. 構成設定関数</h3></div></div></div><!--
   <title>Configuration Settings Functions</title>
--><p><!--
    <xref linkend="functions-admin-set-table"> shows the functions
    available to query and alter run-time configuration parameters.
--><a class="xref" href="functions-admin.html#functions-admin-set-table" title="表9.77 構成設定関数">表 9.77</a>は、実行時設定パラメータの問い合わせや変更に使用できる関数を示しています。
   </p><div class="table" id="functions-admin-set-table"><p class="title"><strong>表9.77 構成設定関数</strong></p><div class="table-contents"><!--
    <title>Configuration Settings Functions</title>
--><table class="table" summary="構成設定関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <a id="idm46270562029344" class="indexterm"></a>
        <code class="literal"><code class="function">current_setting(<em class="parameter"><code>setting_name</code></em> [, <em class="parameter"><code>missing_ok</code></em> ])</code></code>
       </td><td><code class="type">text</code></td><td>現在の設定値の取得</td></tr><tr><td>        <a id="idm46270562024896" class="indexterm"></a>
        <code class="literal"><code class="function">set_config(<em class="parameter"><code>setting_name</code></em>,
                             <em class="parameter"><code>new_value</code></em>,
                             <em class="parameter"><code>is_local</code></em>)</code></code>
       </td><td><code class="type">text</code></td><td>パラメータを設定し、新規値を返す</td></tr></tbody></table></div></div><br class="table-break" /><a id="idm46270562019952" class="indexterm"></a><a id="idm46270562019296" class="indexterm"></a><a id="idm46270562018608" class="indexterm"></a><p><!--
    The function <function>current_setting</function> yields the
    current value of the setting <parameter>setting_name</parameter>.
    It corresponds to the <acronym>SQL</acronym> command
    <command>SHOW</command>.  An example:
-->関数<code class="function">current_setting</code>は、設定<em class="parameter"><code>setting_name</code></em>の現在の値を返します。
この関数は、<acronym class="acronym">SQL</acronym>の<code class="command">SHOW</code>コマンドと同じです。
以下に例を示します。
</p><pre class="programlisting">SELECT current_setting('datestyle');

 current_setting
-----------------
 ISO, MDY
(1 row)</pre><p>
<!--
    If there is no setting named <parameter>setting_name</parameter>,
    <function>current_setting</function> throws an error
    unless <parameter>missing_ok</parameter> is supplied and is
    <literal>true</literal>.
-->
<em class="parameter"><code>setting_name</code></em>という名前の設定がない場合、<em class="parameter"><code>missing_ok</code></em>が渡され、かつ、それが<code class="literal">true</code>のときを除き、<code class="function">current_setting</code>はエラーを発生させます。
   </p><p><!--
    <function>set_config</function> sets the parameter
    <parameter>setting_name</parameter> to
    <parameter>new_value</parameter>.  If
    <parameter>is_local</parameter> is <literal>true</literal>, the
    new value will only apply to the current transaction. If you want
    the new value to apply for the current session, use
    <literal>false</literal> instead. The function corresponds to the
    SQL command <command>SET</command>. An example:
--><code class="function">set_config</code>関数は、パラメータ<em class="parameter"><code>setting_name</code></em>を<em class="parameter"><code>new_value</code></em>に設定します。
ただし、<em class="parameter"><code>is_local</code></em>が<code class="literal">true</code>の場合、新規値は現在のトランザクションにのみ適用されます。
新規値を現在のセッションに適用する場合は、代わりに<code class="literal">false</code>を使用してください。
この関数は、SQLの<code class="command">SET</code>コマンドと同じです。
以下に例を示します。
</p><pre class="programlisting">SELECT set_config('log_statement_stats', 'off', false);

 set_config
------------
 off
(1 row)</pre><p>
   </p></div><div class="sect2" id="functions-admin-signal"><div class="titlepage"><div><div><h3 class="title">9.26.2. サーバシグナル送信関数</h3></div></div></div><!--
   <title>Server Signaling Functions</title>
--><a id="idm46270562001088" class="indexterm"></a><a id="idm46270562000432" class="indexterm"></a><a id="idm46270561999744" class="indexterm"></a><a id="idm46270561999056" class="indexterm"></a><a id="idm46270561998368" class="indexterm"></a><p><!--
    The functions shown in <xref
    linkend="functions-admin-signal-table"> send control signals to
    other server processes.  Use of these functions is restricted to
    superusers by default but access may be granted to others using
    <command>GRANT</command>, with noted exceptions.
--><a class="xref" href="functions-admin.html#functions-admin-signal-table" title="表9.78 サーバシグナル送信関数">表 9.78</a>に示す関数は、制御用シグナルを他のサーバプロセスに送信します。
これらの関数の使用は、デフォルトでスーパーユーザのみに制限されていますが、注記された例外を除き、<code class="command">GRANT</code>により他のユーザにアクセスを許可できます。
   </p><div class="table" id="functions-admin-signal-table"><p class="title"><strong>表9.78 サーバシグナル送信関数</strong></p><div class="table-contents"><!--
    <title>Server Signaling Functions</title>
--><table class="table" summary="サーバシグナル送信関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_cancel_backend(<em class="parameter"><code>pid</code></em> <code class="type">int</code>)</code></code>
        </td><td><code class="type">boolean</code></td><td>バックエンドの現在の問い合わせを取り消す。
       関数を呼ぶユーザが取り消す対象のバックエンドのロールのメンバーであるとき、あるいは<code class="literal">pg_signal_backend</code>の権限を与えられているときも実行できます。
       ただし、スーパーユーザのバックエンドはスーパーユーザのみが取り消せます。
        </td></tr><tr><td>        <code class="literal"><code class="function">pg_reload_conf()</code></code>
        </td><td><code class="type">boolean</code></td><td>サーバプロセスに構成ファイルの再読み込みをさせる</td></tr><tr><td>        <code class="literal"><code class="function">pg_rotate_logfile()</code></code>
        </td><td><code class="type">boolean</code></td><td>サーバログファイルを循環させる</td></tr><tr><td>        <code class="literal"><code class="function">pg_terminate_backend(<em class="parameter"><code>pid</code></em> <code class="type">int</code>)</code></code>
        </td><td><code class="type">boolean</code></td><td>バックエンドを終了する。
       関数を呼ぶユーザが終了対象のバックエンドのロールのメンバーであるとき、あるいは<code class="literal">pg_signal_backend</code>の権限を与えられているときも実行できます。
       ただし、スーパーユーザのバックエンドはスーパーユーザのみが終了できます。
       </td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    Each of these functions returns <literal>true</literal> if
    successful and <literal>false</literal> otherwise.
-->これらのそれぞれの関数は成功の場合<code class="literal">true</code>（真）を返し、そうでない場合は<code class="literal">false</code>（偽）を返します。
   </p><p><!--
    <function>pg_cancel_backend</> and <function>pg_terminate_backend</>
    send signals (<systemitem>SIGINT</> or <systemitem>SIGTERM</>
    respectively) to backend processes identified by process ID.
    The process ID of an active backend can be found from
    the <structfield>pid</structfield> column of the
    <structname>pg_stat_activity</structname> view, or by listing the
    <command>postgres</command> processes on the server (using
    <application>ps</> on Unix or the <application>Task
    Manager</> on <productname>Windows</>).
    The role of an active backend can be found from the
    <structfield>usename</structfield> column of the
    <structname>pg_stat_activity</structname> view.
--><code class="function">pg_cancel_backend</code>と<code class="function">pg_terminate_backend</code>は（それぞれ、<span class="systemitem">SIGINT</span>または<span class="systemitem">SIGTERM</span>）シグナルをプロセス識別子で特定されたバックエンドプロセスに送ります。
使用中のバックエンドのプロセス識別子は<code class="structname">pg_stat_activity</code>ビューの<code class="structfield">pid</code>列から、もしくは、（Unixでは<span class="application">ps</span>、<span class="productname">Windows</span>では<span class="application">Task Manager</span>により）サーバ上の<code class="command">postgres</code>プロセスをリストすることで見つけられます。
実行中のバックエンドのロールは<code class="structname">pg_stat_activity</code>の<code class="structfield">usename</code>列から確認することができます。
   </p><p><!--
    <function>pg_reload_conf</> sends a <systemitem>SIGHUP</> signal
    to the server, causing configuration files
    to be reloaded by all server processes.
--><code class="function">pg_reload_conf</code>は<span class="systemitem">SIGHUP</span>シグナルをサーバに送り、その結果全てのサーバプロセスが構成ファイルを再読み込みすることになります。
   </p><p><!--
    <function>pg_rotate_logfile</> signals the log-file manager to switch
    to a new output file immediately.  This works only when the built-in
    log collector is running, since otherwise there is no log-file manager
    subprocess.
--><code class="function">pg_rotate_logfile</code>はログファイルマネージャに即座に新規出力ファイルに切替えるようシグナルを送ります。
これは組み込みログ取得が起動している場合のみ有効です。起動していない場合はログファイルマネージャの子プロセスが存在しない理由からです。
   </p></div><div class="sect2" id="functions-admin-backup"><div class="titlepage"><div><div><h3 class="title">9.26.3. バックアップ制御関数</h3></div></div></div><!--
   <title>Backup Control Functions</title>
--><a id="idm46270561961264" class="indexterm"></a><a id="idm46270561960384" class="indexterm"></a><a id="idm46270561959696" class="indexterm"></a><a id="idm46270561959040" class="indexterm"></a><a id="idm46270561958336" class="indexterm"></a><a id="idm46270561957648" class="indexterm"></a><a id="idm46270561956960" class="indexterm"></a><a id="idm46270561956272" class="indexterm"></a><a id="idm46270561955584" class="indexterm"></a><a id="idm46270561954896" class="indexterm"></a><a id="idm46270561954208" class="indexterm"></a><a id="idm46270561953520" class="indexterm"></a><a id="idm46270561952832" class="indexterm"></a><p><!--
    The functions shown in <xref
    linkend="functions-admin-backup-table"> assist in making on-line backups.
    These functions cannot be executed during recovery (except
    <function>pg_is_in_backup</function>, <function>pg_backup_start_time</function>
    and <function>pg_wal_lsn_diff</function>).
--><a class="xref" href="functions-admin.html#functions-admin-backup-table" title="表9.79 バックアップ制御関数">表 9.79</a>に示す関数はオンラインバックアップの作成を支援するものです。
これらの関数は、リカバリ中には実行できません(<code class="function">pg_is_in_backup</code>、<code class="function">pg_backup_start_time</code>、および<code class="function">pg_xlog_location_diff</code>は除く)。
   </p><div class="table" id="functions-admin-backup-table"><p class="title"><strong>表9.79 バックアップ制御関数</strong></p><div class="table-contents"><!--
    <title>Backup Control Functions</title>
--><table class="table" summary="バックアップ制御関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_create_restore_point(<em class="parameter"><code>name</code></em> <code class="type">text</code>)</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>リストア実行用に名前付けされたポイントを作成(デフォルトではスーパーユーザのみ実施可能、ただし他のユーザにも関数を実行するEXECUTE権限を与えることができる)</td></tr><tr><td>        <code class="literal"><code class="function">pg_current_wal_flush_lsn()</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>トランザクションログの現在のフラッシュ位置を取得する</td></tr><tr><td>        <code class="literal"><code class="function">pg_current_wal_insert_lsn()</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>現在のトランザクションログの挿入位置の取得</td></tr><tr><td>        <code class="literal"><code class="function">pg_current_wal_lsn()</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>現在のトランザクションログの書き込み位置を取得</td></tr><tr><td>        <code class="literal"><code class="function">pg_start_backup(<em class="parameter"><code>label</code></em> <code class="type">text</code> [<span class="optional">, <em class="parameter"><code>fast</code></em> <code class="type">boolean</code> [<span class="optional">, <em class="parameter"><code>exclusive</code></em> <code class="type">boolean</code> </span>]</span>])</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>オンラインバックアップの実行準備(デフォルトではスーパーユーザでのみ実施可能、ただし他のユーザにも関数を実行するEXECUTE権限を与えることができる)</td></tr><tr><td>        <code class="literal"><code class="function">pg_stop_backup()</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>排他的オンラインバックアップの実行の終了(デフォルトではスーパーユーザでのみ実施可能、ただし他のユーザにも関数を実行するEXECUTE権限を与えることができる)</td></tr><tr><td>        <code class="literal"><code class="function">pg_stop_backup(<em class="parameter"><code>exclusive</code></em> <code class="type">boolean</code> [<span class="optional">, <em class="parameter"><code>wait_for_archive</code></em> <code class="type">boolean</code> </span>])</code></code>
        </td><td><code class="type">setof record</code></td><td>排他的、あるいは非排他的オンラインバックアップの実行の終了（デフォルトではスーパーユーザでのみ実行可能、ただし他のユーザにも関数を実行するEXECUTE権限を与えることができる）</td></tr><tr><td>        <code class="literal"><code class="function">pg_is_in_backup()</code></code>
        </td><td><code class="type">bool</code></td><td>オンラインでの排他的バックアップが実行中は真。</td></tr><tr><td>        <code class="literal"><code class="function">pg_backup_start_time()</code></code>
        </td><td><code class="type">timestamp with time zone</code></td><td>実行中のオンライン排他的バックアップの開始時刻を取得。</td></tr><tr><td>        <code class="literal"><code class="function">pg_switch_wal()</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>新しいトランザクションログファイルへの強制移行(デフォルトではスーパーユーザのみ実行可能、ただし他のユーザにも関数を実行するEXECUTE権限を与えることができる)</td></tr><tr><td>        <code class="literal"><code class="function">pg_walfile_name(<em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>)</code></code>
        </td><td><code class="type">text</code></td><td>トランザクションログの位置を表す文字列をファイル名に変換</td></tr><tr><td>        <code class="literal"><code class="function">pg_walfile_name_offset(<em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>)</code></code>
        </td><td><code class="type">text</code>, <code class="type">integer</code></td><td>トランザクションログの位置を表す文字列を、ファイル名とファイル内の10進のバイトオフセットに変換</td></tr><tr><td>        <code class="literal"><code class="function">pg_wal_lsn_diff(<em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>)</code></code>
       </td><td><code class="type">numeric</code></td><td>2つのトランザクションログの位置差分を算出</td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    <function>pg_start_backup</> accepts an arbitrary user-defined label for
    the backup.  (Typically this would be the name under which the backup dump
    file will be stored.) When used in exclusive mode, the function writes a
    backup label file (<filename>backup_label</>) and, if there are any links
    in the <filename>pg_tblspc/</> directory, a tablespace map file
    (<filename>tablespace_map</>) into the database cluster's data directory,
    performs a checkpoint, and then returns the backup's starting write-ahead
    log location as text.  The user can ignore this result value, but it is
    provided in case it is useful. When used in non-exclusive mode, the
    contents of these files are instead returned by the
    <function>pg_stop_backup</> function, and should be written to the backup
    by the caller.
--><code class="function">pg_start_backup</code>は、ユーザが任意に定義したバックアップラベルを受け付けます。
（通常、格納に使用するバックアップダンプファイルにちなんだ名前が付けられます。）
排他モードで使用される場合、この関数は、データベースクラスタのデータディレクトリにバックアップラベルファイル（<code class="filename">backup_label</code>）および<code class="filename">pg_tblspc/</code>ディレクトリにリンクがあるならテーブル空間マップファイル（<code class="filename">tablespace_map</code>）を書き出し、チェックポイントを実行し、トランザクションログのバックアップ開始位置をテキスト形式で返します。
ユーザはこの結果値を無視することができますが、便利なこともあるので提供されています。
非排他モードで使用される場合は、排他モードとは違い、これらのファイルの内容が<code class="function">pg_stop_backup</code>関数によって戻され、呼び出しユーザはそれをバックアップに書き込む必要があります。

</p><pre class="programlisting">postgres=# select pg_start_backup('label_goes_here');
 pg_start_backup
-----------------
 0/D4445B8
(1 row)</pre><p><!--
    There is an optional second parameter of type <type>boolean</type>.  If <literal>true</>,
    it specifies executing <function>pg_start_backup</> as quickly as
    possible.  This forces an immediate checkpoint which will cause a
    spike in I/O operations, slowing any concurrently executing queries.
-->
オプションの<code class="type">boolean</code>型パラメータがあります。
<code class="literal">true</code>であれば、できる限り高速に<code class="function">pg_start_backup</code>を実行します。
これは、即時のチェックポイントを強制するため、I/O 操作の急激な増加を引き起こし、実行中の問い合わせ全てを遅延させることがあります。
   </p><p><!--
    In an exclusive backup, <function>pg_stop_backup</> removes the label file
    and, if it exists, the <filename>tablespace_map</> file created by
    <function>pg_start_backup</>. In a non-exclusive backup, the contents of
    the <filename>backup_label</> and <filename>tablespace_map</> are returned
    in the result of the function, and should be written to files in the
    backup (and not in the data directory).  There is an optional second
    parameter of type <type>boolean</type>.  If false, the <function>pg_stop_backup</>
    will return immediately after the backup is completed without waiting for
    WAL to be archived.  This behavior is only useful for backup
    software which independently monitors WAL archiving. Otherwise, WAL
    required to make the backup consistent might be missing and make the backup
    useless.  When this parameter is set to true, <function>pg_stop_backup</>
    will wait for WAL to be archived when archiving is enabled; on the standby,
    this means that it will wait only when <varname>archive_mode = always</>.
    If write activity on the primary is low, it may be useful to run
    <function>pg_switch_wal</> on the primary in order to trigger
    an immediate segment switch.
-->排他的バックアップでは、<code class="function">pg_stop_backup</code>は、<code class="function">pg_start_backup</code>で作成されたラベルファイルおよび、もしあれば<code class="filename">tablespace_map</code>ファイルを削除します。
非排他的バックアップでは、<code class="filename">backup_label</code>および<code class="filename">tablespace_map</code>の内容が関数の結果として返され、それをバックアップ内のファイルに書き込む必要があります（データディレクトリ内のファイルに書いてはいけません）。
   </p><p>    When executed on a primary, the function also creates a backup history file
    in the write-ahead log
    archive area. The history file includes the label given to
    <code class="function">pg_start_backup</code>, the starting and ending write-ahead log locations for
    the backup, and the starting and ending times of the backup.  The return
    value is the backup's ending write-ahead log location (which again
    can be ignored).  After recording the ending location, the current
    write-ahead log insertion
    point is automatically advanced to the next write-ahead log file, so that the
    ending write-ahead log file can be archived immediately to complete the backup.
   </p><p>    <code class="function">pg_switch_wal</code> moves to the next write-ahead log file, allowing the
    current file to be archived (assuming you are using continuous archiving).
    The return value is the ending write-ahead log location + 1 within the just-completed write-ahead log file.
    If there has been no write-ahead log activity since the last write-ahead log switch,
    <code class="function">pg_switch_wal</code> does nothing and returns the start location
    of the write-ahead log file currently in use.
   </p><p>    <code class="function">pg_create_restore_point</code> creates a named write-ahead log
--&gt;
この関数はまた、トランザクションログ格納領域にバックアップ履歴ファイルを作成します。
履歴ファイルには<code class="function">pg_start_backup</code>で付与されたラベル、バックアップのトランザクションログの位置の開始位置、終了位置、バックアップ開始時刻、終了時刻が含まれます。
戻り値は、バックアップの終了トランザクションログの位置です（これも同様に無視可能です）。
終了位置を記録した後、現在のトランザクションログの挿入位置は自動的に、次のトランザクションログファイルに進みます。ですので、終了トランザクションログファイルをすぐにアーカイブし、バックアップを完了させることができます。
   </p><p><!--
    record that can be used as recovery target, and returns the corresponding
    write-ahead log location.  The given name can then be used with
    <xref linkend="recovery-target-name"> to specify the point up to which
    recovery will proceed.  Avoid creating multiple restore points with the
    same name, since recovery will stop at the first one whose name matches
    the recovery target.
--><code class="function">pg_create_restore_point</code>はリカバリターゲットとして使用可能な名前付けされたトランザクションログレコードを生成し、それに該当するログ位置を返します。
与えられた名前は、どこまでリカバリをするかを明示的に指定する<a class="xref" href="recovery-target-settings.html#recovery-target-name">recovery_target_name</a>パラメータに使用することができます。
リカバリ処理はリカバリターゲットに指定した名前と一致した最初の時点で終了するため、同じ名前で複数のリストアポイントを作成することは避けてください。
   </p><p><!--
    <function>pg_current_wal_lsn</> displays the current write-ahead log write
    location in the same format used by the above functions.  Similarly,
    <function>pg_current_wal_insert_lsn</> displays the current write-ahead log
    insertion location and <function>pg_current_wal_flush_lsn</> displays the
    current write-ahead log flush location. The insertion location is the <quote>logical</>
    end of the write-ahead log at any instant, while the write location is the end of
    what has actually been written out from the server's internal buffers and flush
    location is the location guaranteed to be written to durable storage. The write
    location is the end of what can be examined from outside the server, and is usually
    what you want if you are interested in archiving partially-complete write-ahead log
    files.  The insertion and flush locations are made available primarily for server
    debugging purposes.  These are both read-only operations and do not
    require superuser permissions.
--><code class="function">pg_current_xlog_location</code>は、上記の関数で使用される同一の書式で現在のトランザクションログの書き込み位置を表示します。
同様に<code class="function">pg_current_xlog_insert_location</code>は、現在のトランザクションログの挿入位置を表示し、<code class="function">pg_current_xlog_flush_location</code>はトランザクションログの現在のフラッシュ位置を表示します。
挿入位置は <span class="quote">「<span class="quote">論理的</span>」</span>な任意の時点のトランザクションログの終了位置です。
一方、書き込み位置は、サーバの内部バッファから書き出された実際の終了位置、またフラッシュ位置は永続的ストレージへの書き込みが保証される位置です。
書き込み位置はサーバ外部から検証可能なものの終端です。通常は、部分的に完了したトランザクションログファイルのアーカイブ処理を行いたい場合に必要とされるものです。
挿入およびフラッシュ位置はサーバをデバッグする際に主に使用されます。
これらはどちらも読み取りのみの操作であり、スーパーユーザ権限を必要としません。
   </p><p><!--
    You can use <function>pg_walfile_name_offset</> to extract the
    corresponding write-ahead log file name and byte offset from the results of any of the
    above functions.  For example:
--><code class="function">pg_xlogfile_name_offset</code>を使用して、上記いずれの関数の結果からも、対応するトランザクションログファイルとバイトオフセットを取り出すことができます。
以下に例を示します。
</p><pre class="programlisting">postgres=# SELECT * FROM pg_walfile_name_offset(pg_stop_backup());
        file_name         | file_offset 
--------------------------+-------------
 00000001000000000000000D |     4039624
(1 row)</pre><p><!--
    Similarly, <function>pg_walfile_name</> extracts just the write-ahead log file name.
    When the given write-ahead log location is exactly at a write-ahead log file boundary, both
    these functions return the name of the preceding write-ahead log file.
    This is usually the desired behavior for managing write-ahead log archiving
    behavior, since the preceding file is the last one that currently
    needs to be archived.
-->
同様に、<code class="function">pg_xlogfile_name</code>は、トランザクションログファイル名のみを取り出します。
指定したトランザクションログの位置が正確にトランザクションログファイルの境界であった場合、これらの両関数は前のトランザクションログファイルの名前を返します。
通常これは、トランザクションログファイルのアーカイブ動作では好まれる動作です。前のファイルが現在のアーカイブで必要とする最後のファイルであるからです。
   </p><p><!--
    <function>pg_wal_lsn_diff</> calculates the difference in bytes
    between two write-ahead log locations. It can be used with
    <structname>pg_stat_replication</structname> or some functions shown in
    <xref linkend="functions-admin-backup-table"> to get the replication lag.
--><code class="function">pg_xlog_location_diff</code>は、2つのトランザクションログの位置の差分をバイト数で算出します。
この関数は<code class="structname">pg_stat_replication</code>や<a class="xref" href="functions-admin.html#functions-admin-backup-table" title="表9.79 バックアップ制御関数">表 9.79</a>に示される関数と併用することで、レプリケーションの遅延の確認に使用できます。
   </p><p><!--
    For details about proper usage of these functions, see
    <xref linkend="continuous-archiving">.
-->これらの関数の正しい使用方法については、<a class="xref" href="continuous-archiving.html" title="25.3. 継続的アーカイブとポイントインタイムリカバリ（PITR）">25.3</a>を参照してください。
   </p></div><div class="sect2" id="functions-recovery-control"><div class="titlepage"><div><div><h3 class="title">9.26.4. リカバリ制御関数</h3></div></div></div><!--
   <title>Recovery Control Functions</title>
--><a id="idm46270561859216" class="indexterm"></a><a id="idm46270561858560" class="indexterm"></a><a id="idm46270561857872" class="indexterm"></a><a id="idm46270561857184" class="indexterm"></a><p><!--
    The functions shown in <xref
    linkend="functions-recovery-info-table"> provide information
    about the current status of the standby.
    These functions may be executed both during recovery and in normal running.
--><a class="xref" href="functions-admin.html#functions-recovery-info-table" title="表9.80 リカバリ情報関数">表 9.80</a>に示される関数は、スタンバイサーバの現在のステータス情報を提供します。
これらの関数はリカバリ中、および通常稼動時に実行することができるでしょう。
   </p><div class="table" id="functions-recovery-info-table"><p class="title"><strong>表9.80 リカバリ情報関数</strong></p><div class="table-contents"><!--
    <title>Recovery Information Functions</title>
--><table class="table" summary="リカバリ情報関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_is_in_recovery()</code></code>
        </td><td><code class="type">bool</code></td><td>まだリカバリ実施中であれば真を返します。
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_last_wal_receive_lsn()</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>ストリーミングレプリケーションにより受信されディスクに書き込みされた、トランザクションログの最後の位置を取得します。ストリーミングレプリケーションが実施されている場合は、この値が単調に増加していくでしょう。リカバリが完了した場合、受信されディスクに書き込まれた最後のWALレコードの位置の値がそのまま残ります。ストリーミングレプリケーションが無効、もしくは開始されていない場合、この関数はNULLを返します。
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_last_wal_replay_lsn()</code></code>
        </td><td><code class="type">pg_lsn</code></td><td>リカバリ中に再生された最後のトランザクションログの位置を取得します。リカバリが実施されている場合は、この値が単調に増加していくでしょう。リカバリが完了した場合は、リカバリ時に適用された最後のWALレコードの値がそのまま残ります。もしサーバがリカバリ無しで普通に起動された場合、この関数はNULLを返します。
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_last_xact_replay_timestamp()</code></code>
        </td><td><code class="type">timestamp with time zone</code></td><td>リカバリ中に再生された最後のトランザクションのタイムスタンプを取得します。
このタイムスタンプは、プライマリにて該当するトランザクションがコミット、もしくはアボートされた際のWALレコードが生成された時間です。
リカバリ中に何のトランザクションも再生されていない場合、この関数はNULLを返します。
リカバリがまだ実行中の場合、この関数の戻り値は単調に増加します。
リカバリが完了している場合、この関数の戻り値はリカバリ中に再生した最後のトランザクションの時間のまま変化しません。
サーバがリカバリ処理無しに正常に開始された場合、この関数はNULLを返します。
       </td></tr></tbody></table></div></div><br class="table-break" /><a id="idm46270561839824" class="indexterm"></a><a id="idm46270561837136" class="indexterm"></a><a id="idm46270561836448" class="indexterm"></a><p><!--
    The functions shown in <xref
    linkend="functions-recovery-control-table"> control the progress of recovery.
    These functions may be executed only during recovery.
--><a class="xref" href="functions-admin.html#functions-recovery-control-table" title="表9.81 リカバリ制御関数">表 9.81</a>に示す関数は、リカバリの進行を制御する関数です。
これらの関数はリカバリ中のみ実行することが可能です。
   </p><div class="table" id="functions-recovery-control-table"><p class="title"><strong>表9.81 リカバリ制御関数</strong></p><div class="table-contents"><!--
    <title>Recovery Control Functions</title>
--><table class="table" summary="リカバリ制御関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_is_wal_replay_paused()</code></code>
        </td><td><code class="type">bool</code></td><td>リカバリが停止中であれば真を返す
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_wal_replay_pause()</code></code>
        </td><td><code class="type">void</code></td><td>即座にリカバリを停止する(デフォルトではスーパーユーザのみ実行可能、ただし他のユーザにも関数を実行するEXECUTE権限を与えることができる)
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_wal_replay_resume()</code></code>
        </td><td><code class="type">void</code></td><td>もしリカバリ停止中であれば再開する(デフォルトではスーパーユーザのみ実行可能、ただし他のユーザにも関数を実行するEXECUTE権限を与えることができる)
       </td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    While recovery is paused no further database changes are applied.
    If in hot standby, all new queries will see the same consistent snapshot
    of the database, and no further query conflicts will be generated until
    recovery is resumed.
-->リカバリ停止中は、それ以降のデータベースへの変更は適用されません。
ホットスタンバイ側では、新しい問い合わせはすべて、同じ一貫性を持ったデータベースのスナップショットを参照することになります。
そしてリカバリが再開されるまで、これ以上の問い合わせの競合は発生しません。
   </p><p><!--
    If streaming replication is disabled, the paused state may continue
    indefinitely without problem. While streaming replication is in
    progress WAL records will continue to be received, which will
    eventually fill available disk space, depending upon the duration of
    the pause, the rate of WAL generation and available disk space.
-->ストリーミングレプリケーションが無効の場合、停止状態はいつまでも問題なく継続するでしょう。
ストリーミングレプリケーションの実行中は、WALレコードの受信が継続され、停止時間、WALの生成速度、ディスクの残存容量によりますが、ディスク溢れが発生する可能性があります。
   </p></div><div class="sect2" id="functions-snapshot-synchronization"><div class="titlepage"><div><div><h3 class="title">9.26.5. スナップショット同期関数</h3></div></div></div><!--
   <title>Snapshot Synchronization Functions</title>
--><a id="idm46270561819264" class="indexterm"></a><p><!--
    <productname>PostgreSQL</> allows database sessions to synchronize their
    snapshots. A <firstterm>snapshot</> determines which data is visible to the
    transaction that is using the snapshot. Synchronized snapshots are
    necessary when two or more sessions need to see identical content in the
    database. If two sessions just start their transactions independently,
    there is always a possibility that some third transaction commits
    between the executions of the two <command>START TRANSACTION</> commands,
    so that one session sees the effects of that transaction and the other
    does not.
--><span class="productname">PostgreSQL</span>はデータベースのセッションに対して、それらのスナップショットを同期させることが可能です。
<em class="firstterm">スナップショット</em>は、そのスナップショットを使用しているトランザクションにどのデータが可視かを決定します。
同期スナップショットは、2つ以上のセッションにおいて、全く同じデータベース内容を見たい場合に必要となります。
単に2つのセッションが独立してそれぞれのトランザクションを開始するだけでは、第3のトランザクションのコミットが、2つのトランザクションの<code class="command">START TRANSACTION</code>の狭間で実行され、そのため一方のトランザクションではそのコミット結果が見え、他方では見えないという可能性が常にあります。
   </p><p><!--
    To solve this problem, <productname>PostgreSQL</> allows a transaction to
    <firstterm>export</> the snapshot it is using.  As long as the exporting
    transaction remains open, other transactions can <firstterm>import</> its
    snapshot, and thereby be guaranteed that they see exactly the same view
    of the database that the first transaction sees.  But note that any
    database changes made by any one of these transactions remain invisible
    to the other transactions, as is usual for changes made by uncommitted
    transactions.  So the transactions are synchronized with respect to
    pre-existing data, but act normally for changes they make themselves.
-->このような問題を解決するため、<span class="productname">PostgreSQL</span>ではトランザクションが使用しているスナップショットを<em class="firstterm">エクスポート</em>できるようになっています。エクスポートしたトランザクションが開かれ続けている限り、他のトランザクションがそれを<em class="firstterm">インポート</em>することができ、
そしてこれにより最初のトランザクションと正確に同じとなるデータベースの可視性を保証されます。ただし、これらの(スナップショットを共有している)トランザクションによって発生したデータベースへの変更は、コミットされていないトランザクションによる変更と同様に、(スナップショットを共有している)他のトランザクションには見えないままです。
つまり、既存データに対しては同期されますが、それら自身による変更については通常の振る舞いをします。
   </p><p><!--
    Snapshots are exported with the <function>pg_export_snapshot</> function,
    shown in <xref linkend="functions-snapshot-synchronization-table">, and
    imported with the <xref linkend="sql-set-transaction"> command.
-->スナップショットは、<a class="xref" href="functions-admin.html#functions-snapshot-synchronization-table" title="表9.82 スナップショット同期関数">表 9.82</a>に示す<code class="function">pg_export_snapshot</code>関数を用いてエクスポートされ、<a class="xref" href="sql-set-transaction.html" title="SET TRANSACTION"><span class="refentrytitle">SET TRANSACTION</span></a>コマンドを用いてインポートされます。
   </p><div class="table" id="functions-snapshot-synchronization-table"><p class="title"><strong>表9.82 スナップショット同期関数</strong></p><div class="table-contents"><!--
    <title>Snapshot Synchronization Functions</title>
--><table class="table" summary="スナップショット同期関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り値型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_export_snapshot()</code></code>
       </td><td><code class="type">text</code></td><td>現在のスナップショットを保存し、その識別子を返す</td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    The function <function>pg_export_snapshot</> saves the current snapshot
    and returns a <type>text</> string identifying the snapshot.  This string
    must be passed (outside the database) to clients that want to import the
    snapshot.  The snapshot is available for import only until the end of the
    transaction that exported it.  A transaction can export more than one
    snapshot, if needed.  Note that doing so is only useful in <literal>READ
    COMMITTED</> transactions, since in <literal>REPEATABLE READ</> and
    higher isolation levels, transactions use the same snapshot throughout
    their lifetime.  Once a transaction has exported any snapshots, it cannot
    be prepared with <xref linkend="sql-prepare-transaction">.
--><code class="function">pg_export_snapshot</code>関数は現在のスナップショットを保存し、そのスナップショットを識別する<code class="type">text</code>文字列を返します。
この文字列はスナップショットをインポートしたい(データベース外の)クライアントに渡されなければなりません。
エクスポートしたトランザクションが終わるまでの間のみ、そのスナップショットをインポートすることができます。
必要ならばトランザクションは複数のスナップショットをエクスポートできます。
<code class="literal">REPEATABLE READ</code>や上位の隔離レベルでは、トランザクションはその有効期間の間同じスナップショットを使用しますので、これは<code class="literal">READ COMMITTED</code>トランザクションでのみ有用であることに注意してください。
一旦スナップショットをエクスポートしたトランザクションでは、<a class="xref" href="sql-prepare-transaction.html" title="PREPARE TRANSACTION"><span class="refentrytitle">PREPARE TRANSACTION</span></a>による準備を使用することができなくなります。
   </p><p><!--
    See  <xref linkend="sql-set-transaction"> for details of how to use an
    exported snapshot.
-->エクスポートしたトランザクションの使用方法の詳細については<a class="xref" href="sql-set-transaction.html" title="SET TRANSACTION"><span class="refentrytitle">SET TRANSACTION</span></a>を参照してください。
   </p></div><div class="sect2" id="functions-replication"><div class="titlepage"><div><div><h3 class="title">9.26.6. レプリケーション関数</h3></div></div></div><!--
   <title>Replication Functions</title>
--><p><!--
    The functions shown
    in <xref linkend="functions-replication-table"> are for
    controlling and interacting with replication features.
    See <xref linkend="streaming-replication">,
    <xref linkend="streaming-replication-slots">, and
    <xref linkend="replication-origins">
    for information about the underlying features.  Use of these
    functions is restricted to superusers.
--><a class="xref" href="functions-admin.html#functions-replication-table" title="表9.83 レプリケーションSQL関数">表 9.83</a>に示す関数はレプリケーション機能を制御したり、情報を取得したりするためのものです。
基盤となっている機能の情報に関しては<a class="xref" href="warm-standby.html#streaming-replication" title="26.2.5. ストリーミングレプリケーション">26.2.5</a>、<a class="xref" href="warm-standby.html#streaming-replication-slots" title="26.2.6. レプリケーションスロット">26.2.6</a>、<a class="xref" href="replication-origins.html" title="第49章 レプリケーション進捗の追跡">第49章</a>を参照してください。
これらの関数の使用はスーパーユーザに限定されています。
   </p><p><!--
    Many of these functions have equivalent commands in the replication
    protocol; see <xref linkend="protocol-replication">.
-->これらの関数の多くには、レプリケーションプロトコルに等価なコマンドがあります。
<a class="xref" href="protocol-replication.html" title="52.4. ストリーミングレプリケーションプロトコル">52.4</a>を参照してください。
   </p><p><!--
    The functions described in
    <xref linkend="functions-admin-backup">,
    <xref linkend="functions-recovery-control">, and
    <xref linkend="functions-snapshot-synchronization">
    are also relevant for replication.
--><a class="xref" href="functions-admin.html#functions-admin-backup" title="9.26.3. バックアップ制御関数">9.26.3</a>、<a class="xref" href="functions-admin.html#functions-recovery-control" title="9.26.4. リカバリ制御関数">9.26.4</a>、<a class="xref" href="functions-admin.html#functions-snapshot-synchronization" title="9.26.5. スナップショット同期関数">9.26.5</a>に書かれている関数もレプリケーションに関係するものです。
   </p><div class="table" id="functions-replication-table"><p class="title"><strong>表9.83 レプリケーション<acronym class="acronym">SQL</acronym>関数</strong></p><div class="table-contents"><!--
    <title>Replication <acronym>SQL</acronym> Functions</title>
--><table class="table" summary="レプリケーションSQL関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>関数</th><th>戻り値型</th><th>説明</th></tr></thead><tbody><tr><td>        <a id="idm46270561780976" class="indexterm"></a>
        <code class="literal"><code class="function">pg_create_physical_replication_slot(<em class="parameter"><code>slot_name</code></em> <code class="type">name</code> [<span class="optional">, <em class="parameter"><code>immediately_reserve</code></em> <code class="type">boolean</code>, <em class="parameter"><code>temporary</code></em> <code class="type">boolean</code></span>])</code></code>
       </td><td>        (<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>)
       </td><td><!--
        Creates a new physical replication slot named
        <parameter>slot_name</parameter>. The optional second parameter,
        when <literal>true</>, specifies that the <acronym>LSN</> for this
        replication slot be reserved immediately; otherwise
        the <acronym>LSN</> is reserved on first connection from a streaming
        replication client. Streaming changes from a physical slot is only
        possible with the streaming-replication protocol &mdash;
        see <xref linkend="protocol-replication">. The optional third
        parameter, <parameter>temporary</>, when set to true, specifies that
        the slot should not be permanently stored to disk and is only meant
        for use by current session. Temporary slots are also
        released upon any error. This function corresponds
        to the replication protocol command <literal>CREATE_REPLICATION_SLOT
        ... PHYSICAL</literal>.
-->
<em class="parameter"><code>slot_name</code></em>という名前の新しい物理レプリケーションスロットを作成します。
2番目のパラメータはオプションで、<code class="literal">true</code>の場合、このレプリケーションスロットの<acronym class="acronym">LSN</acronym>が即座に予約されることを指定します。
それ以外の場合は<acronym class="acronym">LSN</acronym>はストリーミングレプリケーションのクライアントから最初に接続された時に予約されます。
物理スロットからのストリーミングの変更はストリーミングレプリケーションプロトコルでのみ可能です。<a class="xref" href="protocol-replication.html" title="52.4. ストリーミングレプリケーションプロトコル">52.4</a>を参照してください。
この関数は、レプリケーションプロトコルコマンド<code class="literal">CREATE_REPLICATION_SLOT ... PHYSICAL</code>に対応するものです。
       </td></tr><tr><td>        <a id="idm46270561767184" class="indexterm"></a>
        <code class="literal"><code class="function">pg_drop_replication_slot(<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>)</code></code>
       </td><td>        <code class="type">void</code>
       </td><td><!--
        Drops the physical or logical replication slot
        named <parameter>slot_name</parameter>. Same as replication protocol
        command <literal>DROP_REPLICATION_SLOT</>. For logical slots, this must
        be called when connected to the same database the slot was created on.
--><em class="parameter"><code>slot_name</code></em>という名前の物理もしくは論理レプリケーションスロットを削除します。
レプリケーションプロトコルコマンド<code class="literal">DROP_REPLICATION_SLOT</code>と同じです。
       </td></tr><tr><td>        <a id="idm46270561760944" class="indexterm"></a>
        <code class="literal"><code class="function">pg_create_logical_replication_slot(<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>plugin</code></em> <code class="type">name</code> [<span class="optional">, <em class="parameter"><code>temporary</code></em> <code class="type">boolean</code></span>])</code></code>
       </td><td>        (<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>)
       </td><td><!--
        Creates a new logical (decoding) replication slot named
        <parameter>slot_name</parameter> using the output plugin
        <parameter>plugin</parameter>. The optional third
        parameter, <parameter>temporary</>, when set to true, specifies that
        the slot should not be permanently stored to disk and is only meant
        for use by current session. Temporary slots are also
        released upon any error. A call to this function has the same
        effect as the replication protocol command
        <literal>CREATE_REPLICATION_SLOT ... LOGICAL</literal>.
-->出力プラグイン<em class="parameter"><code>plugin</code></em>を使用して、<em class="parameter"><code>slot_name</code></em>という名前の新しい論理(デコード)レプリケーションスロットを作成します。
この関数を呼び出すのはレプリケーションプロトコルコマンド<code class="literal">CREATE_REPLICATION_SLOT ... LOGICAL</code>と同じ効果があります。
       </td></tr><tr><td>        <a id="idm46270561749136" class="indexterm"></a>
        <code class="literal"><code class="function">pg_logical_slot_get_changes(<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">int</code>, VARIADIC <em class="parameter"><code>options</code></em> <code class="type">text[]</code>)</code></code>
       </td><td>        (<em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>xid</code></em> <code class="type">xid</code>, <em class="parameter"><code>data</code></em> <code class="type">text</code>)
       </td><td><!--
        Returns changes in the slot <parameter>slot_name</parameter>, starting
        from the point at which since changes have been consumed last.  If
        <parameter>upto_lsn</> and <parameter>upto_nchanges</> are NULL,
        logical decoding will continue until end of WAL.  If
        <parameter>upto_lsn</> is non-NULL, decoding will include only
        those transactions which commit prior to the specified LSN.  If
        <parameter>upto_nchanges</parameter> is non-NULL, decoding will
        stop when the number of rows produced by decoding exceeds
        the specified value.  Note, however, that the actual number of
        rows returned may be larger, since this limit is only checked after
        adding the rows produced when decoding each new transaction commit.
-->変更が最後に消費された時点から開始して、スロット<em class="parameter"><code>slot_name</code></em>の変更を返します。
<em class="parameter"><code>upto_lsn</code></em>と<em class="parameter"><code>upto_nchanges</code></em>がNULLならば論理デコードはWALの最後まで続きます。
<em class="parameter"><code>upto_lsn</code></em>が非NULLであれば、デコードは指定されたLSNより前にコミットされたトランザクションのみを含みます。
<em class="parameter"><code>upto_nchanges</code></em>が非NULLであれば、デコードにより生成された行の数が指定された値を越えたときに、デコードは止まります。
しかしながら、新しいトランザクションの各コミットをデコードして生成された行を追加した後でしかこの制限は確認されませんので、実際に返される行の数は大きいかもしれないことに注意してください。
       </td></tr><tr><td>        <a id="idm46270561732912" class="indexterm"></a>
        <code class="literal"><code class="function">pg_logical_slot_peek_changes(<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">int</code>, VARIADIC <em class="parameter"><code>options</code></em> <code class="type">text[]</code>)</code></code>
       </td><td>        (<em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>xid</code></em> <code class="type">xid</code>, <em class="parameter"><code>data</code></em> <code class="type">text</code>)
       </td><td><!--
        Behaves just like
        the <function>pg_logical_slot_get_changes()</function> function,
        except that changes are not consumed; that is, they will be returned
        again on future calls.
-->        変更が消費されないということを除いて、<code class="function">pg_logical_slot_get_changes()</code>関数と同じように振る舞います。すなわち、将来の呼び出しでは再び同じものが返ります。
       </td></tr><tr><td>        <a id="idm46270561721024" class="indexterm"></a>
        <code class="literal"><code class="function">pg_logical_slot_get_binary_changes(<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">int</code>, VARIADIC <em class="parameter"><code>options</code></em> <code class="type">text[]</code>)</code></code>
       </td><td>        (<em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>xid</code></em> <code class="type">xid</code>, <em class="parameter"><code>data</code></em> <code class="type">bytea</code>)
       </td><td><!--
        Behaves just like
        the <function>pg_logical_slot_get_changes()</function> function,
        except that changes are returned as <type>bytea</type>.
-->        変更は<code class="type">bytea</code>として返されるということを除いて<code class="function">pg_logical_slot_get_changes()</code>関数と同じように振る舞います。
       </td></tr><tr><td>        <a id="idm46270561708896" class="indexterm"></a>
        <code class="literal"><code class="function">pg_logical_slot_peek_binary_changes(<em class="parameter"><code>slot_name</code></em> <code class="type">name</code>, <em class="parameter"><code>upto_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>upto_nchanges</code></em> <code class="type">int</code>, VARIADIC <em class="parameter"><code>options</code></em> <code class="type">text[]</code>)</code></code>
       </td><td>        (<em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>xid</code></em> <code class="type">xid</code>, <em class="parameter"><code>data</code></em> <code class="type">bytea</code>)
       </td><td><!--
        Behaves just like
        the <function>pg_logical_slot_get_changes()</function> function,
        except that changes are returned as <type>bytea</type> and that
        changes are not consumed; that is, they will be returned again
        on future calls.
-->        変更は<code class="type">bytea</code>として返され消費されないということを除いて<code class="function">pg_logical_slot_get_changes()</code>関数と同じように振る舞います。すなわち、将来の呼び出しでは再び同じものが返ります。
       </td></tr><tr><td id="pg-replication-origin-create">        <a id="idm46270561696112" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_create(<em class="parameter"><code>node_name</code></em> <code class="type">text</code>)</code></code>
       </td><td>        <code class="type">oid</code>
       </td><td><!--
        Create a replication origin with the given external
        name, and return the internal id assigned to it.
-->指定した外部名でレプリケーション起点を作成し、割り当てられた内部IDを返します。
       </td></tr><tr><td id="pg-replication-origin-drop">        <a id="idm46270561690880" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_drop(<em class="parameter"><code>node_name</code></em> <code class="type">text</code>)</code></code>
       </td><td>        <code class="type">void</code>
       </td><td><!--
        Delete a previously created replication origin, including any
        associated replay progress.
-->以前に作成されたレプリケーション起点を、それに関連するすべての再生の進捗も含めて削除します。
       </td></tr><tr><td>        <a id="idm46270561686160" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_oid(<em class="parameter"><code>node_name</code></em> <code class="type">text</code>)</code></code>
       </td><td>        <code class="type">oid</code>
       </td><td><!--
        Lookup a replication origin by name and return the internal id. If no
        corresponding replication origin is found an error is thrown.
-->レプリケーション起点を名前で検索し、内部IDを返します。
相当するレプリケーション起点が見つからない場合はエラーが発生します。
       </td></tr><tr><td id="pg-replication-origin-session-setup">        <a id="idm46270561680800" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_session_setup(<em class="parameter"><code>node_name</code></em> <code class="type">text</code>)</code></code>
       </td><td>        <code class="type">void</code>
       </td><td><!--
        Mark the current session as replaying from the given
        origin, allowing replay progress to be tracked.  Use
        <function>pg_replication_origin_session_reset</function> to revert.
        Can only be used if no previous origin is configured.
-->現在のセッションに、指定の起点から再生中であると印を付け、再生の進捗が追跡できるようにします。
元に戻すには<code class="function">pg_replication_origin_session_reset</code>を使って下さい。
以前に起点が設定されていない場合にのみ使うことができます。
       </td></tr><tr><td>        <a id="idm46270561675088" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_session_reset()</code></code>
       </td><td>        <code class="type">void</code>
       </td><td><!--
        Cancel the effects
        of <function>pg_replication_origin_session_setup()</function>.
--><code class="function">pg_replication_origin_session_setup()</code>の効果を取り消します。
       </td></tr><tr><td>        <a id="idm46270561670960" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_session_is_setup()</code></code>
       </td><td>        <code class="type">bool</code>
       </td><td><!--
        Has a replication origin been configured in the current session?
-->現在のセッションで、レプリケーション起点が設定されたかどうかを返します。
       </td></tr><tr><td id="pg-replication-origin-session-progress">        <a id="idm46270561666688" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_session_progress(<em class="parameter"><code>flush</code></em> <code class="type">bool</code>)</code></code>
       </td><td>        <code class="type">pg_lsn</code>
       </td><td><!--
        Return the replay location for the replication origin configured in
        the current session. The parameter <parameter>flush</parameter>
        determines whether the corresponding local transaction will be
        guaranteed to have been flushed to disk or not.
-->現在のセッションで設定されたレプリケーション起点の再生位置を返します。
パラメータ<em class="parameter"><code>flush</code></em>により、対応するローカルトランザクションがディスクにフラッシュされていることが保証されるかどうかを決定します。
       </td></tr><tr><td id="pg-replication-origin-xact-setup">        <a id="idm46270561660416" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_xact_setup(<em class="parameter"><code>origin_lsn</code></em> <code class="type">pg_lsn</code>, <em class="parameter"><code>origin_timestamp</code></em> <code class="type">timestamptz</code>)</code></code>
       </td><td>        <code class="type">void</code>
       </td><td><!--
        Mark the current transaction as replaying a transaction that has
        committed at the given <acronym>LSN</acronym> and timestamp. Can
        only be called when a replication origin has previously been
        configured using
        <function>pg_replication_origin_session_setup()</function>.
-->現在のトランザクションに、指定の<acronym class="acronym">LSN</acronym>およびタイムスタンプでコミットしたトランザクションを再生中であると印をつけます。
事前にレプリケーション起点が<code class="function">pg_replication_origin_session_setup()</code>を使って設定されている場合にのみ呼び出せます。
       </td></tr><tr><td id="pg-replication-origin-xact-reset">        <a id="idm46270561652672" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_xact_reset()</code></code>
       </td><td>        <code class="type">void</code>
       </td><td><!--
        Cancel the effects of
        <function>pg_replication_origin_xact_setup()</function>.
--><code class="function">pg_replication_origin_xact_setup()</code>の効果を取り消します。
       </td></tr><tr><td id="pg-replication-origin-advance">        <a id="idm46270561648032" class="indexterm"></a>
        <code class="literal">pg_replication_origin_advance<code class="function">(<em class="parameter"><code>node_name</code></em> <code class="type">text</code>, <em class="parameter"><code>lsn</code></em> <code class="type">pg_lsn</code>)</code></code>
       </td><td>        <code class="type">void</code>
       </td><td><!--
        Set replication progress for the given node to the given
        location. This primarily is useful for setting up the initial location
        or a new location after configuration changes and similar. Be aware
        that careless use of this function can lead to inconsistently
        replicated data.
-->指定したノードのレプリケーションの進捗を、指定の位置に設定します。
これは主に設定変更の後で初期位置や新しい位置を設定するときなどに役立ちます。
この関数を不注意に使うと、レプリケーションデータが一貫性を失うかもしれないことに注意して下さい。
       </td></tr><tr><td id="pg-replication-origin-progress">        <a id="idm46270561640720" class="indexterm"></a>
        <code class="literal"><code class="function">pg_replication_origin_progress(<em class="parameter"><code>node_name</code></em> <code class="type">text</code>, <em class="parameter"><code>flush</code></em> <code class="type">bool</code>)</code></code>
       </td><td>        <code class="type">pg_lsn</code>
       </td><td><!--
        Return the replay location for the given replication origin. The
        parameter <parameter>flush</parameter> determines whether the
        corresponding local transaction will be guaranteed to have been
        flushed to disk or not.
-->指定したレプリケーション起点の再生位置を返します。
パラメータ<em class="parameter"><code>flush</code></em>により、対応するローカルトランザクションがディスクにフラッシュされていることが保証されるかどうかを決定します。
       </td></tr><tr><td id="pg-logical-emit-message-text">        <a id="idm46270561633456" class="indexterm"></a>
        <code class="literal"><code class="function">pg_logical_emit_message(<em class="parameter"><code>transactional</code></em> <code class="type">bool</code>, <em class="parameter"><code>prefix</code></em> <code class="type">text</code>, <em class="parameter"><code>content</code></em> <code class="type">text</code>)</code></code>
       </td><td>        <code class="type">pg_lsn</code>
       </td><td><!--
        Emit text logical decoding message. This can be used to pass generic
        messages to logical decoding plugins through WAL. The parameter
        <parameter>transactional</parameter> specifies if the message should
        be part of current transaction or if it should be written immediately
        and decoded as soon as the logical decoding reads the record. The
        <parameter>prefix</parameter> is textual prefix used by the logical
        decoding plugins to easily recognize interesting messages for them.
        The <parameter>content</parameter> is the text of the message.
-->論理デコードのテキストのメッセージを送出します
これは汎用的なメッセージをWALを通して論理デコードのプラグインに渡すのに使うことができます。
パラメータ<em class="parameter"><code>transactional</code></em>は、メッセージが現在のトランザクションの一部なのか、あるいはすぐに書き込み、論理デコードがレコードを読んだらすぐにデコードされるべきものなのかを指定します。
<em class="parameter"><code>prefix</code></em>は文字通りの接頭辞で、論理デコードのプラグインが、自分にとって関心のあるメッセージを容易に認識できるように使われます。
<em class="parameter"><code>content</code></em>はメッセージのテキストです。
       </td></tr><tr><td id="pg-logical-emit-message-bytea">        <code class="literal"><code class="function">pg_logical_emit_message(<em class="parameter"><code>transactional</code></em> <code class="type">bool</code>, <em class="parameter"><code>prefix</code></em> <code class="type">text</code>, <em class="parameter"><code>content</code></em> <code class="type">bytea</code>)</code></code>
       </td><td>        <code class="type">pg_lsn</code>
       </td><td><!--
        Emit binary logical decoding message. This can be used to pass generic
        messages to logical decoding plugins through WAL. The parameter
        <parameter>transactional</parameter> specifies if the message should
        be part of current transaction or if it should be written immediately
        and decoded as soon as the logical decoding reads the record. The
        <parameter>prefix</parameter> is textual prefix used by the logical
        decoding plugins to easily recognize interesting messages for them.
        The <parameter>content</parameter> is the binary content of the
        message.
-->論理デコードのバイナリのメッセージを送出します
これは汎用的なメッセージをWALを通して論理デコードのプラグインに渡すのに使うことができます。
パラメータ<em class="parameter"><code>transactional</code></em>は、メッセージが現在のトランザクションの一部なのか、あるいはすぐに書き込み、論理デコードがレコードを読んだらすぐにデコードされるべきものなのかを指定します。
<em class="parameter"><code>prefix</code></em>は文字通りの接頭辞で、論理デコードのプラグインが、自分にとって関心のあるメッセージを容易に認識できるように使われます。
<em class="parameter"><code>content</code></em>はメッセージのバイナリの内容です。
       </td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="functions-admin-dbobject"><div class="titlepage"><div><div><h3 class="title">9.26.7. データベースオブジェクト管理関数</h3></div></div></div><!--
   <title>Database Object Management Functions</title>
--><p><!--
    The functions shown in <xref linkend="functions-admin-dbsize"> calculate
    the disk space usage of database objects.
--><a class="xref" href="functions-admin.html#functions-admin-dbsize" title="表9.84 データベースオブジェクト容量関数">表 9.84</a>で示された関数はデータベースオブジェクトのディスク領域を計算します。
   </p><a id="idm46270561611392" class="indexterm"></a><a id="idm46270561610736" class="indexterm"></a><a id="idm46270561610048" class="indexterm"></a><a id="idm46270561609360" class="indexterm"></a><a id="idm46270561608672" class="indexterm"></a><a id="idm46270561607984" class="indexterm"></a><a id="idm46270561607296" class="indexterm"></a><a id="idm46270561606608" class="indexterm"></a><a id="idm46270561605920" class="indexterm"></a><div class="table" id="functions-admin-dbsize"><p class="title"><strong>表9.84 データベースオブジェクト容量関数</strong></p><div class="table-contents"><!--
    <title>Database Object Size Functions</title>
--><table class="table" summary="データベースオブジェクト容量関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td><code class="literal"><code class="function">pg_column_size(<code class="type">any</code>)</code></code></td><td><code class="type">int</code></td><td>特定の値を格納するのに使用される（場合により圧縮された）バイト数</td></tr><tr><td>        <code class="literal"><code class="function">pg_database_size(<code class="type">oid</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td>指定されたOIDのデータベースで使用されるディスク容量</td></tr><tr><td>        <code class="literal"><code class="function">pg_database_size(<code class="type">name</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td>指定された名前のデータベースで使用されるディスク容量</td></tr><tr><td>        <code class="literal"><code class="function">pg_indexes_size(<code class="type">regclass</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td><!--
        Total disk space used by indexes attached to the specified table
-->指定されテーブルに付与されたインデックスで使用される総ディスク容量。
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_relation_size(<em class="parameter"><code>relation</code></em> <code class="type">regclass</code>, <em class="parameter"><code>fork</code></em> <code class="type">text</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td><!--
        Disk space used by the specified fork (<literal>'main'</literal>,
        <literal>'fsm'</literal>, <literal>'vm'</>, or <literal>'init'</>)
        of the specified table or index
-->指定されたテーブルまたはインデックスの指定されたフォーク（<code class="literal">'main'</code>、<code class="literal">'fsm'</code>、<code class="literal">'vm'</code>または<code class="literal">'init'</code>）で使用されるディスク容量
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_relation_size(<em class="parameter"><code>relation</code></em> <code class="type">regclass</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td><!--
        Shorthand for <literal>pg_relation_size(..., 'main')</literal>
--><code class="literal">pg_relation_size(..., 'main')</code>の省略表現
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_size_bytes(<code class="type">text</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td><!--
         Converts a size in human-readable format with size units into bytes
-->単位付きの可読性の高い形式のサイズをバイトに変換
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_size_pretty(<code class="type">bigint</code>)</code></code>
        </td><td><code class="type">text</code></td><td><!--
         Converts a size in bytes expressed as a 64-bit integer into a
         human-readable format with size units
-->64ビット整数で表現されたサイズ（バイト数）を、サイズの単位をつけた可読性が高い書式に変換
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_size_pretty(<code class="type">numeric</code>)</code></code>
        </td><td><code class="type">text</code></td><td><!--
         Converts a size in bytes expressed as a numeric value into a
         human-readable format with size units
-->numeric値で表現されたサイズ（バイト数）を、サイズの単位をつけた可読性が高い書式に変換
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_table_size(<code class="type">regclass</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td><!--
        Disk space used by the specified table, excluding indexes
        (but including TOAST, free space map, and visibility map)
-->指定されたテーブルで使用されるディスク容量、インデックスは除外する（しかしTOAST、空き領域マップ、可視性マップは含む）
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_tablespace_size(<code class="type">oid</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td>指定されたOIDを持つテーブル空間で使用されるディスク容量</td></tr><tr><td>        <code class="literal"><code class="function">pg_tablespace_size(<code class="type">name</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td>指定された名前を持つテーブル空間で使用されるディスク容量</td></tr><tr><td>        <code class="literal"><code class="function">pg_total_relation_size(<code class="type">regclass</code>)</code></code>
        </td><td><code class="type">bigint</code></td><td><!--
        Total disk space used by the specified table,
        including all indexes and <acronym>TOAST</> data
-->指定されたテーブルで使用される、すべてのインデックスと<acronym class="acronym">TOAST</acronym>データを含むディスク総容量
       </td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    <function>pg_column_size</> shows the space used to store any individual
    data value.
-->    <code class="function">pg_column_size</code>は任意の個別のデータ値を格納するのに使用されている領域を示します。
   </p><p><!--
    <function>pg_total_relation_size</> accepts the OID or name of a
    table or toast table, and returns the total on-disk space used for
    that table, including all associated indexes.  This function is
    equivalent to <function>pg_table_size</function>
    <literal>+</> <function>pg_indexes_size</function>.
--><code class="function">pg_total_relation_size</code>は、テーブルまたはTOASTテーブルのOIDまたは名前を受け付け、指定されたテーブルと関連する全てのインデックスで使用される総ディスク容量を返します。
この関数は<code class="function">pg_table_size</code> <code class="literal">+</code> <code class="function">pg_indexes_size</code> の結果と等しいです。
   </p><p><!--
    <function>pg_table_size</> accepts the OID or name of a table and
    returns the disk space needed for that table, exclusive of indexes.
    (TOAST space, free space map, and visibility map are included.)
--><code class="function">pg_table_size</code>は、テーブルのOIDまたは名前を受け付け、インデックスを除いたテーブルのみで使用されるディスク容量を返します。
(TOAST領域、空き領域マップ、可視性マップは含みます。)
   </p><p><!--
    <function>pg_indexes_size</> accepts the OID or name of a table and
    returns the total disk space used by all the indexes attached to that
    table.
--><code class="function">pg_indexes_size</code>は、テーブルのOIDまたは名前を受け付け、指定されたテーブル付与されている全てのインデックスで使用されるディスク容量を返します。
   </p><p><!--
    <function>pg_database_size</function> and <function>pg_tablespace_size</>
    accept the OID or name of a database or tablespace, and return the total
    disk space used therein.  To use <function>pg_database_size</function>,
    you must have <literal>CONNECT</> permission on the specified database
    (which is granted by default), or be a member of the <literal>pg_read_all_stats</>
    role. To use <function>pg_tablespace_size</>, you must have
    <literal>CREATE</> permission on the specified tablespace, or be a member
    of the <literal>pg_read_all_stats</> role unless it is the default tablespace for
    the current database.
--><code class="function">pg_database_size</code>と<code class="function">pg_tablespace_size</code>はデータベースまたはテーブル空間の名前またはOIDを受付け、そこで使用される総容量を返します。
<code class="function">pg_database_size</code>を使うためには、指定されたデータベースに<code class="literal">CONNECT</code>権限(デフォルトで付与されている)を持っていなければなりません。
<code class="function">pg_tablespace_size</code>を使うためには、それが現在のデータベースのデフォルトテーブル空間でない限り、指定されたテーブル空間に<code class="literal">CREATE</code>権限を持っていなければなりません。
   </p><p><!--
    <function>pg_relation_size</> accepts the OID or name of a table, index
    or toast table, and returns the on-disk size in bytes of one fork of
    that relation.  (Note that for most purposes it is more convenient to
    use the higher-level functions <function>pg_total_relation_size</>
    or <function>pg_table_size</>, which sum the sizes of all forks.)
    With one argument, it returns the size of the main data fork of the
    relation.  The second argument can be provided to specify which fork
    to examine:
--><code class="function">pg_relation_size</code>は、テーブル、インデックス、またはTOASTテーブルのOIDまたは名前を受け付け、そのリレーションの1つのフォークのディスク容量をバイト単位で返します。
(たいていの目的には、高位の関数<code class="function">pg_total_relation_size</code>や<code class="function">pg_table_size</code>を使うのがより便利であることに注意してください。高位の関数はフォークすべての容量を合計します。)
引数1つでは、そのリレーションの主データフォークの容量を返します。
2番目の引数はどのフォークを調査するかを指定するために設定できます。
    </p><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; "><li class="listitem"><p><!--
       <literal>'main'</literal> returns the size of the main
       data fork of the relation.
--><code class="literal">'main'</code>を指定すると、そのリレーションの主データフォークの容量を返します。
      </p></li><li class="listitem"><p><!--
       <literal>'fsm'</literal> returns the size of the Free Space Map
       (see <xref linkend="storage-fsm">) associated with the relation.
--><code class="literal">'fsm'</code>を指定すると、リレーションに関連した空き領域マップ(<a class="xref" href="storage-fsm.html" title="66.3. 空き領域マップ">66.3</a>を参照)を返します。
      </p></li><li class="listitem"><p><!--
       <literal>'vm'</literal> returns the size of the Visibility Map
       (see <xref linkend="storage-vm">) associated with the relation.
--><code class="literal">'vm'</code>を指定すると、リレーションに関連した可視性マップ(<a class="xref" href="storage-vm.html" title="66.4. 可視性マップ">66.4</a>を参照)の容量を返します。
      </p></li><li class="listitem"><p><!--
       <literal>'init'</literal> returns the size of the initialization
       fork, if any, associated with the relation.
--><code class="literal">'init'</code>を指定すると、もしあれば、リレーションに関連した初期化フォークの容量を返します。
      </p></li></ul></div><p>
   </p><p><!--
    <function>pg_size_pretty</> can be used to format the result of one of
    the other functions in a human-readable way, using bytes, kB, MB, GB or TB
    as appropriate.
--><code class="function">pg_size_pretty</code>は、適切にbytes、kB、MB、GB、もしくはTB単位を使用して目で見て判るようにその他の関数の1つの結果を整形するのに使用可能です。
   </p><p><!--
    <function>pg_size_bytes</> can be used to get the size in bytes from a
    string in human-readable format. The input may have units of bytes, kB,
    MB, GB or TB, and is parsed case-insensitively. If no units are specified,
    bytes are assumed.
--><code class="function">pg_size_bytes</code>可読性の高い形式の文字列からバイト単位のサイズを取得するのに使用可能です。
入力はbytes、kB、MB、GB、TBの単位を使用可能で、大文字小文字を区別せずに解釈されます。
単位の指定がなければ、bytes（バイト）であるとみなされます。
   </p><div class="note"><h3 class="title">注記</h3><p><!--
     The units kB, MB, GB and TB used by the functions
     <function>pg_size_pretty</> and <function>pg_size_bytes</> are defined
     using powers of 2 rather than powers of 10, so 1kB is 1024 bytes, 1MB is
     1024<superscript>2</> = 1048576 bytes, and so on.
--><code class="function">pg_size_pretty</code>および<code class="function">pg_size_bytes</code>が利用するkB、MB、GB、TBの単位は10のべき乗ではなく2のべき乗として定義されているため、1kBは1024バイト、1MBは1024<sup>2</sup> = 1048576バイト、それ以上も同じようになります。
    </p></div><p><!--
    The functions above that operate on tables or indexes accept a
    <type>regclass</> argument, which is simply the OID of the table or index
    in the <structname>pg_class</> system catalog.  You do not have to look up
    the OID by hand, however, since the <type>regclass</> data type's input
    converter will do the work for you.  Just write the table name enclosed in
    single quotes so that it looks like a literal constant.  For compatibility
    with the handling of ordinary <acronym>SQL</acronym> names, the string
    will be converted to lower case unless it contains double quotes around
    the table name.
-->上記の関数において、テーブルやインデックスを<code class="type">regclass</code>引数として受け取って処理するものがありますが、この引数は単に<code class="structname">pg_class</code>システムカタログにあるテーブルやインデックスのOIDです。
ただし、<code class="type">regclass</code>データ型が自動で入力変換を行うため、ユーザが手動で該当するOIDを調べる必要はありません。リテラル定数のようにシングルクオートで囲んだテーブル名を記述するだけです。
通常のSQL名に対する処理互換のため、テーブル名をダブルクオートで囲わない限り、テーブル名として入力された文字列は小文字に変換されます。
   </p><p><!--
    If an OID that does not represent an existing object is passed as
    argument to one of the above functions, NULL is returned.
-->上記の関数に対し、既存オブジェクトに該当するものがないOIDが渡された場合はNULLが返されます。
   </p><p><!--
    The functions shown in <xref linkend="functions-admin-dblocation"> assist
    in identifying the specific disk files associated with database objects.
--><a class="xref" href="functions-admin.html#functions-admin-dblocation" title="表9.85 データベースオブジェクト位置関数">表 9.85</a> に示される関数は、データベースオブジェクトに関連する特定のディスクファイルを確認する際の手助けとなります。
   </p><a id="idm46270561521472" class="indexterm"></a><a id="idm46270561520784" class="indexterm"></a><a id="idm46270561520096" class="indexterm"></a><div class="table" id="functions-admin-dblocation"><p class="title"><strong>表9.85 データベースオブジェクト位置関数</strong></p><div class="table-contents"><!--
    <title>Database Object Location Functions</title>
--><table class="table" summary="データベースオブジェクト位置関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_relation_filenode(<em class="parameter"><code>relation</code></em> <code class="type">regclass</code>)</code></code>
        </td><td><code class="type">oid</code></td><td><!--
        Filenode number of the specified relation
-->        指定されたリレーションのファイルノード番号
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_relation_filepath(<em class="parameter"><code>relation</code></em> <code class="type">regclass</code>)</code></code>
        </td><td><code class="type">text</code></td><td><!--
        File path name of the specified relation
-->        指定されたリレーションのファイルパス
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_filenode_relation(<em class="parameter"><code>tablespace</code></em> <code class="type">oid</code>, <em class="parameter"><code>filenode</code></em> <code class="type">oid</code>)</code></code>
        </td><td><code class="type">regclass</code></td><td><!--
        Find the relation associated with a given tablespace and filenode
-->        与えられたテーブル空間とファイルノードに関連するリレーションを見つける
       </td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    <function>pg_relation_filenode</> accepts the OID or name of a table,
    index, sequence, or toast table, and returns the <quote>filenode</> number
    currently assigned to it.  The filenode is the base component of the file
    name(s) used for the relation (see <xref linkend="storage-file-layout">
    for more information).  For most tables the result is the same as
    <structname>pg_class</>.<structfield>relfilenode</>, but for certain
    system catalogs <structfield>relfilenode</> is zero and this function must
    be used to get the correct value.  The function returns NULL if passed
    a relation that does not have storage, such as a view.
--><code class="function">pg_relation_filenode</code>は、テーブル、インデックス、シーケンス、もしくはTOASTテーブルのOIDまたは名前を受け付け、現在それに充てられている<span class="quote">「<span class="quote">ファイルノード</span>」</span>番号を返します。
ファイルノードは、リレーションに使用しているファイル名の基礎部分です(詳しくは<a class="xref" href="storage-file-layout.html" title="66.1. データベースファイルのレイアウト">66.1</a>を参照して下さい)。
ほとんどのテーブルについては、結果が<code class="structname">pg_class</code>.<code class="structfield">relfilenode</code>と同じになります。ただし、いくつかのシステムカタログでは<code class="structfield">relfilenode</code>が0になるため、これらのシステムカタログの正しいファイルノードを取得するには、この関数を使用しなければいけません。
この関数は、ビューの様にストレージに格納されないリレーションが指定された場合はNULLを返します。
   </p><p><!--
    <function>pg_relation_filepath</> is similar to
    <function>pg_relation_filenode</>, but it returns the entire file path name
    (relative to the database cluster's data directory <varname>PGDATA</>) of
    the relation.
--><code class="function">pg_relation_filepath</code>は<code class="function">pg_relation_filenode</code>と似ていますが、こちらはリレーションのファイルパス名(データベースクラスタのディレクトリである<code class="varname">PGDATA</code>からの相対パス)を返します。
   </p><p><!--
    <function>pg_filenode_relation</> is the reverse of
    <function>pg_relation_filenode</>. Given a <quote>tablespace</> OID and
    a <quote>filenode</>, it returns the associated relation's OID. For a table
    in the database's default tablespace, the tablespace can be specified as 0.
--><code class="function">pg_filenode_relation</code>は<code class="function">pg_relation_filenode</code>の逆です。
<span class="quote">「<span class="quote">テーブル空間</span>」</span>OIDと<span class="quote">「<span class="quote">ファイルノード</span>」</span>を与えると、関連するリレーションのOIDを返します。
データベースのデフォルトテーブル空間内のテーブルに対しては、テーブル空間は0と指定できます。
   </p><p>    <a class="xref" href="functions-admin.html#functions-admin-collation" title="表9.86 Collation Management Functions">表 9.86</a> lists functions used to manage
    collations.
   </p><div class="table" id="functions-admin-collation"><p class="title"><strong>表9.86 Collation Management Functions</strong></p><div class="table-contents"><table class="table" summary="Collation Management Functions" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Name</th><th>Return Type</th><th>Description</th></tr></thead><tbody><tr><td>        <a id="idm46270561489600" class="indexterm"></a>
        <code class="literal"><code class="function">pg_collation_actual_version(<code class="type">oid</code>)</code></code>
       </td><td><code class="type">text</code></td><td>Return actual version of collation from operating system</td></tr><tr><td>        <a id="idm46270561486144" class="indexterm"></a>
        <code class="literal"><code class="function">pg_import_system_collations(<em class="parameter"><code>schema</code></em> <code class="type">regnamespace</code>)</code></code>
       </td><td><code class="type">integer</code></td><td>Import operating system collations</td></tr></tbody></table></div></div><br class="table-break" /><p>    <code class="function">pg_collation_actual_version</code> returns the actual
    version of the collation object as it is currently installed in the
    operating system.  If this is different from the value
    in <code class="literal">pg_collation.collversion</code>, then objects depending on
    the collation might need to be rebuilt.  See also
    <a class="xref" href="sql-altercollation.html" title="ALTER COLLATION"><span class="refentrytitle">ALTER COLLATION</span></a>.
   </p><p>    <code class="function">pg_import_system_collations</code> adds collations to the system
    catalog <code class="literal">pg_collation</code> based on all the
    locales it finds in the operating system.  This is
    what <code class="command">initdb</code> uses;
    see <a class="xref" href="collation.html#collation-managing" title="23.2.2. 照合の管理">23.2.2</a> for more details.  If additional
    locales are installed into the operating system later on, this function
    can be run again to add collations for the new locales.  Locales that
    match existing entries in <code class="literal">pg_collation</code> will be skipped.
    (But collation objects based on locales that are no longer
    present in the operating system are not removed by this function.)
    The <em class="parameter"><code>schema</code></em> parameter would typically
    be <code class="literal">pg_catalog</code>, but that is not a requirement;
    the collations could be installed into some other schema as well.
    The function returns the number of new collation objects it created.
   </p></div><div class="sect2" id="functions-admin-index"><div class="titlepage"><div><div><h3 class="title">9.26.8. インデックス保守関数</h3></div></div></div><!--
   <title>Index Maintenance Functions</title>
--><a id="idm46270561472416" class="indexterm"></a><a id="idm46270561471744" class="indexterm"></a><a id="idm46270561471056" class="indexterm"></a><a id="idm46270561470368" class="indexterm"></a><p><!--
    <xref linkend="functions-admin-index-table"> shows the functions
    available for index maintenance tasks.
    These functions cannot be executed during recovery.
    Use of these functions is restricted to superusers and the owner
    of the given index.
--><a class="xref" href="functions-admin.html#functions-admin-index-table" title="表9.87 インデックス保守関数">表 9.87</a>にインデックスの保守タスクに使用可能な関数を示します。
これらの関数はリカバリ中は実行できません。
これらの関数の使用はスーパーユーザと対象のインデックスの所有者に限定されます。
   </p><div class="table" id="functions-admin-index-table"><p class="title"><strong>表9.87 インデックス保守関数</strong></p><div class="table-contents"><!--
    <title>Index Maintenance Functions</title>
--><table class="table" summary="インデックス保守関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">brin_summarize_new_values(<em class="parameter"><code>index</code></em> <code class="type">regclass</code>)</code></code>
       </td><td><code class="type">integer</code></td><td>まだ要約されていないページ範囲を要約する</td></tr><tr><td>        <code class="literal"><code class="function">brin_summarize_range(<em class="parameter"><code>index</code></em> <code class="type">regclass</code>, <em class="parameter"><code>blockNumber</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">integer</code></td><td>summarize the page range covering the given block, if not already summarized</td></tr><tr><td>        <code class="literal"><code class="function">brin_desummarize_range(<em class="parameter"><code>index</code></em> <code class="type">regclass</code>, <em class="parameter"><code>blockNumber</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">integer</code></td><td>de-summarize the page range covering the given block, if summarized</td></tr><tr><td>        <code class="literal"><code class="function">gin_clean_pending_list(<em class="parameter"><code>index</code></em> <code class="type">regclass</code>)</code></code>
       </td><td><code class="type">bigint</code></td><td>GINの処理待ちリストのエントリをメインのインデックス構造に移動する</td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    <function>brin_summarize_new_values</> accepts the OID or name of a
    BRIN index and inspects the index to find page ranges in the base table
    that are not currently summarized by the index; for any such range
    it creates a new summary index tuple by scanning the table pages.
    It returns the number of new page range summaries that were inserted
    into the index.  <function>brin_summarize_range</> does the same, except
    it only summarizes the range that covers the given block number.
--><code class="function">brin_summarize_new_values</code>はBRINインデックスのOIDまたは名前を受け取り、インデックスを検査してベーステーブル内のインデックスによって現在要約されていないページ範囲を探します。
そのような範囲があれば、テーブルのページをスキャンして新しい要約インデックスタプルを作成します。
インデックスに挿入された新しいページ範囲要約の数を返します。
   </p><p><!--
    <function>gin_clean_pending_list</> accepts the OID or name of
    a GIN index and cleans up the pending list of the specified index
    by moving entries in it to the main GIN data structure in bulk.
    It returns the number of pages removed from the pending list.
    Note that if the argument is a GIN index built with
    the <literal>fastupdate</> option disabled, no cleanup happens and the
    return value is 0, because the index doesn't have a pending list.
    Please see <xref linkend="gin-fast-update"> and <xref linkend="gin-tips">
    for details of the pending list and <literal>fastupdate</> option.
--><code class="function">gin_clean_pending_list</code>はGINインデックスのOIDまたは名前を受け取り、指定のインデックスの処理待ちリストのエントリをメインのGINデータ構造にまとめて移動することで、リストを削除します。
処理待ちリストから削除されたページ数が返されます。
引数が<code class="literal">fastupdate</code>オプションを無効にして構築されたGINインデックスの場合、インデックスには処理待ちリストがないため、削除は発生せず、戻り値は0になることに注意して下さい。
処理待ちリストおよび<code class="literal">fastupdate</code>の詳細については<a class="xref" href="gin-implementation.html#gin-fast-update" title="64.4.1. GIN高速更新手法">64.4.1</a>および<a class="xref" href="gin-tips.html" title="64.5. GINの小技">64.5</a>を参照して下さい。
   </p></div><div class="sect2" id="functions-admin-genfile"><div class="titlepage"><div><div><h3 class="title">9.26.9. 汎用ファイルアクセス関数</h3></div></div></div><!--
   <title>Generic File Access Functions</title>
--><p><!--
    The functions shown in <xref
    linkend="functions-admin-genfile-table"> provide native access to
    files on the machine hosting the server. Only files within the
    database cluster directory and the <varname>log_directory</> can be
    accessed.  Use a relative path for files in the cluster directory,
    and a path matching the <varname>log_directory</> configuration setting
    for log files.  Use of these functions is restricted to superusers
    except where stated otherwise.
--><a class="xref" href="functions-admin.html#functions-admin-genfile-table" title="表9.88 汎用ファイルアクセス関数">表 9.88</a>で示されている関数はサーバをホスティングしているマシン上のファイルに対し、ネイティブのアクセスを提供します。
データベースクラスタディレクトリと<code class="varname">log_directory</code>に存在するファイルのみがアクセス可能です。
クラスタディレクトリ内のファイルに対して相対パスを、そしてログファイルに対しては<code class="varname">log_directory</code>構成設定に一致するパスを使用してください。
これらの関数はスーパーユーザだけが使用できます。
   </p><div class="table" id="functions-admin-genfile-table"><p class="title"><strong>表9.88 汎用ファイルアクセス関数</strong></p><div class="table-contents"><!--
    <title>Generic File Access Functions</title>
--><table class="table" summary="汎用ファイルアクセス関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_ls_dir(<em class="parameter"><code>dirname</code></em> <code class="type">text</code> [, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code>, <em class="parameter"><code>include_dot_dirs</code></em> <code class="type">boolean</code>])</code></code>
       </td><td><code class="type">setof text</code></td><td><!--
        List the contents of a directory.
-->ディレクトリの内容を一覧表示する
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_ls_logdir()</code></code>
       </td><td><code class="type">setof record</code></td><td>        List the name, size, and last modification time of files in the log
        directory. Access is granted to members of the <code class="literal">pg_monitor</code>
        role and may be granted to other non-superuser roles.
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_ls_waldir()</code></code>
       </td><td><code class="type">setof record</code></td><td>        List the name, size, and last modification time of files in the WAL
        directory. Access is granted to members of the <code class="literal">pg_monitor</code>
        role and may be granted to other non-superuser roles.
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_read_file(<em class="parameter"><code>filename</code></em> <code class="type">text</code> [, <em class="parameter"><code>offset</code></em> <code class="type">bigint</code>, <em class="parameter"><code>length</code></em> <code class="type">bigint</code> [, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code>] ])</code></code>
       </td><td><code class="type">text</code></td><td><!--
        Return the contents of a text file.
-->テキストファイルの内容を返す
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_read_binary_file(<em class="parameter"><code>filename</code></em> <code class="type">text</code> [, <em class="parameter"><code>offset</code></em> <code class="type">bigint</code>, <em class="parameter"><code>length</code></em> <code class="type">bigint</code> [, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code>] ])</code></code>
       </td><td><code class="type">bytea</code></td><td><!--
        Return the contents of a file.
-->ファイルの内容を返す
       </td></tr><tr><td>        <code class="literal"><code class="function">pg_stat_file(<em class="parameter"><code>filename</code></em> <code class="type">text</code>[, <em class="parameter"><code>missing_ok</code></em> <code class="type">boolean</code>])</code></code>
       </td><td><code class="type">record</code></td><td><!--
        Return information about a file.
-->ファイルについての情報を返す
       </td></tr></tbody></table></div></div><br class="table-break" /><p><!--
    Some of these functions take an optional <parameter>missing_ok</> parameter,
    which specifies the behavior when the file or directory does not exist.
    If <literal>true</literal>, the function returns NULL (except
    <function>pg_ls_dir</>, which returns an empty result set). If
    <literal>false</>, an error is raised. The default is <literal>false</>.
-->これらの関数はいずれもオプションで<em class="parameter"><code>missing_ok</code></em>パラメータをとり、ファイルまたはディレクトリが存在しない場合の動作を指定できます。
<code class="literal">true</code>の場合、関数はNULLを返します（ただし、<code class="function">pg_ls_dir</code>は空の結果集合を返します）。
<code class="literal">false</code>の場合はエラーが発生します。
デフォルトは<code class="literal">false</code>です。
   </p><a id="idm46270561398816" class="indexterm"></a><p><!--
    <function>pg_ls_dir</> returns the names of all files (and directories
    and other special files) in the specified directory. The <parameter>
    include_dot_dirs</> indicates whether <quote>.</> and <quote>..</> are
    included in the result set. The default is to exclude them
    (<literal>false</>), but including them can be useful when
    <parameter>missing_ok</> is <literal>true</literal>, to distinguish an
    empty directory from an non-existent directory.
--><code class="function">pg_ls_dir</code>は、指定されたディレクトリ内のすべてのファイル（およびディレクトリと他の特殊ファイル）の名前を返します。
<em class="parameter"><code>include_dot_dirs</code></em>は<span class="quote">「<span class="quote">.</span>」</span>と<span class="quote">「<span class="quote">..</span>」</span>が結果集合に含まれるかどうかを指定します。
デフォルト(<code class="literal">false</code>)ではそれらを除外しますが、それらを含めると、<em class="parameter"><code>missing_ok</code></em>が<code class="literal">true</code>の場合は、空のディレクトリと存在しないディレクトリを区別するために役立つでしょう。
   </p><a id="idm46270561392560" class="indexterm"></a><p>    <code class="function">pg_ls_logdir</code> returns the name, size, and last modified time
    (mtime) of each file in the log directory. By default, only superusers
    and members of the <code class="literal">pg_monitor</code> role can use this function.
    Access may be granted to others using <code class="command">GRANT</code>.
   </p><a id="idm46270561389280" class="indexterm"></a><p>    <code class="function">pg_ls_waldir</code> returns the name, size, and last modified time
    (mtime) of each file in the write ahead log (WAL) directory. By
    default only superusers and members of the <code class="literal">pg_monitor</code> role
    can use this function. Access may be granted to others using
    <code class="command">GRANT</code>.
   </p><a id="idm46270561385968" class="indexterm"></a><p><!--
    <function>pg_read_file</> returns part of a text file, starting
    at the given <parameter>offset</>, returning at most <parameter>length</>
    bytes (less if the end of file is reached first).  If <parameter>offset</>
    is negative, it is relative to the end of the file.
    If <parameter>offset</> and <parameter>length</> are omitted, the entire
    file is returned.  The bytes read from the file are interpreted as a string
    in the server encoding; an error is thrown if they are not valid in that
    encoding.
--><code class="function">pg_read_file</code>は与えられた<em class="parameter"><code>offset</code></em>から始まり、最大<em class="parameter"><code>length</code></em>バイト（先にファイルの終りに到達すればこれより少なくなります）テキストファイルの一部分を返します。
<em class="parameter"><code>offset</code></em>が負の場合にはファイルの終りから数えた位置から読み出します。
<em class="parameter"><code>offset</code></em>と<em class="parameter"><code>length</code></em>が省略された場合、ファイル全体が返されます。
ファイルから読み込まれたバイトは、そのサーバの符号化方式での文字列として解釈されます。
読み込んだバイト列がその符号化方式において有効でない場合にはエラーが投げられます。
   </p><a id="idm46270561379280" class="indexterm"></a><p><!--
    <function>pg_read_binary_file</> is similar to
    <function>pg_read_file</>, except that the result is a <type>bytea</type> value;
    accordingly, no encoding checks are performed.
    In combination with the <function>convert_from</> function, this function
    can be used to read a file in a specified encoding:
--><code class="function">pg_read_binary_file</code>は、結果が<code class="type">bytea</code>値となり、従って符号化の検査がされないことを除き、<code class="function">pg_read_file</code>と似ています。
<code class="function">convert_from</code>関数と組み合わせることで、この関数を、指定した符号化方式でファイルの読み込むために使うことができます。
    
</p><pre class="programlisting">SELECT convert_from(pg_read_binary_file('file_in_utf8.txt'), 'UTF8');</pre><p>
   </p><a id="idm46270561374448" class="indexterm"></a><p><!--
    <function>pg_stat_file</> returns a record containing the file
    size, last accessed time stamp, last modified time stamp,
    last file status change time stamp (Unix platforms only),
    file creation time stamp (Windows only), and a <type>boolean</type>
    indicating if it is a directory.  Typical usages include:
--><code class="function">pg_stat_file</code>はファイル容量、最終アクセス時刻、最終更新時刻、最後にファイルステータスを変更した時刻（これはUnixプラットフォームのみ）、ファイル作成時刻（Windowsのみ）および、ディレクトリかどうかを示す<code class="type">boolean</code>を返します。
典型的な使用方法を示します。
</p><pre class="programlisting">SELECT * FROM pg_stat_file('filename');
SELECT (pg_stat_file('filename')).modification;</pre><p>
   </p></div><div class="sect2" id="functions-advisory-locks"><div class="titlepage"><div><div><h3 class="title">9.26.10. 勧告的ロック用関数</h3></div></div></div><!--
   <title>Advisory Lock Functions</title>
--><p><!--
    The functions shown in <xref linkend="functions-advisory-locks-table">
    manage advisory locks.  For details about proper use of these functions,
    see <xref linkend="advisory-locks">.
--><a class="xref" href="functions-admin.html#functions-advisory-locks-table" title="表9.89 勧告的ロック用関数">表 9.89</a>に示す関数は勧告的ロックを管理します。
これらの関数の適切な使用方法についての詳細は、<a class="xref" href="explicit-locking.html#advisory-locks" title="13.3.5. 勧告的ロック">13.3.5</a>を参照してください。
   </p><div class="table" id="functions-advisory-locks-table"><p class="title"><strong>表9.89 勧告的ロック用関数</strong></p><div class="table-contents"><!--
    <title>Advisory Lock Functions</title>
--><table class="table" summary="勧告的ロック用関数" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名前</th><th>戻り型</th><th>説明</th></tr></thead><tbody><tr><td>        <code class="literal"><code class="function">pg_advisory_lock(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">void</code></td><td>セッションレベルの排他勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_lock(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">void</code></td><td>セッションレベルの排他勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_lock_shared(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">void</code></td><td>セッションレベルの共有勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_lock_shared(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">void</code></td><td>セッションレベルの共有勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_unlock(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>セッションレベルの排他勧告的ロックを解放</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_unlock(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>セッションレベルの排他勧告的ロックを解放</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_unlock_all()</code></code>
       </td><td><code class="type">void</code></td><td>現在のセッションで保持している全てのセッションレベルの勧告的ロックを解放</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_unlock_shared(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>セッションレベルの共有勧告的ロックを解放</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_unlock_shared(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>セッションレベルの共有勧告的ロックの解放</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_xact_lock(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">void</code></td><td>トランザクションレベルの排他勧告的ロックの獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_xact_lock(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">void</code></td><td>トランザクションレベルの排他勧告的ロックの獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_xact_lock_shared(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">void</code></td><td>トランザクションレベルの共有勧告的ロックの獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_advisory_xact_lock_shared(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">void</code></td><td>トランザクションレベルの共有勧告的ロックの獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_lock(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばセッションレベルの排他勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_lock(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばセッションレベルの排他勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_lock_shared(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばセッションレベルの共有勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_lock_shared(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばセッションレベルの共有勧告的ロックを獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_xact_lock(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばトランザクションレベルの排他勧告的ロックの獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_xact_lock(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばトランザクションレベルの排他勧告的ロックの獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_xact_lock_shared(<em class="parameter"><code>key</code></em> <code class="type">bigint</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばトランザクションレベルの共有勧告的ロックの獲得</td></tr><tr><td>        <code class="literal"><code class="function">pg_try_advisory_xact_lock_shared(<em class="parameter"><code>key1</code></em> <code class="type">int</code>, <em class="parameter"><code>key2</code></em> <code class="type">int</code>)</code></code>
       </td><td><code class="type">boolean</code></td><td>可能ならばトランザクションレベルの共有勧告的ロックの獲得</td></tr></tbody></table></div></div><br class="table-break" /><a id="idm46270561280608" class="indexterm"></a><p><!--
    <function>pg_advisory_lock</> locks an application-defined resource,
    which can be identified either by a single 64-bit key value or two
    32-bit key values (note that these two key spaces do not overlap).
    If another session already holds a lock on the same resource identifier,
    this function will wait until the resource becomes available.  The lock
    is exclusive.  Multiple lock requests stack, so that if the same resource
    is locked three times it must then be unlocked three times to be
    released for other sessions' use.
--><code class="function">pg_advisory_lock</code>は、アプリケーションが定義したリソースをロックします。キーは単一の64ビットキー値、または、２つの32ビットキー（この2つのキー空間は重複しないことに注意）によって識別されます。
もし、別のセッションが同一リソースに対するロックを保持している場合、関数はリソースが利用可能になるまで待機します。ロックは排他ロックです。
複数のロック要求があればスタックに積まれるため、同一リソースが３回ロックされた場合、他のセッションが使用できるように解放するためにはロック解除を３回行わなければなりません。
   </p><a id="idm46270561279104" class="indexterm"></a><p><!--
    <function>pg_advisory_lock_shared</> works the same as
    <function>pg_advisory_lock</>,
    except the lock can be shared with other sessions requesting shared locks.
    Only would-be exclusive lockers are locked out.
--><code class="function">pg_advisory_lock_shared</code>の動作は<code class="function">pg_advisory_lock</code>と同じですが、他のセッションの共有ロックと共有できるロックである点が異なります。
排他ロック要求のみ締め出されます。
   </p><a id="idm46270561274384" class="indexterm"></a><p><!--
    <function>pg_try_advisory_lock</> is similar to
    <function>pg_advisory_lock</>, except the function will not wait for the
    lock to become available.  It will either obtain the lock immediately and
    return <literal>true</>, or return <literal>false</> if the lock cannot be
    acquired immediately.
--><code class="function">pg_try_advisory_lock</code>は<code class="function">pg_advisory_lock</code>と同様ですが、この関数の場合、ロックが利用可能になるまで待機しません。
ロックを即座に取得し<code class="literal">true</code>を返すか、ロックを即座に獲得できなかった場合に<code class="literal">false</code>を返すかのいずれかです。
   </p><a id="idm46270561270080" class="indexterm"></a><p><!--
    <function>pg_try_advisory_lock_shared</> works the same as
    <function>pg_try_advisory_lock</>, except it attempts to acquire
    a shared rather than an exclusive lock.
--><code class="function">pg_try_advisory_lock_shared</code>の動作は <code class="function">pg_try_advisory_lock</code>と同じですが、排他ロックではなく共有ロックの獲得を試みます。
   </p><a id="idm46270561267392" class="indexterm"></a><p><!--
    <function>pg_advisory_unlock</> will release a previously-acquired
    exclusive session level advisory lock.  It
    returns <literal>true</> if the lock is successfully released.
    If the lock was not held, it will return <literal>false</>,
    and in addition, an SQL warning will be reported by the server.
--><code class="function">pg_advisory_unlock</code>は、事前に獲得したセッションレベルの勧告的排他ロックを解放します。ロックの解放に成功した場合、<code class="literal">true</code>を返します。ロックを保持していない場合、<code class="literal">false</code>を返し、さらに、SQL警告がサーバから報告されます。
   </p><a id="idm46270561263712" class="indexterm"></a><p><!--
    <function>pg_advisory_unlock_shared</> works the same as
    <function>pg_advisory_unlock</>,
    except it releases a shared session level advisory lock.
--><code class="function">pg_advisory_unlock_shared</code>の動作は<code class="function">pg_advisory_unlock</code>と同じですが、セッションレベルの勧告的共有ロックを解放する点が異なります。
   </p><a id="idm46270561261008" class="indexterm"></a><p><!--
    <function>pg_advisory_unlock_all</> will release all session level advisory
    locks held by the current session.  (This function is implicitly invoked
    at session end, even if the client disconnects ungracefully.)
--><code class="function">pg_advisory_unlock_all</code>は、現在のセッションで保持するセッションレベルの勧告的ロックをすべて解放します。
（この関数は、クライアントとの接続がぶざまに切れた場合でも、セッション終了時に暗黙的に呼び出されます。)
   </p><a id="idm46270561258848" class="indexterm"></a><p><!--
    <function>pg_advisory_xact_lock</> works the same as
    <function>pg_advisory_lock</>, except the lock is automatically released
    at the end of the current transaction and cannot be released explicitly.
--><code class="function">pg_advisory_xact_lock</code>の動作は<code class="function">pg_advisory_lock</code>と同じですが、現在のトランザクションの終了時に自動的にロックが解放され、明示的なロックの解放はできません。
   </p><a id="idm46270561256096" class="indexterm"></a><p><!--
    <function>pg_advisory_xact_lock_shared</> works the same as
    <function>pg_advisory_lock_shared</>, except the lock is automatically released
    at the end of the current transaction and cannot be released explicitly.
--><code class="function">pg_advisory_xact_lock_shared</code>の動作は<code class="function">pg_advisory_lock_shared</code>と同じですが、現在のトランザクションの終了時に自動的にロックが解放され、明示的なロックの解放はできません。
   </p><a id="idm46270561253296" class="indexterm"></a><p><!--
    <function>pg_try_advisory_xact_lock</> works the same as
    <function>pg_try_advisory_lock</>, except the lock, if acquired,
    is automatically released at the end of the current transaction and
    cannot be released explicitly.
--><code class="function">pg_try_advisory_xact_lock</code>の動作は<code class="function">pg_try_advisory_lock</code>と同じですが、ロックが獲得できた場合は現在のトランザクションの終了時に自動的にロックが解放され、明示的なロックの解放はできません。
   </p><a id="idm46270561250432" class="indexterm"></a><p><!--
    <function>pg_try_advisory_xact_lock_shared</> works the same as
    <function>pg_try_advisory_lock_shared</>, except the lock, if acquired,
    is automatically released at the end of the current transaction and
    cannot be released explicitly.
--><code class="function">pg_try_advisory_xact_lock_shared</code>の動作は<code class="function">pg_try_advisory_lock_shared</code>と同じですが、ロックが獲得できた場合は現在のトランザクションの終了時に自動的にロックが解放され、明示的なロックの解放はできません。
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-info.html">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-trigger.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">9.25. システム情報関数 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 9.27. トリガ関数</td></tr></table></div></body></html>