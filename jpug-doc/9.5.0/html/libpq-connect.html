<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>31.1. データベース接続制御関数</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="PostgreSQL 9.5.0文書" /><link rel="up" href="libpq.html" title="第31章 libpq - C ライブラリ" /><link rel="prev" href="libpq.html" title="第31章 libpq - C ライブラリ" /><link rel="next" href="libpq-status.html" title="31.2. 接続状態関数" /><link rel="copyright" href="legalnotice.html" title="法的告知" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.1. データベース接続制御関数</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="libpq.html">戻る</a> </td><th width="60%" align="center">第31章 <span class="application">libpq</span> - C ライブラリ</th><td width="20%" align="right"> <a accesskey="n" href="libpq-status.html">次へ</a></td></tr></table><hr /></div><div class="sect1" id="libpq-connect"><div class="titlepage"><div><div><h2 class="title" style="clear: both">31.1. データベース接続制御関数</h2></div></div></div><span class="original">
  &lt;title&gt;Database Connection Control Functions&lt;/title&gt;
</span><p><span class="original">
   The following functions deal with making a connection to a
   &lt;productname&gt;PostgreSQL&lt;/productname&gt; backend server.  An
   application program can have several backend connections open at
   one time.  (One reason to do that is to access more than one
   database.)  Each connection is represented by a
   &lt;structname&gt;PGconn&lt;/&gt;&lt;indexterm&gt;&lt;primary&gt;PGconn&lt;/&gt;&lt;/&gt; object, which
   is obtained from the function &lt;function&gt;PQconnectdb&lt;/&gt;,
   &lt;function&gt;PQconnectdbParams&lt;/&gt;, or
   &lt;function&gt;PQsetdbLogin&lt;/&gt;.  Note that these functions will always
   return a non-null object pointer, unless perhaps there is too
   little memory even to allocate the &lt;structname&gt;PGconn&lt;/&gt; object.
   The &lt;function&gt;PQstatus&lt;/&gt; function should be called to check
   the return value for a successful connection before queries are sent
   via the connection object.
</span><span class="productname">PostgreSQL</span>のバックエンドサーバとの接続を作成するには、以下の関数を使用します。
アプリケーションプログラムはバックエンドとの接続を一度に複数個開くことができます。
（1つの理由として、複数のデータベースへのアクセスが挙げられます。）
個々の接続は、<code class="function">PQconnectdb</code>、<code class="function">PQconnectdbParams</code>または<code class="function">PQsetdbLogin</code>関数を呼び出すことで得られる<code class="structname">PGconn</code><a id="idp81662096" class="indexterm"></a>オブジェクトによって表されます。
なお、これらの関数は、<code class="structname">PGconn</code>オブジェクトに割り当てるほんのわずかなメモリの余裕さえもない場合を除き、NULLではなく常にオブジェクトのポインタを返します。
また、この接続オブジェクトを通じて問い合わせを送る前に、<code class="function">PQstatus</code>関数を呼び出して、データベースとの接続に成功したか戻り値を検査しなければなりません。

   </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">警告</h3><p><span class="original">
     On Unix, forking a process with open libpq connections can lead to
     unpredictable results because the parent and child processes share
     the same sockets and operating system resources.  For this reason,
     such usage is not recommended, though doing an &lt;function&gt;exec&lt;/&gt; from
     the child process to load a new executable is safe.
</span>Unix上で、libpq接続を開いたプロセスのフォークは、親と子のプロセスが同じソケットとオペレーティングシステムの資源を共有するため、予期せぬ結果を招くことがあります。
この理由により、新規実行形式を子プロセスが読み込むため<code class="function">exec</code>を行うことが安全と言っても、このような使用方法は推奨されません。
    </p></div><p>

   </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p><span class="original">
     On Windows, there is a way to improve performance if a single
     database connection is repeatedly started and shutdown.  Internally,
     libpq calls &lt;function&gt;WSAStartup()&lt;/&gt; and &lt;function&gt;WSACleanup()&lt;/&gt; for connection startup
     and shutdown, respectively.  &lt;function&gt;WSAStartup()&lt;/&gt; increments an internal
     Windows library reference count which is decremented by &lt;function&gt;WSACleanup()&lt;/&gt;.
     When the reference count is just one, calling &lt;function&gt;WSACleanup()&lt;/&gt; frees
     all resources and all DLLs are unloaded.  This is an expensive
     operation.  To avoid this, an application can manually call
     &lt;function&gt;WSAStartup()&lt;/&gt; so resources will not be freed when the last database
     connection is closed.
</span>Windowsでは、単一のデータベース接続が反復して開始と終了を繰り返す場合、性能を向上させる方法があります。
内部的には、接続開始と終了に対して、libpqはそれぞれ<code class="function">WSAStartup()</code>と<code class="function">WSACleanup()</code>を呼び出します。
<code class="function">WSAStartup()</code>は<code class="function">WSACleanup()</code>で値が減少させられた内部Windowsライブラリ参照カウントを増加させます。
参照カウントがたった１の場合、<code class="function">WSACleanup()</code>呼び出しはすべてのリソースを解放し、すべてのDLLはアンロードされます。
これは高価な操作です。
これを回避するには、最後のデータベース接続が閉じられる時、リソースが解放されないようにアプリケーションが手動で<code class="function">WSAStartup()</code>を呼び出すことができます。
    </p></div><p>

   </p><div class="variablelist"><dl class="variablelist"><dt id="libpq-pqconnectdbparams"><span class="term"><code class="function">PQconnectdbParams</code><a id="idp81674944" class="indexterm"></a></span></dt><dd><p><span class="original">
       Makes a new connection to the database server.
</span>新たにデータベースサーバへの接続を作成します。

</p><pre class="synopsis">PGconn *PQconnectdbParams(const char * const *keywords,
                          const char * const *values,
                          int expand_dbname);</pre><p>
      </p><p><span class="original">
       This function opens a new database connection using the parameters taken
       from two &lt;symbol&gt;NULL&lt;/symbol&gt;-terminated arrays. The first,
       &lt;literal&gt;keywords&lt;/literal&gt;, is defined as an array of strings, each one
       being a key word. The second, &lt;literal&gt;values&lt;/literal&gt;, gives the value
       for each key word. Unlike &lt;function&gt;PQsetdbLogin&lt;/&gt; below, the parameter
       set can be extended without changing the function signature, so use of
       this function (or its nonblocking analogs &lt;function&gt;PQconnectStartParams&lt;/&gt;
       and &lt;function&gt;PQconnectPoll&lt;/function&gt;) is preferred for new application
       programming.
</span>この関数は、2つの<code class="symbol">NULL</code>終端の配列から取得したパラメータを使用して、データベースとの接続を新たに1つ確立します。
1つ目は文字列配列として定義される<code class="literal">keywords</code>で、それぞれがキーワードとなります。
2つ目は<code class="literal">values</code>で、各キーワードの値を提供します。
後述の<code class="function">PQsetdbLogin</code>とは異なり、関数のシグネチャを変更せずにパラメータ集合を拡張できますので、アプリケーションプログラムを新たに作成する際には、この関数(もしくは非ブロックモードでよく似た処理をする<code class="function">PQconnectStartParams</code>と<code class="function">PQconnectPoll</code>)を使用することをお勧めします。
      </p><p><span class="original">
       The currently recognized parameter key words are listed in
       &lt;xref linkend="libpq-paramkeywords"&gt;.
</span>現在有効なパラメータキーワードを<a class="xref" href="libpq-connect.html#libpq-paramkeywords" title="31.1.2. パラメータキーワード">「パラメータキーワード」</a>に示します。
      </p><p><span class="original">
       When &lt;literal&gt;expand_dbname&lt;/literal&gt; is non-zero, the
       &lt;parameter&gt;dbname&lt;/parameter&gt; key word value is allowed to be recognized
       as a connection string. Only the first occurrence of
       &lt;parameter&gt;dbname&lt;/parameter&gt; is expanded this way, any subsequent
       &lt;parameter&gt;dbname&lt;/parameter&gt; value is processed as plain database name. More
       details on the possible connection string formats appear in
       &lt;xref linkend="libpq-connstring"&gt;.
</span><code class="literal">expand_dbname</code>が非ゼロの場合、<em class="parameter"><code>dbname</code></em>キーワードの値を接続文字列として認識させることができます。
最初に出現した<em class="parameter"><code>dbname</code></em>だけがこのように展開され、後続の<em class="parameter"><code>dbname</code></em>値は通常のデータベース名として処理されます。
接続文字列の取り得る書式に関する詳細については<a class="xref" href="libpq-connect.html#libpq-connstring" title="31.1.1. 接続文字列">「接続文字列」</a>を参照してください。
      </p><p><span class="original">
       The passed arrays can be empty to use all default parameters, or can
       contain one or more parameter settings. They should be matched in length.
       Processing will stop at the first &lt;symbol&gt;NULL&lt;/symbol&gt; element
       in the &lt;literal&gt;keywords&lt;/literal&gt; array.
</span>空の配列を渡してすべてデフォルトパラメータを使用することができます。
また渡される配列に1つ以上のパラメータ設定を持たせることもできます。
これらの長さは一致しなければなりません。
<code class="literal">keywords</code>配列の最初の<code class="symbol">NULL</code>要素で処理は停止します。
      </p><p><span class="original">
       If  any  parameter is &lt;symbol&gt;NULL&lt;/symbol&gt; or an empty string, the corresponding
       environment variable (see &lt;xref linkend="libpq-envars"&gt;) is checked.
       If the  environment  variable is not set either, then the indicated
       built-in defaults are used.
</span>パラメータが<code class="symbol">NULL</code>や空文字列の場合には、対応する環境変数（<a class="xref" href="libpq-envars.html" title="31.14. 環境変数">「環境変数」</a>参照）が検査されます。
環境変数も設定されていない場合は、組み込みのデフォルト値が使用されます。
      </p><p><span class="original">
       In general key words are processed from the beginning of these arrays in index
       order. The effect of this is that when key words are repeated, the last processed
       value is retained. Therefore, through careful placement of the
       &lt;parameter&gt;dbname&lt;/parameter&gt; key word, it is possible to determine what may
       be overridden by a &lt;parameter&gt;conninfo&lt;/parameter&gt; string, and what may not.
</span>一般的にキーワードはこれらの配列の先頭からインデックス順で処理されます。
この影響はキーワードが繰り返された場合で、最後に処理された値が残ることになります。
このため、<em class="parameter"><code>dbname</code></em>キーワードの記述場所に注意することで、<em class="parameter"><code>conninfo</code></em>文字列により何が上書きされるか、何が上書きされないかを決定することができます。
      </p></dd><dt id="libpq-pqconnectdb"><span class="term"><code class="function">PQconnectdb</code><a id="idp81696736" class="indexterm"></a></span></dt><dd><p><span class="original">
       Makes a new connection to the database server.
</span>新たにデータベースサーバへの接続を作成します。

</p><pre class="synopsis">PGconn *PQconnectdb(const char *conninfo);</pre><p>
      </p><p><span class="original">
       This function opens a new database connection using the parameters taken
       from the string &lt;literal&gt;conninfo&lt;/literal&gt;.
</span>この関数は<code class="literal">conninfo</code>文字列から取得されるパラメータを使用して、新しいデータベース接続を開きます。
      </p><p><span class="original">
       The passed string can be empty to use all default parameters, or it can
       contain one or more parameter settings separated by whitespace,
       or it can contain a &lt;acronym&gt;URI&lt;/acronym&gt;.
       See &lt;xref linkend="libpq-connstring"&gt; for details.
</span>空の文字列を渡してすべてデフォルトパラメータを使用することができます。
また空白文字で区切ることで1つ以上のパラメータ設定を持たせることもできます。
さらに<acronym class="acronym">URI</acronym>を含めることができます。
詳細については<a class="xref" href="libpq-connect.html#libpq-connstring" title="31.1.1. 接続文字列">「接続文字列」</a>を参照してください。
     </p></dd><dt id="libpq-pqsetdblogin"><span class="term"><code class="function">PQsetdbLogin</code><a id="idp81703616" class="indexterm"></a></span></dt><dd><p><span class="original">
       Makes a new connection to the database server.
</span>新たにデータベースサーバへの接続を作成します。
</p><pre class="synopsis">PGconn *PQsetdbLogin(const char *pghost,
                     const char *pgport,
                     const char *pgoptions,
                     const char *pgtty,
                     const char *dbName,
                     const char *login,
                     const char *pwd);</pre><p>
       </p><p><span class="original">
        This is the predecessor of &lt;function&gt;PQconnectdb&lt;/function&gt; with a fixed
        set of parameters.  It has the same functionality except that the
        missing parameters will always take on default values.  Write &lt;symbol&gt;NULL&lt;/symbol&gt; or an
        empty string for any one of the fixed parameters that is to be defaulted.
</span>これはパラメータ群を固定した<code class="function">PQconnectdb</code>の前身です。
設定できないパラメータが常にデフォルト値になる点を除き、同一の機能を持ちます。
固定のパラメータに対して<code class="symbol">NULL</code>もしくは空文字列とすると、それはデフォルトを使用することになります。
      </p><p><span class="original">
        If the &lt;parameter&gt;dbName&lt;/parameter&gt; contains
        an &lt;symbol&gt;=&lt;/symbol&gt; sign or has a valid connection &lt;acronym&gt;URI&lt;/acronym&gt; prefix, it
        is taken as a &lt;parameter&gt;conninfo&lt;/parameter&gt; string in exactly the same way as
        if it had been passed to &lt;function&gt;PQconnectdb&lt;/function&gt;, and the remaining
        parameters are then applied as specified for &lt;function&gt;PQconnectdbParams&lt;/&gt;.
</span><em class="parameter"><code>dbName</code></em>内に<code class="symbol">=</code>記号が含まれる場合、または有効な接続<acronym class="acronym">URI</acronym>接頭辞を持つ場合、<code class="function">PQconnectdb</code>に渡された場合とまったく同じ扱いで<em class="parameter"><code>conninfo</code></em>文字列として扱われます。
その後残りのパラメータが<code class="function">PQconnectdbParams</code>の指定のように適用されます。
      </p></dd><dt id="libpq-pqsetdb"><span class="term"><code class="function">PQsetdb</code><a id="idp81713952" class="indexterm"></a></span></dt><dd><p><span class="original">
   Makes a new connection to the database server.
</span>新たにデータベースサーバへの接続を作成します。
</p><pre class="synopsis">PGconn *PQsetdb(char *pghost,
                char *pgport,
                char *pgoptions,
                char *pgtty,
                char *dbName);</pre><p>
     </p><p><span class="original">
      This is a macro that calls &lt;function&gt;PQsetdbLogin&lt;/function&gt; with null pointers
      for the &lt;parameter&gt;login&lt;/&gt; and &lt;parameter&gt;pwd&lt;/&gt; parameters.  It is provided
      for backward compatibility with very old programs.
</span>これは、<em class="parameter"><code>login</code></em>と<em class="parameter"><code>pwd</code></em>にNULLポインタを設定する<code class="function">PQsetdbLogin</code>を呼び出すマクロです。
非常に古いプログラムへの後方互換性のために提供されています。
     </p></dd><dt id="libpq-pqconnectstartparams"><span class="term"><code class="function">PQconnectStartParams</code><a id="idp81720480" class="indexterm"></a><br /></span><span class="term"><code class="function">PQconnectStart</code><a id="idp81721856" class="indexterm"></a><br /></span><span class="term"><code class="function">PQconnectPoll</code><a id="idp81723232" class="indexterm"></a></span></dt><dd><p><span class="original">
       &lt;indexterm&gt;&lt;primary&gt;nonblocking connection&lt;/primary&gt;&lt;/indexterm&gt;
</span>       <a id="idp81724624" class="indexterm"></a><span class="original">
       Make a connection to the database server in a nonblocking manner.
</span>
ブロックしない方法で、データベースサーバへの接続を作成します。

</p><pre class="synopsis">PGconn *PQconnectStartParams(const char * const *keywords,
                             const char * const *values,
                             int expand_dbname);

PGconn *PQconnectStart(const char *conninfo);

PostgresPollingStatusType PQconnectPoll(PGconn *conn);</pre><p>
      </p><p><span class="original">
       These three functions are used to open a connection to a database server such
       that your application's thread of execution is not blocked on remote I/O
       whilst doing so. The point of this approach is that the waits for I/O to
       complete can occur in the application's main loop, rather than down inside
       &lt;function&gt;PQconnectdbParams&lt;/&gt; or &lt;function&gt;PQconnectdb&lt;/&gt;, and so the
       application can manage this operation in parallel with other activities.
</span>これら3つの関数は、リモートI/Oの実行時にアプリケーションスレッドの実行がブロックされないようなデータベースサーバへの接続を作成するために使われます。
この手法の利点は、I/Oの終了待ちが<code class="function">PQconnectdbParams</code>または<code class="function">PQconnectdb</code>内部ではなく、アプリケーションプログラムのメインループでできることにあります。
これによって、アプリケーションは他の処理と並行してこの処理を管理することができます。
      </p><p><span class="original">
       With &lt;function&gt;PQconnectStartParams&lt;/function&gt;, the database connection is made
       using the parameters taken from the &lt;literal&gt;keywords&lt;/literal&gt; and
       &lt;literal&gt;values&lt;/literal&gt; arrays, and controlled by &lt;literal&gt;expand_dbname&lt;/literal&gt;,
       as described above for &lt;function&gt;PQconnectdbParams&lt;/function&gt;.
</span><code class="function">PQconnectStartParams</code>では、上で<code class="function">PQconnectdbParams</code>で説明したように、データベース接続は<code class="literal">keywords</code>および<code class="literal">values</code>配列から取得され、<code class="literal">expand_dbname</code>によって制御されたパラメータを使用して確立します。
      </p><p><span class="original">
       With &lt;function&gt;PQconnectStart&lt;/function&gt;, the database connection is made
       using the parameters taken from the string &lt;literal&gt;conninfo&lt;/literal&gt; as
       described above for &lt;function&gt;PQconnectdb&lt;/function&gt;.
</span><code class="function">PQconnectStart</code>では、上で<code class="function">PQconnectdb</code>で説明したように、<code class="literal">conninfo</code>文字列から取得されたパラメータを使用してデータベース接続を確立します。
      </p><p><span class="original">
       Neither &lt;function&gt;PQconnectStartParams&lt;/function&gt; nor &lt;function&gt;PQconnectStart&lt;/function&gt;
       nor &lt;function&gt;PQconnectPoll&lt;/function&gt; will block, so long as a number of
       restrictions are met:
</span><code class="function">PQconnectStartParams</code>、<code class="function">PQconnectStart</code>と<code class="function">PQconnectPoll</code>のどちらも以下の制限に適合する場合ブロックしません。
       </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="original">
          The &lt;literal&gt;hostaddr&lt;/&gt; and &lt;literal&gt;host&lt;/&gt; parameters are used appropriately to ensure that
          name and reverse name queries are not made. See the documentation of
          these parameters in &lt;xref linkend="libpq-paramkeywords"&gt; for details.
</span><code class="literal">hostaddr</code>と<code class="literal">host</code>パラメータは、ホスト名からのIPアドレス検索やホスト名の逆引きが起こらないように適切に使用されなければいけません。
詳細に付いては<a class="xref" href="libpq-connect.html#libpq-paramkeywords" title="31.1.2. パラメータキーワード">「パラメータキーワード」</a>内のパラメータ説明を参照してください。
         </p></li><li class="listitem"><p><span class="original">
          If you call &lt;function&gt;PQtrace&lt;/function&gt;, ensure that the stream object
          into which you trace will not block.
</span><code class="function">PQtrace</code>を呼び出す場合は、トレースに使用するストリームオブジェクトがブロックされないことが保証されていなくてはなりません。
         </p></li><li class="listitem"><p><span class="original">
          You ensure that the socket is in the appropriate state
          before calling &lt;function&gt;PQconnectPoll&lt;/function&gt;, as described below.
</span>プログラマ自身が、後に示すように、<code class="function">PQconnectPoll</code>を呼び出す前にソケットが適切な状態にあることを保証しなくてはいけません。
         </p></li></ul></div><p>
      </p><p><span class="original">
       Note: use of &lt;function&gt;PQconnectStartParams&lt;/&gt; is analogous to
       &lt;function&gt;PQconnectStart&lt;/&gt; shown below.
</span>注意：<code class="function">PQconnectStartParams</code>の使用は後述の<code class="function">PQconnectStart</code>と類似しています。
      </p><p><span class="original">
       To begin a nonblocking connection request, call &lt;literal&gt;conn = PQconnectStart("&lt;replaceable&gt;connection_info_string&lt;/&gt;")&lt;/literal&gt;.
       If &lt;varname&gt;conn&lt;/varname&gt; is null, then &lt;application&gt;libpq&lt;/&gt; has been unable to allocate a new &lt;structname&gt;PGconn&lt;/&gt;
       structure. Otherwise, a valid &lt;structname&gt;PGconn&lt;/&gt; pointer is returned (though not yet
       representing a valid connection to the database). On return from
       &lt;function&gt;PQconnectStart&lt;/function&gt;, call &lt;literal&gt;status = PQstatus(conn)&lt;/literal&gt;. If &lt;varname&gt;status&lt;/varname&gt; equals
       &lt;symbol&gt;CONNECTION_BAD&lt;/symbol&gt;, &lt;function&gt;PQconnectStart&lt;/function&gt; has failed.
</span>非ブロック接続要求を始めるにはまず、<code class="literal">conn=PQconnectStart("<em class="replaceable"><code>connection_info_string</code></em>")</code>を呼び出します。
<code class="varname">conn</code>がNULLの場合、<span class="application">libpq</span>が新たに<code class="structname">PGconn</code>構造体を割り当てられなかったことを表します。
そうでない場合は、適切な<code class="structname">PGconn</code>へのポインタが返されます
（ただし、データベースに正しく接続されていることを表しているわけではありません）。
<code class="function">PQconnectStart</code>から値が返ってきた段階で、<code class="literal">status=PQstatus(conn)</code>を呼び出します。
もし、<code class="varname">status</code>が<code class="symbol">CONNECTION_BAD</code>と等しい場合には、<code class="function">PQconnectStart</code>が失敗しています。
      </p><p><span class="original">
       If &lt;function&gt;PQconnectStart&lt;/&gt; succeeds, the next stage is to poll
       &lt;application&gt;libpq&lt;/&gt; so that it can proceed with the connection sequence.
       Use &lt;function&gt;PQsocket(conn)&lt;/function&gt; to obtain the descriptor of the
       socket underlying the database connection.
       Loop thus: If &lt;function&gt;PQconnectPoll(conn)&lt;/function&gt; last returned
       &lt;symbol&gt;PGRES_POLLING_READING&lt;/symbol&gt;, wait until the socket is ready to
       read (as indicated by &lt;function&gt;select()&lt;/&gt;, &lt;function&gt;poll()&lt;/&gt;, or
       similar system function).
       Then call &lt;function&gt;PQconnectPoll(conn)&lt;/function&gt; again.
       Conversely, if &lt;function&gt;PQconnectPoll(conn)&lt;/function&gt; last returned
       &lt;symbol&gt;PGRES_POLLING_WRITING&lt;/symbol&gt;, wait until the socket is ready
       to write, then call &lt;function&gt;PQconnectPoll(conn)&lt;/function&gt; again.
       If you have yet to call
       &lt;function&gt;PQconnectPoll&lt;/function&gt;, i.e., just after the call to
       &lt;function&gt;PQconnectStart&lt;/function&gt;, behave as if it last returned
       &lt;symbol&gt;PGRES_POLLING_WRITING&lt;/symbol&gt;.  Continue this loop until
       &lt;function&gt;PQconnectPoll(conn)&lt;/function&gt; returns
       &lt;symbol&gt;PGRES_POLLING_FAILED&lt;/symbol&gt;, indicating the connection procedure
       has failed, or &lt;symbol&gt;PGRES_POLLING_OK&lt;/symbol&gt;, indicating the connection
       has been successfully made.
</span><code class="function">PQconnectStart</code>が成功したら、次は接続シーケンスを進めるために、<span class="application">libpq</span>をポーリングします。
データベース接続の背後にあるソケットの記述子を取り出すには、<code class="function">PQsocket(conn)</code>を使用します。
以下の繰り返しです。
直前の<code class="function">PQconnectPoll(conn)</code>が<code class="symbol">PGRES_POLLING_READING</code>の場合、ソケットの読み込み準備が整うまで待機します。
（<code class="function">select()</code>や<code class="function">poll()</code>などのシステム関数で示されます。）
そして、再度<code class="function">PQconnectPoll(conn)</code>を呼び出します。
反対に直前の<code class="function">PQconnectPoll(conn)</code>が<code class="symbol">PGRES_POLLING_WRITING</code>の場合、ソケットの書き込み準備が整うまで待機し、その後、<code class="function">PQconnectPoll(conn)</code>を再度呼び出します。
まだ<code class="function">PQconnectPoll</code>を呼び出していない場合、つまり、<code class="function">PQconnectStart</code>の呼び出し直後では、直前が<code class="symbol">PGRES_POLLING_WRITING</code>であった場合と同様の処理を行ないます。
この繰り返しを<code class="function">PQconnectPoll(conn)</code>が、接続手続きの失敗を示す<code class="symbol">PGRES_POLLING_FAILED</code>、もしくは、接続確立に成功したことを示す<code class="symbol">PGRES_POLLING_OK</code>を返すまで継続します。
      </p><p><span class="original">
       At any time during connection, the status of the connection can be
       checked by calling &lt;function&gt;PQstatus&lt;/&gt;. If this call returns &lt;symbol&gt;CONNECTION_BAD&lt;/&gt;, then the
       connection procedure has failed; if the call returns &lt;function&gt;CONNECTION_OK&lt;/&gt;, then the
       connection is ready.  Both of these states are equally detectable
       from the return value of &lt;function&gt;PQconnectPoll&lt;/&gt;, described above. Other states might also occur
       during (and only during) an asynchronous connection procedure. These
       indicate the current stage of the connection procedure and might be useful
       to provide feedback to the user for example. These statuses are:
</span>接続している間は、いつでも<code class="function">PQstatus</code>を呼び出すことで、接続の状態を検査することができます。
この関数呼び出しが<code class="symbol">CONNECTION_BAD</code>を返す場合、接続手続きは失敗しており、<code class="symbol">CONNECTION_OK</code>を返す場合、接続が確立しています。
上述のように、このいずれの状態も、<code class="function">PQconnectPoll</code>の戻り値から同様に検出できます。
これ以外の状態は、非同期の接続手続きの間（のみに）現れることがあります。 
これらは、接続手続きの現在の段階を示すものであり、例えばユーザへのフィードバックを提供することに使用できます。 
以下の状態があります。

       </p><div class="variablelist"><dl class="variablelist"><dt id="libpq-connection-started"><span class="term"><code class="symbol">CONNECTION_STARTED</code></span></dt><dd><p><span class="original">
           Waiting for connection to be made.
</span>接続の確立待ち状態です。
          </p></dd><dt id="libpq-connection-made"><span class="term"><code class="symbol">CONNECTION_MADE</code></span></dt><dd><p><span class="original">
           Connection OK; waiting to send.
</span>接続はOKです。送信待ち状態です。
          </p></dd><dt id="libpq-connection-awaiting-response"><span class="term"><code class="symbol">CONNECTION_AWAITING_RESPONSE</code></span></dt><dd><p><span class="original">
           Waiting for a response from the server.
</span>サーバからの応答待ち状態です。
          </p></dd><dt id="libpq-connection-auth-ok"><span class="term"><code class="symbol">CONNECTION_AUTH_OK</code></span></dt><dd><p><span class="original">
           Received authentication; waiting for backend start-up to finish.
</span>        認証済みです。バックエンドの起動待ち状態です。
          </p></dd><dt id="libpq-connection-ssl-startup"><span class="term"><code class="symbol">CONNECTION_SSL_STARTUP</code></span></dt><dd><p><span class="original">
           Negotiating SSL encryption.
</span>SSL暗号化の調停状態です。
          </p></dd><dt id="libpq-connection-setenv"><span class="term"><code class="symbol">CONNECTION_SETENV</code></span></dt><dd><p><span class="original">
           Negotiating environment-driven parameter settings.
</span>環境が提供するパラメータ設定の調停状態です。
          </p></dd></dl></div><p>
<span class="original">
       Note that, although these constants will remain (in order to maintain
       compatibility), an application should never rely upon these occurring in a
       particular order, or at all, or on the status always being one of these
       documented values. An application might do something like this:
</span>
これらの定数は（互換性を保つため）なくなることはありませんが、アプリケーションは、これらが特定の順で出現したり、本書に書いてある値のどれかに必ずステータス値が該当するということを決して当てにしてはいけません。 
アプリケーションは、以下に示すようにするべきです。

</p><pre class="programlisting">switch(PQstatus(conn))
{
        case CONNECTION_STARTED:
            feedback = "Connecting...";
            break;

        case CONNECTION_MADE:
            feedback = "Connected to server...";
            break;
.
.
.
        default:
            feedback = "Connecting...";
}</pre><p>
      </p><p><span class="original">
       The &lt;literal&gt;connect_timeout&lt;/literal&gt; connection parameter is ignored
       when using &lt;function&gt;PQconnectPoll&lt;/function&gt;; it is the application's
       responsibility to decide whether an excessive amount of time has elapsed.
       Otherwise, &lt;function&gt;PQconnectStart&lt;/function&gt; followed by a
       &lt;function&gt;PQconnectPoll&lt;/function&gt; loop is equivalent to
       &lt;function&gt;PQconnectdb&lt;/function&gt;.
</span><code class="function">PQconnectPoll</code>を使用する場合、<code class="literal">connect_timeout</code>接続パラメータは無視されます。
経過時間が長過ぎるかどうかの判定はアプリケーションの責任で行ないます。
さもないと、<code class="function">PQconnectStart</code>の後の<code class="function">PQconnectPoll</code>の繰り返しが<code class="function">PQconnectdb</code>と同じになります。
      </p><p><span class="original">
       Note that if &lt;function&gt;PQconnectStart&lt;/function&gt; returns a non-null pointer, you must call
       &lt;function&gt;PQfinish&lt;/function&gt; when you are finished with it, in order to dispose of
       the structure and any associated memory blocks. This must be done even if
       the connection attempt fails or is abandoned.
</span><code class="function">PQconnectStart</code>が非NULLポインタを返した場合、処理を終了する際には、構造体や関連するメモリブロックを始末するために、<code class="function">PQfinish</code>を呼び出さなくてはならないことに注意してください。
この処理は、接続試行が失敗した場合やその試行を中断する場合にも、必ず実行されなければいけません。
      </p></dd><dt id="libpq-pqconndefaults"><span class="term"><code class="function">PQconndefaults</code><a id="idp81793520" class="indexterm"></a></span></dt><dd><p><span class="original">
       Returns the default connection options.
</span>デフォルトの接続オプションを返します。
</p><pre class="synopsis">PQconninfoOption *PQconndefaults(void);

typedef struct
{<span class="original">
    char   *keyword;   /* The keyword of the option */
    char   *envvar;    /* Fallback environment variable name */
    char   *compiled;  /* Fallback compiled in default value */
    char   *val;       /* Option's current value, or NULL */
    char   *label;     /* Label for field in connect dialog */
    char   *dispchar;  /* Indicates how to display this field
                          in a connect dialog. Values are:
                          ""        Display entered value as is
                          "*"       Password field - hide value
                          "D"       Debug option - don't show by default */
    int     dispsize;  /* Field size in characters for dialog */
</span>
    char   *keyword;   /* このオプションのキーワード */
    char   *envvar;    /* 代替となる環境変数の名前 */
    char   *compiled;  /* 代替となるコンパイル時に組み込まれたデフォルト値 */
    char   *val;       /* オプションの現在値、もしくは、NULL */
    char   *label;     /* 接続ダイアログ内の当該フィールドのラベル */
    char   *dispchar;  /* 接続ダイアログ内の当該フィールドをどのように表示するかの指示
                          値:
                          ""        入力された値をそのまま表示
                          "*"       値を隠すパスワードフィールド用
                          "D"       デバッグオプション。デフォルトで何も表示しません */
    int     dispsize;  /* ダイアログ用のフィールドの大きさ(文字数単位) */
} PQconninfoOption;</pre><p>
      </p><p><span class="original">
       Returns a connection options array.  This can be used to determine
       all possible &lt;function&gt;PQconnectdb&lt;/function&gt; options and their
       current default values.  The return value points to an array of
       &lt;structname&gt;PQconninfoOption&lt;/structname&gt; structures, which ends
       with an entry having a null &lt;structfield&gt;keyword&lt;/&gt; pointer.  The
       null pointer is returned if memory could not be allocated. Note that
       the current default values (&lt;structfield&gt;val&lt;/structfield&gt; fields)
       will depend on environment variables and other context.  A
       missing or invalid service file will be silently ignored.  Callers
       must treat the connection options data as read-only.
</span>接続オプションの配列を返します。
これは、使用可能な<code class="function">PQconnectdb</code>用オプションのすべてや、その時点でのデフォルト値を決定するために使用することができます。
戻り値は、<code class="structname">PQconninfoOption</code>構造体の配列へのポインタで、<code class="structfield">keyword</code>ポインタがヌルとなる項目が配列の末尾にきます。
メモリが確保できなかった場合にはヌルポインタを返します。
現在のデフォルト値(<code class="structfield">val</code> フィールド）は、環境変数や他のコンテキストに依存します。
呼び出し側では、接続オプションの情報は、読み込み専用として取り扱わなければいけません。
      </p><p><span class="original">
       After processing the options array, free it by passing it to
       &lt;function&gt;PQconninfoFree&lt;/function&gt;.  If this is not done, a small amount of memory
       is leaked for each call to &lt;function&gt;PQconndefaults&lt;/function&gt;.
</span>オプションの配列を処理した後は、それを<code class="function">PQconninfoFree</code>に渡して解放します。
この処理をしないと、<code class="function">PQconndefaults</code>が呼び出されるたびに少しずつメモリリークが発生します。
      </p></dd><dt id="libpq-pqconninfo"><span class="term"><code class="function">PQconninfo</code><a id="idp81805952" class="indexterm"></a></span></dt><dd><p><span class="original">
       Returns the connection options used by a live connection.
</span>所在する接続で使用される接続オプションを返します。
</p><pre class="synopsis">PQconninfoOption *PQconninfo(PGconn *conn);</pre><p>
      </p><p><span class="original">
       Returns a connection options array.  This can be used to determine
       all possible &lt;function&gt;PQconnectdb&lt;/function&gt; options and the
       values that were used to connect to the server. The return
       value points to an array of &lt;structname&gt;PQconninfoOption&lt;/structname&gt;
       structures, which ends with an entry having a null &lt;structfield&gt;keyword&lt;/&gt;
       pointer. All notes above for &lt;function&gt;PQconndefaults&lt;/function&gt; also
       apply to the result of &lt;function&gt;PQconninfo&lt;/function&gt;.
</span>接続オプション配列を返します。これは全ての可能性のある<code class="function">PQconnectdb</code>オプションとサーバに接続するのに使用される値を確定するために使用することができます。
返り値は<code class="structname">PQconninfoOption</code>構造体の配列を指し示します。それはnull <code class="structfield">keyword</code> ポインタを持つ項目で終結します。<code class="function">PQconndefaults</code>に対する上記の全ての注釈はまた<code class="function">PQconninfo</code>の結果に適用されます。
      </p></dd><dt id="libpq-pqconninfoparse"><span class="term"><code class="function">PQconninfoParse</code><a id="idp81813680" class="indexterm"></a></span></dt><dd><p><span class="original">
       Returns parsed connection options from the provided connection string.
</span>提供された接続文字列から構文解析された接続オプションを返します。

</p><pre class="synopsis">PQconninfoOption *PQconninfoParse(const char *conninfo, char **errmsg);</pre><p>
      </p><p><span class="original">
       Parses a connection string and returns the resulting options as an
       array; or returns &lt;symbol&gt;NULL&lt;/&gt; if there is a problem with the connection
       string.  This function can be used to extract
       the &lt;function&gt;PQconnectdb&lt;/function&gt; options in the provided
       connection string.  The return value points to an array of
       &lt;structname&gt;PQconninfoOption&lt;/structname&gt; structures, which ends
       with an entry having a null &lt;structfield&gt;keyword&lt;/&gt; pointer.
</span>接続文字列の構文解析を行い、配列として結果オプションを返すか、または接続文字列に問題があった場合に<code class="symbol">NULL</code>を返します。
この関数を提供された接続文字列の中の<code class="function">PQconnectdb</code>オプションを取り出すために使用することができます。
戻り値は<code class="structname">PQconninfoOption</code>構造体の配列を指し示し、それはヌルの<code class="structfield">keyword</code>ポインタを持つ項目で終結します。
      </p><p><span class="original">
       All legal options will be present in the result array, but the
       &lt;literal&gt;PQconninfoOption&lt;/literal&gt; for any option not present
       in the connection string will have &lt;literal&gt;val&lt;/literal&gt; set to
       &lt;literal&gt;NULL&lt;/literal&gt;; default values are not inserted.
</span>正規なオプションはすべて、結果配列内に現れます。
しかし接続文字列内に現れない、何らかのオプション用の<code class="literal">PQconninfoOption</code>は<code class="literal">NULL</code>に設定された<code class="literal">val</code>を持ちます。
デフォルトは挿入されません。
      </p><p><span class="original">
       If &lt;literal&gt;errmsg&lt;/&gt; is not &lt;symbol&gt;NULL&lt;/&gt;, then &lt;literal&gt;*errmsg&lt;/&gt; is set
       to &lt;symbol&gt;NULL&lt;/&gt; on success, else to a &lt;function&gt;malloc&lt;/&gt;'d error string explaining
       the problem.  (It is also possible for &lt;literal&gt;*errmsg&lt;/&gt; to be
       set to &lt;symbol&gt;NULL&lt;/&gt; and the function to return &lt;symbol&gt;NULL&lt;/&gt;;
       this indicates an out-of-memory condition.)
</span><code class="literal">errmsg</code>が非<code class="symbol">NULL</code>であれば、成功した場合<code class="literal">*errmsg</code>は<code class="symbol">NULL</code>に設定され、そうでなければ、問題を説明した<code class="function">malloc</code>されたエラー文字列になります。
（<code class="literal">*errmsg</code>が<code class="symbol">NULL</code>に設定され、かつ、この関数が<code class="symbol">NULL</code>を返すこともあり得ます。
これはメモリ不足状態を意味します。）
      </p><p><span class="original">
       After processing the options array, free it by passing it to
       &lt;function&gt;PQconninfoFree&lt;/function&gt;.  If this is not done, some memory
       is leaked for each call to &lt;function&gt;PQconninfoParse&lt;/function&gt;.
       Conversely, if an error occurs and &lt;literal&gt;errmsg&lt;/&gt; is not &lt;symbol&gt;NULL&lt;/&gt;,
       be sure to free the error string using &lt;function&gt;PQfreemem&lt;/&gt;.
</span>オプション配列を処理した後、それを<code class="function">PQconninfoFree</code>に渡して解放してください。
これが行われない場合、<code class="function">PQconninfoParse</code>へのそれぞれの呼び出しに対してメモリーリークが起こります。
反対に、エラーが起こり、そして<code class="literal">errmsg</code>が非<code class="symbol">NULL</code>であれば、<code class="function">PQfreemem</code>を使用してエラー文字列を必ず解放してください。
      </p></dd><dt id="libpq-pqfinish"><span class="term"><code class="function">PQfinish</code><a id="idp81833392" class="indexterm"></a></span></dt><dd><p><span class="original">
       Closes  the  connection to the server.  Also frees
       memory used by the &lt;structname&gt;PGconn&lt;/structname&gt; object.
</span>サーバとの接続を閉ざします。
また、<code class="structname">PGconn</code>オブジェクトが占めるメモリも解放します。
</p><pre class="synopsis">void PQfinish(PGconn *conn);</pre><p>
      </p><p><span class="original">
       Note that even if the server connection attempt fails (as
       indicated by &lt;function&gt;PQstatus&lt;/function&gt;), the application should call &lt;function&gt;PQfinish&lt;/function&gt;
       to free the memory used by the &lt;structname&gt;PGconn&lt;/structname&gt; object.
       The &lt;structname&gt;PGconn&lt;/&gt; pointer must not be used again after
       &lt;function&gt;PQfinish&lt;/function&gt; has been called.
</span>たとえサーバへの接続試行が失敗しても（<code class="function">PQstatus</code>で調べます）、アプリケーションは<code class="function">PQfinish</code>を呼び出し<code class="structname">PGconn</code>オブジェクトが占めるメモリを解放するべきです。
そして<code class="function">PQfinish</code>を呼び出したら、もう<code class="structname">PGconn</code>へのポインタを使ってはいけません。
      </p></dd><dt id="libpq-pqreset"><span class="term"><code class="function">PQreset</code><a id="idp81841328" class="indexterm"></a></span></dt><dd><p><span class="original">
       Resets the communication channel to the server.
</span>サーバへの通信チャンネルをリセットします。
</p><pre class="synopsis">void PQreset(PGconn *conn);</pre><p>
      </p><p><span class="original">
       This function will close the connection
       to the server and attempt to  reestablish  a  new
       connection to the same server, using all the same
       parameters previously used.  This might be useful for
       error recovery if a working connection is lost.
</span>この関数はサーバへの接続を閉じ、以前使用したパラメータをすべて使用して、同一のサーバへ新しく接続を確立します。
これは、作業中の接続が失われた場合のエラーの修復に役立つでしょう。
      </p></dd><dt id="libpq-pqresetstart"><span class="term"><code class="function">PQresetStart</code><a id="idp81845584" class="indexterm"></a><br /></span><span class="term"><code class="function">PQresetPoll</code><a id="idp81846960" class="indexterm"></a></span></dt><dd><p><span class="original">
       Reset the communication channel to the server, in a nonblocking manner.
</span>非ブロッキング方式で、サーバへの接続チャンネルをリセットします。

</p><pre class="synopsis">int PQresetStart(PGconn *conn);

PostgresPollingStatusType PQresetPoll(PGconn *conn);</pre><p>
      </p><p><span class="original">
       These functions will close the connection to the server and attempt to
       reestablish a new connection to the same server, using all the same
       parameters previously used. This can be useful for error recovery if a
       working connection is lost. They differ from &lt;function&gt;PQreset&lt;/function&gt; (above) in that they
       act in a nonblocking manner. These functions suffer from the same
       restrictions as &lt;function&gt;PQconnectStartParams&lt;/&gt;, &lt;function&gt;PQconnectStart&lt;/&gt;
       and &lt;function&gt;PQconnectPoll&lt;/&gt;.
</span>これらの関数はサーバへの接続を閉じ、それから再度、以前使用したパラメータをすべて使用して、同じサーバと新たな接続を確立しようとします。
これらは作業中の接続が失われた場合のエラー修復に役立つでしょう。
<code class="function">PQreset</code>（前述）との違いは、この2つの関数が非ブロック方式で動作することです。
また、これらの関数は<code class="function">PQconnectStartParams</code>、<code class="function">PQconnectStart</code>および<code class="function">PQconnectPoll</code>と同じ制限を受けます。
      </p><p><span class="original">
       To initiate a connection reset, call
       &lt;function&gt;PQresetStart&lt;/function&gt;. If it returns 0, the reset has
       failed. If it returns 1, poll the reset using
       &lt;function&gt;PQresetPoll&lt;/function&gt; in exactly the same way as you
       would create the connection using &lt;function&gt;PQconnectPoll&lt;/function&gt;.
</span>接続のリセットを始めるためには<code class="function">PQresetStart</code>を呼び出します。
この関数がゼロを返す場合、リセットに失敗しています。
戻り値が1ならば、<code class="function">PQconnectPoll</code>を使って接続を確立した時とまったく同じに、<code class="function">PQresetPoll</code>を使用してリセットのポーリングを行います。
      </p></dd><dt id="libpq-pqpingparams"><span class="term"><code class="function">PQpingParams</code><a id="idp81857808" class="indexterm"></a></span></dt><dd><p><span class="original">
       &lt;function&gt;PQpingParams&lt;/function&gt; reports the status of the
       server.  It accepts connection parameters identical to those of
       &lt;function&gt;PQconnectdbParams&lt;/&gt;, described above.  It is not
       necessary to supply correct user name, password, or database name
       values to obtain the server status; however, if incorrect values
       are provided, the server will log a failed connection attempt.
</span><code class="function">PQpingParams</code>はサーバの状態を報告します。
この関数は上述の<code class="function">PQconnectdbParams</code>と同じ接続パラメータを受け付けます。
サーバの状態を得るために正しいユーザ名、パスワード、データベース名を提供する必要はありません。
しかし、不適切な値が供給されると、サーバは不成功に終わった接続の試みをログに残します。

</p><pre class="synopsis">PGPing PQpingParams(const char * const *keywords,
                    const char * const *values,
                    int expand_dbname);</pre><p>
<span class="original">
       The function returns one of the following values:
</span>
このサーバは以下の値のいずれかを返します。

       </p><div class="variablelist"><dl class="variablelist"><dt id="libpq-pqpingparams-pqping-ok"><span class="term"><code class="literal">PQPING_OK</code></span></dt><dd><p><span class="original">
           The server is running and appears to be accepting connections.
</span>サーバは稼動中で、接続を受け付けているようです。
          </p></dd><dt id="libpq-pqpingparams-pqping-reject"><span class="term"><code class="literal">PQPING_REJECT</code></span></dt><dd><p><span class="original">
           The server is running but is in a state that disallows connections
           (startup, shutdown, or crash recovery).
</span>サーバは稼動中ですが、接続を許可しない状態（起動処理中、停止処理中、クラッシュリカバリ中）です。
          </p></dd><dt id="libpq-pqpingparams-pqping-no-response"><span class="term"><code class="literal">PQPING_NO_RESPONSE</code></span></dt><dd><p><span class="original">
           The server could not be contacted.  This might indicate that the
           server is not running, or that there is something wrong with the
           given connection parameters (for example, wrong port number), or
           that there is a network connectivity problem (for example, a
           firewall blocking the connection request).
</span>サーバと通信できません。
これは、サーバが稼動中ではない、指定した接続パラメータの何か（例えばポート番号の間違い）が間違っている、ネットワーク接続性の問題（例えば接続要求をブロックするファイアウォール）があることを示しているかもしれません。
          </p></dd><dt id="libpq-pqpingparams-pqping-no-attempt"><span class="term"><code class="literal">PQPING_NO_ATTEMPT</code></span></dt><dd><p><span class="original">
           No attempt was made to contact the server, because the supplied
           parameters were obviously incorrect or there was some client-side
           problem (for example, out of memory).
</span>指定されたパラメータが明らかに間違っている、または、（メモリ不足など）クライアント側の問題があったため、サーバとの通信を試行しませんでした。
          </p></dd></dl></div><p>

      </p></dd><dt id="libpq-pqping"><span class="term"><code class="function">PQping</code><a id="idp81873632" class="indexterm"></a></span></dt><dd><p><span class="original">
       &lt;function&gt;PQping&lt;/function&gt; reports the status of the
       server.  It accepts connection parameters identical to those of
       &lt;function&gt;PQconnectdb&lt;/&gt;, described above.  It is not
       necessary to supply correct user name, password, or database name
       values to obtain the server status; however, if incorrect values
       are provided, the server will log a failed connection attempt.
</span><code class="function">PQping</code>はサーバの状態を報告します。
この関数は上述の<code class="function">PQconnectdb</code>と同じ接続パラメータを受け付けます。
サーバの状態を得るために正しいユーザ名、パスワード、データベース名を提供する必要はありません。
しかし、不適切な値が供給されると、サーバは不成功に終わった接続の試みをログに残します。
サーバの状態を入手するためには現在のユーザ名、パスワード、またはデータベース名などの値を供給する必要はありませんが、不適切な値が供給されると、サーバは不成功に終わった接続の試みをログに残します。

</p><pre class="synopsis">PGPing PQping(const char *conninfo);</pre><p>
      </p><p><span class="original">
       The return values are the same as for &lt;function&gt;PQpingParams&lt;/&gt;.
</span>戻り値は<code class="function">PQpingParams</code>と同じです。
      </p></dd></dl></div><p>
  </p><div class="sect2" id="libpq-connstring"><div class="titlepage"><div><div><h3 class="title">31.1.1. 接続文字列</h3></div></div></div><span class="original">
   &lt;title&gt;Connection Strings&lt;/title&gt;
</span><a id="idp81880976" class="indexterm"></a><a id="idp81882400" class="indexterm"></a><p><span class="original">
    Several &lt;application&gt;libpq&lt;/&gt; functions parse a user-specified string to obtain
    connection parameters.  There are two accepted formats for these strings:
    plain &lt;literal&gt;keyword = value&lt;/literal&gt; strings
    and &lt;ulink url="http://www.ietf.org/rfc/rfc3986.txt"&gt;RFC
    3986&lt;/ulink&gt; URIs.
</span>複数の<span class="application">libpq</span>関数は、接続パラメータを得るためにユーザが指定した文字列の解析を行います。
この文字列として、普通の<code class="literal">keyword = value</code>文字列と<a class="ulink" href="http://www.ietf.org/rfc/rfc3986.txt" target="_top">RFC 3986</a>のURIという２種類の書式が受け付けられます。
   </p><div class="sect3" id="idp81886944"><div class="titlepage"><div><div><h4 class="title">31.1.1.1. キーワード/値形式の接続文字列</h4></div></div></div><span class="original">
    &lt;title&gt;Keyword/Value Connection Strings&lt;/title&gt;
</span><p><span class="original">
    In the first format, each parameter setting is in the form
    &lt;literal&gt;keyword = value&lt;/literal&gt;.  Spaces around the equal sign are
    optional. To write an empty value, or a value containing spaces, surround it
    with single quotes, e.g., &lt;literal&gt;keyword = 'a value'&lt;/literal&gt;. Single
    quotes and backslashes within
    the value must be escaped with a backslash, i.e., &lt;literal&gt;\'&lt;/literal&gt; and
    &lt;literal&gt;\\&lt;/literal&gt;.
</span>最初の書式では、各パラメータ設定は<code class="literal">keyword = value</code>という形式です。
等号記号の前後の空白文字は省略可能です。
空の値を書く、または空白文字を含む値を書くためには、<code class="literal">keyword = 'a value'</code>のように単一引用符で値を括ります。
値内部の単一引用符とバックスラッシュはバックスラッシュでエスケープしなければなりません。
つまり<code class="literal">\'</code>と<code class="literal">\\</code>です。
   </p><p><span class="original">
    Example:
</span>以下に例を示します。
</p><pre class="programlisting">host=localhost port=5432 dbname=mydb connect_timeout=10</pre><p>
   </p><p><span class="original">
    The recognized parameter key words are listed in &lt;xref
    linkend="libpq-paramkeywords"&gt;.
</span>有効なパラメータキーワードを<a class="xref" href="libpq-connect.html#libpq-paramkeywords" title="31.1.2. パラメータキーワード">「パラメータキーワード」</a>に示します。
   </p></div><div class="sect3" id="idp81894048"><div class="titlepage"><div><div><h4 class="title">31.1.1.2. 接続URI</h4></div></div></div><span class="original">
    &lt;title&gt;Connection URIs&lt;/title&gt;
</span><p><span class="original">
   The general form for a connection &lt;acronym&gt;URI&lt;/acronym&gt; is:
</span>接続<acronym class="acronym">URI</acronym>の一般的な形式を以下に示します。
</p><pre class="synopsis">postgresql://[user[:password]@][netloc][:port][/dbname][?param1=value1&amp;...]</pre><p>
   </p><p><span class="original">
    The &lt;acronym&gt;URI&lt;/acronym&gt; scheme designator can be either
    &lt;literal&gt;postgresql://&lt;/literal&gt; or &lt;literal&gt;postgres://&lt;/literal&gt;.  Each
    of the &lt;acronym&gt;URI&lt;/acronym&gt; parts is optional.  The following examples
    illustrate valid &lt;acronym&gt;URI&lt;/acronym&gt; syntax uses:
</span><acronym class="acronym">URI</acronym>スキーマ指示子は<code class="literal">postgresql://</code>または<code class="literal">postgres://</code>のいずれかを取ることができます。
個々の<acronym class="acronym">URI</acronym>部品は省略可能です。
以下の例で有効な<acronym class="acronym">URI</acronym>構文の使用例を示します。
</p><pre class="programlisting">postgresql://
postgresql://localhost
postgresql://localhost:5433
postgresql://localhost/mydb
postgresql://user@localhost
postgresql://user:secret@localhost
postgresql://other@localhost/otherdb?connect_timeout=10&amp;application_name=myapp</pre><p><span class="original">
    Components of the hierarchical part of the &lt;acronym&gt;URI&lt;/acronym&gt; can also
    be given as parameters.  For example:
</span>
<acronym class="acronym">URI</acronym>の階層部品の要素をパラメータとして与えることができます。
以下に例を示します。
</p><pre class="programlisting">postgresql:///mydb?host=localhost&amp;port=5433</pre><p>
   </p><p><span class="original">
    Percent-encoding may be used to include symbols with special meaning in any
    of the &lt;acronym&gt;URI&lt;/acronym&gt; parts.
</span>パーセント符号化を使用して、<acronym class="acronym">URI</acronym>部品のいずれかに特殊な意味を持つ記号を含めることができます。
   </p><p><span class="original">
    Any connection parameters not corresponding to key words listed in &lt;xref
    linkend="libpq-paramkeywords"&gt; are ignored and a warning message about them
    is sent to &lt;filename&gt;stderr&lt;/filename&gt;.
</span><a class="xref" href="libpq-connect.html#libpq-paramkeywords" title="31.1.2. パラメータキーワード">「パラメータキーワード」</a>に示されたキーワードに対応しない接続パラメータは無視され、これに関する警告メッセージが<code class="filename">stderr</code>に書き出されます。
   </p><p><span class="original">
    For improved compatibility with JDBC connection &lt;acronym&gt;URI&lt;/acronym&gt;s,
    instances of parameter &lt;literal&gt;ssl=true&lt;/literal&gt; are translated into
    &lt;literal&gt;sslmode=require&lt;/literal&gt;.
</span>JDBCの接続<acronym class="acronym">URI</acronym>構文との互換性を高めるために、<code class="literal">ssl=true</code>パラメータインスタンスは<code class="literal">sslmode=require</code>に変換されます。
   </p><p><span class="original">
    The host part may be either host name or an IP address.  To specify an
    IPv6 host address, enclose it in square brackets:
</span>ホスト部分にはホスト名またはIPアドレスを書くことができます。
IPv6ホストアドレスを指定するためには角括弧で括ります。
</p><pre class="synopsis">postgresql://[2001:db8::1234]/database</pre><p>
   </p><p><span class="original">
    The host component is interpreted as described for the parameter &lt;xref
    linkend="libpq-connect-host"&gt;.  In particular, a Unix-domain socket
    connection is chosen if the host part is either empty or starts with a
    slash, otherwise a TCP/IP connection is initiated.  Note, however, that the
    slash is a reserved character in the hierarchical part of the URI.  So, to
    specify a non-standard Unix-domain socket directory, either omit the host
    specification in the URI and specify the host as a parameter, or
    percent-encode the path in the host component of the URI:
</span>ホスト要素は<a class="xref" href="libpq-connect.html#libpq-connect-host">host</a>で説明したように解釈されます。
具体的には、ホスト部品が空またはスラッシュで始まる場合Unixドメインソケット接続が選択され、さもなければTCP/IP接続で初期化されます。
しかしURIの階層部ではスラッシュが予約された文字であることに注意してください。
このため、標準以外のUnixドメインソケットディレクトリを指定するためには、URIからホスト指定を省き、パラメータとしてホストを指定するか、URIのホスト要素内のパスをパーセントエスケープするかどちらかを行ってください。
</p><pre class="programlisting">postgresql:///dbname?host=/var/lib/postgresql
postgresql://%2Fvar%2Flib%2Fpostgresql/dbname</pre><p>
   </p></div></div><div class="sect2" id="libpq-paramkeywords"><div class="titlepage"><div><div><h3 class="title">31.1.2. パラメータキーワード</h3></div></div></div><span class="original">
   &lt;title&gt;Parameter Key Words&lt;/title&gt;
</span><p><span class="original">
    The currently recognized parameter key words are:
</span>現時点で有効なパラメータのキーワードは以下に示す通りです。

    </p><div class="variablelist"><dl class="variablelist"><dt id="libpq-connect-host"><span class="term"><code class="literal">host</code></span></dt><dd><p><span class="original">
        Name of host to connect to.&lt;indexterm&gt;&lt;primary&gt;host name&lt;/&gt;&lt;/&gt;
        If this begins with a slash, it specifies Unix-domain
        communication rather than TCP/IP communication; the value is the
        name of the directory in which the socket file is stored.  The
        default behavior when &lt;literal&gt;host&lt;/literal&gt; is not specified
        is to connect to a Unix-domain
        socket&lt;indexterm&gt;&lt;primary&gt;Unix domain socket&lt;/&gt;&lt;/&gt; in
        &lt;filename&gt;/tmp&lt;/filename&gt; (or whatever socket directory was specified
        when &lt;productname&gt;PostgreSQL&lt;/&gt; was built). On machines without
        Unix-domain sockets, the default is to connect to &lt;literal&gt;localhost&lt;/&gt;.
</span>接続するホスト名を指定します。
<a id="idp81916992" class="indexterm"></a> この引数をスラッシュで始めた場合、TCP/IPによる通信ではなく、Unixドメインの通信を明示することになります。
その場合、この値はソケットファイルを格納するディレクトリの名前になります。
<code class="literal">host</code>が指定されなかった場合のデフォルトは、<code class="filename">/tmp</code>にあるUnixドメインのソケットに接続することです。
<a id="idp81920720" class="indexterm"></a> （または、<span class="productname">PostgreSQL</span>の構築時に指定した別のディレクトリにあるソケットです。）
Unixドメインソケットを持たないマシンにおけるデフォルトは、<code class="literal">localhost</code>に接続することです。
       </p></dd><dt id="libpq-connect-hostaddr"><span class="term"><code class="literal">hostaddr</code></span></dt><dd><p><span class="original">
        Numeric IP address of host to connect to.  This should be in the
        standard IPv4 address format, e.g., &lt;literal&gt;172.28.40.9&lt;/&gt;.  If
        your machine supports IPv6, you can also use those addresses.
        TCP/IP communication is
        always used when a nonempty string is specified for this parameter.
</span>接続するホストのIPアドレスを指定します。
これは、<code class="literal">172.28.40.9</code>といった標準的なIPv4アドレス書式でなければなりません。
使用するマシンでIPv6をサポートする場合は、そのアドレスを使用することもできます。
このパラメータに空以外の文字列が指定されると、TCP/IP通信が常に使用されます。
       </p><p><span class="original">
        Using &lt;literal&gt;hostaddr&lt;/&gt; instead of &lt;literal&gt;host&lt;/&gt; allows the
        application to avoid a host name look-up, which might be important
        in applications with time constraints. However, a host name is
        required for GSSAPI or SSPI authentication
        methods, as well as for &lt;literal&gt;verify-full&lt;/&gt; SSL
        certificate verification.  The following rules are used:
</span><code class="literal">host</code>の代わりに<code class="literal">hostaddr</code>を使用することで、アプリケーションがホスト名の検索を行なわずに済みます。
特に時間的制約があるアプリケーションでは重要になるでしょう。
しかし、GSSAP、SSPI認証方式では、ホスト名が必要になります。
<code class="literal">verify-full</code>SSL証明書検証を行う場合も同様です。
以下の規則が使用されます。
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="original">
           If &lt;literal&gt;host&lt;/&gt; is specified without &lt;literal&gt;hostaddr&lt;/&gt;,
           a host name lookup occurs.
</span><code class="literal">hostaddr</code>を使わずに<code class="literal">host</code>を指定した場合は、ホスト名の検索が発生します。
          </p></li><li class="listitem"><p><span class="original">
           If &lt;literal&gt;hostaddr&lt;/&gt; is specified without &lt;literal&gt;host&lt;/&gt;,
           the value for &lt;literal&gt;hostaddr&lt;/&gt; gives the server network address.
           The connection attempt will fail if the authentication
           method requires a host name.
</span><code class="literal">host</code>を使わずに<code class="literal">hostaddr</code>を指定した場合、<code class="literal">hostaddr</code>の値はサーバのネットワークアドレスとなります。
認証方式がホスト名を必要する場合は接続試行が失敗します。
          </p></li><li class="listitem"><p><span class="original">
           If both &lt;literal&gt;host&lt;/&gt; and &lt;literal&gt;hostaddr&lt;/&gt; are specified,
           the value for &lt;literal&gt;hostaddr&lt;/&gt; gives the server network address.
           The value for &lt;literal&gt;host&lt;/&gt; is ignored unless the
           authentication method requires it, in which case it will be
           used as the host name.
</span><code class="literal">host</code>と<code class="literal">hostaddr</code>の両方を指定した場合、<code class="literal">hostaddr</code>がサーバのネットワークアドレスとなります。
<code class="literal">host</code>の値は認証方式で必要とされない限り無視され、必要とされる場合にはホスト名として使用されます。
          </p></li></ul></div><p><span class="original">
        Note that authentication is likely to fail if &lt;literal&gt;host&lt;/&gt;
        is not the name of the server at network address &lt;literal&gt;hostaddr&lt;/&gt;.
        Also, note that &lt;literal&gt;host&lt;/&gt; rather than &lt;literal&gt;hostaddr&lt;/&gt;
        is used to identify the connection in &lt;filename&gt;~/.pgpass&lt;/&gt; (see
        &lt;xref linkend="libpq-pgpass"&gt;).
</span>
<code class="literal">host</code>が<code class="literal">hostaddr</code>ネットワークアドレスに対応するマシンの名前と一致しない場合は、認証に失敗する可能性があるので注意してください。
また、<code class="literal">hostaddr</code>ではなく<code class="literal">host</code>が<code class="filename">~/.pgpass</code>(<a class="xref" href="libpq-pgpass.html" title="31.15. パスワードファイル">「パスワードファイル」</a>を参照)での接続の識別に使用されます。
       </p><p><span class="original">
        Without either a host name or host address,
        &lt;application&gt;libpq&lt;/application&gt; will connect using a
        local Unix-domain socket; or on machines without Unix-domain
        sockets, it will attempt to connect to &lt;literal&gt;localhost&lt;/&gt;.
</span>ホスト名もホストのアドレスも用いない場合、<span class="application">libpq</span>はローカルのUnixドメインソケットを使用して接続します。
ただし、Unixドメインソケットを持たないマシンでは、<code class="literal">localhost</code>への接続を試みます。
       </p></dd><dt id="libpq-connect-port"><span class="term"><code class="literal">port</code></span></dt><dd><p><span class="original">
        Port number to connect to at the server host, or socket file
        name extension for Unix-domain
        connections.&lt;indexterm&gt;&lt;primary&gt;port&lt;/&gt;&lt;/&gt;
</span>サーバホストでの接続用のポート番号、または、Unixドメイン接続の場合は、ソケットファイルの拡張子を指定します。
<a id="idp81949104" class="indexterm"></a>
       </p></dd><dt id="libpq-connect-dbname"><span class="term"><code class="literal">dbname</code></span></dt><dd><p><span class="original">
       The database name.  Defaults to be the same as the user name.
       In certain contexts, the value is checked for extended
       formats; see &lt;xref linkend="libpq-connstring"&gt; for more details on
       those.
</span>データベース名を指定します。
デフォルトはユーザ名と同じです。
特定の文脈では、この値は拡張書式で検査されます。
詳細については<a class="xref" href="libpq-connect.html#libpq-connstring" title="31.1.1. 接続文字列">「接続文字列」</a>を参照してください。
      </p></dd><dt id="libpq-connect-user"><span class="term"><code class="literal">user</code></span></dt><dd><p><span class="original">
       &lt;productname&gt;PostgreSQL&lt;/productname&gt; user name to connect as.
       Defaults to be the same as the operating system name of the user
       running the application.
</span>データベースへ接続する<span class="productname">PostgreSQL</span>ユーザ名を指定します。
デフォルトは、そのアプリケーションを実行しているユーザのオペレーティングシステム上の名前と同じです。
      </p></dd><dt id="libpq-connect-password"><span class="term"><code class="literal">password</code></span></dt><dd><p><span class="original">
       Password to be used if the server demands password authentication.
</span>サーバがパスワードによる認証を必要とした場合に使用されるパスワードを指定します。
      </p></dd><dt id="libpq-connect-connect-timeout"><span class="term"><code class="literal">connect_timeout</code></span></dt><dd><p><span class="original">
       Maximum wait for connection, in seconds (write as a decimal integer
       string). Zero or not specified means wait indefinitely.  It is not
       recommended to use a timeout of less than 2 seconds.
</span>接続用の最大待機時間を秒単位(10進数整数で表した文字列として記述してください)で指定します。
ゼロもしくは未設定は、無限時間の待機を意味します。
2秒未満の待機時間を使用することは勧めません。
      </p></dd><dt id="libpq-connect-client-encoding"><span class="term"><code class="literal">client_encoding</code></span></dt><dd><p><span class="original">
       This sets the &lt;varname&gt;client_encoding&lt;/varname&gt;
       configuration parameter for this connection.  In addition to
       the values accepted by the corresponding server option, you
       can use &lt;literal&gt;auto&lt;/literal&gt; to determine the right
       encoding from the current locale in the client
       (&lt;envar&gt;LC_CTYPE&lt;/envar&gt; environment variable on Unix
       systems).
</span>接続用の<code class="varname">client_encoding</code>設定パラメータを設定します。
対応するサーバオプションで受け付けられる値の他に、クライアントにおける現在のロケール（Unixシステムの場合は<code class="envar">LC_CTYPE</code>環境変数）から正しい符号化方式を決定する<code class="literal">auto</code>を使用することができます。
      </p></dd><dt id="libpq-connect-options"><span class="term"><code class="literal">options</code></span></dt><dd><p><span class="original">
        Specifies command-line options to send to the server at connection
        start.  For example, setting this to &lt;literal&gt;-c geqo=off&lt;/&gt; sets the
        session's value of the &lt;varname&gt;geqo&lt;/&gt; parameter to
        &lt;literal&gt;off&lt;/&gt;.  Spaces within this string are considered to
        separate command-line arguments, unless escaped with a backslash
        (&lt;literal&gt;\&lt;/&gt;); write &lt;literal&gt;\\&lt;/&gt; to represent a literal
        backslash.  For a detailed discussion of the available
        options, consult &lt;xref linkend="runtime-config"&gt;.
</span>接続開始時にサーバに送信するコマンドラインオプションを指定します。
例えば、これを<code class="literal">-c geqo=off</code>に設定すると、<code class="varname">geqo</code>パラメータのセッション値は<code class="literal">off</code>になります。
この文字列中の空白はバックスラッシュ(<code class="literal">\</code>)でエスケープされていなければコマンド行引数の区切りであるとみなされます。
リテラルのバックスラッシュを表すには<code class="literal">\\</code>と書いて下さい。
利用可能なオプションに関する詳細については<a class="xref" href="runtime-config.html" title="第18章 サーバの設定">18章<em>サーバの設定</em></a>を参照してください。
       </p></dd><dt id="libpq-connect-application-name"><span class="term"><code class="literal">application_name</code></span></dt><dd><p><span class="original">
        Specifies a value for the &lt;xref linkend="guc-application-name"&gt;
        configuration parameter.
</span><a class="xref" href="runtime-config-logging.html#guc-application-name">application_name</a>設定パラメータの値を指定します。
       </p></dd><dt id="libpq-connect-fallback-application-name"><span class="term"><code class="literal">fallback_application_name</code></span></dt><dd><p><span class="original">
        Specifies a fallback value for the &lt;xref
        linkend="guc-application-name"&gt; configuration parameter.
        This value will be used if no value has been given for
        &lt;literal&gt;application_name&lt;/&gt; via a connection parameter or the
        &lt;envar&gt;PGAPPNAME&lt;/envar&gt; environment variable.  Specifying
        a fallback name is useful in generic utility programs that
        wish to set a default application name but allow it to be
        overridden by the user.
</span><a class="xref" href="runtime-config-logging.html#guc-application-name">application_name</a>設定パラメータの予備値を指定します。
接続パラメータまたは<code class="envar">PGAPPNAME</code>環境変数により<code class="literal">application_name</code>の値が指定されない場合に、この値が使用されます。
予備の名前を指定することは、デフォルトのアプリケーション名を設定したいが、ユーザにもそれを上書きできるようにしておきたい、一般的なユーティリティプログラムで有用です。
       </p></dd><dt id="libpq-keepalives"><span class="term"><code class="literal">keepalives</code></span></dt><dd><p><span class="original">
        Controls whether client-side TCP keepalives are used. The default
        value is 1, meaning on, but you can change this to 0, meaning off,
        if keepalives are not wanted.  This parameter is ignored for
        connections made via a Unix-domain socket.
</span>クライアント側におけるTCPキープアライブの使用を制御します。
デフォルト値は1であり、有効であることを意味します。
しかしキープアライブを望まない場合は、無効であることを意味するゼロに設定することができます。
このパラメータはUnixドメインソケット経由の接続では無視されます。
       </p></dd><dt id="libpq-keepalives-idle"><span class="term"><code class="literal">keepalives_idle</code></span></dt><dd><p><span class="original">
        Controls the number of seconds of inactivity after which TCP should
        send a keepalive message to the server.  A value of zero uses the
        system default. This parameter is ignored for connections made via a
        Unix-domain socket, or if keepalives are disabled. It is only supported
        on systems where the &lt;symbol&gt;TCP_KEEPIDLE&lt;/&gt; or &lt;symbol&gt;TCP_KEEPALIVE&lt;/&gt;
        socket option is available, and on Windows; on other systems, it has no
        effect.
</span>TCPがサーバにキープアライブメッセージを送信した後に活動を行わない期間を秒単位で制御します。
ゼロという値ではシステムのデフォルトを使用します。
Unixドメインソケット経由でなされた接続の場合もしくはキープアライブが無効な場合、このパラメータは無視されます。
これは<code class="symbol">TCP_KEEPIDLE</code>ソケットオプションまたは<code class="symbol">TCP_KEEPALIVE</code>ソケットオプションが利用できるシステムおよびWindowsでのみサポートされます。
他のシステムでは効果がありません。
       </p></dd><dt id="libpq-keepalives-interval"><span class="term"><code class="literal">keepalives_interval</code></span></dt><dd><p><span class="original">
        Controls the number of seconds after which a TCP keepalive message
        that is not acknowledged by the server should be retransmitted.  A
        value of zero uses the system default. This parameter is ignored for
        connections made via a Unix-domain socket, or if keepalives are disabled.
        It is only supported on systems where the &lt;symbol&gt;TCP_KEEPINTVL&lt;/&gt;
        socket option is available, and on Windows; on other systems, it has no
        effect.
</span>TCPキープアライブメッセージに対する応答がサーバからない場合に、何秒後に再送を行うかを制御します。
ゼロという値ではシステムのデフォルトを使用します。
Unixドメインソケット経由でなされた接続の場合、またはキープアライブを無効にしている場合、このパラメータは無視されます。
これは<code class="symbol">TCP_KEEPINTVL</code>ソケットオプションが利用できるシステムおよびWindowsでのみサポートされます。
他のシステムでは効果がありません。
       </p></dd><dt id="libpq-keepalives-count"><span class="term"><code class="literal">keepalives_count</code></span></dt><dd><p><span class="original">
        Controls the number of TCP keepalives that can be lost before the
        client's connection to the server is considered dead.  A value of
        zero uses the system default. This parameter is ignored for
        connections made via a Unix-domain socket, or if keepalives are disabled.
        It is only supported on systems where the &lt;symbol&gt;TCP_KEEPCNT&lt;/&gt;
        socket option is available; on other systems, it has no effect.
</span>サーバへのクライアント接続が不要になったとみなすまで、何回キープアライブの欠落を認めるかを制御します。
ゼロという値ではシステムのデフォルトを使用します。
Unixドメインソケット経由でなされた接続の場合、またはキープアライブを無効にしている場合、このパラメータは無視されます。
これは<code class="symbol">TCP_KEEPCNT</code>ソケットオプションが利用できるシステムでのみサポートされます。
他のシステムでは効果がありません。
       </p></dd><dt id="libpq-connect-tty"><span class="term"><code class="literal">tty</code></span></dt><dd><p><span class="original">
       Ignored (formerly, this specified where to send server debug output).
</span>無視されます(以前は、これはサーバデバッグ出力を送信する場所を指定するものでした)。
      </p></dd><dt id="libpq-connect-sslmode"><span class="term"><code class="literal">sslmode</code></span></dt><dd><p><span class="original">
        This option determines whether or with what priority a secure
        &lt;acronym&gt;SSL&lt;/&gt; TCP/IP connection will be negotiated with the
        server. There are six modes:
</span>このオプションは、どの<acronym class="acronym">SSL</acronym>による安全なTCP/IP接続の優先度でサーバと調停するかを決定します。
6つのモードがあります。

        </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">disable</code></span></dt><dd><p><span class="original">
            only try a non-&lt;acronym&gt;SSL&lt;/&gt; connection
</span>非<acronym class="acronym">SSL</acronym>接続のみ試行
           </p></dd><dt><span class="term"><code class="literal">allow</code></span></dt><dd><p><span class="original">
            first try a non-&lt;acronym&gt;SSL&lt;/&gt; connection; if that
            fails, try an &lt;acronym&gt;SSL&lt;/&gt; connection
</span>最初に非<acronym class="acronym">SSL</acronym>接続を試行し、失敗したら、<acronym class="acronym">SSL</acronym>接続を試行
           </p></dd><dt><span class="term"><code class="literal">prefer</code> （デフォルト）</span></dt><dd><p><span class="original">
            first try an &lt;acronym&gt;SSL&lt;/&gt; connection; if that fails,
            try a non-&lt;acronym&gt;SSL&lt;/&gt; connection
</span>最初に<acronym class="acronym">SSL</acronym>接続を試行し、失敗したら、非<acronym class="acronym">SSL</acronym>接続を試行
           </p></dd><dt><span class="term"><code class="literal">require</code></span></dt><dd><p><span class="original">
            only try an &lt;acronym&gt;SSL&lt;/&gt; connection. If a root CA
            file is present, verify the certificate in the same way as
            if &lt;literal&gt;verify-ca&lt;/literal&gt; was specified
</span><acronym class="acronym">SSL</acronym>接続のみ試行。
ルートCAファイルが存在する場合、<code class="literal">verify-ca</code>が指定された場合と同じ方法で証明書が検証されます。
           </p></dd><dt><span class="term"><code class="literal">verify-ca</code></span></dt><dd><p><span class="original">
            only try an &lt;acronym&gt;SSL&lt;/&gt; connection, and verify that
            the server certificate is issued by a trusted
            certificate authority (&lt;acronym&gt;CA&lt;/&gt;)
</span><acronym class="acronym">SSL</acronym>接続のみ試行し、サーバ証明書が信用された認証局（<acronym class="acronym">CA</acronym>）から発行されたかを検証
           </p></dd><dt><span class="term"><code class="literal">verify-full</code></span></dt><dd><p><span class="original">
            only try an &lt;acronym&gt;SSL&lt;/&gt; connection, verify that the
            server certificate is issued by a
            trusted &lt;acronym&gt;CA&lt;/&gt; and that the requested server host name
            matches that in the certificate
</span><acronym class="acronym">SSL</acronym>接続のみ試行し、サーバ証明書が信用された<acronym class="acronym">CA</acronym>から発行されたか、およびそのサーバホスト名が証明書内のものと一致するかを検証
           </p></dd></dl></div><p>
<span class="original">
        See &lt;xref linkend="libpq-ssl"&gt; for a detailed description of how
        these options work.
</span>
これらのオプションがどのように動くのかについては<a class="xref" href="libpq-ssl.html" title="31.18. SSLサポート">「SSLサポート」</a>を参照してください。
       </p><p><span class="original">
        &lt;literal&gt;sslmode&lt;/&gt; is ignored for Unix domain socket
        communication.
        If &lt;productname&gt;PostgreSQL&lt;/&gt; is compiled without SSL support,
        using options &lt;literal&gt;require&lt;/&gt;, &lt;literal&gt;verify-ca&lt;/&gt;, or
        &lt;literal&gt;verify-full&lt;/&gt; will cause an error, while
        options &lt;literal&gt;allow&lt;/&gt; and &lt;literal&gt;prefer&lt;/&gt; will be
        accepted but &lt;application&gt;libpq&lt;/&gt; will not actually attempt
        an &lt;acronym&gt;SSL&lt;/&gt;
        connection.&lt;indexterm&gt;&lt;primary&gt;SSL&lt;/&gt;&lt;secondary
        sortas="libpq"&gt;with libpq&lt;/&gt;&lt;/indexterm&gt;
</span><code class="literal">sslmode</code>はUnixドメインソケット通信では無視されます。
SSLサポートなしで<span class="productname">PostgreSQL</span>がコンパイルされた場合に、<code class="literal">require</code>、<code class="literal">verify-ca</code>、<code class="literal">verify-full</code>を使用するとエラーになります。
一方、<code class="literal">allow</code>と<code class="literal">prefer</code>は使用できますが、実際に<span class="application">libpq</span>は<acronym class="acronym">SSL</acronym>接続を受け付けません。
<a id="idp82023664" class="indexterm"></a>
       </p></dd><dt id="libpq-connect-requiressl"><span class="term"><code class="literal">requiressl</code></span></dt><dd><p><span class="original">
        This option is deprecated in favor of the &lt;literal&gt;sslmode&lt;/&gt;
        setting.
</span>このオプションは<code class="literal">sslmode</code>設定を支持する観点から廃止予定になっています。
       </p><p><span class="original">
        If set to 1, an &lt;acronym&gt;SSL&lt;/acronym&gt; connection to the server
        is required (this is equivalent to &lt;literal&gt;sslmode&lt;/&gt;
        &lt;literal&gt;require&lt;/&gt;).  &lt;application&gt;libpq&lt;/&gt; will then refuse
        to connect if the server does not accept an
        &lt;acronym&gt;SSL&lt;/acronym&gt; connection.  If set to 0 (default),
        &lt;application&gt;libpq&lt;/&gt; will negotiate the connection type with
        the server (equivalent to &lt;literal&gt;sslmode&lt;/&gt;
        &lt;literal&gt;prefer&lt;/&gt;).  This option is only available if
        &lt;productname&gt;PostgreSQL&lt;/&gt; is compiled with SSL support.
</span>1に設定することで、サーバへの<acronym class="acronym">SSL</acronym>接続が必要になります
(これは<code class="literal">sslmode</code>の<code class="literal">require</code>と同じです)。
サーバが<acronym class="acronym">SSL</acronym>接続を受け付けない場合、<span class="application">libpq</span>は接続を拒絶します。
0(デフォルト)に設定することで、サーバと接続形式の調停を行います。
(<code class="literal">sslmode</code>の<code class="literal">prefer</code>と同じです。)
SSLサポート付きで<span class="productname">PostgreSQL</span>をコンパイルした場合にのみ、このオプションが利用できます。
       </p></dd><dt id="libpq-connect-sslcompression"><span class="term"><code class="literal">sslcompression</code></span></dt><dd><p><span class="original">
        If set to 1 (default), data sent over SSL connections will be
        compressed (this requires &lt;productname&gt;OpenSSL&lt;/&gt; version
        0.9.8 or later).
        If set to 0, compression will be disabled (this requires
        &lt;productname&gt;OpenSSL&lt;/&gt; 1.0.0 or later).
        This parameter is ignored if a connection without SSL is made,
        or if the version of &lt;productname&gt;OpenSSL&lt;/&gt; used does not support
        it.
</span>１（デフォルト）に設定することで、SSL接続越えで送信されるデータは圧縮されます（これには<span class="productname">OpenSSL</span>バージョン0.9.8以降が必要です）。
０に設定すると、圧縮が無効になります（これには<span class="productname">OpenSSL</span>1.0.0以降が必要です）。
このパラメータはSSLが確立していない接続や使用される<span class="productname">OpenSSL</span>がサポートしていない場合は無視されます。
       </p><p><span class="original">
        Compression uses CPU time, but can improve throughput if
        the network is the bottleneck.
        Disabling compression can improve response time and throughput
        if CPU performance is the limiting factor.
</span>圧縮はCPU処理時間を使用しますが、ネットワークが問題である場合はスループットを改良することができます。
CPU性能が制約要因であれば、圧縮を無効にすることで、応答時間やスループットを改良することができます。
       </p></dd><dt id="libpq-connect-sslcert"><span class="term"><code class="literal">sslcert</code></span></dt><dd><p><span class="original">
        This parameter specifies the file name of the client SSL
        certificate, replacing the default
        &lt;filename&gt;~/.postgresql/postgresql.crt&lt;/&gt;.
        This parameter is ignored if an SSL connection is not made.
</span>このパラメータは、<code class="filename">~/.postgresql/postgresql.crt</code>というデフォルトを置き換えるクライアントSSL証明書のファイル名を指定します。
このパラメータはSSL接続が確立していない場合は無視されます。
       </p></dd><dt id="libpq-connect-sslkey"><span class="term"><code class="literal">sslkey</code></span></dt><dd><p><span class="original">
        This parameter specifies the location for the secret key used for
        the client certificate. It can either specify a file name that will
        be used instead of the default
        &lt;filename&gt;~/.postgresql/postgresql.key&lt;/&gt;, or it can specify a key
        obtained from an external &lt;quote&gt;engine&lt;/&gt; (engines are
        &lt;productname&gt;OpenSSL&lt;/&gt; loadable modules).  An external engine
        specification should consist of a colon-separated engine name and
        an engine-specific key identifier.  This parameter is ignored if an
        SSL connection is not made.
</span>このパラメータはクライアント証明書に対して使用される秘密鍵の場所を指定します。
デフォルトの<code class="filename">~/.postgresql/postgresql.key</code>の代わりに使用されるファイル名、または外部<span class="quote">「<span class="quote">エンジン</span>」</span>（エンジンとは<span class="productname">OpenSSL</span>ロード可能なモジュール）から得られるキーを指定することも可能です。
外部エンジンの指定にはコロンで区切ったエンジン名とエンジン特有の鍵識別子を含んでいなければなりません。
SSL接続が確立していない場合このパラメータは無視されます。
       </p></dd><dt id="libpq-connect-sslrootcert"><span class="term"><code class="literal">sslrootcert</code></span></dt><dd><p><span class="original">
        This parameter specifies the name of a file containing SSL
        certificate authority (&lt;acronym&gt;CA&lt;/&gt;) certificate(s).
        If the file exists, the server's certificate will be verified
        to be signed by one of these authorities.  The default is
        &lt;filename&gt;~/.postgresql/root.crt&lt;/&gt;.
</span>このパラメータはSSL認証局(<acronym class="acronym">CA</acronym>)の証明書のファイル名を指定します。
このファイルが存在する場合、サーバ証明書はこれらの認証局の1つで署名されているかどうか検証されます。
デフォルトは<code class="filename">~/.postgresql/root.crt</code>です。
       </p></dd><dt id="libpq-connect-sslcrl"><span class="term"><code class="literal">sslcrl</code></span></dt><dd><p><span class="original">
        This parameter specifies the file name of the SSL certificate
        revocation list (CRL).  Certificates listed in this file, if it
        exists, will be rejected while attempting to authenticate the
        server's certificate.  The default is
        &lt;filename&gt;~/.postgresql/root.crl&lt;/&gt;.
</span>このパラメータはSSL証明書失効リスト（CRL）のファイル名を指定します。
このファイルに列挙された証明書が存在した場合、それはサーバ証明書を承認しようとする時に拒絶されます。
デフォルトは<code class="filename">~/.postgresql/root.crl</code>です。
       </p></dd><dt id="libpq-connect-requirepeer"><span class="term"><code class="literal">requirepeer</code></span></dt><dd><p><span class="original">
        This parameter specifies the operating-system user name of the
        server, for example &lt;literal&gt;requirepeer=postgres&lt;/literal&gt;.
        When making a Unix-domain socket connection, if this
        parameter is set, the client checks at the beginning of the
        connection that the server process is running under the specified
        user name; if it is not, the connection is aborted with an error.
        This parameter can be used to provide server authentication similar
        to that available with SSL certificates on TCP/IP connections.
        (Note that if the Unix-domain socket is in
        &lt;filename&gt;/tmp&lt;/filename&gt; or another publicly writable location,
        any user could start a server listening there.  Use this parameter
        to ensure that you are connected to a server run by a trusted user.)
        This option is only supported on platforms for which the
        &lt;literal&gt;peer&lt;/&gt; authentication method is implemented; see
        &lt;xref linkend="auth-peer"&gt;.
</span>このパラメータは、例えば<code class="literal">requirepeer=postgres</code>のようにサーバのオペレーティングシステムのユーザ名を指定します。
Unixドメインソケット接続を確立する時に、このパラメータが設定された場合、クライアントは接続開始時にサーバプロセスが指定されたユーザ名で稼動しているか検査し、稼動していない場合は接続をエラーとして中断します。
このパラメータは、TCP/IP接続においてSSL証明書で実現するようなサーバ認証を実現するために使用することができます。
（Unixドメインソケットが<code class="filename">/tmp</code>などの誰にでも書き込むことができる場所にある場合、誰でもそこで接続を監視するサーバを起動できることに注意してください。
信頼できるユーザが起動したサーバに接続することを確実に行うために、このパラメータを使用してください。）
このオプションは<code class="literal">peer</code>認証方式が実装されたプラットフォームでのみでサポートされます。
<a class="xref" href="auth-methods.html#auth-peer" title="19.3.6. Peer認証">「Peer認証」</a>を参照してください。
       </p></dd><dt id="libpq-connect-krbsrvname"><span class="term"><code class="literal">krbsrvname</code></span></dt><dd><p><span class="original">
        Kerberos service name to use when authenticating with GSSAPI.
        This must match the service name specified in the server
        configuration for Kerberos authentication to succeed. (See also
        &lt;xref linkend="gssapi-auth"&gt;.)
</span>GSSAPIの認証時に使われるKerberosサービス名です。
成功するためには、これはサーバのKerberos認証設定のサービス名と一致していなければなりません。
(<a class="xref" href="auth-methods.html#gssapi-auth" title="19.3.3. GSSAPI認証">「GSSAPI認証」</a>も参照してください。)
       </p></dd><dt id="libpq-connect-gsslib"><span class="term"><code class="literal">gsslib</code></span></dt><dd><p><span class="original">
        GSS library to use for GSSAPI authentication. Only used on Windows.
        Set to &lt;literal&gt;gssapi&lt;/literal&gt; to force libpq to use the GSSAPI
        library for authentication instead of the default SSPI.
</span>GSSAPI認証で使用されるGSSライブラリです。
Windows上のみで使用されます。
libpqの認証がデフォルトのSSPIではなく、強制的にGSSAPIライブラリを使用させるには<code class="literal">gssapi</code>を設定してください。
       </p></dd><dt id="libpq-connect-service"><span class="term"><code class="literal">service</code></span></dt><dd><p><span class="original">
        Service name to use for additional parameters.  It specifies a service
        name in &lt;filename&gt;pg_service.conf&lt;/filename&gt; that holds additional connection parameters.
        This allows applications to specify only a service name so connection parameters
        can be centrally maintained. See &lt;xref linkend="libpq-pgservice"&gt;.
</span>追加のパラメータ用に使用されるサービス名です。
<code class="filename">pg_service.conf</code>内の追加的な接続パラメータを保持するサービス名を指定します。
これによりアプリケーションはサービス名だけを指定でき、接続パラメータを集中的に保守できるようになります。
<a class="xref" href="libpq-pgservice.html" title="31.16. 接続サービスファイル">「接続サービスファイル」</a>を参照してください。
       </p></dd></dl></div><p>
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="libpq.html">戻る</a> </td><td width="20%" align="center"><a accesskey="u" href="libpq.html">上に戻る</a></td><td width="40%" align="right"> <a accesskey="n" href="libpq-status.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第31章 <span class="application">libpq</span> - C ライブラリ </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 31.2. 接続状態関数</td></tr></table></div></body></html>