<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.52. リリース9.4</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-9-4-1.html" title="E.51. リリース9.4.1" /><link rel="next" href="release-9-3-24.html" title="E.53. Release 9.3.24" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.52. リリース9.4</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-9-4-1.html" title="E.51. リリース9.4.1">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-9-3-24.html" title="E.53. Release 9.3.24">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-9-4"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.52. リリース9.4</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-9-4.html#id-1.11.6.56.3">E.52.1. 概要</a></span></dt><dt><span class="sect2"><a href="release-9-4.html#id-1.11.6.56.4">E.52.2. バージョン9.4への移行</a></span></dt><dt><span class="sect2"><a href="release-9-4.html#id-1.11.6.56.5">E.52.3. 変更点</a></span></dt></dl></div><p><strong>リリース日: </strong>2014-12-18</p><div class="sect2" id="id-1.11.6.56.3"><div class="titlepage"><div><div><h3 class="title">E.52.1. 概要</h3></div></div></div><p>    <span class="productname">PostgreSQL</span>9.4の主な強化点には以下のものがあります。
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><acronym class="acronym">JSON</acronym>を格納するためのより高機能で効率的な<a class="link" href="datatype-json.html" title="8.14. JSONデータ型"><code class="type">jsonb</code></a>データ型が追加されました。
      </p></li><li class="listitem"><p><code class="filename">postgresql.conf</code>設定ファイルの項目を変更する新たな
<acronym class="acronym">SQL</acronym>コマンド<a class="xref" href="sql-altersystem.html" title="ALTER SYSTEM"><span class="refentrytitle">ALTER SYSTEM</span></a>を追加しました。
      </p></li><li class="listitem"><p>いくつかの<a class="xref" href="sql-altertable.html" title="ALTER TABLE"><span class="refentrytitle">ALTER TABLE</span></a>コマンドでロックを軽減しました。
      </p></li><li class="listitem"><p><a class="link" href="rules-materializedviews.html" title="40.3. マテリアライズドビュー">マテリアライズドビュー</a>を同時実行の読み取りを
妨げずにリフレッシュできるようにしました。
      </p></li><li class="listitem"><p>データベース変更をカスタマイズ可能な形式でストリーミング出力する、
WALデータの<a class="link" href="logicaldecoding.html" title="Chapter 48. ロジカルデコーディング">ロジカルデコーディング</a>をサポートしました。
      </p></li><li class="listitem"><p><a class="link" href="bgworker.html" title="Chapter 47. バックグラウンドワーカプロセス">バックグラウンドワーカプロセス</a>を動的に登録、開始、終了
できるようにしました。
      </p></li></ul></div><p>上記の項目については、以下でより詳細に説明します。
   </p></div><div class="sect2" id="id-1.11.6.56.4"><div class="titlepage"><div><div><h3 class="title">E.52.2. バージョン9.4への移行</h3></div></div></div><p>以前のリリースからデータを移行したい時は、<a class="xref" href="app-pg-dumpall.html" title="pg_dumpall"><span class="refentrytitle"><span class="application">pg_dumpall</span></span></a>利用したダンプとリストア、あるいは<a class="xref" href="pgupgrade.html" title="pg_upgrade"><span class="refentrytitle"><span class="application">pg_upgrade</span></span></a>の利用が必要です。
   </p><p>バージョン9.4には、以前のバージョンとの互換性に影響する多くの変更点が含まれています。
以下の非互換性に注意してください。
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>多次元<a class="link" href="arrays.html" title="8.15. 配列">配列</a>の入力検査を厳格にしました。
(Bruce Momjian)
     </p><p>これまでは、単一要素の副配列から始まる入力配列文字列が、後に複数要素の副配列を
含むことができました。例えば <code class="literal">'{{1}, {2,3}}'::int[]</code> は受け付けられます。
     </p></li><li class="listitem"><p><a class="link" href="datatype-json.html" title="8.14. JSONデータ型"><code class="type">JSON</code></a>文字列値におけるユニコードエスケープで、バックスラッシュではエスケープされなくなりました。
(Andrew Dunstan)
     </p><p>これまで、JSONに整形されるテキスト中のすべてのバックスラッシュはエスケープされていました。
エスケープしなくとも正しいJSON文字列値であり、エスケープすることでひねくれた結果がもたらされていたことから、これからは、<code class="literal">u</code>と16進数4桁に続くバックスラッシュはエスケープされません。
     </p><p>訳注：9.4.1で本修正は取り消されています。
オリジナルの9.4.1マニュアルでは、9.4.0リリースノートから本項目自体が削除されていますが、9.4.0バージョンの情報を残すため、日本語訳では項目を残しました。
     </p></li><li class="listitem"><p><code class="type">date</code>型、<code class="type">timestamp</code>型、<code class="type">timestamptz</code>型の値を
<a class="link" href="datatype-json.html" title="8.14. JSONデータ型"><code class="type">JSON</code></a>に変換するとき、
ISO 8601に従った書式にします。
(Andrew Dunstan)
     </p><p>これまでは現在の<a class="xref" href="runtime-config-client.html#GUC-DATESTYLE">DateStyle</a>設定に基づいて処理されていました。
しかし、多くのJSONプロセッサはタイムスタンプにISO 8601形式を要求します。
必要であれば、JSON変換関数に渡す前に日付時刻の値を<code class="type">text</code>に明示的
キャストすることで以前の振る舞いを実現できます。
     </p></li><li class="listitem"><p>パス展開演算子 <a class="link" href="functions-json.html#FUNCTIONS-JSON-OP-TABLE" title="Table 9.43. jsonとjsonb演算子"><code class="type">json</code>
 <code class="literal">#&gt;</code> <code class="type">text[]</code></a> は、配列が空であるとき、
これからはNULLではなく左辺値を返すようになります。
     </p><p>これは、フィールド/要素を取り出す演算子 <code class="literal">-&gt;</code> の適用を
全く行わないという意味で一貫性があります。
同様に <code class="type">json</code> <code class="literal">#&gt;&gt;</code> <code class="type">text[]</code> は、
単にその左辺値を強制的にテキストに変換します。
     </p></li><li class="listitem"><p><a class="link" href="functions-json.html#FUNCTIONS-JSON-OP-TABLE" title="Table 9.43. jsonとjsonb演算子"><code class="type">JSON</code>のフィールド、要素、
パスを取り出す演算子</a>は境界条件で、これからはエラーでなくNULLを返すようにしました。
(Tom Lane)
     </p><p>例えば、JSON配列にフィールド取り出し演算子（-&gt;）を適用するとき、
これからは、エラーでなくNULLがでます。これはより一貫性のある振る舞いです
（類似の指定フィールドが無い場合では既にNULLが返ります）。
また、正当な任意のJSONに対して決してエラーを投げないことから、これら演算子を
使った式インデックスの作成を安全にします。
     </p></li><li class="listitem"><p><a class="link" href="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE" title="Table 9.23. 書式設定関数"><code class="function">to_timestamp()</code></a>と<code class="function">to_date()</code>の書式文字列の連続した空白が、（空白文字以外を含め）入力文字列から対応した数だけ文字を消費するため、<code class="literal">FX</code>モードでなくても条件付きで隣接した空白を消費します。
(Jeevan Chalke)
     </p><p>これまでは、<code class="literal">FX</code>書式以外での連続する空白文字は、単一の空白文字の
ように振る舞い、入力文字列中の全ての隣接した空白を消費しました。例えば、
以前は3つの空白の書式文字列は<code class="literal">' 12'</code>の最初の空白のみ消費しました。
これからは、3文字すべてが消費されます。
     </p></li><li class="listitem"><p><a class="link" href="functions-textsearch.html#TEXTSEARCH-FUNCTIONS-TABLE" title="Table 9.41. テキスト検索関数"><code class="function">ts_rank_cd()</code></a>関数を除去された語彙素を無視するように修正しました。
     </p><p>これまでは除去された語彙素がデフォルト位置を持つかのように扱われ、
有効であるか疑わしい順位が生じていました。
     </p></li><li class="listitem"><p>引数に<a class="link" href="xfunc-sql.html#XFUNC-SQL-VARIADIC-FUNCTIONS" title="37.4.5. 可変長引数を取るSQL関数"><code class="literal">VARIADIC "any"</code></a>を取る関数で、<code class="literal">VARIADIC</code>と指定された引数は決定可能な配列型でなければならなくなりました。
     </p><p>そのような引数に修飾されていない文字列リテラルや<code class="literal">NULL</code>を書くことが
できなくなり、これからは適切な配列データ型でキャストが必要となります。
なお、本変更は<code class="literal">VARIADIC</code>が指定されていない引数には影響しません。
     </p></li><li class="listitem"><p>行全体の変数で期待される列名が、複合型引数を取り列名に注意を払う関数に
伝わることを、保証するようになりました。
(Tom Lane)
     </p><p><code class="literal">row_to_json(tab.*)</code>などのデータ構成で、これからは、常に呼び出し時点の
テーブル<code class="literal">tab</code>の列別名に一致する列名を出力します。
以前のリリースでは、列名がクエリに割り当てられた別名に関係なく
テーブルの実際の列名になっていました。
     </p></li><li class="listitem"><p><a class="xref" href="sql-discard.html" title="DISCARD"><span class="refentrytitle">DISCARD</span></a>がこれからはシーケンス関連の状態も廃棄します。
(Fabrízio de Royes Mello, Robert Haas)
     </p></li><li class="listitem"><p><a class="link" href="sql-explain.html" title="EXPLAIN"><code class="command">EXPLAIN ANALYZE</code></a>の出力で
<span class="quote">“<span class="quote">total runtime</span>”</span>から、<span class="quote">“<span class="quote">execution time</span>”</span>に
項目名を変更しました。
(Tom Lane)
     </p><p>これからはプラン時間も報告されるため、従来の項目名では紛らわしいです。
     </p></li><li class="listitem"><p><a class="link" href="sql-show.html" title="SHOW"><code class="command">SHOW TIME ZONE</code></a>は、これからは
<acronym class="acronym">POSIX</acronym>時間帯形式の簡素な数値のUTCオフセットを出力します。
(Tom Lane)
     </p><p>これまでは、timezone設定を<a class="link" href="datatype-datetime.html#DATATYPE-INTERVAL-OUTPUT" title="8.5.5. 時間間隔の出力"><code class="type">interval</code></a>
の値として表示していました。
単純な文字列が渡されたとき、
旧出力では正しく再解析されるように特別な扱いが必要であるのに対して、
新出力では<code class="command">SET TIME ZONE</code>により適切に解釈されます。
     </p></li><li class="listitem"><p>外部テーブルの更新に対応した外部データラッパは、<code class="literal">AFTER ROW</code>トリガが
存在する可能性に考慮しなければいけません。
(Noah Misch)
     </p><p><code class="literal">AFTER ROW</code>トリガがある場合、トリガが読むかもしれないので、
更新動作でテーブルのすべての列を返されなければいけません。
これまでは、外部テーブルはトリガを持つことがなかったので、外部データラッパが
<code class="literal">RETURNING</code>句で言及されていない列の取得を省略して最適化しているかもしれません。
     </p></li><li class="listitem"><p><a class="link" href="ddl-constraints.html#DDL-CONSTRAINTS-CHECK-CONSTRAINTS" title="5.3.1. 検査制約"><code class="literal">CHECK</code></a>制約が
<code class="structfield">tableoid</code>以外のシステム列を参照できないようにしました。
(Amit Kapila)
     </p><p>これまではそのようなチェック制約が許されていましたが、リストア時にしばしばエラーを
引き起こしていました。
     </p></li><li class="listitem"><p>複数の<a class="link" href="recovery-target-settings.html" title="27.2. リカバリ対象の設定">リカバリターゲット設定</a>が
指定されていた場合、最後の指定を使用するようにしました。
(Heikki Linnakangas)
     </p><p>これまでは<code class="literal">recovery_target_<em class="replaceable"><code>xxx</code></em></code>設定の優先順位が
文書化されていませんでした。
     </p></li><li class="listitem"><p>Windowsで、機械的にユーザが書いたコマンド文字列内のクオートを維持します。
(Heikki Linnakangas)
     </p><p>クオートを維持するようにしているユーザコマンドではおそらく修正が必要です。
<a class="xref" href="runtime-config-wal.html#GUC-ARCHIVE-COMMAND">archive_command</a>や<a class="xref" href="archive-recovery-settings.html#RESTORE-COMMAND">restore_command</a>、
<a class="link" href="sql-copy.html" title="COPY"><code class="command">COPY TO/FROM PROGRAM</code></a>の
コマンドで問題がありそうです。
     </p></li><li class="listitem"><p>システムカタログの列
<a class="link" href="catalog-pg-class.html" title="51.11. pg_class"><code class="structfield">pg_class.reltoastidxid</code></a>
が取り除かれました。
(Michael Paquier)
     </p></li><li class="listitem"><p>システムカタログの列
<a class="link" href="catalog-pg-rewrite.html" title="51.44. pg_rewrite"><code class="structfield">pg_rewrite.ev_attr</code></a>
が取り除かれました。
(Kevin Grittner)
     </p><p>列単位のルールは<span class="application">PostgreSQL</span> 7.3以来サポートされていませんでした。
     </p></li><li class="listitem"><p><span class="application">Kerberos</span>認証のネイティブサポート（<code class="option">--with-krb5</code>など）が除去されました。
(Magnus Hagander)
     </p><p><span class="application">Kerberos</span>認証の使用は<acronym class="acronym">GSSAPI</acronym>でサポートされます。
ネイティブコードは<span class="productname">PostgreSQL</span> 8.3から非推奨となっていました。
     </p></li><li class="listitem"><p><span class="application">PL/Python</span>で、配列のドメインを配列型を基底とするように扱います。
(Rodolfo Campero)
     </p><p>これまでは文字列として扱われていました。
     </p></li><li class="listitem"><p>libpq の
<a class="link" href="libpq-connect.html#LIBPQ-PQCONNECTDBPARAMS"><code class="function">PQconnectdbParams()</code></a>、
<a class="link" href="libpq-connect.html#LIBPQ-PQPINGPARAMS"><code class="function">PQpingParams()</code></a>関数が
空文字列をデフォルトとして処理します。
(Adrian Vondendriesch)
     </p><p>これまでは、これらの関数では一部の場合だけ空文字列でデフォルトを選んでいました。
     </p></li><li class="listitem"><p><a class="xref" href="intarray.html" title="F.19. intarray">intarray</a>モジュールが空配列を返すときゼロ次元配列になるように変更しました。
(Bruce Momjian)
     </p><p>これまでは、空配列を長さゼロの１次元配列として返していました。それらのテキスト表現はゼロ次元配列としたときと同じ（<code class="literal">{}</code>）ですが、配列操作での動作が異なります。
この部分で<span class="application">intarray</span>の振る舞いが組み込みの配列演算子と同じになります。
     </p></li><li class="listitem"><p><a class="xref" href="pgupgrade.html" title="pg_upgrade"><span class="refentrytitle"><span class="application">pg_upgrade</span></span></a>は、これからは<code class="option">-U</code>または<code class="option">--username</code>
でユーザ名を指定するようになります。
(Bruce Momjian)
     </p><p>これまでは本オプションは<code class="option">-u</code>または<code class="option">--user</code>でしたが、
他のツールとの一貫性に欠けていました。
     </p></li></ul></div></div><div class="sect2" id="id-1.11.6.56.5"><div class="titlepage"><div><div><h3 class="title">E.52.3. 変更点</h3></div></div></div><p>これまでのメジャーリリースからの<span class="productname">PostgreSQL</span> 9.4
の変更点の詳細説明を以下に示します。
   </p><div class="sect3" id="id-1.11.6.56.5.3"><div class="titlepage"><div><div><h4 class="title">E.52.3.1. サーバ</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="bgworker.html" title="Chapter 47. バックグラウンドワーカプロセス">バックグラウンドワーカプロセス</a>を動的に
登録、開始、終了できるようにしました。
(Robert Haas)
       </p><p>新たな<code class="filename">worker_spi</code>モジュールで本新機能の例を示します。
       </p></li><li class="listitem"><p>共有メモリセグメントを動的に割り当てできるようにしました。
(Robert Haas, Amit Kapila)
       </p><p>本機能は<code class="filename">test_shm_mq</code>モジュールで例示されています。
       </p></li><li class="listitem"><p>クラッシュリカバリ、あるいは、immediateシャットダウンの際に、
即座に停止しない子プロセスにキャッチできないシグナル（<span class="systemitem">SIGKILL</span>）
を送るようになりました。
(MauMau, Álvaro Herrera)
       </p><p>これにより、<a class="xref" href="app-postmaster.html" title="postmaster"><span class="refentrytitle"><span class="application">postmaster</span></span></a>シャットダウン後に子プロセスが
残ってしまう可能性を減らし、また、いくつかの子プロセスが<span class="quote">“<span class="quote">刺った</span>”</span>
場合でもクラッシュリカバリの進行を保証します。
       </p></li><li class="listitem"><p>データベースのシステム識別子のランダム性を改善しました。
(Tom Lane)
       </p></li><li class="listitem"><p><a class="xref" href="sql-vacuum.html" title="VACUUM"><span class="refentrytitle">VACUUM</span></a>が、削除済(dead)であるけれど未だ除去できない行に
ついて統計情報コレクタに適切に報告するようにしました。
(Hari Babu)
       </p><p>これまでは有効(live)行であるものと報告されていました。
       </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.3.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.1.1. インデックス</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="gin.html" title="Chapter 64. GINインデックス"><acronym class="acronym">GIN</acronym></a>インデックスのサイズを減らしました。
(Alexander Korotkov, Heikki Linnakangas)
       </p><p><a class="xref" href="pgupgrade.html" title="pg_upgrade"><span class="refentrytitle"><span class="application">pg_upgrade</span></span></a>を使ってアップグレードした場合、動作しますが、
従来のサイズの大きいGIN形式のままです。<a class="xref" href="sql-reindex.html" title="REINDEX"><span class="refentrytitle">REINDEX</span></a>
で新たな形式でインデックスを作り直す必要があります。
       </p></li><li class="listitem"><p>複合キーでの<a class="link" href="gin.html" title="Chapter 64. GINインデックス"><acronym class="acronym">GIN</acronym></a>
インデックス照会の速度を改善しました。
(Alexander Korotkov, Heikki Linnakangas)
       </p></li><li class="listitem"><p><a class="link" href="gist.html" title="Chapter 62. GiSTインデックス"><acronym class="acronym">GiST</acronym></a>インデックスが<a class="link" href="datatype-net-types.html#DATATYPE-INET" title="8.9.1. inet"><code class="type">inet</code></a>型、<a class="link" href="datatype-net-types.html#DATATYPE-CIDR" title="8.9.2. cidr"><code class="type">cidr</code></a>型に対応しました。
(Emre Hasegeli)
       </p><p>これらインデックス改善は、
<a class="link" href="functions-net.html#CIDR-INET-OPERATORS-TABLE" title="Table 9.36. cidrとinet演算子">サブネット・スーパーネット</a>
の照会や並べ替えのための比較を性能向上させます。
       </p></li><li class="listitem"><p>B-treeインデックスのページ削除における稀な競合状態を修正しました。
(Heikki Linnakangas)
       </p></li><li class="listitem"><p>割り込みされたB-treeインデックスのページ分割の扱いをより頑健にしました。
(Heikki Linnakangas)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.3.4"><div class="titlepage"><div><div><h5 class="title">E.52.3.1.2. 性能全般</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>複数バックエンドから<a class="link" href="wal.html" title="Chapter 30. 信頼性とログ先行書き込み"><acronym class="acronym">WAL</acronym></a>バッファに
並行に挿入できるようになりました。
(Heikki Linnakangas)
       </p><p>本変更は並列書き込み性能を改善します。
       </p></li><li class="listitem"><p>条件によって、更新された行のうち変更部分だけを
<a class="link" href="wal.html" title="Chapter 30. 信頼性とログ先行書き込み"><acronym class="acronym">WAL</acronym></a>に書き込むようにしました。
(Amit Kapila)
       </p></li><li class="listitem"><p><a class="link" href="sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS" title="4.2.8. ウィンドウ関数呼び出し">WINDOW関数</a>
として使われる集約関数の性能を改善しました。
(David Rowley, Florian Pflug, Tom Lane)
       </p></li><li class="listitem"><p><a class="link" href="datatype-numeric.html" title="8.1. 数値データ型"><code class="type">numeric</code></a>型を
状態値に使う集約処理の速度を改善しました。
       </p></li><li class="listitem"><p>テーブルが<a class="xref" href="sql-cluster.html" title="CLUSTER"><span class="refentrytitle">CLUSTER</span></a>または<a class="link" href="sql-vacuum.html" title="VACUUM"><code class="command">VACUUM FULL</code></a>コマンドで書き直されたときにタプルの
<a class="link" href="routine-vacuuming.html#VACUUM-FOR-WRAPAROUND" title="24.1.5. トランザクションIDの周回エラーの防止">凍結</a>を試みます。
(Robert Haas, Andres Freund)
       </p><p>これにより将来にタプル凍結が必要になることを避けられます。
       </p></li><li class="listitem"><p>デフォルトがシーケンスの
<a class="link" href="functions-sequence.html#FUNCTIONS-SEQUENCE-TABLE" title="Table 9.47. シーケンス関数"><code class="function">nextval()</code></a>
である列に対する<a class="xref" href="sql-copy.html" title="COPY"><span class="refentrytitle">COPY</span></a>の速度を改善しました。
(Simon Riggs)
       </p></li><li class="listitem"><p>一つの接続で多数の<a class="link" href="sql-createsequence.html" title="CREATE SEQUENCE">シーケンス</a>
にアクセスする場合の速度を改善しました。
(David Rowley)
       </p></li><li class="listitem"><p>メモリ上でソートやB-treeインデックス構築をする際のタプル数の固定上限を引き上げました。
(Noah Misch)
       </p></li><li class="listitem"><p>PL/pgSQL手続き言語の<a class="xref" href="sql-do.html" title="DO"><span class="refentrytitle">DO</span></a>ブロックによるメモリ割り当てを
小さくしました。
(Tom Lane)
       </p></li><li class="listitem"><p>プランナが<code class="literal">AND</code>/<code class="literal">OR</code>句が混在する中から、
より積極的に制約句を抽出するようにしました。
(Tom Lane)
       </p></li><li class="listitem"><p>揮発性の<code class="literal">WHERE</code>句を<code class="literal">DISTINCT</code>サブクエリに
プッシュダウンしないようにしました。
(Tom Lane)
       </p><p><code class="literal">WHERE</code>句のプッシュダウンは概してプラン改善に効果的ですが、
問い合わせ文によっては句の評価コストがより多くなると考えられます。
そのため、句がVOLATILE関数を含むときにはプッシュダウンを実施しません。
       </p></li><li class="listitem"><p>カタログキャッシュが自動でサイズ変更されるようにしました。
(Heikki Linnakangas)
       </p><p>これは少数のテーブルにだけアクセスする接続に対してメモリ消費を減らし、
また、多数のテーブルにアクセスする接続に対しては性能を向上させます。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.3.5"><div class="titlepage"><div><div><h5 class="title">E.52.3.1.3. 監視</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="wal.html" title="Chapter 30. 信頼性とログ先行書き込み"><acronym class="acronym">WAL</acronym></a>アーカイバの活動を報告する
<a class="xref" href="monitoring-stats.html#PG-STAT-ARCHIVER-VIEW" title="Table 28.9. pg_stat_archiverビュー">pg_stat_archiver</a>システムビューを追加しました。
(Gabriele Bartolini)
       </p></li><li class="listitem"><p><code class="structfield">n_mod_since_analyze</code>列を
<a class="xref" href="monitoring-stats.html#PG-STAT-ALL-TABLES-VIEW" title="Table 28.13. pg_stat_all_tablesビュー">pg_stat_all_tables</a>と関連するシステムビューに追加しました。
(Mark Kirkwood)
       </p><p>この列は最後に<a class="xref" href="sql-analyze.html" title="ANALYZE"><span class="refentrytitle">ANALYZE</span></a>が行われて以降のタプル変更回数の推計値を表示します。この推計値が自動ANALYZEの駆動を決めるために使われます。
       </p></li><li class="listitem"><p><code class="structfield">backend_xid</code>列、<code class="structfield">backend_xmin</code>列を、
システムビュー<a class="xref" href="monitoring-stats.html#PG-STAT-ACTIVITY-VIEW" title="Table 28.3. pg_stat_activityビュー">pg_stat_activity</a>に追加し、
<code class="structfield">backend_xmin</code>列が<a class="xref" href="monitoring-stats.html#PG-STAT-REPLICATION-VIEW" title="Table 28.5. pg_stat_replicationビュー">pg_stat_replication</a>
に追加しました。
(Christian Kruse)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.3.6"><div class="titlepage"><div><div><h5 class="title">E.52.3.1.4. <acronym class="acronym">SSL</acronym></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>SSLでECDH鍵交換をサポートしました。
(Marko Kreen)
       </p><p>楕円曲線鍵でサーバ認証ができるようになります。
この鍵は<acronym class="acronym">RSA</acronym>鍵よりも高速で安全です。
新たな設定パラメータ<a class="xref" href="runtime-config-connection.html#GUC-SSL-ECDH-CURVE">ssl_ecdh_curve</a>でどの曲線を
<acronym class="acronym">ECDH</acronym>に使うかを制御します。
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-connection.html#GUC-SSL-CIPHERS">ssl_ciphers</a>設定のデフォルト値を改善しました。
(Marko Kreen)
       </p></li><li class="listitem"><p>デフォルトでクライアント側でなくサーバ側の
<acronym class="acronym">SSL</acronym>暗号の優先順設定を使用するようにしました。
(Marko Kreen)
       </p><p>これまでは、<a class="xref" href="runtime-config-connection.html#GUC-SSL-CIPHERS">ssl_ciphers</a>で指定した順番が、
クライアント側のデフォルトの好みによってたいてい無視されていました。
これはほとんどの<span class="productname">PostgreSQL</span>クライアントで設定不能です。
望むなら新たな設定パラメータ<a class="xref" href="runtime-config-connection.html#GUC-SSL-PREFER-SERVER-CIPHERS">ssl_prefer_server_ciphers</a>により従来の振る舞いに戻すこともできます。
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-logging.html#GUC-LOG-CONNECTIONS">log_connections</a>で<acronym class="acronym">SSL</acronym>暗号化情報を出力するようにしました。
(Andreas Kunert)
       </p></li><li class="listitem"><p><acronym class="acronym">SSL</acronym>再ネゴシエーション処理を改善しました。
(Álvaro Herrera)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.3.7"><div class="titlepage"><div><div><h5 class="title">E.52.3.1.5. サーバ設定</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">postgresql.conf</code>設定ファイルの項目を変更できる新たな<acronym class="acronym">SQL</acronym>コマンド<a class="xref" href="sql-altersystem.html" title="ALTER SYSTEM"><span class="refentrytitle">ALTER SYSTEM</span></a>を追加しました。
(Amit Kapila)
       </p><p>従来は設定変更するには<code class="filename">postgresql.conf</code>を手で編集するほかありませんでした。
       </p></li><li class="listitem"><p>自動VACUUMワーカーのメモリ使用量を調整する<a class="xref" href="runtime-config-resource.html#GUC-AUTOVACUUM-WORK-MEM">autovacuum_work_mem</a>設定パラメータを追加しました。
(Peter Geoghegan)
       </p></li><li class="listitem"><p>Linuxのhuge pagesを利用できる<a class="xref" href="runtime-config-resource.html#GUC-HUGE-PAGES">huge_pages</a>設定パラメータを追加しました。
(Christian Kruse, Richard Poole, Abhijit Menon-Sen)
       </p><p>これにより巨大メモリを持つシステムの性能を改善できます。
       </p></li><li class="listitem"><p>バックグラウンドワーカの数を制限する <a class="xref" href="runtime-config-resource.html#GUC-MAX-WORKER-PROCESSES">max_worker_processes</a>パラメータを追加しました。
(Robert Haas)
       </p><p>スタンバイサーバに必要な（プライマリと同じ）ワーカプロセス数を調整するときに役立ちます。
       </p></li><li class="listitem"><p>スーパーユーザのみ使用できるセッション開始時にライブラリをロードする<a class="xref" href="runtime-config-client.html#GUC-SESSION-PRELOAD-LIBRARIES">session_preload_libraries</a>パラメータを追加しました。
       </p><p><a class="xref" href="runtime-config-client.html#GUC-LOCAL-PRELOAD-LIBRARIES">local_preload_libraries</a>と違い、<code class="filename">$libdir/plugins</code>ディレクトリにあるものに限られず、本パラメータでは、どの共有ライブラリでもロードできます。
       </p></li><li class="listitem"><p>ヒントビットの変更もWAL出力するようにする<a class="xref" href="runtime-config-wal.html#GUC-WAL-LOG-HINTS">wal_log_hints</a>パラメータを追加しました。
(Sawada Masahiko)
       </p><p>チェックサムを有効にしているときを除き、通常ヒントビットはWAL記録されません。
本設定は、<span class="application">pg_rewind</span>のような外部ツールにおいて有用です。
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-resource.html#GUC-WORK-MEM">work_mem</a>と<a class="xref" href="runtime-config-resource.html#GUC-MAINTENANCE-WORK-MEM">maintenance_work_mem</a>
のデフォルト設定値を４倍に増やしました。
(Bruce Momjian)
       </p><p>それぞれ4MBと64MBが新たなデフォルト値となります。
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-query.html#GUC-EFFECTIVE-CACHE-SIZE">effective_cache_size</a>のデフォルト値を4GBに増やしました。
(Bruce Momjian, Tom Lane)
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-logging.html#GUC-LOG-LINE-PREFIX">log_line_prefix</a>で<code class="function">printf</code>形式の空白パディングを指定できるようにしました。
(David Rowley)
       </p></li><li class="listitem"><p>設定ファイルにテラバイト単位 (<code class="literal">TB</code>)を記述できるようにしました。
(Simon Riggs)
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-logging.html#GUC-LOG-LOCK-WAITS">log_lock_waits</a>によるログメッセージで、
ロックを保持しているプロセス、待っているプロセスの<acronym class="acronym">PID</acronym>、
および、改善されたリレーション情報が出力されるようにしました。
(Christian Kruse)
       </p></li><li class="listitem"><p>共有ライブラリをロードした際のログレベルをDEBUG1に下げました。
(Peter Geoghegan)
       </p><p>これまでは<code class="literal">LOG</code>レベルでしたが、接続ごとにロードされるライブラリの場合には冗長すぎました。
       </p></li><li class="listitem"><p>Windowsにて<code class="literal">SQL_ASCII</code>エンコーディングのデータベースとサーバプロセス（例えば <a class="xref" href="app-postmaster.html" title="postmaster"><span class="refentrytitle"><span class="application">postmaster</span></span></a>）が、サーバのWindowsユーザロケールの文字エンコーディングでメッセージを出力するようになりました。
(Alexander Law, Noah Misch)
       </p><p>これまでは、Windowsの<acronym class="acronym">ANSI</acronym>コードページでメッセージが出力されていました。
       </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.56.5.4"><div class="titlepage"><div><div><h4 class="title">E.52.3.2. レプリケーションとリカバリ</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ストリーミングレプリケーション元ノードでスタンバイの活動を調整する
<a class="link" href="warm-standby.html#STREAMING-REPLICATION-SLOTS" title="26.2.6. レプリケーションスロット">レプリケーションスロット</a>
を追加しました。
(Andres Freund, Robert Haas)
       </p><p>レプリケーションスロットにより、プライマリ上の<acronym class="acronym">WAL</acronym>ファイル等リソースをスタンバイサーバが必要としなくなるまで保持することができます。
       </p></li><li class="listitem"><p>レプリケーションを遅延させるリカバリ設定パラメータ<a class="xref" href="standby-settings.html#RECOVERY-MIN-APPLY-DELAY">recovery_min_apply_delay</a>を追加しました。
(Robert Haas, Fabrízio de Royes Mello, Simon Riggs)
       </p><p>スタンバイサーバでの再生を遅らせることは、ユーザによる誤りから復旧するのに役立ちます。
       </p></li><li class="listitem"><p>リカバリ設定パラメータ<a class="xref" href="recovery-target-settings.html#RECOVERY-TARGET">recovery_target</a>にオプション<code class="option">immediate</code>を追加しました。<a class="link" href="wal.html" title="Chapter 30. 信頼性とログ先行書き込み"><acronym class="acronym">WAL</acronym></a>リカバリを整合性のある状態に到達したらすぐに停止します。
(MauMau, Heikki Linnakangas)
       </p></li><li class="listitem"><p>リカバリターゲットの処理を改善しました。
(Heikki Linnakangas)
       </p><p>停止を判定する<a class="link" href="functions-admin.html#FUNCTIONS-RECOVERY-INFO-TABLE" title="Table 9.80. リカバリ情報関数"><code class="function">pg_last_xact_replay_timestamp()</code></a>が報告するタイムスタンプが、コミットされるであろうトランザクションでなく、コミット済みのレコードを反映するようにしました。
リストアポイントよりも早すぎる時点で再生が止まってしまうのを防ぎます。
       </p></li><li class="listitem"><p><a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE" title="Table 9.79. バックアップ制御関数"><code class="function">pg_switch_xlog()</code></a>が古い<acronym class="acronym">WAL</acronym>ファイル上の使われない末尾領域をクリアするようにしました。
(Heikki Linnakangas)
       </p><p>これは<acronym class="acronym">WAL</acronym>ファイルの圧縮率を改善します。
       </p></li><li class="listitem"><p><a class="link" href="archive-recovery-settings.html" title="27.1. アーカイブリカバリの設定">リカバリ用外部コマンド</a>からの
リターンコードを報告するようにしました。
(Peter Eisentraut)
       </p></li><li class="listitem"><p><acronym class="acronym">WAL</acronym>再生中のスピンロック競合を減らしました。
(Heikki Linnakangas)
       </p></li><li class="listitem"><p>トランザクション実行の<acronym class="acronym">WAL</acronym>レコードの書き出しをより頻繁にしました。
       </p><p>これによりスタンバイサーバで起動が速くなり、より積極的にリソースの片づけができるようになります。
       </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.4.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.2.1. <a class="link" href="logicaldecoding.html" title="Chapter 48. ロジカルデコーディング">ロジカルデコーディング</a></h5></div></div></div><p>ロジカルデコーディングにより、データベース変更を可変な形式で流し出すことができるようになります。
データは<a class="link" href="wal.html" title="Chapter 30. 信頼性とログ先行書き込み"><acronym class="acronym">WAL</acronym></a>から読みとり、望む形式に変換されます。本機能を実装するため、以下の改修が行われました。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>データベース変更をカスタマイズ可能な形式で連続的に出力できる、WALデータの<a class="link" href="logicaldecoding.html" title="Chapter 48. ロジカルデコーディング">ロジカルデコーディング</a>をサポートしました。
(Andres Freund)
        </p></li><li class="listitem"><p><a class="xref" href="runtime-config-wal.html#GUC-WAL-LEVEL">wal_level</a>設定パラメータに、<acronym class="acronym">WAL</acronym>に論理変更セットのエンコードを有効にする新たなオプション<code class="option">logical</code>を追加しました。
(Andres Freund)
        </p></li><li class="listitem"><p>論理レプリケーションの制御用にテーブル単位のパラメータ
<a class="link" href="catalog-pg-class.html" title="51.11. pg_class"><code class="literal">REPLICA IDENTITY</code></a>
を追加しました。
(Andres Freund)
        </p></li><li class="listitem"><p>論理変更セットのエンコードにおいてユーザ作成テーブルを識別するためのテーブル単位のパラメータ
<a class="link" href="sql-createtable.html#SQL-CREATETABLE-STORAGE-PARAMETERS" title="格納パラメータ"><code class="option">user_catalog_table</code></a>
を追加しました。
(Andres Freund)
        </p></li><li class="listitem"><p>ロジカルデコーディングデータを受け取るアプリケーション<a class="xref" href="app-pgrecvlogical.html" title="pg_recvlogical"><span class="refentrytitle"><span class="application">pg_recvlogical</span></span></a>を追加しました。
(Andres Freund)
        </p></li><li class="listitem"><p><acronym class="acronym">SQL</acronym>レベルでロジカルデコーディングを例示する<a class="xref" href="test-decoding.html" title="F.41. test_decoding">test_decoding</a>モジュールを追加しました。
(Andres Freund)
        </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.56.5.5"><div class="titlepage"><div><div><h4 class="title">E.52.3.3. 問い合わせ</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">FROM</code>句の集合を返す関数から返される行に番号をつける
<a class="link" href="queries-table-expressions.html#QUERIES-TABLEFUNCTIONS" title="7.2.1.4. テーブル関数"><code class="literal">WITH ORDINALITY</code></a>構文を追加しました。
(Andrew Gierth, David Fetter)
       </p><p><code class="function">unnest()</code>のような関数で特に役立ちます。
       </p></li><li class="listitem"><p><code class="literal">FROM</code>句で集合を返す関数の水平結合ができる
<a class="link" href="queries-table-expressions.html#QUERIES-TABLEFUNCTIONS" title="7.2.1.4. テーブル関数"><code class="literal">ROWS FROM()</code></a>構文を追加しました。
(Andrew Gierth)
       </p></li><li class="listitem"><p><a class="xref" href="sql-select.html" title="SELECT"><span class="refentrytitle">SELECT</span></a>で空のターゲットリストを持てるようにしました。
       </p><p>これにより、ゼロ個の列を選択するビューを正しくダンプ、リストアできるようになります。
       </p></li><li class="listitem"><p><a class="link" href="sql-select.html" title="SELECT"><code class="literal">SELECT ... FOR UPDATE NOWAIT</code></a>が例外的なケースでも既に同時更新されているタプルを待たないようにしました。
(Craig Ringer and Thomas Munro)
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.56.5.6"><div class="titlepage"><div><div><h4 class="title">E.52.3.4. ユーティリティコマンド</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>キャッシュされたシーケンス関連の状態を破棄する<a class="link" href="sql-discard.html" title="DISCARD"><code class="command">DISCARD SEQUENCES</code></a>コマンドを追加しました。
(Fabrízio de Royes Mello, Robert Haas)
       </p><p>これからは<code class="command">DISCARD ALL</code>もシーケンス関連の状態情報を破棄します。
       </p></li><li class="listitem"><p><a class="link" href="sql-copy.html" title="COPY"><code class="command">COPY FROM</code></a>に、
<code class="literal">CSV</code>モードで指定のNULL文字列に一致するクオートされた文字列をNULLに変換する、
<code class="literal">FORCE NULL</code>オプションを追加しました。
(Ian Barwick, Michael Paquier)
        </p><p>本オプションが無い場合、クオートされていなくてマッチした文字列だけNULLとして扱われます。
        </p></li><li class="listitem"><p>トランザクションブロックの外で意味をなさないコマンドを実行したとき、警告を出すようにしました。
(Bruce Momjian)
       </p><p>新たに<code class="command">SET LOCAL</code>、<code class="command">SET CONSTRAINTS</code>、
<code class="command">SET TRANSACTION</code>、および、<code class="command">ABORT</code>について、トランザクション外で使うと警告がでるようになります。
       </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.6.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.4.1. <a class="xref" href="sql-explain.html" title="EXPLAIN"><span class="refentrytitle">EXPLAIN</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="command">EXPLAIN ANALYZE</code>がプラン時間を表示するようにしました。
(Andreas Karlsson)
        </p></li><li class="listitem"><p><code class="command">EXPLAIN</code>がAgg、Groupプラン要素にて集約している列を出力するようにしました。
(Tom Lane)
        </p></li><li class="listitem"><p><code class="command">EXPLAIN ANALYZE</code>でビットマップヒープスキャンのexactブロックカウントとlossyブロックカウントを出力するようにしました。
(Etsuro Fujita)
        </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.6.4"><div class="titlepage"><div><div><h5 class="title">E.52.3.4.2. ビュー</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="rules-materializedviews.html" title="40.3. マテリアライズドビュー">マテリアライズドビュー</a>を他セッションの同時参照を妨げずにリフレッシュできるようにしました。
(Kevin Grittner)
       </p><p><a class="link" href="sql-refreshmaterializedview.html" title="REFRESH MATERIALIZED VIEW"><code class="command">REFRESH MATERIALIZED VIEW CONCURRENTLY</code></a>コマンドで行います。
       </p></li><li class="listitem"><p>たとえ更新できない列が含まれていても、ビューが<a class="link" href="sql-createview.html#SQL-CREATEVIEW-UPDATABLE-VIEWS" title="更新可能ビュー">自動更新可能</a>になります。
(Dean Rasheed)
       </p><p>これまでは、式や定数、関数呼び出しなどの更新不能な出力列があると、ビューは自動更新可能にはなりませんでした。
これからは、更新不能な列に新しい値を割り当てしようとしないなら<code class="command">INSERT</code>、<code class="command">UPDATE</code>、<code class="command">DELETE</code>がサポートされます。
       </p></li><li class="listitem"><p><code class="command">INSERT</code>や<code class="command">UPDATE</code>で、
自動更新可能ビューにそのビューにはあらわれない行を加えることができるかを制御できるようにしました。
(Dean Rasheed)
       </p><p>新たに追加された<a class="xref" href="sql-createview.html" title="CREATE VIEW"><span class="refentrytitle">CREATE VIEW</span></a>の<code class="literal">WITH CHECK OPTION</code>句で制御します。
       </p></li><li class="listitem"><p><a class="link" href="rules-privileges.html" title="40.5. ルールと権限">セキュリティバリアビュー</a>も自動更新可能になれるようにしました。
(Dean Rasheed)
       </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.56.5.7"><div class="titlepage"><div><div><h4 class="title">E.52.3.5. オブジェクトの操作</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="sql-createforeigntable.html" title="CREATE FOREIGN TABLE">外部テーブル</a>のトリガをサポートしました。
(Ronan Dunklau)
       </p></li><li class="listitem"><p><a class="xref" href="sql-altertable.html" title="ALTER TABLE"><span class="refentrytitle">ALTER TABLE</span></a>、<a class="xref" href="sql-alterindex.html" title="ALTER INDEX"><span class="refentrytitle">ALTER INDEX</span></a>、
<a class="xref" href="sql-altermaterializedview.html" title="ALTER MATERIALIZED VIEW"><span class="refentrytitle">ALTER MATERIALIZED VIEW</span></a>にて、
<code class="literal">ALL IN TABLESPACE ... SET TABLESPACE</code>指定を使って、
テーブルスペースのオブジェクト群をまとめて別テーブルスペースに移動できるようにしました。
(Stephen Frost)
       </p></li><li class="listitem"><p><a class="xref" href="sql-altertable.html" title="ALTER TABLE"><span class="refentrytitle">ALTER TABLE</span></a> ... <code class="literal">ALTER CONSTRAINT</code>で外部キー制約が遅延できるかを変更できるようにしました。
(Simon Riggs)
       </p></li><li class="listitem"><p>いくつかの<a class="xref" href="sql-altertable.html" title="ALTER TABLE"><span class="refentrytitle">ALTER TABLE</span></a>コマンドでロックの強さを下げました。
(Simon Riggs, Noah Misch, Robert Haas)
       </p><p>特に、<code class="literal">VALIDATE CONSTRAINT</code>、<code class="literal">CLUSTER ON</code>、
<code class="literal">SET WITHOUT CLUSTER</code>、<code class="literal">ALTER COLUMN SET STATISTICS</code>、
<code class="literal">ALTER COLUMN</code> <code class="literal">SET</code> <code class="option">(attribute_option)</code>、
<code class="literal">ALTER COLUMN RESET</code> <code class="option">(attribute_option)</code>は、もはや
<code class="literal">ACCESS EXCLUSIVE</code>ロックを必要としません。
       </p></li><li class="listitem"><p>テーブルスペースのオプションを
<a class="xref" href="sql-createtablespace.html" title="CREATE TABLESPACE"><span class="refentrytitle">CREATE TABLESPACE</span></a>で設定できるようにしました。
(Vik Fearing)
       </p><p>以前はこれらのオプションは<a class="xref" href="sql-altertablespace.html" title="ALTER TABLESPACE"><span class="refentrytitle">ALTER TABLESPACE</span></a>でしか設定できませんでした。
       </p></li><li class="listitem"><p><a class="xref" href="sql-createaggregate.html" title="CREATE AGGREGATE"><span class="refentrytitle">CREATE AGGREGATE</span></a>で集約の遷移状態データの推定サイズを指定できるようにしました。
(Hadi Moshayedi)
       </p><p>この機能を適切に使うことでプランナが集約での必要メモリ量をよりよく見積もれます。
       </p></li><li class="listitem"><p><code class="command">DROP IF EXISTS</code>が場合によってはオブジェクトが無いことでエラーになるのを修正しました。
(Pavel Stehule, Dean Rasheed)
       </p></li><li class="listitem"><p>システムリレーションの識別方法を改善しました。
(Andres Freund, Robert Haas)
       </p><p>これまでは、一度<code class="literal">pg_catalog</code>スキーマに移動したリレーションは、変更も削除もできませんでした。
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.56.5.8"><div class="titlepage"><div><div><h4 class="title">E.52.3.6. データ型</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="datatype-geometric.html#DATATYPE-LINE" title="8.8.2. 直線"><code class="type">line</code></a>データ型を完全に実装しました。
(Peter Eisentraut)
       </p><p><span class="emphasis"><em>線分</em></span>データ型(<a class="link" href="datatype-geometric.html#DATATYPE-LSEG" title="8.8.3. 線分"><code class="type">lseg</code></a>)
は既にサポートされています。
従来の<code class="type">line</code>データ型（コンパイルオプションでのみ有効にできます）は、バイナリでもダンプでも新しい実装と互換性がありません。
       </p></li><li class="listitem"><p><acronym class="acronym">WAL</acronym>のログシーケンス番号(<acronym class="acronym">LSN</acronym>)をあらわす<a class="link" href="datatype-pg-lsn.html" title="8.19. pg_lsn 型"><code class="type">pg_lsn</code></a>データ型を追加しました。
(Robert Haas, Michael Paquier)
       </p></li><li class="listitem"><p>一点だけの<a class="link" href="datatype-geometric.html#DATATYPE-POLYGON" title="8.8.6. 多角形(ポリゴン)"><code class="type">polygon</code></a>を
<a class="link" href="datatype-geometric.html#DATATYPE-CIRCLE" title="8.8.7. 円"><code class="type">circle</code></a>に変換できるようにしました。
(Bruce Momjian)
       </p></li><li class="listitem"><p>UTCオフセットが変化するタイムゾーン略称をサポートしました。
(Tom Lane)
       </p><p>これまで<span class="productname">PostgreSQL</span>では（<code class="literal">EST</code>などの）一つのタイムゾーン略称に関連づけられたUTCオフセットは、いかなるロケールでの使用でも変化しないと仮定していました。
しかしながら、実世界においてこの仮定は失敗しました。そこで、意味するUTCオフセットをときに変更できるタイムゾーン略称を導入しました。
1970年以来の略称のUTCオフセットが変更されたタイムゾーンロケールで本機能を使えるように（IANAタイムゾーンデータベースに基づいて）ゾーン略称定義ファイルを刷新しました。これからは<span class="productname">PostgreSQL</span>は、略称に日付に応じた適切なUTCオフセットを関連づけます。
       </p></li><li class="listitem"><p><a class="link" href="datatype-datetime.html" title="8.5. 日付/時刻データ型"><code class="type">timestamp</code></a>と
<code class="type">date</code>のISO形式以外の文字列で5桁以上の年を使用可能にしました。
(Bruce Momjian)
       </p></li><li class="listitem"><p><a class="link" href="datatype-datetime.html" title="8.5. 日付/時刻データ型"><code class="type">interval</code></a>値のオーバーフロー、アンダーフローのチェックを加えました。
(Bruce Momjian)
       </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.8.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.6.1. <a class="link" href="datatype-json.html" title="8.14. JSONデータ型"><acronym class="acronym">JSON</acronym></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>より高機能で効率的な<acronym class="acronym">JSON</acronym>文字列のデータ型<a class="link" href="datatype-json.html" title="8.14. JSONデータ型"><code class="type">jsonb</code></a>を追加しました。
(Oleg Bartunov, Teodor Sigaev, Alexander Korotkov, Peter Geoghegan, Andrew Dunstan)
        </p><p>この新しいデータ型は、JSON文書により高速にアクセスでき、また、JSON列により高速で有用なインデックス適用ができます。
従来の<code class="type">json</code>型がJSON文書全体をテキストとして格納するのに対し、
<code class="type">jsonb</code>文書のスカラ値は適当なSQLデータ型として格納され、JSON文書の構造は事前解析されます。
        </p></li><li class="listitem"><p>任意の複雑なJSONツリーを構築できる新たなJSON関数を追加しました。
(Andrew Dunstan, Laurence Rowe)
        </p><p>新たな関数には、
<a class="link" href="functions-json.html#FUNCTIONS-JSON-PROCESSING-TABLE" title="Table 9.46. JSON処理関数"><code class="function">json_array_elements_text()</code></a>、
<code class="function">json_build_array()</code>、<code class="function">json_object()</code>、
<code class="function">json_object_agg()</code>、<code class="function">json_to_record()</code>、
<code class="function">json_to_recordset()</code>が含まれます。
        </p></li><li class="listitem"><p><code class="type">json</code>値のデータ型を返す
<a class="link" href="functions-json.html#FUNCTIONS-JSON-PROCESSING-TABLE" title="Table 9.46. JSON処理関数"><code class="function">json_typeof()</code></a>を追加しました。
(Andrew Tipton)
        </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.56.5.9"><div class="titlepage"><div><div><h4 class="title">E.52.3.7. 関数</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>より柔軟に遅延を指定できる<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-DELAY" title="9.9.5. 遅延実行"><code class="function">pg_sleep_for(interval)</code></a>と<code class="function">pg_sleep_until(timestamp)</code>を追加しました。
(Vik Fearing, Julien Rouhaud)
       </p><p>既存の<code class="function">pg_sleep()</code>関数は秒指定の遅延のみをサポートしていました。
       </p></li><li class="listitem"><p>配列を引数とする<a class="link" href="functions-array.html#ARRAY-FUNCTIONS-TABLE" title="Table 9.49. 配列関数"><code class="function">cardinality()</code></a>関数を追加しました。
(Marko Tiikkaja)
       </p><p>この関数は、配列要素の総数、要素が無い場合にはゼロを返します。
       </p></li><li class="listitem"><p>任意のオフセットで<a class="link" href="lo-funcs.html" title="34.4. サーバ側の関数">ラージオブジェクトを読み書き</a>できる<acronym class="acronym">SQL</acronym>関数を追加しました。
(Pavel Stehule)
       </p></li><li class="listitem"><p><a class="link" href="functions-array.html#ARRAY-FUNCTIONS-TABLE" title="Table 9.49. 配列関数"><code class="function">unnest()</code></a>を複数引数をとれるようにしました。引数は各々に展開され、水平に結合されます。
(Andrew Gierth)
       </p></li><li class="listitem"><p>文字列ではなく個別の値から、<code class="type">time</code>、<code class="type">date</code>、<code class="type">timestamp</code>、<code class="type">timestamptz</code>、<code class="type">interval</code>の各データ型を構築する関数を追加しました。
(Pavel Stehule)
       </p><p>これらの関数には<code class="literal">make_</code>という接頭辞が付きます（例えば<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="Table 9.30. 日付/時刻関数"><code class="function">make_date()</code></a>）。
       </p></li><li class="listitem"><p><a class="link" href="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE" title="Table 9.23. 書式設定関数"><code class="function">to_char()</code></a>関数の<code class="literal">TZ</code>書式指示子が、数値であらわれたタイムゾーンオフセットに対して有効な値を返すようにしました。
(Tom Lane)
       </p><p>これまでは、
<code class="literal">timezone</code>に「<code class="literal">-4</code>」のような定数が設定されていると、
<code class="literal">to_char(CURRENT_TIMESTAMP, 'TZ')</code>が空文字列を返していました。
       </p></li><li class="listitem"><p><a class="link" href="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE" title="Table 9.23. 書式設定関数"><code class="function">to_char()</code></a>で
タイムゾーンオフセットの書式指示子「<code class="literal">OF</code>」がサポートされました。
(Bruce Momjian)
       </p></li><li class="listitem"><p><a class="link" href="functions-math.html#FUNCTIONS-MATH-RANDOM-TABLE" title="Table 9.6. 乱数関数"><code class="function">random()</code></a>
のランダムシードを改善しました。
(Honza Horak)
       </p></li><li class="listitem"><p><a class="link" href="functions-string.html#FUNCTIONS-STRING-OTHER" title="Table 9.9. その他の文字列関数"><code class="function">chr(int)</code></a>で
ユニコードのコードポイントの正当性チェックをより厳しくしました。
(Tom Lane)
       </p><p>本関数はRFC 3629に従ったUTF8文字のみを有効な値として受けるようになります。
       </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.9.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.7.1. システム情報関数</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>システムテーブル<code class="structname">pg_class</code>、<code class="structname">pg_proc</code>、<code class="structname">pg_type</code>、<code class="structname">pg_operator</code>を検索して、オブジェクトが無くてもエラーを返さない関数をいくつか追加しました。
(Yugo Nagata, Nozomi Anzai, Robert Haas)
       </p><p>例えば、<a class="link" href="functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE" title="Table 9.63. システムカタログ情報関数"><code class="function">to_regclass()</code></a>は<code class="structname">pg_class</code>を<code class="type">regclass</code>入力関数と同様に検索しますが、オブジェクトが無い場合には失敗するのでなくNULLを返します。
       </p></li><li class="listitem"><p>リレーション名をファイルノードからより効率的に検索できる<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-DBLOCATION" title="Table 9.85. データベースオブジェクト位置関数"><code class="function">pg_filenode_relation()</code></a>関数を追加しました。
(Andres Freund)
       </p></li><li class="listitem"><p><a class="link" href="infoschema-parameters.html" title="36.32. parameters"><code class="structname">information_schema.parameters</code></a>ビューに<code class="structfield">parameter_default</code>列を追加しました。
(Peter Eisentraut)
       </p></li><li class="listitem"><p><a class="link" href="infoschema-schemata.html" title="36.41. schemata"><code class="structname">information_schema.schemata</code></a>が全てのアクセス可能なスキーマを表示するようにしました。
(Peter Eisentraut)
       </p><p>これまでは現在ユーザが所有者のスキーマだけ表示していました。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.9.4"><div class="titlepage"><div><div><h5 class="title">E.52.3.7.2. 集約</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>どの行を集約関数に渡すかを制御する<a class="link" href="sql-expressions.html#SYNTAX-AGGREGATES" title="4.2.7. 集約式"><code class="literal">FILTER</code></a>句が追加されました。
(David Fetter)
       </p></li><li class="listitem"><p>順序付けされた集合(<a class="link" href="sql-expressions.html#SYNTAX-AGGREGATES" title="4.2.7. 集約式"><code class="literal">WITHIN GROUP</code></a>)の集約をサポートしました。
(Atri Sharma, Andrew Gierth, Tom Lane)
       </p></li><li class="listitem"><p>SQL標準の順序集合の集約関数
<a class="link" href="functions-aggregate.html#FUNCTIONS-ORDEREDSET-TABLE" title="Table 9.54. 順序集合集約関数"><code class="function">percentile_cont()</code></a>、
<code class="function">percentile_disc()</code>、
<code class="function">mode()</code>、
<a class="link" href="functions-aggregate.html#FUNCTIONS-HYPOTHETICAL-TABLE" title="Table 9.55. 仮想集合集約関数"><code class="function">rank()</code></a>、
<code class="function">dense_rank()</code>、
<code class="function">percent_rank()</code>、
<code class="function">cume_dist()</code>が追加されました。
(Atri Sharma, Andrew Gierth)
       </p></li><li class="listitem"><p>集約関数で<a class="link" href="xfunc-sql.html#XFUNC-SQL-VARIADIC-FUNCTIONS" title="37.4.5. 可変長引数を取るSQL関数"><code class="literal">VARIADIC</code></a>
をサポートしました。
(Tom Lane)
       </p></li><li class="listitem"><p>引数に多態集約が多態でない状態データ型を持てるようにしました。
(Tom Lane)
       </p><p>組み込みの<code class="function">array_agg()</code>のような集約関数をSQLで適切に宣言できるようになります。
       </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.56.5.10"><div class="titlepage"><div><div><h4 class="title">E.52.3.8. サーバサイド言語</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="plperl.html" title="Chapter 44. PL/Perl - Perl手続き言語">PL/Perl</a>と<a class="link" href="pltcl.html" title="Chapter 43. PL/Tcl - Tcl手続き言語">PL/Tcl</a>にイベントトリガのサポートを加えました。
(Dimitri Fontaine)
      </p></li><li class="listitem"><p><a class="link" href="datatype-numeric.html" title="8.1. 数値データ型"><code class="type">numeric</code></a>型の値を
<a class="link" href="plpython.html" title="Chapter 45. PL/Python - Python手続き言語">PL/Python</a>で<code class="type">decimal</code>型に変換するようにしました。
(Szymon Guz, Ronan Dunklau)
      </p><p>これまでは、値をPythonの<code class="type">float</code>型の値に変換していました。
      </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.10.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.8.1. <a class="link" href="plpgsql.html" title="Chapter 42. PL/pgSQL - SQL手続き言語">PL/pgSQL</a>サーバサイド言語</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="plpgsql-control-structures.html#PLPGSQL-CALL-STACK" title="42.6.7. 実行位置情報の取得"><code class="command">GET DIAGNOSTICS</code></a>
を使ってPL/pgSQLの現在のコールスタックを取得できるようにしました。
(Pavel Stehule, Stephen Frost)
       </p></li><li class="listitem"><p><code class="literal">STRICT</code>制約に違反したクエリを表示する
<a class="link" href="plpgsql-statements.html#PLPGSQL-STATEMENTS-SQL-ONEROW" title="42.5.3. 1行の結果を返す問い合わせの実行"><code class="option">print_strict_params</code></a>オプションを追加しました。
(Marko Tiikkaja)
       </p></li><li class="listitem"><p>追加的なPL/pgSQLの警告とエラーを有効にする
<a class="link" href="plpgsql-development-tips.html#PLPGSQL-EXTRA-CHECKS" title="42.11.2. コンパイル時の付加的チェック"><code class="varname">plpgsql.extra_warnings</code></a>変数、
<code class="varname">plpgsql.extra_errors</code>変数を追加しました。
(Marko Tiikkaja, Petr Jelinek)
       </p><p>いまのところ隠し変数についての警告、エラーが有効になるだけです。
       </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.56.5.11"><div class="titlepage"><div><div><h4 class="title">E.52.3.9. <a class="link" href="libpq.html" title="Chapter 33. libpq - C ライブラリ"><span class="application">libpq</span></a></h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>libpqの<a class="link" href="libpq-connect.html#LIBPQ-PQCONNDEFAULTS"><code class="function">PQconndefaults()</code></a>が
無効なサービスファイルを無視するようにしました。
(Steve Singer, Bruce Momjian)
       </p><p>これまでは、不正なサービスファイルに遭遇するとNULLを返していました。
       </p></li><li class="listitem"><p><code class="literal">TLSv1</code>以降バージョンの<acronym class="acronym">TLS</acronym>プロトコルを受け付けます。
(Marko Kreen)
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.56.5.12"><div class="titlepage"><div><div><h4 class="title">E.52.3.10. クライアントアプリケーション</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="app-createuser.html" title="createuser"><span class="refentrytitle"><span class="application">createuser</span></span></a>に、所属するロールを指定する<code class="option">-g</code>オプションを追加しました。
(Christopher Browne)
       </p></li><li class="listitem"><p><a class="xref" href="app-vacuumdb.html" title="vacuumdb"><span class="refentrytitle"><span class="application">vacuumdb</span></span></a>粒度を増やして複数段階で解析を行う<code class="option">--analyze-in-stages</code>オプションが追加されました。
       </p><p>これにより最小限の統計情報を素早く生成できます。
       </p></li><li class="listitem"><p><a class="link" href="app-pgresetwal.html" title="pg_resetwal"><span class="application">pg_resetxlog</span></a>が<code class="option">-n</code>オプションにて現在値ともしかすると変更された値を出力するようにしました。
(Rajeev Rastogi)
       </p></li><li class="listitem"><p><a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle">initdb</span></a>が誤ったロケール設定に黙って代替にデフォルトを選択するのでなくエラーを出すようにしました。
(Tom Lane)
       </p></li><li class="listitem"><p><a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a>がデータディレクトリにアクセスできないとき終了コード<code class="literal">4</code>を返すようにしました。
(Amit Kapila, Bruce Momjian)
       </p><p>この振る舞いはLinux Standard Base(<acronym class="acronym">LSB</acronym>)のコア仕様により厳密に適合します。
       </p></li><li class="listitem"><p>Windowsで相対パスで指定された<code class="option">-D</code>オプションを<a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a>のカレントディレクトリからの相対パスと解釈することを保証します。
(Kumar Rajeev Rastogi)
       </p><p>これまでは、元となるWindowsサービスが開始されたディレクトリを起点にして解釈されていました。
       </p></li><li class="listitem"><p><a class="link" href="ecpg.html" title="Chapter 35. ECPG - C言語による埋め込みSQL">ECPG</a>でC言語の配列定義に<code class="function">sizeof()</code>を使用可能にしました。
(Michael Meskes)
       </p></li><li class="listitem"><p><a class="link" href="ecpg.html" title="Chapter 35. ECPG - C言語による埋め込みSQL">ECPG</a>で入れ子になったC言語スタイルのコメントをC言語中でも
<acronym class="acronym">SQL</acronym>中でも適切に扱えるようにしました。
(Michael Meskes)
       </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.12.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.10.1. <a class="xref" href="app-psql.html" title="psql"><span class="refentrytitle"><span class="application">psql</span></span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">psql</span>の<a class="link" href="app-psql.html#APP-PSQL-META-COMMANDS" title="メタコマンド"><code class="option">expanded</code></a>
モードでfooterが無効であるときには、<span class="quote">“<span class="quote">No rows</span>”</span>出力を抑止します。
(Bruce Momjian)
       </p></li><li class="listitem"><p>コネクション開始時にハングアップしたとき、Control-C押下で終了できるようにしました。
(Peter Eisentraut)
       </p></li></ul></div><div class="sect5" id="id-1.11.6.56.5.12.3.3"><div class="titlepage"><div><div><h6 class="title">E.52.3.10.1.1. <a class="link" href="app-psql.html#APP-PSQL-META-COMMANDS" title="メタコマンド">バックスラッシュコマンド</a></h6></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">psql</span>の<code class="command">\db+</code>でテーブルスペースオプションが
表示されるようにしました。
(Magnus Hagander)
        </p></li><li class="listitem"><p><code class="command">\do+</code>で演算子を実装している関数が表示されるようにしました。
(Marko Tiikkaja)
        </p></li><li class="listitem"><p><code class="command">\d+</code>でテーブルに<code class="literal">oid</code>列がある場合だけ
<code class="literal">OID</code>行を表示するようにしました。
(Bruce Momjian)
        </p><p>これまでは<code class="literal">oid</code>列の有無にかかわらず常に報告されていました。
        </p></li><li class="listitem"><p><code class="command">\d</code>で無効になっているシステムトリガを表示するようにしました。
(Bruce Momjian)
        </p><p>これまでは、すべてのトリガを無効にした場合、ユーザトリガだけが無効であるものとして表示されていました。
        </p></li><li class="listitem"><p><code class="command">\copy</code>で「<code class="literal">stdin</code>」とセミコロンの間の空白を不要にしました。
(Etsuro Fujita)
        </p></li><li class="listitem"><p><code class="command">COPY</code>ですでにそうなっているように、
<code class="command">\copy</code>で最後に行数を出力します。
(Kumar Rajeev Rastogi)
        </p></li><li class="listitem"><p><code class="command">\conninfo</code>で<code class="literal">hostaddr</code>を使って接続した場合に
サーバの<acronym class="acronym">IP</acronym>アドレスを表示するように修正しました。
(Fujii Masao)
        </p><p>これまでは<code class="command">\conninfo</code>はこのようなケースでサーバの
<acronym class="acronym">IP</acronym>アドレスを表示できませんでした。
        </p></li><li class="listitem"><p><code class="command">\conninfo</code>で<acronym class="acronym">SSL</acronym>プロトコルバージョンを表示します。
(Marko Kreen)
        </p></li><li class="listitem"><p><code class="command">\pset</code>のためのタブ補完が追加しました。
(Pavel Stehule)
        </p></li><li class="listitem"><p>引数無しの<code class="command">\pset</code>で設定一覧を表示するようにしました。
(Gilles Darold)
        </p></li><li class="listitem"><p><code class="command">\s</code>で書き出すヒストリファイル名を絶対パスに変換せずに表示するようにしました。
(Tom Lane)
        </p><p>これまでのコードでは表示するのに相対パスを絶対パスに変換しようと試みていましたが、しばしば誤っていました。
        </p></li></ul></div></div></div><div class="sect4" id="id-1.11.6.56.5.12.4"><div class="titlepage"><div><div><h5 class="title">E.52.3.10.2. <a class="xref" href="app-pgdump.html" title="pg_dump"><span class="refentrytitle">pg_dump</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="app-pgrestore.html" title="pg_restore"><span class="refentrytitle">pg_restore</span></a>のオプション<code class="option">-I</code>、<code class="option">-P</code>、<code class="option">-T</code>、<code class="option">-n</code>を複数指定できるようにしました。
(Heikki Linnakangas)
       </p><p>これにより一度の操作で複数オブジェクトをリストアできます。
       </p></li><li class="listitem"><p>古いオブジェクトをリストア時に削除する場合にオプションで<code class="literal">IF EXISTS</code>句を<code class="command">DROP</code>コマンド出力に加えることができます。
(Pavel Stehule)
       </p><p>本変更は古いオブジェクトを削除する際に不要なエラーがでるのを防ぎます。
新たな<code class="option">--if-exists</code>オプションは、<a class="xref" href="app-pgdump.html" title="pg_dump"><span class="refentrytitle">pg_dump</span></a>、
<a class="xref" href="app-pg-dumpall.html" title="pg_dumpall"><span class="refentrytitle"><span class="application">pg_dumpall</span></span></a>、<a class="xref" href="app-pgrestore.html" title="pg_restore"><span class="refentrytitle">pg_restore</span></a>で
<code class="option">--clean</code>オプションも指定している場合に使用できます。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.12.5"><div class="titlepage"><div><div><h5 class="title">E.52.3.10.3. <a class="xref" href="app-pgbasebackup.html" title="pg_basebackup"><span class="refentrytitle">pg_basebackup</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">pg_basebackup</span>に<code class="filename">pg_xlog</code>ディレクトリを指定するオプション
<code class="option">--xlogdir</code>を追加しました。
(Haribabu Kommi)
       </p></li><li class="listitem"><p><span class="application">pg_basebackup</span>でバックアップコピー内のテーブルスペースを
新しい場所に移すことができます。
(Steeve Lennmark)
       </p><p>これは特に、プライマリと同マシンで<span class="application">pg_basebackup</span>を使用するときに便利です。
       </p></li><li class="listitem"><p>ネットワークストリーム経由のベースバックアップ取得を減速できるようにしました。
(Antonin Houska)
       </p><p><span class="application">pg_basebackup</span>の<code class="option">--max-rate</code>パラメータで制御できます。
       </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.56.5.13"><div class="titlepage"><div><div><h4 class="title">E.52.3.11. ソースコード</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>タプルを調査情報を保持して凍結する方法を改善しました。
(Robert Haas, Andres Freund)
       </p><p>この変更は、タプルをできるだけ早く凍結させることの難点を除去します。
タプルのフラグビットを解析するコードは修正が必要となります。
       </p></li><li class="listitem"><p>関数宣言には<a class="link" href="xfunc-c.html" title="37.9. C言語関数"><code class="function">PG_FUNCTION_INFO_V1</code></a>
マクロでの印づけを不要にしました。
(Peter Eisentraut)
       </p><p>本変更は定形的なプロトタイプ記述の必要を除去します。
なお、コンパイラ警告を避けるため、<code class="function">PG_FUNCTION_INFO_V1</code>
マクロは対応する関数定義の手前では必要です。
       </p></li><li class="listitem"><p><code class="varname">SnapshotNow</code>と<code class="function">HeapTupleSatisfiesNow()</code>を除去しました。
(Robert Haas)
       </p><p>既存の使用箇所はより適切なスナップショットタイプに切り替えられます。
これからはカタログスキャンに<acronym class="acronym">MVCC</acronym>スナップショットが使われます。
       </p></li><li class="listitem"><p>1GB以上のメモリ割り当てが可能な<acronym class="acronym">API</acronym>を追加しました。
(Noah Misch)
       </p></li><li class="listitem"><p>文字列構成用のメモリ割り当てを簡単にする<code class="function">psprintf()</code>を追加しました。
(Peter Eisentraut, Tom Lane)
       </p></li><li class="listitem"><p><code class="type">size_t</code>値を表示する
<code class="function">printf()</code>のサイズ修飾子<code class="literal">z</code>をサポートしました。
(Andres Freund)
       </p></li><li class="listitem"><p><code class="function">vsnprintf()</code>をよりよく使用するように
<code class="function">appendStringInfoVA()</code><acronym class="acronym">API</acronym>が変更されました。
(David Rowley, Tom Lane)
       </p></li><li class="listitem"><p>新たな種類の外部TOASTデータを作成できるようにしました。
(Andres Freund)
       </p></li><li class="listitem"><p>単一リーダ、単一ライタの軽量な共有メッセージキューを追加しました。
(Robert Haas)
       </p></li><li class="listitem"><p>x86_64 <acronym class="acronym">CPU</acronym>のスピンロックスピードを改善しました。
(Heikki Linnakangas)
       </p></li><li class="listitem"><p>サポートされないプラットフォーム<span class="productname">SINIX</span>、<span class="productname">Sun3</span>、<span class="productname">NS32K</span>のスピンロックサポートを除去しました。
(Robert Haas)
       </p></li><li class="listitem"><p><acronym class="acronym">IRIX</acronym>移植を無くしました。
(Robert Haas)
       </p></li><li class="listitem"><p><code class="option">--disable-spinlocks</code>指定でビルドしたことによる必要セマフォ数を減らしました。
(Robert Haas)
       </p></li><li class="listitem"><p><span class="application">duplicate_oids</span>シェルスクリプトを<span class="application">Perl</span>で書き直しました。
(Andrew Dunstan)
       </p></li><li class="listitem"><p>クライアントプログラムむけにTest Anything Protocol(<acronym class="acronym">TAP</acronym>)のテストを追加しました。
(Peter Eisentraut)
       </p><p>現在、これらのテストは<code class="literal">make check-world</code>で
<code class="option">--enable-tap-tests</code>が<span class="application">configure</span>に指定されたときのみ実行されます。
将来の機能リリースでデフォルトの振る舞いになるかもしれません。
       </p></li><li class="listitem"><p>makeターゲットに、選択した個々のテストを実行できる<code class="option">check-tests</code>と<code class="option">installcheck-tests</code>を追加しました。(Andrew Dunstan)
       </p></li><li class="listitem"><p>makefileルールの<code class="option">maintainer-check</code>を除去しました。
(Peter Eisentraut)
       </p><p>これからはデフォルトのビルドルールに以前はオプションであったテストが全て含まれます。
       </p></li><li class="listitem"><p><acronym class="acronym">PGXS</acronym>モジュールの<code class="envar">VPATH</code>ビルドのサポートを改善しました。
(Cédric Villemain, Andrew Dunstan, Peter Eisentraut)
       </p></li><li class="listitem"><p>Autoconf 2.69にアップグレードしました。
(Peter Eisentraut)
       </p></li><li class="listitem"><p><code class="envar">PG_VERSION</code>文字列に任意のカスタム文字列を追加できる<span class="application">configure</span>フラグを追加しました。
(Oskari Saarenmaa)
       </p><p>パッケージ製作者がカスタムバイナリを作るのに有用です。
       </p></li><li class="listitem"><p>DocBookの<acronym class="acronym">XML</acronym>検証が改善されました。
(Peter Eisentraut)
       </p></li><li class="listitem"><p><span class="productname">Coverity</span>スキャナーで報告された、多様な細かなセキュリティと健全性の問題を修正しました。
(Stephen Frost)
       </p></li><li class="listitem"><p><span class="productname">PostgreSQL</span>を<span class="application">Valgrind</span>でテストしたときの
不正なメモリ利用の検出を改善しました。
(Noah Misch)
       </p></li><li class="listitem"><p>サンプル<span class="application">Emacs</span>設定ファイル<code class="filename">emacs.samples</code>を改善しました。
(Peter Eisentraut)
       </p><p>また、<code class="filename">.dir-locals.el</code>をソースツリーのトップに加えました。
       </p></li><li class="listitem"><p><span class="application">pgindent</span>がtypedefsのコマンドラインリストを受け入れるようにしました。
(Bruce Momjian)
       </p></li><li class="listitem"><p><span class="application">pgindent</span>を条件プリプロセッサ周辺の空行についてより賢くしました。
(Bruce Momjian)
       </p></li><li class="listitem"><p><span class="productname">Cygwin</span>と<span class="productname">Mingw</span>でのビルドで
<code class="command">dlltool</code>をほとんど使用しないようにしました。
(Marco Atzeri, Hiroshi Inoue)
       </p></li><li class="listitem"><p><acronym class="acronym">MSVC</acronym>(Windows)ビルドでクライアントのみインストールをサポートしました。
(MauMau)
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.56.5.14"><div class="titlepage"><div><div><h4 class="title">E.52.3.12. 追加モジュール</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>サーバ起動時にリレーションデータを共有バッファに事前読み込みする<a class="xref" href="pgprewarm.html" title="F.28. pg_prewarm">pg_prewarm</a>拡張を追加しました。
(Robert Haas)
       </p><p>これにより素早く完全な運用性能に達することができます。
       </p></li><li class="listitem"><p><a class="xref" href="pgcrypto.html" title="F.26. pgcrypto">pgcrypto</a>に
<acronym class="acronym">UUID</acronym>乱数を生成をする<code class="function">gen_random_uuid()</code>を追加しました。
(Oskari Saarenmaa)
       </p><p><a class="xref" href="uuid-ossp.html" title="F.45. uuid-ossp">uuid-ossp</a>をインストールすることなく、
バージョン 4 <acronym class="acronym">UUID</acronym>が生成可能です。
       </p></li><li class="listitem"><p><a class="xref" href="uuid-ossp.html" title="F.45. uuid-ossp">uuid-ossp</a>が<span class="systemitem">OSSP</span>UUIDライブラリだけでなく、
<span class="systemitem">BSD</span>や<span class="systemitem">e2fsprogs</span>のUUIDライブラリで動作するようにしました。
(Matteo Beccati)
       </p><p>この改善は、もはや廃れつつあるOSSPライブラリを必要としないので、
<span class="application">uuid-ossp</span>モジュールの移植性を改善します。
モジュール名は今や不適切ですが変更しないつもりです。
       </p></li><li class="listitem"><p><a class="xref" href="auto-explain.html" title="F.4. auto_explain">auto_explain</a>に実行時間を含めるオプションを追加しました。
(Horiguchi Kyotaro)
       </p></li><li class="listitem"><p>コミットされていないトランザクションの行をdeadと報告しないように
<a class="xref" href="pgstattuple.html" title="F.31. pgstattuple">pgstattuple</a>を修正しました。
(Robert Haas)
       </p></li><li class="listitem"><p><a class="xref" href="pgstattuple.html" title="F.31. pgstattuple">pgstattuple</a>関数が<code class="type">regclass</code>型の引数を使うようにしました。
(Satoshi Nagayasu)
       </p><p>しばらくは<code class="type">text</code>型引数も未だサポートしますが、将来のメジャーリリースで除かれるでしょう。
       </p></li><li class="listitem"><p>スナップショット規則を一貫して尊重して<a class="xref" href="pgrowlocks.html" title="F.29. pgrowlocks">pgrowlocks</a>
出力の一貫性を改善しました。
(Robert Haas)
       </p></li><li class="listitem"><p><a class="xref" href="pgtrgm.html" title="F.32. pg_trgm">pg_trgm</a>でインデックス付けされた正規表現検索のためのトライグラム選択を
改善しました。
(Alexander Korotkov)
       </p><p>本変更は通常低い選択性である空白文字を含むトライグラムの使用を抑止します。
       </p></li><li class="listitem"><p><a class="link" href="pgwaldump.html" title="pg_waldump"><span class="application">pg_xlogdump</span></a>が<code class="option">--follow</code>オプションで活動中のログストリームについて報告できるようにしました。
(Heikki Linnakangas)
       </p></li><li class="listitem"><p><a class="xref" href="cube.html" title="F.10. cube">cube</a>データをより小さく格納します。
(Stas Kelvich)
       </p><p>既存データはダンプ、リストアで新フォーマットにする必要があります。
旧フォーマットも未だ読み取り可能です。
       </p></li><li class="listitem"><p>カーソルを使うことで<a class="xref" href="vacuumlo.html" title="vacuumlo"><span class="refentrytitle"><span class="application">vacuumlo</span></span></a>のクライアント側メモリ使用量を減らしました。
(Andrew Dunstan)
       </p></li><li class="listitem"><p><a class="xref" href="pgupgrade.html" title="pg_upgrade"><span class="refentrytitle"><span class="application">pg_upgrade</span></span></a>のメモリ使用量を大幅に削減しました。
(Bruce Momjian)
       </p></li><li class="listitem"><p><a class="xref" href="pgupgrade.html" title="pg_upgrade"><span class="refentrytitle"><span class="application">pg_upgrade</span></span></a>でユーザ指定する<code class="option">-U</code>オプションを
生成される解析スクリプトに渡すようにしました。
(Bruce Momjian)
       </p></li></ul></div><div class="sect4" id="id-1.11.6.56.5.14.3"><div class="titlepage"><div><div><h5 class="title">E.52.3.12.1. <a class="xref" href="pgbench.html" title="pgbench"><span class="refentrytitle"><span class="application">pgbench</span></span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">pgbench</span>スクリプトの行の長さ制限をなくしました。
(Sawada Masahiko)
       </p><p>以前は<code class="envar">BUFSIZ</code>が行の長さの上限でした。
       </p></li><li class="listitem"><p><span class="application">pgbench</span>に長いオプション名を追加しました。
(Fabien Coelho)
       </p></li><li class="listitem"><p><span class="application">pgbench</span>にトランザクション速度を指定する<code class="option">--rate</code>オプションを追加しました。
(Fabien Coelho)
       </p></li><li class="listitem"><p><span class="application">pgbench</span>に定期的に進行報告を表示する<code class="option">--progress</code>オプションを追加しました。
(Fabien Coelho)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.56.5.14.4"><div class="titlepage"><div><div><h5 class="title">E.52.3.12.2. <a class="xref" href="pgstatstatements.html" title="F.30. pg_stat_statements">pg_stat_statements</a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">pg_stat_statements</span>がクエリ文字列の格納のために
共有メモリではなくファイルを使うようにしました。
(Peter Geoghegan)
       </p><p>これにより、クエリ文字列の長さの制限をなくし、デフォルトでこれまでより
たくさんの異なるステートメントを追跡できるようにしました。
       </p></li><li class="listitem"><p><span class="application">pg_stat_statements</span>の内部クエリハッシュ識別子の報告を
できるようにしました。
(Daniel Farina, Sameer Thakur, Peter Geoghegan)
       </p></li><li class="listitem"><p>クエリ文字列以外にのすべての情報について<span class="application">pg_stat_statements</span>を
取り出す機能を追加しました。
(Peter Geoghegan)
       </p><p>これにより、モニタリングツールが作成されたばかりのエントリをフェッチできるようになり、統計情報のために繰り返すクエリの性能を高めます。
       </p></li><li class="listitem"><p><span class="application">pg_stat_statements</span>が<code class="command">DEALLOCATE</code>コマンドを
無視するようにしました。
(Fabien Coelho)
       </p><p>すでに<code class="command">PREPARE</code>を無視するようになっていますので、より一貫性を高めます。
       </p></li><li class="listitem"><p>サーバシャットダウン時に、統計ファイルを<code class="filename">$PGDATA/global</code>ではなく、<code class="filename">$PGDATA/pg_stat</code>に保存します。
(Fujii Masao)
       </p></li></ul></div></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-9-4-1.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-9-3-24.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.51. リリース9.4.1 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.53. Release 9.3.24</td></tr></table></div></body></html>