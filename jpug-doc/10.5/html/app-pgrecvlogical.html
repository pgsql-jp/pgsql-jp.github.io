<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>pg_recvlogical</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="app-pgreceivewal.html" title="pg_receivewal" /><link rel="next" href="app-pgrestore.html" title="pg_restore" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center"><span xmlns="http://www.w3.org/1999/xhtml" class="application">pg_recvlogical</span></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="app-pgreceivewal.html" title="pg_receivewal">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="reference-client.html" title="PostgreSQLクライアントアプリケーション">Up</a></td><th width="60%" align="center">PostgreSQLクライアントアプリケーション</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="app-pgrestore.html" title="pg_restore">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="APP-PGRECVLOGICAL"><div class="titlepage"></div><a id="id-1.9.4.16.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle"><span class="application">pg_recvlogical</span></span></h2><p>pg_recvlogical — <span class="productname">PostgreSQL</span>のストリームの論理デコードを制御する</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p id="id-1.9.4.16.4.1"><code class="command">pg_recvlogical</code> [<em class="replaceable"><code>option</code></em>...]</p></div></div><div class="refsect1" id="id-1.9.4.16.5"><h2>説明</h2><p><code class="command">pg_recvlogical</code>はレプリケーションスロットの論理デコードを制御し、またレプリケーションスロットからデータを流します。
  </p><p>これはレプリケーションモードの接続をするため、<a class="xref" href="app-pgreceivewal.html" title="pg_receivewal"><span class="refentrytitle">pg_receivewal</span></a>と同じ制約に加えて、論理レプリケーション(<a class="xref" href="logicaldecoding.html" title="Chapter 48. ロジカルデコーディング">Chapter 48</a>を参照)と同じ制約も受けます。
  </p><p><code class="command">pg_recvlogical</code>には、論理デコードのSQLインタフェースのpeekとgetのモードに対応するものがありません。
データを受信する度、および終了時にダラダラとその再生確認を送信します。
スロット上の未処理のデータを処理せずに検査するには、<a class="link" href="functions-admin.html#FUNCTIONS-REPLICATION" title="9.26.6. レプリケーション関数"><code class="function">pg_logical_slot_peek_changes</code></a>を使用してください。
  </p></div><div class="refsect1" id="id-1.9.4.16.6"><h2>オプション</h2><p>動作を選択するため、以下のオプションのうち少なくとも1つを指定しなければなりません。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">--create-slot</code></span></dt><dd><p>新しい論理レプリケーションスロットを<code class="option">--slot</code>で指定した名前で、<code class="option">--plugin</code>の出力プラグインを使い、<code class="option">--dbname</code>で指定したデータベースに対して作成します。
       </p></dd><dt><span class="term"><code class="option">--drop-slot</code></span></dt><dd><p><code class="option">--slot</code>で指定された名前のレプリケーションスロットを削除して、終了します。
       </p></dd><dt><span class="term"><code class="option">--start</code></span></dt><dd><p><code class="option">--slot</code>で指定した論理レプリケーションスロットからストリームの変更を開始し、シグナルを受けて終了するまで継続します。
サーバ側の変更ストリームがサーバのシャットダウンまたは接続断によって終了した場合は、<code class="option">--no-loop</code>が指定されていなければ、ループ内でリトライします。
       </p><p>ストリームのフォーマットは、スロットが作成された時に指定された出力プラグインによって決定されます。
       </p><p>接続はスロットの作成時に使用したのと同じデータベースに対してでなければなりません。
       </p></dd></dl></div><p>
   </p><p><code class="option">--create-slot</code>と<code class="option">--start</code>は同時に指定することができます。
<code class="option">--drop-slot</code>は他の動作と組み合わせることができません。
   </p><p>以下のコマンド行オプションは出力の場所とフォーマット、およびその他のレプリケーションの動作を制御します。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-E <em class="replaceable"><code>lsn</code></em></code><br /></span><span class="term"><code class="option">--endpos=<em class="replaceable"><code>lsn</code></em></code></span></dt><dd><p><code class="option">--start</code>モードでは、自動的にレプリケーションを停止し、受信が指定のLSNに到達したら正常な終了ステータス0で終了します。
<code class="option">--start</code>以外のモードの時に指定された場合は、エラーが発生します。
       </p><p>LSNが<em class="replaceable"><code>lsn</code></em>と正確に一致するレコードがある場合、そのレコードは出力されます。
       </p><p><code class="option">--endpos</code>オプションはトランザクションの境界を意識しないため、トランザクションの途中で出力を切り捨てるかもしれません。
部分的に出力されたトランザクションはいずれも処理されず、スロットが次回、読み込まれた時に再び再生されます。
個々のメッセージが切り捨てられることはありません。
       </p></dd><dt><span class="term"><code class="option">-f <em class="replaceable"><code>filename</code></em></code><br /></span><span class="term"><code class="option">--file=<em class="replaceable"><code>filename</code></em></code></span></dt><dd><p>受け取り、デコードしたトランザクションデータをこのファイルに書き込みます。
<span class="systemitem">stdout</span>に出力するには<code class="literal">-</code>を使います。
       </p></dd><dt><span class="term"><code class="option">-F <em class="replaceable"><code>interval_seconds</code></em></code><br /></span><span class="term"><code class="option">--fsync-interval=<em class="replaceable"><code>interval_seconds</code></em></code></span></dt><dd><p>出力ファイルがディスクに安全にフラッシュされることを確実にするため、<span class="application">pg_recvlogical</span>が<code class="function">fsync()</code>の呼び出しを実行する頻度を指定します。
       </p><p>サーバはクライアントに対して、フラッシュを実行し、またフラッシュ位置をサーバに報告するように、ときどき要求します。
この設定はそれに加えて、フラッシュをより高頻度で実行するものです。
       </p><p><code class="literal">0</code>という間隔を指定すると、<code class="function">fsync()</code>の呼び出しをまったく実行しなくなりますが、それでも状況をサーバに報告はします。
この場合、クラッシュするとデータが失われるかもしれません。
       </p></dd><dt><span class="term"><code class="option">-I <em class="replaceable"><code>lsn</code></em></code><br /></span><span class="term"><code class="option">--startpos=<em class="replaceable"><code>lsn</code></em></code></span></dt><dd><p><code class="option">--start</code>モードでは、レプリケーションを指定のLSNから開始します。
この効果の詳細については<a class="xref" href="logicaldecoding.html" title="Chapter 48. ロジカルデコーディング">Chapter 48</a>および<a class="xref" href="protocol-replication.html" title="52.4. ストリーミングレプリケーションプロトコル">Section 52.4</a>を参照してください。
その他のモードでは無視されます。
       </p></dd><dt><span class="term"><code class="option">--if-not-exists</code></span></dt><dd><p><code class="option">--create-slot</code>が指定され、指定された名前のスロットが既に存在している場合に、エラーを発生させません。
       </p></dd><dt><span class="term"><code class="option">-n</code><br /></span><span class="term"><code class="option">--no-loop</code></span></dt><dd><p>サーバへの接続が失われたとき、ループ内でリトライせず、単に終了します。
       </p></dd><dt><span class="term"><code class="option">-o <em class="replaceable"><code>name</code></em>[=<em class="replaceable"><code>value</code></em>]</code><br /></span><span class="term"><code class="option">--option=<em class="replaceable"><code>name</code></em>[=<em class="replaceable"><code>value</code></em>]</code></span></dt><dd><p>オプション<em class="replaceable"><code>name</code></em>と(指定されていれば)オプション値<em class="replaceable"><code>value</code></em>を出力プラグインに渡します。
存在するオプションとその効果は、利用する出力プラグインに依存します。
       </p></dd><dt><span class="term"><code class="option">-P <em class="replaceable"><code>plugin</code></em></code><br /></span><span class="term"><code class="option">--plugin=<em class="replaceable"><code>plugin</code></em></code></span></dt><dd><p>スロットを作成するとき、指定された論理デコードの出力プラグインを使います。
<a class="xref" href="logicaldecoding.html" title="Chapter 48. ロジカルデコーディング">Chapter 48</a>を参照してください。
このオプションは、スロットが既に存在する時は、何の効果もありません。
       </p></dd><dt><span class="term"><code class="option">-s <em class="replaceable"><code>interval_seconds</code></em></code><br /></span><span class="term"><code class="option">--status-interval=<em class="replaceable"><code>interval_seconds</code></em></code></span></dt><dd><p>このオプションは<a class="xref" href="app-pgreceivewal.html" title="pg_receivewal"><span class="refentrytitle">pg_receivewal</span></a>の同じ名前のオプションと同じ効果があります。
そちらの説明を参照してください。
       </p></dd><dt><span class="term"><code class="option">-S <em class="replaceable"><code>slot_name</code></em></code><br /></span><span class="term"><code class="option">--slot=<em class="replaceable"><code>slot_name</code></em></code></span></dt><dd><p><code class="option">--start</code>モードでは、<em class="replaceable"><code>slot_name</code></em>という名前の既存の論理レプリケーションスロットを使います。
<code class="option">--create-slot</code>では、この名前のスロットを作成します。
<code class="option">--drop-slot</code>モードでは、この名前のスロットを削除します。
       </p></dd><dt><span class="term"><code class="option">-v</code><br /></span><span class="term"><code class="option">--verbose</code></span></dt><dd><p>冗長モードを有効にします。
       </p></dd></dl></div><p>
   </p><p>以下のコマンド行オプションはデータベース接続パラメータを制御します。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-d <em class="replaceable"><code>database</code></em></code><br /></span><span class="term"><code class="option">--dbname=<em class="replaceable"><code>database</code></em></code></span></dt><dd><p>接続するデータベースです。
この意味の詳細は動作の説明を参照してください。
<span class="application">libpq</span>の接続文字列とすることもできます。
詳細は<a class="xref" href="libpq-connect.html#LIBPQ-CONNSTRING" title="33.1.1. 接続文字列">Section 33.1.1</a>を参照してください。
デフォルトはユーザ名です。
        </p></dd><dt><span class="term"><code class="option">-h <em class="replaceable"><code>hostname-or-ip</code></em></code><br /></span><span class="term"><code class="option">--host=<em class="replaceable"><code>hostname-or-ip</code></em></code></span></dt><dd><p>サーバが動作しているマシンのホスト名を指定します。
値がスラッシュで始まるときは、Unixドメインソケットのディレクトリとみなされます。
デフォルト値は、環境変数<code class="envar">PGHOST</code>が設定されていればそれが使用され、設定されていなければUnixドメインソケット接続を試みます。
        </p></dd><dt><span class="term"><code class="option">-p <em class="replaceable"><code>port</code></em></code><br /></span><span class="term"><code class="option">--port=<em class="replaceable"><code>port</code></em></code></span></dt><dd><p>サーバが接続を監視しているTCPポート番号またはローカルのUnixドメインソケットのファイル拡張子を指定します。
デフォルトは環境変数<code class="envar">PGPORT</code>が設定されていればそれを使用し、そうでなければコンパイル時に設定されたデフォルト値です。
        </p></dd><dt><span class="term"><code class="option">-U <em class="replaceable"><code>user</code></em></code><br /></span><span class="term"><code class="option">--username=<em class="replaceable"><code>user</code></em></code></span></dt><dd><p>接続で使用するユーザ名です。
デフォルトは現在のOSのユーザ名です。
        </p></dd><dt><span class="term"><code class="option">-w</code><br /></span><span class="term"><code class="option">--no-password</code></span></dt><dd><p>パスワード入力を促しません。
サーバがパスワード認証を必要とし、<code class="filename">.pgpass</code>ファイルなど他の手段によるパスワードが利用できない場合は、接続試行は失敗します。
このオプションはバッチジョブやスクリプトなど、パスワードを入力するユーザがいない場合に有用でしょう。
        </p></dd><dt><span class="term"><code class="option">-W</code><br /></span><span class="term"><code class="option">--password</code></span></dt><dd><p><span class="application">pg_recvlogical</span>がデータベースに接続する前に、強制的にパスワード入力を促します。
        </p><p>サーバがパスワード認証を要求する場合、<span class="application">pg_recvlogical</span>は自動的にパスワード入力を促しますから、このオプションは本質的ではありません。
しかし、サーバがパスワードを必要とすることを確認するために<span class="application">pg_recvlogical</span>が無駄な接続試行を行うことになります。
無駄な接続試行を避けるために<code class="option">-W</code>を指定するのが有効になる場合もあるでしょう。
        </p></dd></dl></div><p>
   </p><p>この他に、以下のオプションが利用できます。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-V</code><br /></span><span class="term"><code class="option">--version</code></span></dt><dd><p><span class="application">pg_recvlogical</span>のバージョンを出力して、終了します。
       </p></dd><dt><span class="term"><code class="option">-?</code><br /></span><span class="term"><code class="option">--help</code></span></dt><dd><p><span class="application">pg_recvlogical</span>のコマンド行引数に関するヘルプを表示して、終了します。
        </p></dd></dl></div><p>
   </p></div><div class="refsect1" id="id-1.9.4.16.7"><h2>環境</h2><p>このユーティリティは、他のほとんどの<span class="productname">PostgreSQL</span>ユーティリティと同様、<span class="application">libpq</span>でサポートされる環境変数を使用します。
(<a class="xref" href="libpq-envars.html" title="33.14. 環境変数">Section 33.14</a>を参照してください)。
  </p></div><div class="refsect1" id="id-1.9.4.16.8"><h2>例</h2><p>例については<a class="xref" href="logicaldecoding-example.html" title="48.1. ロジカルデコーディングの例">Section 48.1</a>を参照してください。
  </p></div><div class="refsect1" id="id-1.9.4.16.9"><h2>関連項目</h2><span class="simplelist"><a class="xref" href="app-pgreceivewal.html" title="pg_receivewal"><span class="refentrytitle">pg_receivewal</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="app-pgreceivewal.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-client.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="app-pgrestore.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">pg_receivewal </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> pg_restore</td></tr></table></div></body></html>