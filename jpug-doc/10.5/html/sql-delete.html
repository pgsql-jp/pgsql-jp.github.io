<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>DELETE</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="sql-declare.html" title="DECLARE" /><link rel="next" href="sql-discard.html" title="DISCARD" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">DELETE</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-declare.html" title="DECLARE">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="SQLコマンド">Up</a></td><th width="60%" align="center">SQLコマンド</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-discard.html" title="DISCARD">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="SQL-DELETE"><div class="titlepage"></div><a id="id-1.9.3.96.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">DELETE</span></h2><p>DELETE — テーブルから行を削除する</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="synopsis">[ WITH [ RECURSIVE ] <em class="replaceable"><code>with_query</code></em> [, ...] ]
DELETE FROM [ ONLY ] <em class="replaceable"><code>table_name</code></em> [ * ] [ [ AS ] <em class="replaceable"><code>alias</code></em> ]
    [ USING <em class="replaceable"><code>using_list</code></em> ]
    [ WHERE <em class="replaceable"><code>condition</code></em> | WHERE CURRENT OF <em class="replaceable"><code>cursor_name</code></em> ]
    [ RETURNING * | <em class="replaceable"><code>output_expression</code></em> [ [ AS ] <em class="replaceable"><code>output_name</code></em> ] [, ...] ]</pre></div><div class="refsect1" id="id-1.9.3.96.5"><h2>説明</h2><p><code class="command">DELETE</code>は、指定したテーブルから<code class="literal">WHERE</code>句を満たす行を削除します。
<code class="literal">WHERE</code>がない場合、指定したテーブルの全ての行を削除することになります。
この結果、そのテーブルは存在するが中身が空のテーブルになります。
  </p><div class="tip"><h3 class="title">Tip</h3><p><a class="xref" href="sql-truncate.html" title="TRUNCATE"><span class="refentrytitle">TRUNCATE</span></a>は、より高速に、テーブルから全ての行を削除する仕組みを提供します。
    </p></div><p>データベース内のほかのテーブルに含まれる情報を用いてテーブル内の行を削除する方法には、副問い合わせと<code class="literal">USING</code>句で追加テーブルを指定する方法の2つがあります。
どちらの技法が適切かはその状況によります。
  </p><p><code class="literal">RETURNING</code>句を指定すると、<code class="command">DELETE</code>は実際に削除された各行に基づいて計算された値を返すようになります。
そのテーブルの列、<code class="literal">USING</code>で指定された他のテーブルの列、あるいは、その両方を使用した式を計算することができます。
<code class="literal">RETURNING</code>リストの構文は<code class="command">SELECT</code>の出力リストと同一です。
  </p><p>削除を実行するには、そのテーブルの<code class="literal">DELETE</code>権限が必要です。
また、<code class="literal">USING</code>句内のテーブルに対する<code class="literal">SELECT</code>権限、および、<em class="replaceable"><code>condition</code></em>で使用する値を読み取るために、その値が含まれるテーブルに対する<code class="literal">SELECT</code>権限も必要です。
  </p></div><div class="refsect1" id="id-1.9.3.96.6"><h2>パラメータ</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>with_query</code></em></span></dt><dd><p><code class="literal">WITH</code>句により<code class="command">DELETE</code>問い合わせ内で名前で参照可能な１つ以上の副問い合わせを指定することができます。
詳しくは<a class="xref" href="queries-with.html" title="7.8. WITH問い合わせ（共通テーブル式）">Section 7.8</a>と<a class="xref" href="sql-select.html" title="SELECT"><span class="refentrytitle">SELECT</span></a>を参照してください。
     </p></dd><dt><span class="term"><em class="replaceable"><code>table_name</code></em></span></dt><dd><p>行を削除するテーブルの名前です（スキーマ修飾名も可）。
テーブル名の前に<code class="literal">ONLY</code>が指定された場合、そのテーブルでのみマッチする行が削除されます。
<code class="literal">ONLY</code>が指定されていない場合、そのテーブルおよび（もしあれば）そのテーブルを継承する全てのテーブルから一致する行が削除されます。
オプションで、テーブル名の後に<code class="literal">*</code>を指定することで、明示的に継承するテーブルも含まれることを示すことができます。
     </p></dd><dt><span class="term"><em class="replaceable"><code>alias</code></em></span></dt><dd><p>対象テーブルの別名です。
別名が与えられた場合、実際のテーブル名は完全に隠蔽されます。
たとえば、<code class="literal">DELETE FROM foo AS f</code>とあるとき、この<code class="command">DELETE</code>文の残りの部分ではこのテーブルを<code class="literal">foo</code>ではなく<code class="literal">f</code>として参照しなければなりません。
     </p></dd><dt><span class="term"><em class="replaceable"><code>using_list</code></em></span></dt><dd><p><code class="literal">WHERE</code>条件内に他のテーブルの列を記述できるようにするための、テーブル式のリストです。
これは、<code class="command">SELECT</code>文の<a class="xref" href="sql-select.html#SQL-FROM" title="FROM句"><code class="literal">FROM</code>句</a>において指定できるテーブルのリストと似ています。
例えば、テーブル名の別名も指定することができます。
自己結合を設定する目的以外では<em class="replaceable"><code>using_list</code></em>に対象のテーブルを繰り返さないでください。
     </p></dd><dt><span class="term"><em class="replaceable"><code>condition</code></em></span></dt><dd><p><code class="type">boolean</code>型の値を返す式です。
この式が<code class="literal">true</code>を返す行のみが削除されます。
     </p></dd><dt><span class="term"><em class="replaceable"><code>cursor_name</code></em></span></dt><dd><p><code class="literal">WHERE CURRENT OF</code>条件で使用されるカーソルの名前です。
削除対象の行は、そのカーソルからもっとも最近に取り出される行です。
カーソルは、<code class="command">DELETE</code>の対象テーブルに対するグループ化のない問い合わせでなければなりません。
<code class="literal">WHERE CURRENT OF</code>を論理条件といっしょに指定することはできません。
<code class="literal">WHERE CURRENT OF</code>付きのカーソルの使用に関する情報については<a class="xref" href="sql-declare.html" title="DECLARE"><span class="refentrytitle">DECLARE</span></a>を参照してください。
     </p></dd><dt><span class="term"><em class="replaceable"><code>output_expression</code></em></span></dt><dd><p>各行を削除した後に<code class="command">DELETE</code>によって計算され、返される式です。
この式には、<em class="replaceable"><code>table_name</code></em>で指名したテーブルまたは<code class="literal">USING</code>で指定したテーブルの任意の列名を使用することができます。
すべての列を返す場合は<code class="literal">*</code>と記載してください。
     </p></dd><dt><span class="term"><em class="replaceable"><code>output_name</code></em></span></dt><dd><p>返される列で使用される名前です。
     </p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.96.7"><h2>出力</h2><p>正常に終了した場合、<code class="command">DELETE</code>コマンドは以下の形式のコマンドタグを返します。
</p><pre class="screen">DELETE <em class="replaceable"><code>count</code></em></pre><p>
<em class="replaceable"><code>count</code></em>は削除した行数です。
この数は、<code class="literal">BEFORE DELETE</code>トリガによって削除が抑止された場合、<em class="replaceable"><code>condition</code></em>に合致した行より少なくなる可能性があることに注意してください。
<em class="replaceable"><code>count</code></em>が0の場合、<em class="replaceable"><code>condition</code></em>を満たす行が存在しなかったことを示します
（これはエラーとはみなされません）。
  </p><p><code class="command">DELETE</code>コマンドが<code class="literal">RETURNING</code>句を持つ場合、その結果は、<code class="literal">RETURNING</code>リストで定義した列と値を持ち、そのコマンドで削除された行全体に対して計算を行う<code class="command">SELECT</code>文の結果と似たものになるでしょう。
  </p></div><div class="refsect1" id="id-1.9.3.96.8"><h2>注釈</h2><p><span class="productname">PostgreSQL</span>では、<code class="literal">USING</code>句で他のテーブルを指定することで、<code class="literal">WHERE</code>条件内で他のテーブルを参照することができます。
例えば、指定したプロデューサが製作した全ての映画を削除する時は、次のようなコマンドを実行します。
</p><pre class="programlisting">DELETE FROM films USING producers
  WHERE producer_id = producers.id AND producers.name = 'foo';</pre><p>
ここでは、<code class="structname">films</code>と<code class="structname">producers</code>とを結合して、<code class="structname">films</code>行に削除用の印を付けるという作業を行っています。
この構文は標準に従ったものではありません。
より標準的な方法は以下の通りです。
</p><pre class="programlisting">DELETE FROM films
  WHERE producer_id IN (SELECT id FROM producers WHERE name = 'foo');</pre><p>
副問い合わせ形式より結合形式の方が書き易い、あるいは、実行が速くなることがあります。
  </p></div><div class="refsect1" id="id-1.9.3.96.9"><h2>例</h2><p>ミュージカル以外の全ての映画を削除します。

</p><pre class="programlisting">DELETE FROM films WHERE kind &lt;&gt; 'Musical';</pre><p>
  </p><p><code class="literal">films</code>テーブルを空にします。
</p><pre class="programlisting">DELETE FROM films;</pre><p>
  </p><p>完了した作業（statusがDONE）を削除し、削除された行のすべての詳細を返します。
</p><pre class="programlisting">DELETE FROM tasks WHERE status = 'DONE' RETURNING *;</pre><p>
  </p><p><code class="structname">tasks</code>において<code class="literal">c_tasks</code>カーソルが現在位置している行を削除します。
</p><pre class="programlisting">DELETE FROM tasks WHERE CURRENT OF c_tasks;</pre></div><div class="refsect1" id="id-1.9.3.96.10"><h2>互換性</h2><p>このコマンドは標準SQLに準拠しています。
ただし、<code class="literal">USING</code>句と<code class="literal">RETURNING</code>句は<span class="productname">PostgreSQL</span>の拡張です。
<code class="command">DELETE</code>で<code class="literal">WITH</code>が使用可能であることも同様に拡張です。
  </p></div><div class="refsect1" id="id-1.9.3.96.11"><h2>関連項目</h2><span class="simplelist"><a class="xref" href="sql-truncate.html" title="TRUNCATE"><span class="refentrytitle">TRUNCATE</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-declare.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-discard.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">DECLARE </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> DISCARD</td></tr></table></div></body></html>