<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ALTER ROLE</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="sql-alterpublication.html" title="ALTER PUBLICATION" /><link rel="next" href="sql-alterrule.html" title="ALTER RULE" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">ALTER ROLE</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-alterpublication.html" title="ALTER PUBLICATION">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="SQLコマンド">Up</a></td><th width="60%" align="center">SQLコマンド</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-alterrule.html" title="ALTER RULE">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="SQL-ALTERROLE"><div class="titlepage"></div><a id="id-1.9.3.25.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">ALTER ROLE</span></h2><p>ALTER ROLE — データベースロールを変更する</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="synopsis">ALTER ROLE <em class="replaceable"><code>role_specification</code></em> [ WITH ] <em class="replaceable"><code>option</code></em> [ ... ]

<span class="phrase">ここで<em class="replaceable"><code>option</code></em>は以下の通りです。</span>

      SUPERUSER | NOSUPERUSER
    | CREATEDB | NOCREATEDB
    | CREATEROLE | NOCREATEROLE
    | INHERIT | NOINHERIT
    | LOGIN | NOLOGIN
    | REPLICATION | NOREPLICATION
    | BYPASSRLS | NOBYPASSRLS
    | CONNECTION LIMIT <em class="replaceable"><code>connlimit</code></em>
    | [ ENCRYPTED ] PASSWORD '<em class="replaceable"><code>password</code></em>'
    | VALID UNTIL '<em class="replaceable"><code>timestamp</code></em>'

ALTER ROLE <em class="replaceable"><code>name</code></em> RENAME TO <em class="replaceable"><code>new_name</code></em>

ALTER ROLE { <em class="replaceable"><code>role_specification</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>database_name</code></em> ] SET <em class="replaceable"><code>configuration_parameter</code></em> { TO | = } { <em class="replaceable"><code>value</code></em> | DEFAULT }
ALTER ROLE { <em class="replaceable"><code>role_specification</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>database_name</code></em> ] SET <em class="replaceable"><code>configuration_parameter</code></em> FROM CURRENT
ALTER ROLE { <em class="replaceable"><code>role_specification</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>database_name</code></em> ] RESET <em class="replaceable"><code>configuration_parameter</code></em>
ALTER ROLE { <em class="replaceable"><code>role_specification</code></em> | ALL } [ IN DATABASE <em class="replaceable"><code>database_name</code></em> ] RESET ALL

<span class="phrase">ここで<em class="replaceable"><code>role_specification</code></em>は以下の通りです。</span>

    <em class="replaceable"><code>role_name</code></em>
  | CURRENT_USER
  | SESSION_USER</pre></div><div class="refsect1" id="id-1.9.3.25.5"><h2>説明</h2><p><code class="command">ALTER ROLE</code>は<span class="productname">PostgreSQL</span>のロールの属性を変更します。
  </p><p>このコマンドの最初の構文では、<a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>で指定可能な多くのロール属性を変更することができます。
（指定し得るすべての属性に対応していますが、メンバ資格の追加および削除用のオプションはありません。
追加および削除には<a class="xref" href="sql-grant.html" title="GRANT"><span class="refentrytitle">GRANT</span></a>と<a class="xref" href="sql-revoke.html" title="REVOKE"><span class="refentrytitle">REVOKE</span></a>を使用してください。）
このコマンドで指定しなかった属性は以前の設定のまま残ります。
データベーススーパーユーザはすべてのロールのすべての属性を変更することができます。
<code class="literal">CREATEROLE</code>権限を持つロールは、スーパーユーザおよびレプリケーション以外のロールに対してすべての属性を変更することができます。
通常のロールは自身のパスワードのみを変更することができます。
  </p><p>2番目の構文ではロールの名前を変更することができます。
データベーススーパーユーザはすべてのロールの名前を変更できます。
<code class="literal">CREATEROLE</code>権限を持つロールはスーパーユーザ以外のロールに対してその名前を変更できます。
現在のセッションユーザの名前を変更することはできません。
（必要ならば別のユーザで接続してください）。
<code class="literal">MD5</code>暗号化パスワードではロール名を暗号用のソルトとして使用しますので、パスワードが<code class="literal">MD5</code>で暗号化されている場合、ロール名を変更するとパスワードは空になります。
  </p><p>残りの構文では、全データベース用、または<code class="literal">IN DATABASE</code>句が指定された場合はそのデータベース用のセッションに対するロールの設定変数についてのセッションデフォルトを変更します。
ロール名の代わりに<code class="literal">ALL</code>を指定すると、すべてのロール用の設定を変更します。
<code class="literal">ALL</code>と<code class="literal">IN DATABASE</code>を一緒に使用することは実質<code class="literal">ALTER DATABASE ... SET ...</code>コマンドの使用と同じです。
  </p><p>その後、ロールが新しいセッションを始めると常に、<code class="filename">postgresql.conf</code>内の設定や<code class="command">postgres</code>コマンドラインから受け取った設定よりも優先されて、指定された値がセッションのデフォルトとなります。
これはログイン時のみに発生します。
<a class="xref" href="sql-set-role.html" title="SET ROLE"><span class="refentrytitle">SET ROLE</span></a>または<a class="xref" href="sql-set-session-authorization.html" title="SET SESSION AUTHORIZATION"><span class="refentrytitle">SET SESSION AUTHORIZATION</span></a>を実行しても新しい設定値は設定されません。
全データベースに対する設定よりも、ロールに割り当てたデータベース固有の設定が優先します。
特定のデータベースまたは特定のロールに対する設定は、すべてのロールに対する設定よりも優先します。
  </p><p>スーパーユーザはすべてのユーザのセッションのデフォルトを変更することができます。
<code class="literal">CREATEROLE</code>権限を持つロールはスーパーユーザ以外のロールのデフォルトを変更することができます。
通常のロールは自身のデフォルトのみを設定することができます。
設定変数の中にはこの方法で変更できないものがあります。
また、スーパーユーザがこのコマンドを発行した時にのみ変更できるものもあります。
スーパーユーザのみがすべてのデータベースにおけるすべてのロール用の設定を変更することができます。
  </p></div><div class="refsect1" id="id-1.9.3.25.6"><h2>パラメータ</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>name</code></em></span></dt><dd><p>属性を変更するロールの名前です。
       </p></dd><dt><span class="term"><code class="literal">CURRENT_USER</code></span></dt><dd><p>明示的にロールを指定する代わりに現在のユーザを変更します。
       </p></dd><dt><span class="term"><code class="literal">SESSION_USER</code></span></dt><dd><p>明示的にロールを指定する代わりに現在のセッションユーザを変更します。
       </p></dd><dt><span class="term"><code class="literal">SUPERUSER</code><br /></span><span class="term"><code class="literal">NOSUPERUSER</code><br /></span><span class="term"><code class="literal">CREATEDB</code><br /></span><span class="term"><code class="literal">NOCREATEDB</code><br /></span><span class="term"><code class="literal">CREATEROLE</code><br /></span><span class="term"><code class="literal">NOCREATEROLE</code><br /></span><span class="term"><code class="literal">INHERIT</code><br /></span><span class="term"><code class="literal">NOINHERIT</code><br /></span><span class="term"><code class="literal">LOGIN</code><br /></span><span class="term"><code class="literal">NOLOGIN</code><br /></span><span class="term"><code class="literal">REPLICATION</code><br /></span><span class="term"><code class="literal">NOREPLICATION</code><br /></span><span class="term"><code class="literal">BYPASSRLS</code><br /></span><span class="term"><code class="literal">NOBYPASSRLS</code><br /></span><span class="term"><code class="literal">CONNECTION LIMIT</code> <em class="replaceable"><code>connlimit</code></em><br /></span><span class="term">[ <code class="literal">ENCRYPTED</code> ] <code class="literal">PASSWORD</code> <em class="replaceable"><code>password</code></em><br /></span><span class="term"><code class="literal">VALID UNTIL</code> '<em class="replaceable"><code>timestamp</code></em>'</span></dt><dd><p>これらの句は、元々<a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>で設定された属性を変更します。
詳細は<code class="command">CREATE ROLE</code>のマニュアルページを参照してください。
       </p></dd><dt><span class="term"><em class="replaceable"><code>new_name</code></em></span></dt><dd><p>ロールの新しい名前です。
       </p></dd><dt><span class="term"><em class="replaceable"><code>database_name</code></em></span></dt><dd><p>設定変数を設定する対象のデータベースの名前です。
         </p></dd><dt><span class="term"><em class="replaceable"><code>configuration_parameter</code></em><br /></span><span class="term"><em class="replaceable"><code>value</code></em></span></dt><dd><p>指定した設定パラメータに対して、ロールのセッションデフォルトを指定した値に設定します。
<em class="replaceable"><code>value</code></em>が<code class="literal">DEFAULT</code>、または<code class="literal">RESET</code>が使用されていた場合、ロール固有の変数設定は削除され、新しいセッションではロールはシステム全体のデフォルト設定を継承します。
すべてのロール固有の設定を削除するには<code class="literal">RESET ALL</code>を使用してください。
<code class="literal">SET FROM CURRENT</code>はセッションのパラメータ値をロール固有の値として保管します。
<code class="literal">IN DATABASE</code>が指定された場合、設定パラメータは指定されたロールとデータベースのみで設定または削除されます。
       </p><p>ロール固有の変数設定はログイン時のみに影響を与えます。
<a class="xref" href="sql-set-role.html" title="SET ROLE"><span class="refentrytitle">SET ROLE</span></a>および<a class="xref" href="sql-set-session-authorization.html" title="SET SESSION AUTHORIZATION"><span class="refentrytitle">SET SESSION AUTHORIZATION</span></a>はロール固有の変数設定を処理しません。
       </p><p>取り得るパラメータ名とその値に関する詳細は<a class="xref" href="sql-set.html" title="SET"><span class="refentrytitle">SET</span></a>および<a class="xref" href="runtime-config.html" title="Chapter 19. サーバの設定">Chapter 19</a>を参照してください。
       </p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.25.7"><h2>注釈</h2><p>新規にロールを追加するには<a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>を使用してください。
また、ロールを削除するには<a class="xref" href="sql-droprole.html" title="DROP ROLE"><span class="refentrytitle">DROP ROLE</span></a>を使用してください。
  </p><p><code class="command">ALTER ROLE</code>ではロールのメンバ資格を変更できません。
メンバ資格の変更には<a class="xref" href="sql-grant.html" title="GRANT"><span class="refentrytitle">GRANT</span></a>および<a class="xref" href="sql-revoke.html" title="REVOKE"><span class="refentrytitle">REVOKE</span></a>を使用してください。
  </p><p>このコマンドで暗号化しないパスワードを指定するときには注意しなければなりません。
パスワードはサーバに平文で送信されます。
クライアントのコマンド履歴やサーバのログにこれが残ってしまうかもしれません。
<a class="xref" href="app-psql.html" title="psql"><span class="refentrytitle"><span class="application">psql</span></span></a>には<code class="command">\password</code>コマンドがあります。
これを使用してロールのパスワードを平文のパスワードをさらすことなく変更することができます。
  </p><p>ロールではなくデータベースにセッションのデフォルトを結びつけることもできます。
<a class="xref" href="sql-alterdatabase.html" title="ALTER DATABASE"><span class="refentrytitle">ALTER DATABASE</span></a>を参照してください。
競合する場合、データベースとロールの組み合わせに固有な設定はロール固有の設定よりも優先し、ロール固有の設定はデータベース固有の設定よりも優先します。
  </p></div><div class="refsect1" id="id-1.9.3.25.8"><h2>例</h2><p>ロールのパスワードを変更します。

</p><pre class="programlisting">ALTER ROLE davide WITH PASSWORD 'hu8jmn3';</pre><p>
  </p><p>ロールのパスワードを削除します。

</p><pre class="programlisting">ALTER ROLE davide WITH PASSWORD NULL;</pre><p>
  </p><p>パスワードの有効期限を変更します。
以下では、2015年5月4日正午（ただしUTCより1時間進んだタイムゾーンを使用）にパスワードが無効となるように変更しています。
</p><pre class="programlisting">ALTER ROLE chris VALID UNTIL 'May 4 12:00:00 2015 +1';</pre><p>
  </p><p>パスワードの有効期限を無効にします。
</p><pre class="programlisting">ALTER ROLE fred VALID UNTIL 'infinity';</pre><p>
  </p><p>ロールに他のロールの作成権限と新しいデータベースの作成権限を与えます。

</p><pre class="programlisting">ALTER ROLE miriam CREATEROLE CREATEDB;</pre><p>
  </p><p>ロールに<a class="xref" href="runtime-config-resource.html#GUC-MAINTENANCE-WORK-MEM">maintenance_work_mem</a>パラメータ用のデフォルトとは異なる設定を与えます。

</p><pre class="programlisting">ALTER ROLE worker_bee SET maintenance_work_mem = 100000;</pre><p>
  </p><p>ロールにデータベース固有の<a class="xref" href="runtime-config-logging.html#GUC-CLIENT-MIN-MESSAGES">client_min_messages</a>パラメータ用のデフォルトとは異なる設定を与えます。

</p><pre class="programlisting">ALTER ROLE fred IN DATABASE devel SET client_min_messages = DEBUG;</pre></div><div class="refsect1" id="id-1.9.3.25.9"><h2>互換性</h2><p><code class="command">ALTER ROLE</code>文は<span class="productname">PostgreSQL</span>の拡張です。
  </p></div><div class="refsect1" id="id-1.9.3.25.10"><h2>関連項目</h2><span class="simplelist"><a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>, <a class="xref" href="sql-droprole.html" title="DROP ROLE"><span class="refentrytitle">DROP ROLE</span></a>, <a class="xref" href="sql-alterdatabase.html" title="ALTER DATABASE"><span class="refentrytitle">ALTER DATABASE</span></a>, <a class="xref" href="sql-set.html" title="SET"><span class="refentrytitle">SET</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-alterpublication.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-alterrule.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">ALTER PUBLICATION </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> ALTER RULE</td></tr></table></div></body></html>