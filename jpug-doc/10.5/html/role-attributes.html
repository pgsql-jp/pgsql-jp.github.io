<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>21.2. ロールの属性</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="database-roles.html" title="21.1. データベースロール" /><link rel="next" href="role-membership.html" title="21.3. ロールのメンバ資格" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">21.2. ロールの属性</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="database-roles.html" title="21.1. データベースロール">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="user-manag.html" title="Chapter 21. データベースロール">Up</a></td><th width="60%" align="center">Chapter 21. データベースロール</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="role-membership.html" title="21.3. ロールのメンバ資格">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="ROLE-ATTRIBUTES"><div class="titlepage"><div><div><h2 class="title" style="clear: both">21.2. ロールの属性</h2></div></div></div><p>データベースロールは、権限を定義し、クライアント認証システムと相互作用する数多くの属性を持つことができます。

    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">ログイン権限<a id="id-1.6.8.6.2.1.1.1.1" class="indexterm"></a></span></dt><dd><p><code class="literal">LOGIN</code>属性を持つロールのみがデータベース接続の初期ロール名として使用できます。
<code class="literal">LOGIN</code> 属性を持つロールは<span class="quote">“<span class="quote">データベースユーザ</span>”</span>と同じであるとみなすことができます。
ログイン権限を持つロールの作成方法は、以下のいずれかです。
</p><pre class="programlisting">CREATE ROLE <em class="replaceable"><code>name</code></em> LOGIN;
CREATE USER <em class="replaceable"><code>name</code></em>;</pre><p>
（<code class="command">CREATE USER</code>はデフォルトで <code class="literal">LOGIN</code>を持ち、<code class="command">CREATE ROLE</code>は持たないという点を除き、<code class="command">CREATE USER</code>は<code class="command">CREATE ROLE</code>と同じです。）
       </p></dd><dt><span class="term">スーパーユーザ状態<a id="id-1.6.8.6.2.1.2.1.1" class="indexterm"></a></span></dt><dd><p>ログイン権限を除き、データベーススーパーユーザに対する権限検査は全て行われません。
これは危険な権限ですので、安易に使用してはいけません。
作業のほとんどを非スーパーユーザのロールで行うことが最善です。
新しいデータベーススーパーユーザを作成するには、<code class="literal">CREATE ROLE <em class="replaceable"><code>name</code></em> SUPERUSER</code>を使用してください。
これはスーパーユーザのロールで実行しなければなりません。
       </p></dd><dt><span class="term">データベース作成<a id="id-1.6.8.6.2.1.3.1.1" class="indexterm"></a></span></dt><dd><p>（全ての権限検査が行われないスーパーユーザを除き）ロールに明示的にデータベースを作成するための権限を指定しておかねばいけません。
そのようなロールを作るためには<code class="literal">CREATE ROLE <em class="replaceable"><code>name</code></em> CREATEDB</code>を使用してください。
       </p></dd><dt><span class="term">ロールの作成<a id="id-1.6.8.6.2.1.4.1.1" class="indexterm"></a></span></dt><dd><p>あるロールがロールを作成するには、明示的な権限が付与されていなければなりません。
（スーパーユーザは、すべての権限検査を迂回しますので、例外です。）
こうしたロールを作成するには、<code class="literal">CREATE ROLE <em class="replaceable"><code>name</code></em> CREATEROLE</code>を使用してください。
<code class="literal">CREATEROLE</code>権限を持つロールは他のロールを変更したり削除したりすることもできます。
また、他のロールのメンバ資格を付与したり取り上げたりすることもできます。
しかし、スーパーユーザロールの変更、削除、メンバ資格の変更を行うにはスーパーユーザ状態が必要です。
<code class="literal">CREATEROLE</code>だけでは不足しています。
       </p></dd><dt><span class="term">レプリケーションの新規接続<a id="id-1.6.8.6.2.1.5.1.1" class="indexterm"></a></span></dt><dd><p>あるロールがストリーミングレプリケーションの新規接続を実施するには、明示的な権限が付与されていなければなりません。
（スーパーユーザは、すべての権限検査を迂回しますので、例外です。）
ストリーミングレプリケーションを行うロールは、<code class="literal">LOGIN</code>権限も持っていることが必要です。
こうしたロールを作成するには、<code class="literal">CREATE ROLE <em class="replaceable"><code>name</code></em> REPLICATION LOGIN</code>を使用してください。
       </p></dd><dt><span class="term">パスワード<a id="id-1.6.8.6.2.1.6.1.1" class="indexterm"></a></span></dt><dd><p>パスワードは、クライアント認証方法においてデータベースに接続する際にユーザにパスワードを要求する場合にのみ重要になります。
<code class="option">password</code>と<code class="option">md5</code>認証方式でパスワードが使用されます。
データベースパスワードはオペレーティングシステムのパスワードとは異なります。
ロール作成時に<code class="literal">CREATE ROLE <em class="replaceable"><code>name</code></em> PASSWORD 'string'</code>のようにパスワードを指定します。
       </p></dd></dl></div><p>

ロール属性は、ロールを作成した後でも<code class="command">ALTER ROLE</code><a id="id-1.6.8.6.2.3" class="indexterm"></a>コマンドで変更できます。
詳細は<a class="xref" href="sql-createrole.html" title="CREATE ROLE"><span class="refentrytitle">CREATE ROLE</span></a>と<a class="xref" href="sql-alterrole.html" title="ALTER ROLE"><span class="refentrytitle">ALTER ROLE</span></a>のマニュアルページを参照してください。
   </p><div class="tip"><h3 class="title">Tip</h3><p>スーパーユーザ以外に<code class="literal">CREATEDB</code>権限と<code class="literal">CREATEROLE</code>権限を持つロールを作成することを勧めます。
そして、このロールを使用して、データベースとロールを管理するためのすべての処理を行ってください。
この方法によって、実際には不要な処理をスーパーユーザとして行う危険性を避けることができます。
   </p></div><p>ロールは、<a class="xref" href="runtime-config.html" title="Chapter 19. サーバの設定">Chapter 19</a>で説明されている実行時の設定の多くをロールごとのデフォルトに設定することもできます。
例えば何らかの理由で、自分が接続する時は常にインデックススキャンを無効にしたい場合（注:お勧めしません）、次のようにします。
</p><pre class="programlisting">ALTER ROLE myname SET enable_indexscan TO off;</pre><p>
このようにして設定を保存します（ただし、すぐに反映はされません）。
以降のこのロールによる接続においては、セッションの開始の直前に<code class="literal">SET enable_indexscan TO off;</code>が呼び出されたのと同様になります。
これはデフォルトとする設定をするだけなので、設定をセッション途中いつでも変更できます。
ロール固有のデフォルト設定を削除するには、<code class="literal">ALTER ROLE <em class="replaceable"><code>rolename</code></em> RESET <em class="replaceable"><code>varname</code></em></code>を使用してください。
呼び出されることがありませんので、<code class="literal">LOGIN</code>権限を持たないロールにロール固有のデフォルトを持たせることに意味がないことに注意してください。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="database-roles.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="user-manag.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="role-membership.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">21.1. データベースロール </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 21.3. ロールのメンバ資格</td></tr></table></div></body></html>