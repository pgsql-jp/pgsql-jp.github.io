<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.242. リリース8.1.4</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-8-1-5.html" title="E.241. リリース8.1.5" /><link rel="next" href="release-8-1-3.html" title="E.243. リリース8.1.3" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.242. リリース8.1.4</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-8-1-5.html" title="E.241. リリース8.1.5">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-8-1-3.html" title="E.243. リリース8.1.3">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-8-1-4"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.242. リリース8.1.4</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-8-1-4.html#id-1.11.6.246.4">E.242.1. バージョン8.1.4への移行</a></span></dt><dt><span class="sect2"><a href="release-8-1-4.html#id-1.11.6.246.5">E.242.2. 変更点</a></span></dt></dl></div><p><strong>リリース日: </strong>2006-05-23</p><p>このリリースは8.1.3の各種不具合を修正したもので、非常に深刻なセキュリティ問題を解消するパッチを含みます。
8.1メジャーリリースにおける新機能については<a class="xref" href="release-8-1.html" title="E.246. リリース8.1">Section E.246</a>を参照してください。
  </p><div class="sect2" id="id-1.11.6.246.4"><div class="titlepage"><div><div><h3 class="title">E.242.1. バージョン8.1.4への移行</h3></div></div></div><p>8.1.Xからの移行ではダンプ/リストアは不要です。
しかしながら、8.1.2より前のバージョンからアップグレードする場合は、<a class="xref" href="release-8-1-2.html" title="E.244. リリース8.1.2">Section E.244</a>を参照してください。
   </p><p>CVE-2006-2313およびCVE-2006-2314に示されたSQLインジェクション攻撃を完全に防ぐためには、アプリケーション側のコードの変更が必要となる場合があります。
SQLコマンド内に信頼できない文字列を埋め込むアプリケーションでは、できる限り早く、その文字列が推奨するエスケープ技法を使用していることを確実に検証しなければなりません。
ほとんどの場合、アプリケーションは文字列のエスケープ処理に、<span class="foreignphrase"><em class="foreignphrase">その場しのぎ</em></span>のコードではなく、ライブラリやドライバが提供する（<span class="application">libpq</span>の<code class="function">PQescapeStringConn()</code>のような）関数を使用しなければなりません。
   </p></div><div class="sect2" id="id-1.11.6.246.5"><div class="titlepage"><div><div><h3 class="title">E.242.2. 変更点</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>すべての場合において、符号化が無効なマルチバイト文字を拒絶するようにサーバを変更しました。
(Tatsuo, Tom)</p><p><span class="productname">PostgreSQL</span>は少し前からこのような方向に移行していましたが、この検査がすべての符号化方式とすべてのテキスト入力に対して統一的に適用されるようになりました。
さらに、単なる警告ではなく常にエラーとなるようになりました。
この変更はCVE-2006-2313で示されるような種類のSQLインジェクション攻撃から保護します。</p></li><li class="listitem"><p>文字列リテラル内の<code class="literal">\'</code>の安全ではない使用を拒絶します。</p><p>CVE-2006-2314で示されるような種類のSQLインジェクション攻撃からのサーバ側の保護として、
サーバは、SQL文字列リテラル内のASCII単一引用符の表現として、<code class="literal">''</code>のみを受付け、<code class="literal">\'</code>を受付けないようになりました。
デフォルトでは、SQLインジェクションが可能となる状況である、<code class="varname">client_encoding</code>がクライアント側のみの符号化方式（SJIS、BIG5、GBK、GB18030、UHC）に設定された場合にのみ<code class="literal">\'</code>は拒絶されます。
新しい設定パラメータ<code class="varname">backslash_quote</code>により、必要な場合にこの動作を調整できます。
CVE-2006-2314に対して完全に保護するには、クライアント側を変更する必要があるかもしれないことに注意してください。
安全ではないクライアントを安全ではないものとして明らかにすることが、<code class="varname">backslash_quote</code>の目的の一つです。</p></li><li class="listitem"><p><span class="application">libpq</span>の文字列エスケープルーチンを、符号化方式と<code class="varname">standard_conforming_strings</code>を考慮するように変更しました。</p><p>これは、CVE-2006-2313およびCVE-2006-2314で示されるセキュリティ問題に対し、<span class="application">libpq</span>を使用したアプリケーションを修正します。
また、将来予定されるSQL標準文字列リテラル構文への移行に対しても保護しています。
同時に複数の<span class="productname">PostgreSQL</span>接続を使用するアプリケーションは、各データベース接続において使用される設定に合わせてエスケープ処理が正しく行われるように、<code class="function">PQescapeStringConn()</code>と<code class="function">PQescapeByteaConn()</code>に移行しなければなりません。
<span class="quote">“<span class="quote">独自に</span>”</span>文字列エスケープ処理を行うアプリケーションはライブラリルーチンを使用するように変更しなければなりません。</p></li><li class="listitem"><p>pgcryptoのキー選択の弱さを修正しました。
(Marko Kreen)</p><p>偶発的なPRNGの種再作成ロジック内のエラーにより、<code class="function">pgp_sym_encrypt()</code>で選択されるセッションキーが予測可能になりました。
これはOpenSSLを使用せずに構築した場合にのみ影響します。</p></li><li class="listitem"><p>一部の不正な符号化方式変換関数を修正しました。</p><p><code class="function">win1251_to_iso</code>、<code class="function">win866_to_iso</code>、<code class="function">euc_tw_to_big5</code>、<code class="function">euc_tw_to_mic</code>、<code class="function">mic_to_euc_tw</code>はすべて可変拡張に関して正しくありませんでした。</p></li><li class="listitem"><p>文字列における偶然残る<code class="literal">\'</code>の使用を整理しました。
(Bruce, Jan)</p></li><li class="listitem"><p>autovacuumを<code class="structname">pg_stat_activity</code>で確認できるようにしました。
(Alvaro)</p></li><li class="listitem"><p><code class="literal">full_page_writes</code>を無効にしました。 (Tom)</p><p><code class="literal">full_page_writes</code>を無効にするとクラッシュリカバリが失敗する特定の状況があります。
8.2で適切に修正する予定ですが、当面は単に無効にします。</p></li><li class="listitem"><p>プランナ、特にビットマップインデックススキャンとMIN/MAX最適化に関してさまざまな修正を行いました。
(Tom)</p></li><li class="listitem"><p>マージ結合における不正な最適化を修正しました。
(Tom)</p><p>外部結合で一致しなかった行の複数のコピーを省くことがありました。</p></li><li class="listitem"><p>同一トランザクション内でplpgsql関数を使用し、変更する場合のクラッシュを修正しました。</p></li><li class="listitem"><p>B-Treeインデックスが消去された場合のWAL再生を修正しました。</p></li><li class="listitem"><p><code class="literal">|</code>を含むパターンに対する<code class="literal">SIMILAR TO</code>を修正しました。(Tom)</p></li><li class="listitem"><p><code class="command">SELECT INTO</code>および<code class="command">CREATE TABLE AS</code>が基本ディレクトリではなくデフォルトのテーブル空間にテーブルを作成するように変更しました。(Kris Jurka)</p></li><li class="listitem"><p>独自のDH SSLパラメータを正しく使用するようにサーバを修正しました。(Michael Fuhr)</p></li><li class="listitem"><p>qsortの性能を向上しました。(Dann Corbit)</p><p>現時点ではSolarisでのみこのコードが使用されます。</p></li><li class="listitem"><p>x86システムでのOS/X Bonjourを修正しました。(Ashley Clark)</p></li><li class="listitem"><p>さまざまな小規模のメモリリークを修正しました。</p></li><li class="listitem"><p>一部のWin32システムにおけるパスワードプロンプトに関する問題を修正しました。(Robert Kinberg)</p></li><li class="listitem"><p><span class="application">pg_dump</span>のドメインに関するデフォルト値の取り扱いを改良しました。</p></li><li class="listitem"><p>同一名称のユーザとグループを適切に扱うよう<span class="application">pg_dumpall</span>を修正しました。
（8.1より前のサーバからのダンプを行う場合のみです。）
(Tom)</p><p>ユーザとグループは<code class="literal">LOGIN</code>権限を持つ一つのロールにまとめられます。
これまではまとめられたロールは<code class="literal">LOGIN</code>権限を持たなかったため、ユーザとして使用することができなくなっていました。</p></li><li class="listitem"><p><span class="application">pg_restore</span> <code class="literal">-n</code>が文書通りに動くよう修正しました。(Tom)</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-8-1-5.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-8-1-3.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.241. リリース8.1.5 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.243. リリース8.1.3</td></tr></table></div></body></html>