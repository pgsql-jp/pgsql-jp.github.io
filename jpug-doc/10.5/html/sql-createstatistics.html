<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE STATISTICS</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="sql-createserver.html" title="CREATE SERVER" /><link rel="next" href="sql-createsubscription.html" title="CREATE SUBSCRIPTION" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">CREATE STATISTICS</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-createserver.html" title="CREATE SERVER">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="SQLコマンド">Up</a></td><th width="60%" align="center">SQLコマンド</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-createsubscription.html" title="CREATE SUBSCRIPTION">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="SQL-CREATESTATISTICS"><div class="titlepage"></div><a id="id-1.9.3.79.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">CREATE STATISTICS</span></h2><p>CREATE STATISTICS — 拡張統計情報を定義する</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="synopsis">CREATE STATISTICS [ IF NOT EXISTS ] <em class="replaceable"><code>statistics_name</code></em>
    [ ( <em class="replaceable"><code>statistics_kind</code></em> [, ... ] ) ]
    ON <em class="replaceable"><code>column_name</code></em>, <em class="replaceable"><code>column_name</code></em> [, ...]
    FROM <em class="replaceable"><code>table_name</code></em></pre></div><div class="refsect1" id="SQL-CREATESTATISTICS-DESCRIPTION"><h2>説明</h2><p><code class="command">CREATE STATISTICS</code>は指定したテーブル、外部テーブル、マテリアライズドビューのデータを追跡する新しい拡張統計オブジェクトを作成します。
統計オブジェクトは現在のデータベースに作成され、コマンドを実行したユーザに所有されます。
  </p><p>スキーマ名が指定された場合（例：<code class="literal">CREATE STATISTICS myschema.mystat ...</code>）、統計オブジェクトは指定したスキーマ内に作成されます。
スキーマ名を指定しなければ、現在のスキーマ内に作成されます。
統計オブジェクトの名前は、同じスキーマ内のどの統計オブジェクトとも異なるものでなければなりません。
  </p></div><div class="refsect1" id="id-1.9.3.79.6"><h2>パラメータ</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">IF NOT EXISTS</code></span></dt><dd><p>同じ名前の統計オブジェクトが既に存在していてもエラーを発生させません。
この場合、注意メッセージが発行されます。
この場合、統計オブジェクトの名前だけが問題にされ、その定義の詳細は考慮されないことに注意してください。
     </p></dd><dt><span class="term"><em class="replaceable"><code>statistics_name</code></em></span></dt><dd><p>作成する統計オブジェクトの名前（オプションでスキーマ修飾可）です。
     </p></dd><dt><span class="term"><em class="replaceable"><code>statistics_kind</code></em></span></dt><dd><p>この統計オブジェクト内で計算する統計の種別です。
現在サポートされる種別は、N個別値統計を有効にする<code class="literal">ndistinct</code>と、関数的依存統計を有効にする<code class="literal">dependencies</code>です。
この句を省略すると、統計オブジェクトのすべてのサポート対象の統計種別が含まれます。
より詳細な情報は<a class="xref" href="planner-stats.html#PLANNER-STATS-EXTENDED" title="14.2.2. 拡張統計情報">Section 14.2.2</a>および<a class="xref" href="multivariate-statistics-examples.html" title="68.2. 多変量統計の例">Section 68.2</a>を参照してください。
     </p></dd><dt><span class="term"><em class="replaceable"><code>column_name</code></em></span></dt><dd><p>統計計算の対象となるテーブル列の名前です。
少なくとも2つの列名を指定しなければなりません。
     </p></dd><dt><span class="term"><em class="replaceable"><code>table_name</code></em></span></dt><dd><p>統計情報が計算される列があるテーブルの名前（オプションでスキーマ修飾可）です。
     </p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.79.7"><h2>注釈</h2><p>テーブルを読み取る統計オブジェクトを作るには、そのテーブルの所有者でなければなりません。
しかし、統計オブジェクトが作成された後は、その所有者と対象となるテーブルは無関係になります。
  </p></div><div class="refsect1" id="SQL-CREATESTATISTICS-EXAMPLES"><h2>例</h2><p>関数従属性のある2つの列を含むテーブル<code class="structname">t1</code>を作成します。
つまり、第1の列の値を知っていれば、それだけでもう一方の列の値がわかる、というものです。
その次に、これらの列の間に関数的依存統計を構築します。

</p><pre class="programlisting">CREATE TABLE t1 (
    a   int,
    b   int
);

INSERT INTO t1 SELECT i/100, i/500
                 FROM generate_series(1,1000000) s(i);

ANALYZE t1;

-- マッチする行の数は非常に低く見積もられる
EXPLAIN ANALYZE SELECT * FROM t1 WHERE (a = 1) AND (b = 0);

CREATE STATISTICS s1 (dependencies) ON a, b FROM t1;

ANALYZE t1;

-- 行数の見積もりがより正確になる
EXPLAIN ANALYZE SELECT * FROM t1 WHERE (a = 1) AND (b = 0);</pre><p>

関数的依存統計がなければ、プランナは2つの<code class="literal">WHERE</code>条件を独立なものとみなすため、それらの選択性を掛け算して、非常に小さな行数見積もりを導きます。
このような統計があれば、プランナは<code class="literal">WHERE</code>条件が冗長であることを認識し、行数を低く見積もりません。
  </p></div><div class="refsect1" id="id-1.9.3.79.9"><h2>互換性</h2><p>標準SQLに<code class="command">CREATE STATISTICS</code>コマンドはありません。
  </p></div><div class="refsect1" id="id-1.9.3.79.10"><h2>関連項目</h2><span class="simplelist"><a class="xref" href="sql-alterstatistics.html" title="ALTER STATISTICS"><span class="refentrytitle">ALTER STATISTICS</span></a>, <a class="xref" href="sql-dropstatistics.html" title="DROP STATISTICS"><span class="refentrytitle">DROP STATISTICS</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-createserver.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-createsubscription.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">CREATE SERVER </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> CREATE SUBSCRIPTION</td></tr></table></div></body></html>