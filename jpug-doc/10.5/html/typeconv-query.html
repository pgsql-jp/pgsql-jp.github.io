<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>10.4. 値の格納</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="typeconv-func.html" title="10.3. 関数" /><link rel="next" href="typeconv-union-case.html" title="10.5. UNION、CASEおよび関連する構文" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">10.4. 値の格納</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="typeconv-func.html" title="10.3. 関数">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="typeconv.html" title="Chapter 10. 型変換">Up</a></td><th width="60%" align="center">Chapter 10. 型変換</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="typeconv-union-case.html" title="10.5. UNION、CASEおよび関連する構文">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="TYPECONV-QUERY"><div class="titlepage"><div><div><h2 class="title" style="clear: both">10.4. 値の格納</h2></div></div></div><p>以下の手順に従って、テーブルに挿入される値は対象とする列のデータ型に変換されます。
  </p><div class="procedure" id="id-1.5.9.9.3"><p class="title"><strong>値の格納における型変換</strong></p><ol class="procedure" type="1"><li class="step"><p>対象に正確に一致するかどうかを検査します。</p></li><li class="step"><p>なければ、式を対象の型に変換してみます。
もし2つの型の間の<em class="firstterm">代入キャスト</em>が<code class="structname">pg_cast</code>カタログ(<a class="xref" href="sql-createcast.html" title="CREATE CAST"><span class="refentrytitle">CREATE CAST</span></a>を参照してください)に登録されている場合、これは可能です。
あるいは、もし式がunknown型リテラルの場合、リテラル文字列の内容は対象の型の入力変換ルーチンに与えられます。</p></li><li class="step"><p>対象の型に対してサイズ調整キャストがあるかどうかを検査します。
サイズ調整キャストは、ある型からその同じ型へのキャストです。
<code class="structname">pg_cast</code>カタログに1つ見つかった場合は、格納先の列に収納する前に式に適用します。
こうしたキャストを実装する関数は、常に<code class="type">integer</code>型のパラメータを1つ余計に取ります。
このパラメータは、格納先の列の<code class="structfield">atttypmod</code>値を受け付けます
（<code class="structfield">atttypmod</code>の解釈方法はデータ型によって異なりますが、典型的にはそれの宣言された長さです）。
また、キャストが明示的か暗黙的かを示す、第三の<code class="type">boolean</code>パラメータを取ることもできます。
サイズ検査や切り詰めなど、長さに依存したセマンティックスの適用について、キャスト関数が責任を持ちます。</p></li></ol></div><div class="example" id="id-1.5.9.9.4"><p class="title"><strong>Example 10.9. <code class="type">character</code>格納における型変換</strong></p><div class="example-contents"><p><code class="type">varchar(20)</code>として宣言された対象の列への以下の文では、対象の大きさが正確に調整されることを示します。

</p><pre class="screen">CREATE TABLE vv (v character(20));
INSERT INTO vv SELECT 'abc' || 'def';
SELECT v, octet_length(v) FROM vv;

          v           | octet_length
----------------------+--------------
 abcdef               |           20
(1 row)</pre><p>ここで実際に起こったのは、デフォルトで<code class="literal">||</code>演算子が<code class="type">text</code>の連結として解決できるように、2つのunknownリテラルが<code class="type">text</code>に解決されたということです。
そして演算子の<code class="type">text</code>型の結果は対象の列の型に合うように<code class="type">bpchar</code>(<span class="quote">“<span class="quote">空白が埋められる文字</span>”</span>, <code class="type">character</code>データ型の内部名)に変換されます
（しかし、<code class="type">text</code>から<code class="type">bpchar</code>へバイナリ変換可能ですので、この型変換のために実際の関数呼び出しは挿入されません）。
最後に、<code class="literal">bpchar(bpchar, integer, boolean)</code>サイズ調整関数がシステムカタログの中から見つかり、演算子の結果と格納する列の長さを適用します。
この型特有の関数は必要とされる長さを検査し、空白の埋め込みを行います。</p></div></div><br class="example-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="typeconv-func.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="typeconv.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="typeconv-union-case.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">10.3. 関数 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 10.5. <code class="literal">UNION</code>、<code class="literal">CASE</code>および関連する構文</td></tr></table></div></body></html>