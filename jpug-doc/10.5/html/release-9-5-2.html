<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.30. リリース9.5.2</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-9-5-3.html" title="E.29. リリース9.5.3" /><link rel="next" href="release-9-5-1.html" title="E.31. リリース9.5.1" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.30. リリース9.5.2</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-9-5-3.html" title="E.29. リリース9.5.3">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-9-5-1.html" title="E.31. リリース9.5.1">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-9-5-2"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.30. リリース9.5.2</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-9-5-2.html#id-1.11.6.34.4">E.30.1. バージョン9.5.2への移行</a></span></dt><dt><span class="sect2"><a href="release-9-5-2.html#id-1.11.6.34.5">E.30.2. 変更点</a></span></dt></dl></div><p><strong>リリース日: </strong>2016-03-31</p><p>このリリースは9.5.1に対し、各種不具合を修正したものです。
9.5メジャーリリースにおける新機能については、<a class="xref" href="release-9-5.html" title="E.32. リリース9.5">Section E.32</a>
を参照してください。
  </p><div class="sect2" id="id-1.11.6.34.4"><div class="titlepage"><div><div><h3 class="title">E.30.1. バージョン9.5.2への移行</h3></div></div></div><p>9.5.Xからの移行ではダンプ/リストアは不要です。
   </p><p>しかしながら、下記の先頭の変更項目により、アップグレード適用後に一部インデックスの<code class="command">REINDEX</code>が必要となるかもしれません。
   </p></div><div class="sect2" id="id-1.11.6.34.5"><div class="titlepage"><div><div><h3 class="title">E.30.2. 変更点</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>非<code class="literal">C</code>ロケールでは文字列のソートに対して短縮キーを無効にしました。
(Robert Haas)
     </p><p><span class="productname">PostgreSQL</span> 9.5は、標準Cライブラリ関数<code class="function">strxfrm()</code>を<code class="function">strcoll()</code>の代わりに使うことで、文字列データ型の比較を高速化する仕組みを導入しました。
このたび、glibc（LinuxのCライブラリ実装）の大部分のバージョンでは<code class="function">strxfrm()</code>関数がバグのある実装であると判明しました。
いくつかのロケールで<code class="function">strcoll()</code>と一致しない文字列比較結果が生じることがあります。
この問題の詳細がより明らかにされるまで、全ての非<code class="literal">C</code>ロケールでこの最適化を無効にしました（<code class="literal">C</code>ロケールは<code class="function">strcoll()</code>も<code class="function">strxfrm()も使わないので</code>安全です）。
     </p><p>残念ながら、この問題はソートのみならずBツリーインデックスの項目順にも悪影響を及ぼします。
すなわち、<code class="type">text</code>、<code class="type">varchar</code>、または、<code class="type">char</code>カラムに対するBツリーインデックスは、該当するロケールに従ってソートし、<span class="productname">PostgreSQL</span> 9.5.0または9.5.1で作られるか変更されていたなら、現在おそらく壊れているということを意味します。
ユーザはバグの影響を受けたかもしれないインデックスを<code class="command">REINDEX</code>したほうがよいでしょう。
     </p><p>現時点では既知の該当するロケールの網羅的リストを提供することはできません。
<code class="literal">C</code>ロケールは安全と知られています。
また、<code class="literal">en_US</code>などの英語ベースのロケールには障害の形跡はありません。
しかし、<code class="literal">de_DE</code>などの他のいくつかの一般的なロケールは大部分のglibcバージョンでバグの影響を受けます。
     </p></li><li class="listitem"><p>キャッシュされたプランで行セキュリティ状態を適切に維持するようにしました。
(Stephen Frost)
     </p><p>2つ以上のロールとして問い合わせを実行するセッションでは、プランキャッシュが他のロールIDむけに生成されたプランを誤って再使用するかもしれず、これにより行単位セキュリティ(row-level security, RLS)が使われているときに間違ったポリシーセットを適用するおそれがありました。
(CVE-2016-2193)
     </p></li><li class="listitem"><p><code class="filename">contrib/pageinspect</code>のいくつかの新関数にスーパーユーザでなければいけないというチェックを追加しました。
(Andreas Seltenreich)
     </p><p><code class="filename">pageinspect</code>拡張の<code class="type">bytea</code>値を解析する大部分の関数は、スーパーユーザ以外からの呼び出しを許していませんが、<code class="function">brin_page_type()</code>と<code class="function">brin_metapage_info()</code>はそうなっていませんでした。
これら関数に作りこまれた<code class="type">bytea</code>値を渡すことでサーバのクラッシュや若干のサーバメモリ露出があるかもしれません。
悪用を防ぐため欠けていた権限チェックを加えました。
(CVE-2016-3065)
     </p></li><li class="listitem"><p>インデックス付けされた<code class="literal">ROW()</code>比較の誤った扱いを修正しました。
(Simon Riggs)
     </p><p>9.5で導入された小さな最適化の欠陥のため、<code class="literal">ROW()</code>比較がインデックス順序に完全にではなく部分的に一致するとき（例えば、異なるカラム順や、インデックスに<code class="literal">ASC</code>のカラムと<code class="literal">DESC</code>のカラムが両方含まれる場合）、誤った結果が生じました。
よい解決法が得られるまで、この最適化は削除されます。
     </p></li><li class="listitem"><p>インデックス付けされた<code class="literal">ROW()</code>比較におけるNULLインデックス項目の誤った扱いを修正しました。
(Tom Lane)
     </p><p><code class="literal">ROW(a, b) &gt; ROW('x', 'y')</code>のような行比較を使うインデックス検索は、
<code class="structfield">b</code>カラムでNULL項目に到達すると、以降の<code class="structfield">a</code>の値に付随した非NULLの<code class="structfield">b</code>の値があるのを無視して、そこで止まってしまいました。
     </p></li><li class="listitem"><p>前後に適切な<code class="function">fsync()</code>呼び出しを伴わないファイル名変更による、可能性の低いデータ損失のシナリオを回避するようにしました。
(Michael Paquier, Tomas Vondra, Andres Freund)
     </p></li><li class="listitem"><p><code class="command">SELECT FOR UPDATE/SHARE</code>を行い、ロックする必要のないリレーションを含む問い合わせで、直近に更新された行を再チェックするときの誤った振る舞いを修正しました。
(Tom Lane)
     </p><p>ロックされないリレーションからの行は再チェックにおいて誤って全てNULLが入っているように扱われていました。その結果、更新された行が<code class="literal">WHERE</code>条件にもう適合しないと誤って判断されたり、誤ってNULLが出力されたりします。
     </p></li><li class="listitem"><p><code class="function">json_to_record()</code>において、要求された出力カラム名の一つと一致するフィールド名を持つサブオブジェクトが入力オブジェクトに含まれているときの障害を修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><code class="function">jsonb_object()</code>の2引数形式に空配列を与えて呼び出したとき無意味な結果になるのを修正しました。
(Michael Paquier, Andrew Dunstan)
     </p></li><li class="listitem"><p><code class="function">jsonb_set()</code>でパス配列要素を配列の添え字に使うために整数に変換するときの誤動作を修正しました。
(Michael Paquier)
     </p></li><li class="listitem"><p><code class="function">to_char()</code>の書式<code class="literal">OF</code>による、負のタイムゾーンオフセットの誤った整形を修正しました。
(Thomas Munro, Tom Lane)
     </p></li><li class="listitem"><p><code class="command">INSERT ... ON CONFLICT</code>で待機について誤ったログ出力の可能性があり、修正しました。
(Peter Geoghegan)
     </p><p>原因となる制約が無いにも拘らず、しばしばログメッセージが排他制約のために待機が生じたと主張していました。
     </p></li><li class="listitem"><p>リカバリが一貫性のある状態に達するまで<a class="xref" href="standby-settings.html#RECOVERY-MIN-APPLY-DELAY">recovery_min_apply_delay</a>パラメータを無視するようにしました。
(Michael Paquier)
     </p><p>これまでは、データベース状態を有効にするのに必要とされるWALの初期部分を再生する間であっても、<code class="varname">recovery_min_apply_delay</code>に応じてスタンバイサーバはWALレコードの適用を遅らせていました。
スタンバイはそれが一貫性のあるデータベース状態に到達するまで使用できないので、これは用をなさないとみなされました。
     </p></li><li class="listitem"><p>サーバのスタートアップ中に<code class="literal">pg_subtrans</code>がXID周回に近い場合を、正しく扱うようになりました。
(Jeff Janes)
     </p></li><li class="listitem"><p>ロジカルデコーディングについて様々なバグを修正しました。
(Andres Freund)
     </p><p>問題のある場合には、
レプリカ識別子が<code class="literal">FULL</code>のとき1ページより大きいタプル、
ディスクにスプールされるほど大きいトランザクション内で主キーを変更する<code class="command">UPDATE</code>、
<span class="quote">“<span class="quote">subxact logged without previous toplevel record</span>”</span>（サブトランザクションが前のトップレベルレコード無しに記録されました）という誤った報告、および、
トランザクションのコミット時刻の誤った報告が含まれます。
     </p></li><li class="listitem"><p>入れ子になったセキュリティバリアビューで、外側のビューが相関副問い合わせを含む<code class="literal">WHERE</code>句を持つときの、プランナのエラーを修正しました。
(Dean Rasheed)
     </p></li><li class="listitem"><p>GINインデックス検索のメモリリークを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><code class="function">localeconv()</code>の出力文字列を2回以上解放しようとしておきる、稀な場合のクラッシュを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><code class="literal">ispell</code>辞書用の接辞ファイルの解析を修正しました。
(Tom Lane)
     </p><p>例えばトルコ語UTF8ロケールの<code class="literal">I</code>など、バイト長が大文字小文字変換で変わる文字が接辞ファイルに何らか含まれていた場合に、動作がおかしくなる可能性がありました。
     </p></li><li class="listitem"><p>
<code class="literal">ispell</code>辞書ファイルを解析するのに<code class="function">sscanf()</code>を使わないようにしました。
(Artur Zakirov)
     </p><p>これにより（macOSを含む）FreeBSD派生のプラットフォームにおける移植性の問題を回避します。
     </p></li><li class="listitem"><p>IBMのxlcコンパイラによるPPC上のアトミック操作のコードを修正しました。
(Noah Misch)
     </p><p>この間違いはこれらプラットフォーム上で稀に同時操作の失敗をもらたしました。
     </p></li><li class="listitem"><p>古いバージョンのWindows（7SP1/2008R2SP1より前）上でAVX2対応CPUとVisual Studio 2013でビルドされたPostgresでのクラッシュを回避しました。
(Christian Ullrich)
     </p><p>この修正はVisual Studio 2013のランタイムライブラリのバグの回避策ですが、このバグについてマイクロソフトはこのバージョンでは修正しないと宣言しています。
     </p></li><li class="listitem"><p>マルチバイト文字を適切に扱えるように<span class="application">psql</span>のタブ補完のロジックを修正しました。
(Kyotaro Horiguchi, Robert Haas)
     </p></li><li class="listitem"><p><code class="literal">SECURITY LABEL</code>について<span class="application">psql</span>のタブ補完を修正しました。
(Tom Lane)
     </p><p><code class="literal">SECURITY LABEL</code>の後のタブ押下がクラッシュや不適切なキーワード提示を引き起こす可能性がありました。
     </p></li><li class="listitem"><p>コマンドラインでの指定が無い場合に、<span class="application">pg_ctl</span>が<code class="envar">PGCTLTIMEOUT</code>環境変数による待機タイムアウトを受け付けるようにしました。
(Noah Misch)
     </p><p>これはpostmasterの起動とシャットダウンに対しグローバルに通常より長いタイムアウトを指定できるようにすることで、遅いビルドファームメンバーのテスト実施を容易にします。
     </p></li><li class="listitem"><p><span class="application">pg_ctl</span>におけるWindowsサービス状態の誤った検査を修正しました。
(Manuel Mathar)
     </p><p>前のマイナーリリース群では、ログメッセージをWindowsイベントログに送るかどうかを適切に判断するように<span class="application">pg_ctl</span>を修正しようとしていましたが、逆さに検査していました。
     </p></li><li class="listitem"><p><code class="literal">-C</code>と<code class="literal">-M prepared</code>のオプション組み合わせを適切に扱うように<span class="application">pgbench</span>を修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><span class="application">pg_upgrade</span>で、新データディレクトリが旧データディレクトリ内に在るとき、削除スクリプトの作成を省略するようにしました。

     </p><p>このような場合のスクリプトの盲目的な適用は新データディレクトリが失われる結果になりました。
     </p></li><li class="listitem"><p>PL/Perlで、空のPostgres配列を適切に空のPerl配列に変換するようにしました。
(Alex Hunsaker)
     </p></li><li class="listitem"><p>PL/Pythonが有効なPython識別子でない関数名をうまく処理できるようにしました。
(Jim Nasby)
     </p></li><li class="listitem"><p><code class="filename">contrib/pgstattuple</code>の<code class="function">pgstatindex()</code>関数が返す統計の複数の誤りを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p>Perl本体からもはや提供されなくなったため、MSVCビルドで<code class="literal">psed</code>への依存を除去しました。
(Michael Paquier, Andrew Dunstan)
     </p></li><li class="listitem"><p>タイムゾーンデータファイルを<span class="application">tzdata</span> release 2016cに更新しました。
アゼルバイジャン、チリ、ハイチ、パレスチナ、ロシア（アルタイ、アストラハン、キーロフ、サハリン、ウリヤノフスク地域）の夏時間法の変更、加えて、リトアニア、モルドバ、ロシア（カリーニングラード、サマラ、ヴォルゴグラード）の歴史的修正が含まれます。
     </p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-9-5-3.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-9-5-1.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.29. リリース9.5.3 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.31. リリース9.5.1</td></tr></table></div></body></html>