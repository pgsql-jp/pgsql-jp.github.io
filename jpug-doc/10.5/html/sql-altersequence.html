<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ALTER SEQUENCE</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="sql-alterschema.html" title="ALTER SCHEMA" /><link rel="next" href="sql-alterserver.html" title="ALTER SERVER" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">ALTER SEQUENCE</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-alterschema.html" title="ALTER SCHEMA">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="SQLコマンド">Up</a></td><th width="60%" align="center">SQLコマンド</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-alterserver.html" title="ALTER SERVER">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="SQL-ALTERSEQUENCE"><div class="titlepage"></div><a id="id-1.9.3.28.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">ALTER SEQUENCE</span></h2><p>ALTER SEQUENCE —    シーケンスジェネレータの定義を変更する
  </p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="synopsis">ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>name</code></em>
    [ AS <em class="replaceable"><code>data_type</code></em> ]
    [ INCREMENT [ BY ] <em class="replaceable"><code>increment</code></em> ]
    [ MINVALUE <em class="replaceable"><code>minvalue</code></em> | NO MINVALUE ] [ MAXVALUE <em class="replaceable"><code>maxvalue</code></em> | NO MAXVALUE ]
    [ START [ WITH ] <em class="replaceable"><code>start</code></em> ]
    [ RESTART [ [ WITH ] <em class="replaceable"><code>restart</code></em> ] ]
    [ CACHE <em class="replaceable"><code>cache</code></em> ] [ [ NO ] CYCLE ]
    [ OWNED BY { <em class="replaceable"><code>table_name</code></em>.<em class="replaceable"><code>column_name</code></em> | NONE } ]
ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>name</code></em> OWNER TO { <em class="replaceable"><code>new_owner</code></em> | CURRENT_USER | SESSION_USER }
ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>name</code></em> RENAME TO <em class="replaceable"><code>new_name</code></em>
ALTER SEQUENCE [ IF EXISTS ] <em class="replaceable"><code>name</code></em> SET SCHEMA <em class="replaceable"><code>new_schema</code></em></pre></div><div class="refsect1" id="id-1.9.3.28.5"><h2>説明</h2><p><code class="command">ALTER SEQUENCE</code>は、既存のシーケンスジェネレータのパラメータを変更します。
<code class="command">ALTER SEQUENCE</code>で指定されなかったパラメータについては、以前の設定が保持されます。
  </p><p><code class="command">ALTER SEQUENCE</code>を使用するには、シーケンスの所有者でなければなりません。
シーケンスのスキーマを変更するには、新しいスキーマにおける<code class="literal">CREATE</code>権限も持たなければなりません。
所有者を変更するには、新しく所有者となるロールの直接または間接的なメンバでなければなりません。
またそのロールはシーケンスのスキーマ上に<code class="literal">CREATE</code>権限を持たなければなりません。
（これらの制限は、シーケンスの削除および再作成によりユーザが実行できないことを、所有者の変更により実行されないようにするためのものです。
しかし、スーパーユーザはすべてのシーケンスの所有者を変更することができます。）
  </p></div><div class="refsect1" id="id-1.9.3.28.6"><h2>パラメータ</h2><p>    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>name</code></em></span></dt><dd><p>変更するシーケンスの名前です（スキーマ修飾名も可）。
       </p></dd><dt><span class="term"><code class="literal">IF EXISTS</code></span></dt><dd><p>シーケンスが存在しない場合にエラーとしません。
この場合、注意メッセージが発生します。
       </p></dd><dt><span class="term"><em class="replaceable"><code>data_type</code></em></span></dt><dd><p>オプション句<code class="literal">AS <em class="replaceable"><code>data_type</code></em></code>はシーケンスのデータ型を変更します。
有効な型は<code class="literal">smallint</code>、<code class="literal">integer</code>、<code class="literal">bigint</code>です。
       </p><p>データ型を変更したとき、以前の最小値と最大値は、古いデータ型の最小値と最大値に一致している場合に限り（別の言い方をすれば、暗示的にせよ明示的にせよ、シーケンスが<code class="literal">NO MINVALUE</code>または<code class="literal">NO MAXVALUE</code>で作られていいた場合に）、シーケンスの最小値および最大値が自動的に変更されます。
そうでない場合、新しい値が同じコマンドの一部として指定されているのでなければ、最小値と最大値は保存されます。
最小値と最大値が新しいデータ型に適合しない場合は、エラーが生成されます。
       </p></dd><dt><span class="term"><em class="replaceable"><code>increment</code></em></span></dt><dd><p><code class="literal">INCREMENT BY <em class="replaceable"><code>increment</code></em></code>句は省略可能です。
正の値が指定された時は昇順のシーケンス、負の値が指定された時は降順のシーケンスにします。
指定がない場合、以前の増分値が保持されます。
       </p></dd><dt><span class="term"><em class="replaceable"><code>minvalue</code></em><br /></span><span class="term"><code class="literal">NO MINVALUE</code></span></dt><dd><p><code class="literal">MINVALUE <em class="replaceable"><code>minvalue</code></em></code>句はシーケンスジェネレータが生成する最小値を決定します。
<code class="literal">NO MINVALUE</code>が指定された場合、昇順の時は1、降順の時はデータ型の最小値がデフォルトになります。
どちらのオプションも指定されていなければ、現在の最小値が保持されます。
       </p></dd><dt><span class="term"><em class="replaceable"><code>maxvalue</code></em><br /></span><span class="term"><code class="literal">NO MAXVALUE</code></span></dt><dd><p><code class="literal">MAXVALUE <em class="replaceable"><code>maxvalue</code></em></code>句はシーケンスが生成する最大値を決定します。
<code class="literal">NO MAXVALUE</code>が指定された場合、昇順の時はデータ型の最大値、降順の時は-1がデフォルトになります。
どちらのオプションも指定されていなければ、現在の最大値が保持されます。
       </p></dd><dt><span class="term"><em class="replaceable"><code>start</code></em></span></dt><dd><p><code class="literal">START WITH <em class="replaceable"><code>start</code></em></code>句(省略可能)は、記録されているシーケンスの開始値を変更します。
これは<span class="emphasis"><em>現在の</em></span>シーケンス値に影響しません。
単に将来実行される<code class="command">ALTER SEQUENCE RESTART</code>コマンドが使用する値を設定するだけです。
       </p></dd><dt><span class="term"><em class="replaceable"><code>restart</code></em></span></dt><dd><p><code class="literal">RESTART WITH <em class="replaceable"><code>restart</code></em></code>句(省略可能)は、シーケンスの現在値を変更します。
これは<code class="literal">is_called</code> = <code class="literal">false</code>として<code class="function">setval</code>関数を呼び出すことと似ています。
指定した値は<span class="emphasis"><em>次の</em></span><code class="function">nextval</code>呼出時に返されます。
<em class="replaceable"><code>restart</code></em>を付けずに<code class="literal">RESTART</code>と記述することは、<code class="command">CREATE SEQUENCE</code>で記録、または前回<code class="command">ALTER SEQUENCE START WITH</code>で設定された開始値を指定することと同じです。
       </p><p><code class="function">setval</code>の呼び出しとは異なり、シーケンスに対する<code class="literal">RESTART</code>の操作はトランザクション的で、同時実行中のトランザクションが同じシーケンスから値を取得するのをブロックします。
それが期待する動作でないときは、<code class="function">setval</code>を使用してください。
       </p></dd><dt><span class="term"><em class="replaceable"><code>cache</code></em></span></dt><dd><p><code class="literal">CACHE <em class="replaceable"><code>cache</code></em></code>句を使用すると、アクセスを高速化するために、シーケンス番号を事前に割り当て、メモリに保存しておくことができます。
最小値は1です（一度に生成する値が1つだけなので、キャッシュがない状態になります）。
指定がなければ、以前のキャッシュ値が保持されます。
       </p></dd><dt><span class="term"><code class="literal">CYCLE</code></span></dt><dd><p><code class="literal">CYCLE</code>キーワードを使用すると、シーケンスが限界値（昇順の場合は<em class="replaceable"><code>maxvalue</code></em>、降順の場合は<em class="replaceable"><code>minvalue</code></em>）に達した時、そのシーケンスを周回させることができます。
限界値に達した時、次に生成される番号は、昇順の場合は<em class="replaceable"><code>minvalue</code></em>、降順の場合は<em class="replaceable"><code>maxvalue</code></em>になります。
       </p></dd><dt><span class="term"><code class="literal">NO CYCLE</code></span></dt><dd><p><code class="literal">NO CYCLE</code>キーワードが指定されると、シーケンスの限界値に達した後の<code class="function">nextval</code>呼び出しは全てエラーとなります。
<code class="literal">CYCLE</code>も<code class="literal">NO CYCLE</code>も指定されていない場合は、以前の周回動作が保持されます。
       </p></dd><dt><span class="term"><code class="literal">OWNED BY</code> <em class="replaceable"><code>table_name</code></em>.<em class="replaceable"><code>column_name</code></em><br /></span><span class="term"><code class="literal">OWNED BY NONE</code></span></dt><dd><p><code class="literal">OWNED BY</code>オプションにより、シーケンスは指定されたテーブル列に関連付けられ、その列（やテーブル全体）が削除されると、自動的にシーケンスも一緒に削除されるようになります。
指定があると、以前に指定されたシーケンスの関連は、指定された関連に置き換えられます。
指定するテーブルは、シーケンスと同一所有者でなければならず、また、同一のスキーマ内に存在しなければなりません。
<code class="literal">OWNED BY NONE</code>を指定することで、既存の関連は削除され、シーケンスは<span class="quote">“<span class="quote">独立</span>”</span>したものになります。

     </p></dd><dt><span class="term"><em class="replaceable"><code>new_owner</code></em></span></dt><dd><p>シーケンスの新しい所有者のユーザ名です。
     </p></dd><dt><span class="term"><em class="replaceable"><code>new_name</code></em></span></dt><dd><p>シーケンスの新しい名称です。
     </p></dd><dt><span class="term"><em class="replaceable"><code>new_schema</code></em></span></dt><dd><p>シーケンスの新しいスキーマです。
     </p></dd></dl></div><p>
   </p></div><div class="refsect1" id="id-1.9.3.28.7"><h2>注釈</h2><p><code class="command">ALTER SEQUENCE</code>は、コマンドを実行したバックエンド以外のバックエンドにおける<code class="function">nextval</code>に対しては、すぐには効力を発揮しません。
これらのバックエンドに事前に割り当てられた（キャッシュされた）シーケンス値がある場合、この値を全て使い果たした後に、変更されたシーケンス生成パラメータを検知します。
コマンドを実行したバックエンドには、即座に変更が反映されます。

  </p><p><code class="command">ALTER SEQUENCE</code>はシーケンスの<code class="function">currval</code>状態には影響しません。
（8.3より前の<span class="productname">PostgreSQL</span>では影響を与える場合がありました。）
  </p><p><code class="command">ALTER SEQUENCE</code>は、同時に実行される<code class="function">nextval</code>、<code class="function">currval</code>、<code class="function">lastval</code>、<code class="command">setval</code>の呼び出しをブロックします。
  </p><p>歴史的な理由により<code class="command">ALTER TABLE</code>はシーケンスにも使用することができます。
しかし、シーケンスに対して許される<code class="command">ALTER TABLE</code>の構文は、上で示した構文と等価なものだけです。
  </p></div><div class="refsect1" id="id-1.9.3.28.8"><h2>例</h2><p><code class="literal">serial</code>というシーケンスを105から再開します。
</p><pre class="programlisting">ALTER SEQUENCE serial RESTART WITH 105;</pre></div><div class="refsect1" id="id-1.9.3.28.9"><h2>互換性</h2><p><code class="command">ALTER SEQUENCE</code>は、<span class="productname">PostgreSQL</span>の拡張である<code class="literal">AS</code>、<code class="literal">START WITH</code>、<code class="literal">OWNED BY</code>、<code class="literal">OWNER TO</code>、<code class="literal">RENAME TO</code>、<code class="literal">SET SCHEMA</code>構文を除いて、標準<acronym class="acronym">SQL</acronym>に従っています。
  </p></div><div class="refsect1" id="id-1.9.3.28.10"><h2>関連項目</h2><span class="simplelist"><a class="xref" href="sql-createsequence.html" title="CREATE SEQUENCE"><span class="refentrytitle">CREATE SEQUENCE</span></a>, <a class="xref" href="sql-dropsequence.html" title="DROP SEQUENCE"><span class="refentrytitle">DROP SEQUENCE</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-alterschema.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-alterserver.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">ALTER SCHEMA </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> ALTER SERVER</td></tr></table></div></body></html>