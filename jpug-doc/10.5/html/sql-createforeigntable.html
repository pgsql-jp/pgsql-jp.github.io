<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE FOREIGN TABLE</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="sql-createforeigndatawrapper.html" title="CREATE FOREIGN DATA WRAPPER" /><link rel="next" href="sql-createfunction.html" title="CREATE FUNCTION" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">CREATE FOREIGN TABLE</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-createforeigndatawrapper.html" title="CREATE FOREIGN DATA WRAPPER">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="SQLコマンド">Up</a></td><th width="60%" align="center">SQLコマンド</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-createfunction.html" title="CREATE FUNCTION">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="SQL-CREATEFOREIGNTABLE"><div class="titlepage"></div><a id="id-1.9.3.63.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">CREATE FOREIGN TABLE</span></h2><p>CREATE FOREIGN TABLE — 新しい外部テーブルを定義する</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="synopsis">CREATE FOREIGN TABLE [ IF NOT EXISTS ] <em class="replaceable"><code>table_name</code></em> ( [
  { <em class="replaceable"><code>column_name</code></em> <em class="replaceable"><code>data_type</code></em> [ OPTIONS ( <em class="replaceable"><code>option</code></em> '<em class="replaceable"><code>value</code></em>' [, ... ] ) ] [ COLLATE <em class="replaceable"><code>collation</code></em> ] [ <em class="replaceable"><code>column_constraint</code></em> [ ... ] ]
    | <em class="replaceable"><code>table_constraint</code></em> }
    [, ... ]
] )
[ INHERITS ( <em class="replaceable"><code>parent_table</code></em> [, ... ] ) ]
  SERVER <em class="replaceable"><code>server_name</code></em>
[ OPTIONS ( <em class="replaceable"><code>option</code></em> '<em class="replaceable"><code>value</code></em>' [, ... ] ) ]

CREATE FOREIGN TABLE [ IF NOT EXISTS ] <em class="replaceable"><code>table_name</code></em>
  PARTITION OF <em class="replaceable"><code>parent_table</code></em> [ (
  { <em class="replaceable"><code>column_name</code></em> [ WITH OPTIONS ] [ <em class="replaceable"><code>column_constraint</code></em> [ ... ] ]
    | <em class="replaceable"><code>table_constraint</code></em> }
    [, ... ]
) ] <em class="replaceable"><code>partition_bound_spec</code></em>
  SERVER <em class="replaceable"><code>server_name</code></em>
[ OPTIONS ( <em class="replaceable"><code>option</code></em> '<em class="replaceable"><code>value</code></em>' [, ... ] ) ]

<span class="phrase">ここで<em class="replaceable"><code>column_constraint</code></em>は以下の通りです。</span>

[ CONSTRAINT <em class="replaceable"><code>constraint_name</code></em> ]
{ NOT NULL |
  NULL |
  CHECK ( <em class="replaceable"><code>expression</code></em> ) [ NO INHERIT ] |
  DEFAULT <em class="replaceable"><code>default_expr</code></em> }

<span class="phrase">また<em class="replaceable"><code>table_constraint</code></em>は以下の通りです。</span>

[ CONSTRAINT <em class="replaceable"><code>constraint_name</code></em> ]
CHECK ( <em class="replaceable"><code>expression</code></em> ) [ NO INHERIT ]</pre></div><div class="refsect1" id="SQL-CREATEFOREIGNTABLE-DESCRIPTION"><h2>説明</h2><p><code class="command">CREATE FOREIGN TABLE</code>は現在のデータベース内に新しい外部テーブルを作成します。
このテーブルはコマンドを発行したユーザにより所有されます。
  </p><p>スキーマ名が指定された場合（例えば<code class="literal">CREATE FOREIGN TABLE myschema.mytable ...</code>）、テーブルは指定されたスキーマ内に作成されます。
そうでなければ現在のスキーマ内に作成されます。
外部テーブルの名前は同じスキーマ内にある他の外部テーブル、テーブル、シーケンス、インデックス、ビュー、マテリアライズドビューと異なるものでなければなりません。
  </p><p><code class="command">CREATE FOREIGN TABLE</code>はまた自動的に外部テーブルの１行に対応する複合型を表すデータ型を作成します。
したがって外部テーブルは同じスキーマ内の既存のデータ型の名前と同じものを持つことができません。
  </p><p><code class="literal">PARTITION OF</code>句が指定された場合、テーブルは<code class="literal">parent_table</code>の指定された境界のパーティションとして作られます。
  </p><p>外部テーブルを作成するためには、外部サーバに対する<code class="literal">USAGE</code>権限とテーブルで使用される列の型すべてに対する<code class="literal">USAGE</code>権限を持たなければなりません。
  </p></div><div class="refsect1" id="id-1.9.3.63.6"><h2>パラメータ</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">IF NOT EXISTS</code></span></dt><dd><p>同じ名前のリレーションがすでに存在していてもエラーとしません。
この場合注意が発せられます。
既存のリレーションが作成しようとしたものと何かしら似たものであることは保証されません。
     </p></dd><dt><span class="term"><em class="replaceable"><code>table_name</code></em></span></dt><dd><p>作成するテーブルの名前です（スキーマ修飾名でも可）。
     </p></dd><dt><span class="term"><em class="replaceable"><code>column_name</code></em></span></dt><dd><p>新しいテーブルで作成される列の名前です。
     </p></dd><dt><span class="term"><em class="replaceable"><code>data_type</code></em></span></dt><dd><p>列のデータ型です。
これには、配列指定子を含めることができます。
<span class="productname">PostgreSQL</span>でサポートされるデータ型の情報に関する詳細は<a class="xref" href="datatype.html" title="Chapter 8. データ型">Chapter 8</a>を参照してください。
     </p></dd><dt><span class="term"><code class="literal">COLLATE <em class="replaceable"><code>collation</code></em></code></span></dt><dd><p><code class="literal">COLLATE</code>句は列（照合可能なデータ型でなければなりません）の照合順序を指定します。
指定されなければ、列のデータ型のデフォルトの照合順序が使用されます。
     </p></dd><dt><span class="term"><code class="literal">INHERITS ( <em class="replaceable"><code>parent_table</code></em> [, ... ] )</code></span></dt><dd><p>オプションで<code class="literal">INHERITS</code>句を使い、新しい外部テーブルが自動的にすべての列を継承するテーブルのリストを指定できます。
親テーブルには通常のテーブルまたは外部テーブルが指定できます。
詳しくは<a class="xref" href="sql-createtable.html" title="CREATE TABLE"><span class="refentrytitle">CREATE TABLE</span></a>の類似の構文を参照してください。
     </p></dd><dt><span class="term"><code class="literal">CONSTRAINT <em class="replaceable"><code>constraint_name</code></em></code></span></dt><dd><p>列制約またはテーブル制約の名前（省略可）です。
制約に違反した時、エラーメッセージ内に制約名が表示されるので、<code class="literal">col must be positive</code>のような制約名を使って、クライアントアプリケーションに役立つ制約情報を通知することができます。
（空白文字を含む制約名を指定するには二重引用符を使う必要があります。）
制約名が指定されなければ、システムが名前を生成します。
     </p></dd><dt><span class="term"><code class="literal">NOT NULL</code></span></dt><dd><p>その列がNULL値を持てないことを指定します。
     </p></dd><dt><span class="term"><code class="literal">NULL</code></span></dt><dd><p>その列がNULL値を持てることを指定します。
これがデフォルトです。
     </p><p>この句は非標準的なSQLデータベースとの互換性のためだけに提供されています。
新しいアプリケーションでこれを使用するのはお勧めしません。
     </p></dd><dt><span class="term"><code class="literal">CHECK ( <em class="replaceable"><code>expression</code></em> ) [ NO INHERIT ] </code></span></dt><dd><p><code class="literal">CHECK</code>句では、外部テーブルの各行が満たすと期待されるブーリアン結果を生成する式を指定します。
つまり、式は外部テーブルのすべての行に対して、TRUEまたはUNKNOWNを生成し、決してFALSEにはなりません。
列制約として指定したチェック制約はその列の値だけを参照しますが、テーブル制約として使われる式は複数の列を参照することができます。
     </p><p>現在のところ、<code class="literal">CHECK</code>の式は副問い合わせを含むことや、現在の行の列以外の変数を参照することはできません。
システム列<code class="literal">tableoid</code>を参照することはできますが、それ以外のシステム列を参照することはできません。
     </p><p><code class="literal">NO INHERIT</code>と印を付けられた制約は、子テーブルに継承されません。
     </p></dd><dt><span class="term"><code class="literal">DEFAULT
    <em class="replaceable"><code>default_expr</code></em></code></span></dt><dd><p><code class="literal">DEFAULT</code>句は、
列定義の中に現れる、列に対するデフォルトデータ値を割り当てます。
値は変数がない任意の式（副問い合わせおよび、現在のテーブル内の他の列へのクロス参照は許されません）です。
デフォルト式のデータ型は列のデータ型とマッチしなければなりません。
     </p><p>デフォルト式は、列に対する値指定がないすべての挿入操作で使用されます。
列に対するデフォルトがない場合、デフォルトはNULLです。
     </p></dd><dt><span class="term"><em class="replaceable"><code>server_name</code></em></span></dt><dd><p>外部テーブル用に使用される既存の外部サーバの名前です。
外部サーバの詳細については<a class="xref" href="sql-createserver.html" title="CREATE SERVER"><span class="refentrytitle">CREATE SERVER</span></a>を参照してください。
     </p></dd><dt><span class="term"><code class="literal">OPTIONS ( <em class="replaceable"><code>option</code></em> '<em class="replaceable"><code>value</code></em>' [, ...] )</code></span></dt><dd><p>新しい外部テーブルまたはその列の１つに関連するオプションです。
設定可能なオプションの名前と値は外部データラッパそれぞれに固有なものであり、外部データラッパの検証関数を用いて検証されます。
重複するオプション名は許されません（しかしテーブルオプションと列オプションでは同じ名前を持たせることはできます）。
     </p></dd></dl></div></div><div class="refsect1" id="id-1.9.3.63.7"><h2>注釈</h2><p>外部テーブル上の制約（<code class="literal">CHECK</code>句や<code class="literal">NOT NULL</code>句など）は<span class="productname">PostgreSQL</span>のコアシステムによって強制されませんし、ほとんどの外部データラッパもそれを強制しようとはしません。
つまり、制約は単にそれが成り立つと仮定されるものです。
制約は外部テーブルの機能を使って行を挿入あるいは更新するときにのみ適用され、リモートサーバ上で直接更新するなど、他の手段による行の更新には適用されませんから、それを強制することにはあまり意味はありません。
その代わりに、外部テーブルに指定する制約は、リモートサーバによって強制される制約を表現するものであるべきです。
   </p><p>一部の特別な目的の外部データラッパは、それがアクセス対象のデータにアクセスするための唯一の機構であり、またその場合、外部データラッパそれ自体にとって、制約の強制を実行することが適切なことがあります。
ただし、ラッパのドキュメントにそのように書いてあるのでなければ、それを仮定しない方が良いでしょう。
   </p><p><span class="productname">PostgreSQL</span>では外部テーブルの制約を強制しませんが、問い合わせの最適化という目的のため、制約が正しいということを仮定します。
外部テーブルで、宣言された制約を満たさない行が可視の状態で存在する場合、そのテーブルに対する問い合わせは誤った結果をもたらすかもしれません。
制約の定義が現実に即したものであることを保証するのは、ユーザの責任です。
   </p></div><div class="refsect1" id="SQL-CREATEFOREIGNTABLE-EXAMPLES"><h2>例</h2><p>サーバ<code class="structname">film_server</code>を通してアクセスされる、外部テーブル<code class="structname">films</code>を作成します。

</p><pre class="programlisting">CREATE FOREIGN TABLE films (
    code        char(5) NOT NULL,
    title       varchar(40) NOT NULL,
    did         integer NOT NULL,
    date_prod   date,
    kind        varchar(10),
    len         interval hour to minute
)
SERVER film_server;</pre><p>範囲パーティションテーブル<code class="structname">measurement</code>のパーティションとして、サーバ<code class="structname">server_07</code>を通してアクセスされる外部テーブル<code class="structname">measurement_y2016m07</code>を作成します。

</p><pre class="programlisting">CREATE FOREIGN TABLE measurement_y2016m07
    PARTITION OF measurement FOR VALUES FROM ('2016-07-01') TO ('2016-08-01')
    SERVER server_07;</pre></div><div class="refsect1" id="SQL-CREATEFOREIGNTABLE-COMPATIBILITY"><h2>互換性</h2><p><code class="command">CREATE FOREIGN TABLE</code>はおおよそ標準<acronym class="acronym">SQL</acronym>に準拠します。
しかし<a class="link" href="sql-createtable.html" title="CREATE TABLE"><code class="command">CREATE TABLE</code></a>とほとんど同様、<code class="literal">NULL</code>制約とゼロ列の外部テーブルが許されます。
列のデフォルト値を指定する機能も<span class="productname">PostgreSQL</span>の拡張です。
<span class="productname">PostgreSQL</span>が定義する形式のテーブルの継承は標準とは異なります。
  </p></div><div class="refsect1" id="id-1.9.3.63.10"><h2>関連項目</h2><span class="simplelist"><a class="xref" href="sql-alterforeigntable.html" title="ALTER FOREIGN TABLE"><span class="refentrytitle">ALTER FOREIGN TABLE</span></a>, <a class="xref" href="sql-dropforeigntable.html" title="DROP FOREIGN TABLE"><span class="refentrytitle">DROP FOREIGN TABLE</span></a>, <a class="xref" href="sql-createtable.html" title="CREATE TABLE"><span class="refentrytitle">CREATE TABLE</span></a>, <a class="xref" href="sql-createserver.html" title="CREATE SERVER"><span class="refentrytitle">CREATE SERVER</span></a>, <a class="xref" href="sql-importforeignschema.html" title="IMPORT FOREIGN SCHEMA"><span class="refentrytitle">IMPORT FOREIGN SCHEMA</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-createforeigndatawrapper.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-createfunction.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">CREATE FOREIGN DATA WRAPPER </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> CREATE FUNCTION</td></tr></table></div></body></html>