<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>23.1. ロケールのサポート</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="charset.html" title="Chapter 23. 多言語対応" /><link rel="next" href="collation.html" title="23.2. 照合順序サポート" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">23.1. ロケールのサポート</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="charset.html" title="Chapter 23. 多言語対応">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="charset.html" title="Chapter 23. 多言語対応">Up</a></td><th width="60%" align="center">Chapter 23. 多言語対応</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="collation.html" title="23.2. 照合順序サポート">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="LOCALE"><div class="titlepage"><div><div><h2 class="title" style="clear: both">23.1. ロケールのサポート</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="locale.html#id-1.6.10.3.4">23.1.1. 概要</a></span></dt><dt><span class="sect2"><a href="locale.html#id-1.6.10.3.5">23.1.2. 動作</a></span></dt><dt><span class="sect2"><a href="locale.html#id-1.6.10.3.6">23.1.3. 問題点</a></span></dt></dl></div><a id="id-1.6.10.3.2" class="indexterm"></a><p><em class="firstterm">ロケール</em>のサポートはアルファベット、並び換え、数字の書式など文化的嗜好を配慮したアプリケーションを対象にします。
<span class="productname">PostgreSQL</span>は、サーバのオペレーティングシステムが提供する、標準ISO Cと<acronym class="acronym">POSIX</acronym>のロケール機能を使用します。
これ以上の情報についてはお使いのシステムのドキュメントを参照ください。
  </p><div class="sect2" id="id-1.6.10.3.4"><div class="titlepage"><div><div><h3 class="title">23.1.1. 概要</h3></div></div></div><p>ロケールのサポートは、<code class="command">initdb</code>を使用してデータベースクラスタを作成する時自動的に初期化されます。
<code class="command">initdb</code>は、デフォルトでその実行環境のロケール設定に従ってデータベースクラスタを初期化します。
そのため、システムがデータベースクラスタで使用したいロケールを使用するように既に設定してある場合は何も行う必要はありません。
違うロケールを使用したい場合（またはシステムのロケール設定が不明な場合）は、<code class="command">initdb</code>の<code class="option">--locale</code>オプションで希望のロケールを指定することができます。
以下に例を示します。
</p><pre class="screen">initdb --locale=sv_SE</pre><p>
   </p><p>Unixシステム用のこの例の設定はロケールをスウェーデン（<code class="literal">SE</code>）で使用されているスウェーデン語（<code class="literal">sv</code>）に合わせています。
他にも<code class="literal">en_US</code>（米国英語）や<code class="literal">fr_CA</code>（カナダのフランス語）などの設定もできます。
ロケールに複数の文字セットが使用可能であれば、<em class="replaceable"><code>language_territory.codeset</code></em>のように記述することができます。
例えば、<code class="literal">fr_BE.UTF-8</code>はベルギー（BE）で使用されているフランス語（fr）で<acronym class="acronym">UTF-8</acronym>の文字セットを表します。
   </p><p>お使いのシステムでどのロケールがどういう名前で使えるかはオペレーティングシステムのベンダがどのようなものを提供しているかと、何がインストールされているかに依存します。
ほとんどのUnixシステムでは、<code class="literal">locale -a</code>というコマンドで利用可能なロケールの一覧を入手することができます。
Windowsは、<code class="literal">German_Germany</code>や<code class="literal">Swedish_Sweden.1252</code>のようなもっと冗長なロケール名を使用しますが、原理は同じです。
   </p><p>英語の照合順序規則でスペイン語のメッセージを使用する時など、時として複数のロケールの規則を併用すると便利です。
これをサポートするために、ロケールには以下のような多言語対応規則の特定の箇所だけを管理する一連のサブカテゴリがあります。

    </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td><code class="envar">LC_COLLATE</code></td><td>文字列の並び換え順</td></tr><tr><td><code class="envar">LC_CTYPE</code></td><td>文字の分類（文字とはどんなもの？大文字小文字を区別しない？）</td></tr><tr><td><code class="envar">LC_MESSAGES</code></td><td>メッセージの言語</td></tr><tr><td><code class="envar">LC_MONETARY</code></td><td>通貨書式</td></tr><tr><td><code class="envar">LC_NUMERIC</code></td><td>数字の書式</td></tr><tr><td><code class="envar">LC_TIME</code></td><td>日付と時刻の書式</td></tr></tbody></table></div><p>

これらのカテゴリの名前は、特定のカテゴリについてのロケールの選択を上書きするための<code class="command">initdb</code>オプションの名前としてそのまま使用できます。
例えば、ロケールをカナダのフランス語に設定しながら通貨書式については米国の規則を使用するには、<code class="literal">initdb --locale=fr_CA --lc-monetary=en_US</code>とします。
   </p><p>システムがロケールをサポートしていないように動作させたい場合は、特別なロケールの<code class="literal">C</code>、もしくは同等な<code class="literal">POSIX</code>を使用してください。
   </p><p>一部のロケールカテゴリでは、その値がデータベース生成時に固定されていなければならないものがあります。
他のデータベースで他の設定を使用することができますが、一度データベースが生成されると、そのデータベースでは変更することができません。
<code class="literal">LC_COLLATE</code>と<code class="literal">LC_CTYPE</code>がこれらのカテゴリにあてはまります。
これらはインデックスのソート順に影響を及ぼすため、固定されていなければなりません。
さもないと、テキスト型の列上のインデックスは破壊されるでしょう。
(しかし<a class="xref" href="collation.html" title="23.2. 照合順序サポート">Section 23.2</a>内で述べられているように、照合順序を使用することで、この制限を緩和することができます)
<code class="command">initdb</code>が実行された時に、これらのカテゴリのデフォルト値は決定され、<code class="command">CREATE DATABASE</code>コマンドで他を指定しない限り、新しいデータベースが作成されるときにこの値が使用されます。
   </p><p>その他のロケールカテゴリは、いつでも、ロケールカテゴリと同じ名前の実行時パラメータを設定することで、希望値に変更することができます
（詳細は<a class="xref" href="runtime-config.html" title="Chapter 19. サーバの設定">Chapter 19</a>を参照してください）。
<code class="command">initdb</code>で選択された値は、実際のところ、サーバの起動時にデフォルトとして動作するように<code class="filename">postgresql.conf</code>設定ファイルに書き込まれるだけです。
この代入文を<code class="filename">postgresql.conf</code>から削除すると、サーバは実行環境の設定をそのまま使用します。
   </p><p>サーバのロケールの動作はどのクライアントの環境にも依存せず、サーバが参照できる環境変数で決まります。
ですからサーバを稼動させる前に正しいロケール設定を行うように注意してください。
結果としてサーバとクライアントで異なるロケールが設定されていると、メッセージはそれらがどこから生じたかによって、異なる言語で表示されます。
   </p><div class="note"><h3 class="title">Note</h3><p>実行環境のロケールをそのまま使用するということは、ほとんどのオペレーティングシステムでは次のような意味を持ちます。
指定されたロケールカテゴリ（例えば照合順序）について、設定するものが見つかるまで、以下の環境変数がこの順番で調べられます。<code class="envar">LC_ALL</code>、<code class="envar">LC_COLLATE</code>（またはそれぞれのカテゴリに対応する変数）、<code class="envar">LANG</code>。
これらのいずれの環境変数も設定されない場合に、ロケールはデフォルトで<code class="literal">C</code>に設定されます。
    </p><p>メッセージの言語を設定する目的で、メッセージ多言語化ライブラリの中には全てのロケール設定を上書きする環境変数<code class="envar">LANGUAGE</code>を検索するものがあります。
お使いのシステムでの挙動が不明ならばより詳細な情報を得るためお使いのオペレーティングシステムの文書、特に<span class="application">gettext</span>の文書を参照してください。
    </p></div><p>ユーザの選択した言語にメッセージを翻訳できるようにするためには<acronym class="acronym">NLS</acronym>を構築時に有効にする（<code class="literal">configure --enable-nls</code>）必要があります。
他のロケールサポートはすべて自動的に構築されます。
   </p></div><div class="sect2" id="id-1.6.10.3.5"><div class="titlepage"><div><div><h3 class="title">23.1.2. 動作</h3></div></div></div><p>ロケールの設定は以下のSQL機能に影響を与えます。

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>文字列データに対する<code class="literal">ORDER BY</code>または標準の比較演算子を使用した問い合わせにおける並び替え順
<a id="id-1.6.10.3.5.2.1.1.1.2" class="indexterm"></a>
      </p></li><li class="listitem"><p><code class="function">upper</code>、<code class="function">lower</code>、<code class="function">initcap</code>関数
<a id="id-1.6.10.3.5.2.1.2.1.4" class="indexterm"></a>
<a id="id-1.6.10.3.5.2.1.2.1.5" class="indexterm"></a>
      </p></li><li class="listitem"><p>(<code class="literal">LIKE</code>、<code class="literal">SIMILAR TO</code>やPOSIX形式の正規表現といった)パターンマッチング演算子では
ロケールは大文字、小文字を区別せず正規表現の文字クラスによる文字の区別に影響を及ぼします。
<a id="id-1.6.10.3.5.2.1.3.1.3" class="indexterm"></a>
<a id="id-1.6.10.3.5.2.1.3.1.4" class="indexterm"></a>
      </p></li><li class="listitem"><p>一群の<code class="function">to_char</code>関数
<a id="id-1.6.10.3.5.2.1.4.1.2" class="indexterm"></a>
      </p></li><li class="listitem"><p><code class="literal">LIKE</code>節が付いたインデックスを使用する性能
      </p></li></ul></div><p>
   </p><p><code class="literal">C</code>や<code class="literal">POSIX</code>以外で、<span class="productname">PostgreSQL</span>でロケールを使用する際の欠点は実行速度です。
ロケールは文字の扱いを遅くし、さらに<code class="literal">LIKE</code>で通常のインデックスが使用されなくなります。この理由から、本当に必要な時のみロケールを使用してください。
   </p><p>C以外のロケールにおいて、<span class="productname">PostgreSQL</span>が<code class="literal">LIKE</code>句を持つインデックスを使用できるようにする回避方法として、いくつかのカスタム演算子クラスがあります。
これらを用いると、文字と文字を厳密に比較するようなインデックスや、ロケールの比較規則を無視するようなインデックスを作成できます。
詳細は<a class="xref" href="indexes-opclass.html" title="11.9. 演算子クラスと演算子族">Section 11.9</a>を参照してください。
もうひとつの方法は、<a class="xref" href="collation.html" title="23.2. 照合順序サポート">Section 23.2</a>内で解説されているような<code class="literal">C</code>照合順序を使用してインデックスを作成することです。
   </p></div><div class="sect2" id="id-1.6.10.3.6"><div class="titlepage"><div><div><h3 class="title">23.1.3. 問題点</h3></div></div></div><p>上記の説明に従ってロケールのサポートが正常に動作しない場合、オペレーティングシステムのロケールサポートが正確に設定されているか確認してください。
指定されたロケールがインストールされているかどうか確認するために、オペレーティングシステムが提供していれば、<code class="literal">locale -a</code>コマンドを使用することができます。
   </p><p><span class="productname">PostgreSQL</span>が想定しているロケールを実際に使用しているかどうかを確認してください。
<code class="envar">LC_COLLATE</code>と<code class="envar">LC_CTYPE</code>の設定はデータベース作成時に決定され、新しいデータベースを作成する方法以外に変更することはできません。
<code class="envar">LC_MESSAGES</code>や<code class="envar">LC_MONETARY</code>など他のロケール設定はサーバ起動時の環境変数によって初めに決定されますが、その場で変更することができます。
<code class="command">SHOW</code>コマンドを使用して、使用中のロケール設定を確認することができます。
   </p><p>ソース配布物の<code class="filename">src/test/locale</code>ディレクトリには、<span class="productname">PostgreSQL</span>のロケールサポート用の試験一式があります。
   </p><p>エラーメッセージ内のテキストを解析してサーバ側のエラーを扱っているクライアントアプリケーションでは、サーバのメッセージが異なる言語で記載されると、明らかに問題になります。
こうしたアプリケーションの作者には、エラーコードスキームで代替させることを推奨します。
   </p><p>メッセージ翻訳のカタログのメンテナンスには<span class="productname">PostgreSQL</span>に選択した言語を話させてみたいという数多くのボランティアのたゆみのない努力を必要としています。
もしあなたの言語が現在使えなかったり完全に翻訳されてない場合、助力をよろしくお願いします。
もし助力頂けるのであれば、<a class="xref" href="nls.html" title="Chapter 54. 多言語サポート">Chapter 54</a>を参照するか開発グループのメーリングリストに投稿してください。
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="charset.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="charset.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="collation.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 23. 多言語対応 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 23.2. 照合順序サポート</td></tr></table></div></body></html>