<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>45.1. Python 2対Python 3</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="plpython.html" title="Chapter 45. PL/Python - Python手続き言語" /><link rel="next" href="plpython-funcs.html" title="45.2. PL/Python関数" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">45.1. Python 2対Python 3</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="plpython.html" title="Chapter 45. PL/Python - Python手続き言語">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="plpython.html" title="Chapter 45. PL/Python - Python手続き言語">Up</a></td><th width="60%" align="center">Chapter 45. PL/Python - Python手続き言語</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="plpython-funcs.html" title="45.2. PL/Python関数">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="PLPYTHON-PYTHON23"><div class="titlepage"><div><div><h2 class="title" style="clear: both">45.1. Python 2対Python 3</h2></div></div></div><p>PL/PythonはPython 2およびPython 3言語の両方をサポートします。
(PostgreSQLのインストール手順では、サポートするPythonの細かなマイナーバージョンに関して、より正確な情報が記載されています。)
Python 2及びPython 3言語には重要な側面でいくつか互換性がありませんので、混在を防ぐためにPL/Pythonでは以下の命名ならびに移行計画が使用されています。

   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">plpython2u</code>という名前のPostgreSQL言語はPython 2言語に基づいたPL/Pythonを実装します。
     </p></li><li class="listitem"><p><code class="literal">plpython3u</code>という名前のPostgreSQL言語はPython 3言語に基づいたPL/Pythonを実装します。
     </p></li><li class="listitem"><p><code class="literal">plpythonu</code>という名前の言語はデフォルトのPython言語(現時点ではPython 2)に基づいたPL/Pythonを実装します。
(このデフォルトはどのローカルにインストールされたPythonがその<span class="quote">“<span class="quote">デフォルト</span>”</span>とみなされるか、例えば<code class="filename">/usr/bin/python</code>が何を示すか、とは独立しています。)
PythonコミュニティにおけるPython 3への移行の進行状況に依存しますが、おそらく近い将来のPostgreSQLのデフォルトはPython 3に変わります。
     </p></li></ul></div><p>

この計画は、<a class="ulink" href="http://www.python.org/dev/peps/pep-0394/" target="_top">PEP 394</a>内の、<code class="command">python</code>コマンドの命名と移行に関する推奨に類似しています。
  </p><p>Python 2用のPL/PythonかPython 3用のPL/Python、またはその両方が利用できるかどうかは、構築時の設定またはインストールしたパッケージに依存します。
  </p><div class="tip"><h3 class="title">Tip</h3><p>どのバージョンのPythonがインストール時に検出されるか、または、<code class="envar">PYTHON</code>環境変数を使用してバージョンを明示的に設定することで、構築される亜種が決まります。
<a class="xref" href="install-procedure.html" title="16.4. インストール手順">Section 16.4</a>を参照してください。
１つのインストレーションで両方のPL/Pythonを利用可能にするためには、ソースツリーでconfigureと構築を２回行う必要があります。
   </p></div><p>この結果以下のような使用方法と移行戦略となります。

   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>既存のユーザおよび現時点でPython 3に興味を持たないユーザは<code class="literal">plpythonu</code>という名前の言語を使用し、当分の間何も変更する必要はありません。
最終的なPython 3への移行を簡単にするために、Python 2.6/2.7への移行を介してコードを少しずつ<span class="quote">“<span class="quote">将来に備える</span>”</span>ことを勧めます。
     </p><p>実際には、多くのPL/Python関数はそのまま、またはわずかな変更を行うことでPython 3に移行されます。
     </p></li><li class="listitem"><p>Python 2に大きく依存するコードがあることが分かっていて、変更する予定がないユーザは<code class="literal">plpython2u</code>言語名を使用することができます。
これは、PostgreSQLでPython 2のサポートが完全になくなる、非常に先の将来まで動作し続けます。
     </p></li><li class="listitem"><p>Python 3に挑戦したいユーザは、現在の標準では永久に動作し続ける<code class="literal">plpython3u</code>言語名を使用できます。
遠い将来、Python 3がデフォルトになった時、美的な理由から<span class="quote">“<span class="quote">3</span>”</span>という文字はなくなることになるでしょう。
     </p></li><li class="listitem"><p>Python 3のみのオペレーティングシステム環境を構築したい、恐れを知らぬユーザは、<a class="link" href="catalog-pg-pltemplate.html" title="51.37. pg_pltemplate"><code class="structname">pg_pltemplate</code></a>の内容を変更して、<code class="literal">plpythonu</code>が<code class="literal">plpython3u</code>を示すようにすることができます。
ただし、世間一般と互換性がないインストレーションを作成していることを覚えておいてください。
     </p></li></ul></div><p>
  </p><p>また、Python 3への移植に関する情報については<a class="ulink" href="http://docs.python.org/py3k/whatsnew/3.0.html" target="_top">Python 3.0における新機能</a>文書を参照してください。
  </p><p>Python 2を基にしたPL/PythonとPython 3を基にしたPL/Pythonを同じセッションで使用することはできません。
動的モジュール内のシンボルが相反するため、こうするとPostgreSQLサーバプロセスがクラッシュしてしまうためです。
あるセッション内でPythonのメジャーバージョンが混在させないための検査があり、不一致が見つかるとセッションは中断されます。
しかし別々のセッションからであれば、同じデータベースにおいて異なるPL/Pythonの両方を使用することができます。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="plpython.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="plpython.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="plpython-funcs.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 45. PL/Python - Python手続き言語 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 45.2. PL/Python関数</td></tr></table></div></body></html>