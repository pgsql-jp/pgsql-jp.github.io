<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>19.10. 自動Vacuum作業</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="runtime-config-statistics.html" title="19.9. 実行時統計情報" /><link rel="next" href="runtime-config-client.html" title="19.11. クライアント接続デフォルト" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">19.10. 自動Vacuum作業</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="runtime-config-statistics.html" title="19.9. 実行時統計情報">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="runtime-config.html" title="Chapter 19. サーバの設定">Up</a></td><th width="60%" align="center">Chapter 19. サーバの設定</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="runtime-config-client.html" title="19.11. クライアント接続デフォルト">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RUNTIME-CONFIG-AUTOVACUUM"><div class="titlepage"><div><div><h2 class="title" style="clear: both">19.10. 自動Vacuum作業</h2></div></div></div><a id="id-1.6.6.13.2" class="indexterm"></a><p>     
      以下に示す設定は<em class="firstterm">自動バキューム</em>機能の動作を制御します。詳細は<a class="xref" href="routine-vacuuming.html#AUTOVACUUM" title="24.1.6. 自動バキュームデーモン">Section 24.1.6</a>を参照してください。
これらの設定の多くは、テーブル単位で変更できることに注意してください。
<a class="xref" href="sql-createtable.html#SQL-CREATETABLE-STORAGE-PARAMETERS" title="格納パラメータ">格納パラメータ</a>を参照してください。
     </p><div class="variablelist"><dl class="variablelist"><dt id="GUC-AUTOVACUUM"><span class="term"><code class="varname">autovacuum</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.13.4.1.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       サーバがautovacuumランチャデーモンを実行すべきかどうかを管理します。
デフォルトでは有効です。
しかしautovacuumを作動させるためには<a class="xref" href="runtime-config-statistics.html#GUC-TRACK-COUNTS">track_counts</a>も有効でなければなりません。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインでのみで設定されます。
ただし、テーブルストレージパラメータを変更することにより、autovacuumは個々のテーブルに対して無効にできます。
       </p><p>       
       このパラメータが無効であったとしてもシステムは、トランザクションIDの周回を防止する必要があれば、autovacuumプロセスを起動することに注意してください。
詳細は<a class="xref" href="routine-vacuuming.html#VACUUM-FOR-WRAPAROUND" title="24.1.5. トランザクションIDの周回エラーの防止">Section 24.1.5</a>を参照してください。
       </p></dd><dt id="GUC-LOG-AUTOVACUUM-MIN-DURATION"><span class="term"><code class="varname">log_autovacuum_min_duration</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.2.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       少なくとも指定ミリ秒実行した場合、autovacuumで実行される各活動がログに残るようになります。
これをゼロに設定すると、すべてのautovacuumの活動がログに残ります。
マイナス1（デフォルト）はautovacuum活動のログを無効にします。
例えば、これを<code class="literal">250ms</code>に設定すると、250ms以上かかって実行されたautovacuumや解析はすべてログに残ります。
        さらに、<code class="literal">-1</code>以外の値にこのパラメータが設定された場合、競合するロックの存在によりオートバキューム動作が省略されるとメッセージはログに記録されます。
        このパラメータを有効にすることは、autovacuum活動の追跡に役に立ちます。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインでのみで設定されます。
ただし、この設定はテーブルストレージパラメータの変更により、それぞれのテーブルに対して上書きすることができます。
       </p></dd><dt id="GUC-AUTOVACUUM-MAX-WORKERS"><span class="term"><code class="varname">autovacuum_max_workers</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.3.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       同時に実行することができるautovacuumプロセス（autovacuumランチャ以外）の最大数を指定します。
デフォルトは3です。
サーバ起動時のみで設定可能です。
       </p></dd><dt id="GUC-AUTOVACUUM-NAPTIME"><span class="term"><code class="varname">autovacuum_naptime</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.4.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       あるデータベースについて実行されるautovacuumデーモンの最小遅延を指定します。
それぞれの周期で、デーモンはそのデータベースを試験し、そしてそのデータベース内のテーブルで必要性が認められると、<code class="command">VACUUM</code>および<code class="command">ANALYZE</code>コマンドを発行します。
遅延は秒単位で計測され、デフォルトは1分（<code class="literal">1min</code>）です。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインでのみで設定されます。
       </p></dd><dt id="GUC-AUTOVACUUM-VACUUM-THRESHOLD"><span class="term"><code class="varname">autovacuum_vacuum_threshold</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.5.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
どのテーブルに対しても<code class="command">VACUUM</code>を起動するために必要な、更新もしくは削除されたタプルの最小数を指定します。
デフォルトは50タプルです。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインでのみで設定されます。
ただし、この設定はテーブルストレージパラメータの変更により、それぞれのテーブルに対して上書きすることができます。
       </p></dd><dt id="GUC-AUTOVACUUM-ANALYZE-THRESHOLD"><span class="term"><code class="varname">autovacuum_analyze_threshold</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.6.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
どのテーブルに対しても<code class="command">ANALYZE</code>を起動するのに必要な、挿入、更新、もしくは削除されたタプルの最小数を指定します。
デフォルトは50タプルです。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインでのみで設定されます。
この設定はテーブルストレージパラメータの変更により、それぞれのテーブルに対して上書きすることができます。
       </p></dd><dt id="GUC-AUTOVACUUM-VACUUM-SCALE-FACTOR"><span class="term"><code class="varname">autovacuum_vacuum_scale_factor</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.13.4.7.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       <code class="command">VACUUM</code>を起動するか否かを決定するときに、<code class="varname">autovacuum_vacuum_threshold</code>に足し算するテーブル容量の割合を指定します。
デフォルトは0.2（テーブルサイズの20%）です。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインでのみで設定されます。
この設定はテーブルストレージパラメータの変更により、それぞれのテーブルに対して上書きされます。
       </p></dd><dt id="GUC-AUTOVACUUM-ANALYZE-SCALE-FACTOR"><span class="term"><code class="varname">autovacuum_analyze_scale_factor</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.13.4.8.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
<code class="command">ANALYZE</code>を起動するか否かを決定するときに、<code class="varname">autovacuum_analyze_threshold</code>に足し算するテーブル容量の割合を指定します。
デフォルトは0.1（テーブルサイズの10%）です。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインでのみで設定されます。
この設定はテーブルストレージパラメータの変更により、それぞれのテーブルに対して上書きされます。
       </p></dd><dt id="GUC-AUTOVACUUM-FREEZE-MAX-AGE"><span class="term"><code class="varname">autovacuum_freeze_max_age</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.9.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       トランザクションID周回を防ぐために<code class="command">VACUUM</code>操作が強制される前までにテーブルの<code class="structname">pg_class</code>.<code class="structfield">relfrozenxid</code> フィールドが到達できる最大（トランザクションにおける）年代を指定します。
自動バキュームが無効であった時でも、システムは周回を防ぐために自動バキューム子プロセスを起動することに注意してください。
       </p><p>       
       vacuumは同時に<code class="filename">pg_xact</code>サブディレクトリから古いファイルの削除を許可します。
       これが、比較的低い2億トランザクションがデフォルトである理由です。
       このパラメータはサーバ起動時にのみ設定可能です。
しかし、この設定はテーブルストレージパラメータの変更により、それぞれのテーブルで減らすことができます。
詳細は<a class="xref" href="routine-vacuuming.html#VACUUM-FOR-WRAPAROUND" title="24.1.5. トランザクションIDの周回エラーの防止">Section 24.1.5</a>を参照してください。
       </p></dd><dt id="GUC-AUTOVACUUM-MULTIXACT-FREEZE-MAX-AGE"><span class="term"><code class="varname">autovacuum_multixact_freeze_max_age</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.10.1.3" class="indexterm"></a>
      </span></dt><dd><p>       トランザクションID周回を防ぐために<code class="command">VACUUM</code>操作が強制される前までにテーブルの<code class="structname">pg_class</code>.<code class="structfield">relminmxid</code> フィールドが到達できる最大（マルチトランザクションにおける）年代を指定します。
自動バキュームが無効であった時でも、システムは周回を防ぐために自動バキューム子プロセスを起動することに注意してください。
       </p><p>       またマルチトランザクションIDのvacuumは<code class="filename">pg_multixact</code>と<code class="filename">pg_multixact/offsets</code>サブディレクトリから古いファイルの削除します。
       これがデフォルトが4億トランザクションをやや下回る理由です。
       このパラメータはサーバ起動時にのみ設定可能です。
しかし、この設定はテーブルストレージパラメータの変更により、それぞれのテーブルで減らすことができます。
詳細は<a class="xref" href="routine-vacuuming.html#VACUUM-FOR-MULTIXACT-WRAPAROUND" title="24.1.5.1. マルチトランザクションと周回">Section 24.1.5.1</a>を参照してください。
       </p></dd><dt id="GUC-AUTOVACUUM-VACUUM-COST-DELAY"><span class="term"><code class="varname">autovacuum_vacuum_cost_delay</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.11.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       自動<code class="command">VACUUM</code>操作に使用されるコスト遅延値を指定します。
        -1に指定されると、一定の <a class="xref" href="runtime-config-resource.html#GUC-VACUUM-COST-DELAY">vacuum_cost_delay</a>の値が使用されます。
デフォルト値は20ミリ秒です。
このパラメータは<code class="filename">postgresql.conf</code>ファイル内、または、サーバのコマンドラインのみで設定可能です。
この設定はテーブルストレージパラメータの変更により、それぞれのテーブルに対して上書きすることができます。
       </p></dd><dt id="GUC-AUTOVACUUM-VACUUM-COST-LIMIT"><span class="term"><code class="varname">autovacuum_vacuum_cost_limit</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.13.4.12.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       自動<code class="command">VACUUM</code>操作に使用されるコスト限界値を指定します。
（デフォルトの）-1が指定されると、一定の <a class="xref" href="runtime-config-resource.html#GUC-VACUUM-COST-LIMIT">vacuum_cost_limit</a>の値が使用されます。
この値は、実行中の自動バキュームワーカが複数存在する場合ワーカすべてに比例分配されることに注意してください。
したがって各ワーカの制限を足し合わせてもこの変数による制限を超えることはありません。
このパラメータは<code class="filename">postgresql.conf</code>ファイル、または、サーバのコマンドラインのみで設定可能です。
この設定はテーブルストレージパラメータの変更により、それぞれのテーブルに対して上書きすることができます。
       </p></dd></dl></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-config-statistics.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-config-client.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">19.9. 実行時統計情報 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 19.11. クライアント接続デフォルト</td></tr></table></div></body></html>