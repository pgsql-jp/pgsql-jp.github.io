<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>54.1. 翻訳者へ</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="nls.html" title="Chapter 54. 多言語サポート" /><link rel="next" href="nls-programmer.html" title="54.2. プログラマへ" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">54.1. 翻訳者へ</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="nls.html" title="Chapter 54. 多言語サポート">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="nls.html" title="Chapter 54. 多言語サポート">Up</a></td><th width="60%" align="center">Chapter 54. 多言語サポート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="nls-programmer.html" title="54.2. プログラマへ">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="NLS-TRANSLATOR"><div class="titlepage"><div><div><h2 class="title" style="clear: both">54.1. 翻訳者へ</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="nls-translator.html#id-1.10.7.2.3">54.1.1. 必要事項</a></span></dt><dt><span class="sect2"><a href="nls-translator.html#id-1.10.7.2.4">54.1.2. 概念</a></span></dt><dt><span class="sect2"><a href="nls-translator.html#id-1.10.7.2.5">54.1.3. メッセージカタログの作成と保守</a></span></dt><dt><span class="sect2"><a href="nls-translator.html#id-1.10.7.2.6">54.1.4. POファイルの編集</a></span></dt></dl></div><p><span class="productname">PostgreSQL</span>プログラムは（サーバ、クライアントともに）メッセージが翻訳されていれば、使い慣れた言語でそのメッセージを出すことができます。
翻訳メッセージセットの作成と保守は、自分の言語を上手に話し<span class="productname">PostgreSQL</span>の成果に貢献したい人々の協力が必要です。
この作業にはプログラマである必要はまったくありません。
本節ではお手伝いの仕方を説明します。
  </p><div class="sect2" id="id-1.10.7.2.3"><div class="titlepage"><div><div><h3 class="title">54.1.1. 必要事項</h3></div></div></div><p>協力者の言語の熟練度については判断しません。
本節ではソフトウェアツールについて説明します。
理論的には、テキストエディタのみが必要です。
しかし、これは自分で作成した翻訳メッセージを試そうとはしないという、あまりあり得ない場合のみです。
ソースツリーを構築する際に、<code class="option">--enable-nls</code>オプションを使用していることを確認してください。
これにより、全てのエンドユーザがとにかく必要とする、<span class="application">libintl</span>ライブラリと<code class="filename">msgfmt</code>プログラムも同時に検査されます。
作業を試す際には、インストール手順の適切な部分に従ってください。
   </p><p>新規に翻訳作業を始めるか、（後述の）メッセージカタログのマージを行いたい場合、GNU版と互換性を持った実装の<code class="filename">xgettext</code>と<code class="filename">msgmerge</code>という2つのプログラムがそれぞれ必要です。
将来はパッケージ化されたソース配布物を使用する場合に<code class="filename">xgettext</code>を必要としないように変更する予定です
（Git版で作業をしているのであれば、まだこれが必要です）。
現在<span class="application">GNU Gettext 0.10.36</span>以上を推奨します。
   </p><p>使用するマシンのgettextの実装については、文書が一緒に付いてくると思います。
以下のいくつかはおそらく重複していますが、追補すべき詳細についてはその文書を参照してください。
   </p></div><div class="sect2" id="id-1.10.7.2.4"><div class="titlepage"><div><div><h3 class="title">54.1.2. 概念</h3></div></div></div><p>英語による元のメッセージとそれを基に（場合によって）翻訳されたメッセージの組み合わせは<em class="firstterm">メッセージカタログ</em>に、（関連するプログラムはメッセージカタログを共有することができますが）各プログラム、対象とする言語に対して一つずつ保持されます。
メッセージカタログには2つのファイル形式があります。
1つは<span class="quote">“<span class="quote">PO</span>”</span>ファイル（移植可能オブジェクト-Portable Object-を意味します）で翻訳者が編集する特別な構文を持った平文ファイルです。
2番目は<span class="quote">“<span class="quote">MO</span>”</span>ファイル（マシンオブジェクト-Machine Object-を意味します)で対応するPOファイルから生成され、国際化プログラムの実行の際に使用されるバイナリファイルです。
翻訳者は、MOファイルを扱いません。
実際に扱うことは困難です。
   </p><p>メッセージカタログファイルの拡張子は想像していたかもしれませんが<code class="filename">.po</code>もしくは<code class="filename">.mo</code>です。
基本名（拡張子を除いた部分）は、プログラムが伴っている名前、もしくは翻訳目的とする言語の名前のいずれかで、状況によって変わります。
少し混乱するかもしれません。
例えば、<code class="filename">psql.po</code>（psql用のPOファイル）、もしくは<code class="filename">fr.mo</code>（フランス語用のMOファイル）です。
   </p><p>POファイルの書式を以下に示します。
</p><pre class="programlisting"># comment

msgid "original string"
msgstr "translated string"

msgid "more original"
msgstr "another translated"
"string can be broken up like this"

...</pre><p>
msgidはプログラムのソースから抽出されます。
（これは必要はありませんが最も一般的な方法です。）
msgstr行は初期状態では空であり、翻訳者によって有益な文字列が埋め込まれます。
この文字列には、C言語形式のエスケープ文字を含めることも、上に示したように複数行にまたがって続けることもできます。
（継続行は必ず行の先頭から始まらなければなりません。）
   </p><p>#文字はコメントの開始を示します。
#文字の直後に空白文字があった場合、それは翻訳者によって保守されるコメントです。
#の直後に非空白文字が付く、自動的に付与されるコメントもあります。
これらは、POファイルに対する操作を行う各種ツールによって保守され、翻訳者の補助を意図しています。
</p><pre class="programlisting">#. automatic comment
#: filename.c:1023
#, flags, flags</pre><p>
#.スタイルのコメントはそのメッセージが使用されているソースファイルから抽出されます。
おそらくプログラマが、翻訳者のために追加した、そのようにしてほしいと考える体裁についてなどの情報です。
#:コメントは、ソース内でそのメッセージが使用される正確な場所を示します。
翻訳者はプログラムソースを参照する必要はありませんが、翻訳の正確さに疑問がある場合にソースを参照することができます。
#,コメントは何らかの方法でメッセージを説明するフラグです。
現在、2つのフラグがあります。
そのメッセージがプログラムソースの変更によって古いものとなった可能性がある場合、<code class="literal">fuzzy</code>が設定されます。
翻訳者はこれを検証し、fuzzyフラグを削除できます。
fuzzyメッセージはエンドユーザからは利用できないことに注意してください。
もう1つのフラグは<code class="literal">c-format</code>で、そのメッセージが<code class="function">printf</code>形式の書式テンプレートであることを示します。
これは、翻訳側もプレースホルダの型と同じ番号を持った書式文字列でなければならないことを意味します。
これを検証するツールがあり、それらはc-formatフラグを入力として受け取ります。
   </p></div><div class="sect2" id="id-1.10.7.2.5"><div class="titlepage"><div><div><h3 class="title">54.1.3. メッセージカタログの作成と保守</h3></div></div></div><p>さて、<span class="quote">“<span class="quote">空の</span>”</span>メッセージカタログをどうやって作成するのでしょうか。
まず、翻訳したいメッセージを持つプログラムが存在するディレクトリに移動します。
<code class="filename">nls.mk</code>ファイルがあればこのプログラムは翻訳の準備が整っています。
   </p><p>もし、<code class="filename">.po</code>ファイルが数個既にあれば、誰かがある翻訳作業を行っています。
そのファイルは<code class="filename"><em class="replaceable"><code>language</code></em>.po</code> と名前が付けられています。
ここで、<em class="replaceable"><code>language</code></em>は<a class="ulink" href="http://www.loc.gov/standards/iso639-2/php/English_list.php" target="_top">ISO 639-1の2文字言語コード（小文字）</a>を表します。
例えば、<code class="filename">fr.po</code>はフランス語用です。
1つの言語に複数の翻訳成果が必要である場合そのファイルの名前は<code class="filename"><em class="replaceable"><code>language</code></em>_<em class="replaceable"><code>region</code></em>.po</code>のようになります。
ここで、<em class="replaceable"><code>region</code></em>は<a class="ulink" href="http://www.iso.org/iso/country_names_and_code_elements" target="_top">ISO 3166-1の2文字国コード（大文字）</a>を表します。
例えば、<code class="filename">pt_BR.po</code>はブラジルでのポルトガル語用を示します。
翻訳対象とする言語用のファイルがあれば、それを基に作業を始めることができます。
   </p><p>新規に翻訳を始める必要がある場合、以下のコマンドを最初に実行してください。
</p><pre class="programlisting">make init-po</pre><p>
これは、<code class="filename"><em class="replaceable"><code>progname</code></em>.pot</code>ファイルを作成します。
（<code class="filename">.pot</code>は<span class="quote">“<span class="quote">実用の</span>”</span>POファイルと区別するためのものです。
<code class="literal">T</code>は<span class="quote">“<span class="quote">テンプレート</span>”</span>を意味します。）
このファイルを<code class="filename"><em class="replaceable"><code>language</code></em>.po</code>にコピーして編集します。
新規の言語が利用可能になったことを知らせるために、<code class="filename">nls.mk</code>を編集し、言語（もしくは言語と国）コードを以下のように追加してください。
</p><pre class="programlisting">AVAIL_LANGUAGES := de fr</pre><p>
（もちろん他の言語があるかもしれません。）
   </p><p>対象のプログラムやライブラリの変更に伴い、メッセージはプログラマによって変更、追加されます。
この場合は始めからやり直す必要はありません。
その代わりに以下のコマンドを実行してください。
</p><pre class="programlisting">make update-po</pre><p>
そうすると新しい空のメッセージカタログファイル（最初に使用したpotファイル）が作成され、既存のPOファイルにマージされます。
このマージのアルゴリズムが特定のメッセージに関して確実でない場合、それは上で説明した<span class="quote">“<span class="quote">fuzzy</span>”</span>となります。
新規POファイルは<code class="filename">.po.new</code>という拡張子付きで保存されます。
   </p></div><div class="sect2" id="id-1.10.7.2.6"><div class="titlepage"><div><div><h3 class="title">54.1.4. POファイルの編集</h3></div></div></div><p>POファイルは普通のテキストエディタで編集することができます。
翻訳者はmsgstrディレクティブの後の引用符の間の部分の変更、コメントの追加、fuzzyフラグの変更のみを行えばよいのです。
Emacsには（予想通り）POモードがあり、非常に使いやすいものです。
   </p><p>POファイルを完全に埋めることは必要ありません。
ソフトウェアは使用できる翻訳がない（もしくは翻訳が空の）場合自動的に元の文字列に戻します。
他の人が作業を引き継ぐことができますので、ソースツリー内に不完全な翻訳を含めることにも問題はありません。
しかし、マージの後のfuzzyフラグを削除することを優先に考えることが推奨されています。
fuzzyエントリはインストールされないことを忘れないでください。
これらは何が正しい翻訳になり得るかの参照のためにのみ提供されています。
   </p><p>以下に、翻訳の編集を行う際に注意すべき点を示します。
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>元の文字列の終端が改行の場合、翻訳も同様になっていることを確認してください。
タブなども同様です。
      </p></li><li class="listitem"><p>元が<code class="function">printf</code>書式文字列の場合、翻訳も同じでなければなりません。
また、翻訳は同じ書式識別子を同じ順番で持たなければなりません。
言語固有の規則によっては不可能な場合や扱いづらい場合も起こります。
このような場合は、以下の書式指定子を使用することができます。
</p><pre class="programlisting">msgstr "Die Datei %2$s hat %1$u Zeichen."</pre><p>
そして、リストの最初のプレースホルダが実際にはこのリストの2番目の引数に使用されます。
<code class="literal"><em class="replaceable"><code>digits</code></em>$</code>は%の直後に続く必要があり、他の書式の操作の前に使用する必要があります。
（この機能は<code class="function">printf</code>系の関数に本当に存在するものです。
メッセージ国際化以外ではほとんど使用されませんので、聞いたことがないかもしれません。）
      </p></li><li class="listitem"><p>元の文字列に言語上の間違いがある場合、それを報告し（もしくはプログラムソースを直して）、普通に翻訳してください。
修正された文字列は、プログラムのソースが修正された時にマージ可能になります。
元の文字列が事実と異なる場合、それを報告し（もしくは自ら直して）、翻訳を行わないでください。
その代わりに、POファイルのその文字列にコメントを付けてください。
      </p></li><li class="listitem"><p>元の文字列のスタイルや調子を維持してください。
特に、（<code class="literal">cannot open file %s</code>など）文章になっていないメッセージは、（翻訳する言語が大文字小文字を区別するのであれば）おそらく最初の文字を大文字にしてはなりませんし、（翻訳する言語が句読点として使用しているのであれば）ピリオドを終わりに付けてはいけません。
<a class="xref" href="error-style-guide.html" title="53.3. エラーメッセージのスタイルガイド">Section 53.3</a>を読むと参考になります。
      </p></li><li class="listitem"><p>メッセージの意味がわからない時や、曖昧な場合は、開発者用のメーリングリストに問い合わせてください。
英語を話すエンドユーザも理解できない、または曖昧であると判断することができる機会となり、メッセージの改良を行う最善のものです。
      </p></li></ul></div><p>
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="nls.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="nls.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="nls-programmer.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 54. 多言語サポート </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 54.2. プログラマへ</td></tr></table></div></body></html>