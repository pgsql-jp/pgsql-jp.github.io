<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.82. リリース9.2.20</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-9-2-21.html" title="E.81. リリース9.2.21" /><link rel="next" href="release-9-2-19.html" title="E.83. リリース9.2.19" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.82. リリース9.2.20</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-9-2-21.html" title="E.81. リリース9.2.21">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-9-2-19.html" title="E.83. リリース9.2.19">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-9-2-20"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.82. リリース9.2.20</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-9-2-20.html#id-1.11.6.86.4">E.82.1. バージョン9.2.20への移行</a></span></dt><dt><span class="sect2"><a href="release-9-2-20.html#id-1.11.6.86.5">E.82.2. 変更点</a></span></dt></dl></div><p><strong>リリース日: </strong>2017-02-09</p><p>このリリースは9.2.19に対し、各種不具合を修正したものです。
9.2メジャーリリースにおける新機能については、<a class="xref" href="release-9-2.html" title="E.102. リリース9.2">Section E.102</a>を参照してください。
  </p><div class="sect2" id="id-1.11.6.86.4"><div class="titlepage"><div><div><h3 class="title">E.82.1. バージョン9.2.20への移行</h3></div></div></div><p>9.2.Xからの移行ではダンプ/リストアは不要です。
   </p><p>しかしながら、インストレーションが下記変更点の最初の項目に書かれたバグの影響を受けている場合には、アップデート後に壊れたインデックスを修復する作業が必要になるでしょう。
   </p><p>また、9.2.11よりも前のリリースからアップグレードする場合は、<a class="xref" href="release-9-2-11.html" title="E.91. リリース9.2.11">Section E.91</a>を参照して下さい。
   </p></div><div class="sect2" id="id-1.11.6.86.5"><div class="titlepage"><div><div><h3 class="title">E.82.2. 変更点</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="command">CREATE INDEX CONCURRENTLY</code>で作られたインデックスの破損をもたらす競合状態を修正しました。
(Pavan Deolasee, Tom Lane)
     </p><p><code class="command">CREATE INDEX CONCURRENTLY</code>が前もってインデックスされていない列に依存するインデックスの作成に使われていたなら、<code class="command">CREATE INDEX</code>コマンドと同時実行するトランザクションにより更新された行が誤ったインデックスエントリを受け入れるおそれがありました。
この現象が生じた疑いがあるなら、最も確実な対応はアップデート実施後に影響をうけたインデックスを再作成することです。
     </p></li><li class="listitem"><p>ログをとらないテーブルに対する<span class="quote">“<span class="quote">init fork</span>”</span>生成を無条件にWAL出力するようにしました。
(Michael Paquier)
     </p><p>これまで<a class="xref" href="runtime-config-wal.html#GUC-WAL-LEVEL">wal_level</a> = <code class="literal">minimal</code>のときには省略されていましたが、ログをとらないテーブルがクラッシュ後に適切に空に初期化されることを保証するために、実際にはその場合でも必要でした。
     </p></li><li class="listitem"><p>セグメントの再読み込みでのWALページヘッダの検証を修正しました。(Takayuki Tsunakawa, Amit Kapila)
     </p><p>稀に、リカバリ中に誤った<span class="quote">“<span class="quote">out-of-sequence TLI</span>”</span>エラーが報告される可能性がありました。
     </p></li><li class="listitem"><p>統計情報コレクタがホットスタンバイ動作中に落ちたときに、それを再起動するようにしました。
(Takayuki Tsunakawa)
     </p></li><li class="listitem"><p>ホットスタンバイが衝突する問い合わせを待機している間、割り込みを検査するようにしました。
(Simon Riggs)
     </p></li><li class="listitem"><p>稀な場合に絶えず自動バキュームランチャーが再生成されるのを回避しました。
(Amit Khandekar)
     </p><p>この修正は自動バキュームが名目上offでいくつか凍結を要するテーブルがあるけれども全てのそのようなテーブルは既に自動バキュームワーカにより処理中である場合の問題を回避します。
     </p></li><li class="listitem"><p>拡張のメンバオブジェクトが削除できるときのチェックを修正しました。
(Tom Lane)
     </p><p>拡張のアップグレードスクリプトはメンバオブジェクトを削除できなければいけませんが、serial列のシーケンスについてできませんでした。また、他の場合でもそうなる可能性がありました。
     </p></li><li class="listitem"><p>インデックス再作成のときに<code class="command">ALTER TABLE</code>がインデックスのテーブル空間の割り当てを確実に維持するようにしました。
(Tom Lane, Michael Paquier)
     </p><p>これまでは<a class="xref" href="runtime-config-client.html#GUC-DEFAULT-TABLESPACE">default_tablespace</a>のデフォルト以外の設定によりインデックス破壊をもたらす可能性がありました。
     </p></li><li class="listitem"><p>参照先リレーションに対する待機中トリガイベントがあるときに外部キー制約を削除しないようにしました。
(Tom Lane)
     </p><p>これにより<span class="quote">“<span class="quote">could not find trigger <em class="replaceable"><code>NNN</code></em></span>”</span>（トリガNNNが見つかりません）または<span class="quote">“<span class="quote">relation <em class="replaceable"><code>NNN</code></em> has no triggers</span>”</span>（リレーションNNNにトリガがありません）というエラーを回避します。
     </p></li><li class="listitem"><p>OIDを持つテーブルがOIDを持つ親テーブルと<code class="command">ALTER TABLE ... INHERIT</code>を通して関連づけられているときのOID列の処理を修正しました。
(Amit Langote)
     </p><p>この場合、OID列は通常のユーザ列と同様に扱われるべきでしたが、そうなっておらず、後の継承の変更で奇妙な振る舞いをひき起こしていました。
     </p></li><li class="listitem"><p>直列化可能かを、制約違反エラーを報告する前に検査するようにしました。
(Thomas Munro)
     </p><p>シリアライザブルトランザクション隔離を使っているとき、同時トランザクションを原因とするいかなるエラーも直列化の失敗として表明するのが望ましく、それによりアプリケーションにリトライが成功するかもしれないという手がかりを与えます。
残念ながら、キー重複の失敗が同時挿入で引き起こされた場合には、これは確実には生じません。
本変更は、アプリケーションがトランザクションのより早くに明示的に競合するキーの存在をチェックした（そして見つからなかった）なら、このようなエラーが直列化のエラーとして報告されることを保証します。
     </p></li><li class="listitem"><p>複数行の<code class="literal">VALUES</code>コンストラクトに対して列のtypmodが精密に決定されるようにしました。
(Tom Lane)
     </p><p>これは、列の最初の値が決定可能なtypmod（例えば<code class="type">varchar</code>の長さ）を持つけれど続く値は同じ制限を共有しないときに発生する問題を修正します。
     </p></li><li class="listitem"><p>ユニコード文字列の末尾における完結しないユニコードのサロゲートペアにエラーを出すようにしました。
(Tom Lane)
     </p><p>通常、ユニコードのサロゲート先頭文字にはユニコードのサロゲート末尾文字が続かなければなりませんが、先頭文字がユニコード文字列リテラル(<code class="literal">U&amp;'...'</code>)またはユニコード識別子(<code class="literal">U&amp;"..."</code>)の最後の文字である場合に、これについての検査が見逃されていました。
     </p></li><li class="listitem"><p><code class="literal">!foo</code>のような純粋な否定のテキスト検索問い合わせが空の<code class="type">tsvector</code>にマッチするようにしました。
(Tom Dunstan)
     </p><p>このようなマッチはGINインデックス検索では見つかりましたが、シーケンシャルスキャンやGiSTインデックススキャンでは見つかりませんでした。
     </p></li><li class="listitem"><p><code class="function">ts_rewrite()</code>が非トップレベルのサブツリーを空クエリで置き換えるときのクラッシュを、防止しました。
(Artur Zakirov)
     </p></li><li class="listitem"><p><code class="function">ts_rewrite()</code>での性能問題を修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><code class="function">ts_rewrite()</code>の入れ子NOT演算子の扱いを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p>空配列を適切に扱うように<code class="function">array_fill()</code>を修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><code class="function">quote_literal_cstr()</code>で1バイトのバッファオーバランを修正しました。
(Heikki Linnakangas)
     </p><p>このオーバランは入力全体がシングルクォートおよび/またはバックスラッシュで構成される場合でのみ発生します。
     </p></li><li class="listitem"><p><code class="function">pg_start_backup()</code>と<code class="function">pg_stop_backup()</code>の複数回の呼び出しが同時に実行されないようにしました。
(Michael Paquier)
     </p><p>誰かがこれらの関数を並列に実行しようとしたときの、アサート失敗あるいはもっと悪い事態を回避します。
     </p></li><li class="listitem"><p>実際にはノーオペレーションではない<code class="type">interval</code>から<code class="type">interval</code>へのキャストを捨てないようにしました。
(Tom Lane)
     </p><p>一部の場合に下位の<code class="type">interval</code>フィールドのゼロ埋めした結果になるべきキャストが誤って何もしない処理と認識され、捨てられていました。
一例は<code class="type">INTERVAL MONTH</code>から<code class="type">INTERVAL YEAR</code>へのキャストが月フィールドをクリアしないことです。
     </p></li><li class="listitem"><p>組み込み関数を使うユーザ定義キャストと変換をダンプするように<span class="application">pg_dump</span>を修正しました。
(Stephen Frost)
     </p></li><li class="listitem"><p>WALファイルを含めたときスタンバイサーバで起こりうる<span class="application">pg_basebackup</span>の失敗を修正しました。
(Amit Kapila, Robert Haas)
     </p></li><li class="listitem"><p>PL/Pythonむけに作成したPython例外オブジェクトが確実に適切にリファレンスカウントされるようにしました。
(Rafa de la Torre, Tom Lane)
     </p><p>これはPythonのガーベージコレクションのサイクルが起きた後にオブジェクトが使われた場合の失敗を回避します。
     </p></li><li class="listitem"><p>列名として<code class="literal">.tupno</code>を持つテーブルのトリガに対応するようにPL/Tclを修正しました。
(Tom Lane)
     </p><p>これは（以前の文書化されていない）PL/Tclの<code class="command">spi_exec</code>および<code class="command">spi_execp</code>コマンドの振る舞いと調和させます。
すなわち、<code class="literal">.tupno</code>マジック列はその名前の真の列が無い場合だけ挿入されます。
     </p></li><li class="listitem"><p>Unix上であってもDOS形式の改行文字が<code class="filename">~/.pgpass</code>ファイルで許されるようにしました。
(Vik Fearing)
     </p><p>この変更は同じパスワードファイルをUnixマシンとWindowsマシンとで使うのを簡単にします。
     </p></li><li class="listitem"><p><span class="application">ecpg</span>にドットで終わるファイル名が与えられた際の1バイトのバッファオーバランを修正しました。
(Takayuki Tsunakawa)
     </p></li><li class="listitem"><p><code class="command">ALTER DEFAULT PRIVILEGES</code>に対する<span class="application">psql</span>のタブ補完を修正しました。
(Gilles Darold, Stephen Frost)
     </p></li><li class="listitem"><p><span class="application">psql</span>で、空または全てブランクの<code class="envar">PAGER</code>環境変数設定を<span class="quote">“<span class="quote">ページャ無し</span>”</span>という意味で扱うようにしました。
(Tom Lane)
     </p><p>これまでは、このような設定はページャにむけようとした出力を全く見えなくしていました。
     </p></li><li class="listitem"><p><code class="filename">contrib/dblink</code>のメモリ不足などの低レベル<span class="application">libpq</span>エラーの報告を改善しました。
(Joe Conway)
     </p></li><li class="listitem"><p>Windowsで環境変数の変更がデバッグオプションを有効にしてビルドされたDLLに確実に伝播するようにしました。
(Christian Ullrich)
     </p></li><li class="listitem"><p>タイムゾーンライブラリをIANA release tzcode2016jに同期しました。
(Tom Lane)
     </p><p>多数の問題が修正されており、最も重要なものとしては対象ディレクトリがハードリンクをサポートしない場合はタイムゾーンデータ導入に失敗していたことがあります。
     </p></li><li class="listitem"><p>タイムゾーンデータを<span class="application">tzdata</span> release 2016jに更新しました。
北キプロス（新タイムゾーン Asia/Famagusta 追加）、ロシア（新タイムゾーン Europe/Saratov 追加）、トンガ、Antarctica/Casey における夏時間法の変更と、イタリア、カザフスタン、マルタ、パレスチナにおける歴史的修正、トンガにおける数値によるゾーン略記法を選択する変更が含まれます。
     </p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-9-2-21.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-9-2-19.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.81. リリース9.2.21 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.83. リリース9.2.19</td></tr></table></div></body></html>