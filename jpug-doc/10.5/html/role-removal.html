<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>21.4. ロールの削除</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="role-membership.html" title="21.3. ロールのメンバ資格" /><link rel="next" href="default-roles.html" title="21.5. デフォルトロール" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">21.4. ロールの削除</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="role-membership.html" title="21.3. ロールのメンバ資格">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="user-manag.html" title="Chapter 21. データベースロール">Up</a></td><th width="60%" align="center">Chapter 21. データベースロール</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="default-roles.html" title="21.5. デフォルトロール">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="ROLE-REMOVAL"><div class="titlepage"><div><div><h2 class="title" style="clear: both">21.4. ロールの削除</h2></div></div></div><p>ロールはデータベースオブジェクトを所有したり、他のオブジェクトにアクセスする権限を保持したりできるので、ロールを削除するのは、単に<a class="xref" href="sql-droprole.html" title="DROP ROLE"><span class="refentrytitle">DROP ROLE</span></a>を実行すれば良いというだけのものでないことがよくあります。
そのロールが所有するすべてのオブジェクトについて、まずそれを削除するか、あるいは他の所有者に移すかしなければなりません。
また、そのロールに付与されたすべての権限を取り上げる必要があります。
  </p><p>オブジェクトの所有権は<code class="command">ALTER</code>コマンドを使って、1度に1つずつ移管することができます。
以下に例を示します。
</p><pre class="programlisting">ALTER TABLE bobs_table OWNER TO alice;</pre><p>
その代わりに<a class="xref" href="sql-reassign-owned.html" title="REASSIGN OWNED"><span class="refentrytitle">REASSIGN OWNED</span></a>コマンドを使って、削除予定のロールが所有するすべてのオブジェクトの所有権を、単一の他のロールに移管することもできます。
<code class="command">REASSIGN OWNED</code>は他のデータベースのオブジェクトにはアクセスできないので、そのロールが所有するオブジェクトを含むそれぞれのデータベース内で実行する必要があります。
（最初にそのような<code class="command">REASSIGN OWNED</code>を実行した時に、データベース間で共有されるオブジェクト、つまりデータベースとテーブル空間については、すべて削除予定のロールから所有権が変更されることに注意してください。）
  </p><p>重要なオブジェクトがすべて新しい所有者に移管された後は、削除予定のロールが所有する残りのオブジェクトはすべて<a class="xref" href="sql-drop-owned.html" title="DROP OWNED"><span class="refentrytitle">DROP OWNED</span></a>コマンドで削除することができます。
ここでも、このコマンドは他のデータベースのオブジェクトにはアクセスできないので、そのロールが所有するオブジェクトを含むそれぞれのデータベース内で実行する必要があります。
また、<code class="command">DROP OWNED</code>はデータベース全体、あるいはテーブル空間全体を削除することはありませんので、ロールが所有するデータベースあるいはテーブル空間で新しい所有者に移管されていないものがあれば、手作業でそれを削除する必要があります。
  </p><p><code class="command">DROP OWNED</code>は対象のロールが所有しないオブジェクトについて、そのロールに付与されたすべての権限を削除することも行います。
<code class="command">REASSIGN OWNED</code>はそのようなオブジェクトに関与しないので、削除されるロールによる依存関係を完全に取り除くには、多くの場合、<code class="command">REASSIGN OWNED</code>と<code class="command">DROP OWNED</code>の両方を（この順序で！）実行する必要があります。
  </p><p>まとめると、オブジェクトを所有するために使用されたロールを削除する最も一般的な手順は以下のようになります。
  </p><pre class="programlisting">REASSIGN OWNED BY doomed_role TO successor_role;
DROP OWNED BY doomed_role;
-- 上記のコマンドをクラスタ内の各データベースについて繰り返す
DROP ROLE doomed_role;</pre><p>すべての所有オブジェクトを同一の後継所有者に移管するのでない場合は、例外部分を手作業で処理した後で、上記の手順を実行して残りを処理するのが最善でしょう。
  </p><p>依存するオブジェクトがまだ残っている状態で<code class="command">DROP ROLE</code>を実行すると、どのオブジェクトが所有者変更または削除の必要があるかを特定するメッセージが発行されます。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="role-membership.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="user-manag.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="default-roles.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">21.3. ロールのメンバ資格 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 21.5. デフォルトロール</td></tr></table></div></body></html>