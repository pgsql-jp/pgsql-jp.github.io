<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>66.4. 可視性マップ</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="storage-fsm.html" title="66.3. 空き領域マップ" /><link rel="next" href="storage-init.html" title="66.5. 初期化フォーク" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">66.4. 可視性マップ</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="storage-fsm.html" title="66.3. 空き領域マップ">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="storage.html" title="Chapter 66. データベースの物理的な格納">Up</a></td><th width="60%" align="center">Chapter 66. データベースの物理的な格納</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="storage-init.html" title="66.5. 初期化フォーク">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="STORAGE-VM"><div class="titlepage"><div><div><h2 class="title" style="clear: both">66.4. 可視性マップ</h2></div></div></div><a id="id-1.10.19.6.2" class="indexterm"></a><a id="id-1.10.19.6.3" class="indexterm"></a><p>各ヒープリレーションは、どのページがすべての実行中のトランザクションから可視であることが分かっているタプルだけを含むかを追跡する、可視性マップ（VM）を持ちます。どのページが凍結状態のタプルだけを含むのかも追跡します。
これは、リレーションのファイルノード番号に<code class="literal">_vm</code>という接尾辞を付与した名前の別のリレーションフォーク内に主リレーションデータと並行して格納されます。
例えばリレーションのファイルノードが12345の場合、VMは主リレーションファイルと同じディレクトリ内の<code class="filename">12345_vm</code>というファイル内に格納されます。
インデックスはVMを持たないことに注意してください。</p><p>可視性マップはヒープページ当たり2ビットを保持します。
最初のビットがセットされていれば、ページはすべて可視であること、すなわち、そのページにはバキュームが必要なタプルをまったく含んでいないことを示しています。
またこの情報は、インデックスタプルのみを使用して問い合わせに答えるために<a class="link" href="indexes-index-only-scans.html" title="11.11. インデックスオンリースキャン"><em class="firstterm">インデックスオンリースキャン</em></a>によっても使用されます。
2番目のビットがセットされていれば、そのページのタプルはすべて凍結状態であることを意味します。
これは、周回対策のバキュームすらそのページを再び訪れる必要はないことを意味します。</p><p>このマップは、ビットがセットされている時は常にこの条件が真であることを確実に把握できるという点で保守的ですが、ビットがセットされていない場合は、真かもしれませんし偽かもしれません。
可視性マップのビットはバキュームによってのみで設定されます。
しかしページに対する任意のデータ編集操作によってクリアされます。</p><p><a class="xref" href="pgvisibility.html" title="F.33. pg_visibility">pg_visibility</a>モジュールは可視性マップに入っている情報を確かめるのに使えます。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="storage-fsm.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="storage.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="storage-init.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">66.3. 空き領域マップ </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 66.5. 初期化フォーク</td></tr></table></div></body></html>