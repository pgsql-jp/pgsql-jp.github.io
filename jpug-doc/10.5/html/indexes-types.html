<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>11.2. インデックスの種類</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="indexes-intro.html" title="11.1. 序文" /><link rel="next" href="indexes-multicolumn.html" title="11.3. 複数列インデックス" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">11.2. インデックスの種類</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="indexes-intro.html" title="11.1. 序文">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="indexes.html" title="Chapter 11. インデックス">Up</a></td><th width="60%" align="center">Chapter 11. インデックス</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="indexes-multicolumn.html" title="11.3. 複数列インデックス">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="INDEXES-TYPES"><div class="titlepage"><div><div><h2 class="title" style="clear: both">11.2. インデックスの種類</h2></div></div></div><p><span class="productname">PostgreSQL</span>では、B-tree、Hash、GiST、SP-GiST、GIN、BRINといった複数の種類のインデックスを使用可能です。
インデックスの各種類は、異なる種類の問い合わせに最も適した、異なるアルゴリズムを使用します。
デフォルトで<code class="command">CREATE INDEX</code>コマンドは、B-treeインデックスを作成し、それは最も一般的な状況に適合します。
  </p><p>   <a id="id-1.5.10.5.3.1" class="indexterm"></a>
   <a id="id-1.5.10.5.3.2" class="indexterm"></a>
B-treeインデックスは、ある順番でソート可能なデータに対する等価性や範囲を問い合わせることを扱うことができます。
具体的には、<span class="productname">PostgreSQL</span>の問い合わせプランナは、インデックスの付いた列を次の演算子を使用して比較する場合に、B-treeインデックスの使用を検討します。

   </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">&lt;</code></td></tr><tr><td><code class="literal">&lt;=</code></td></tr><tr><td><code class="literal">=</code></td></tr><tr><td><code class="literal">&gt;=</code></td></tr><tr><td><code class="literal">&gt;</code></td></tr></table><p>

また、<code class="literal">BETWEEN</code>や<code class="literal">IN</code>などのこれらの演算子の組み合わせと等価な式もB-treeインデックス検索で実装することができます。
インデックスの付いた列に対する<code class="literal">IS NULL</code>や<code class="literal">IS NOT NULL</code>でもB-treeインデックスを使用することができます。
  </p><p>オプティマイザは、パターンマッチ演算子<code class="literal">LIKE</code>、<code class="literal">~</code>を含む問い合わせでも、そのパターンが定数であり、先頭文字列を指定している<span class="emphasis"><em>のであれば</em></span>B-treeインデックスを使用することができます。
例えば、<code class="literal">col LIKE 'foo%'</code>または<code class="literal">col ~ '^foo'</code>では使用されますが、<code class="literal">col LIKE '%bar'</code>では使用されません。
しかし、データベースがCロケールを使用していない場合、パターンマッチ問い合わせのインデックス付けをサポートする特別な演算子クラスでインデックスを作成しなければなりません。
後述の<a class="xref" href="indexes-opclass.html" title="11.9. 演算子クラスと演算子族">Section 11.9</a>を参照してください。
なお、<code class="literal">ILIKE</code>と<code class="literal">~*</code>でもB-treeインデックスを使用することができますが、パターンが英字以外の文字、つまり、大文字小文字の違いの影響がない文字で始まる場合のみです。
  </p><p>B-treeインデックスをソートされた順序でデータを受けとるために使用することもできます。
これは常に単純なスキャンとソート処理より高速になるものではありませんが、よく役に立つことがあります。
  </p><p>   <a id="id-1.5.10.5.6.1" class="indexterm"></a>
   <a id="id-1.5.10.5.6.2" class="indexterm"></a>
ハッシュインデックスは単純な等価性比較のみを扱うことができます。
問い合わせプランナでは、インデックスの付いた列を<code class="literal">=</code>演算子を使用して比較する場合に、ハッシュインデックスの使用を検討します。
ハッシュインデックスを作成するには、以下のようなコマンドを使用してください。
</p><pre class="synopsis">CREATE INDEX <em class="replaceable"><code>name</code></em> ON <em class="replaceable"><code>table</code></em> USING HASH (<em class="replaceable"><code>column</code></em>);</pre><p>
  </p><p>   <a id="id-1.5.10.5.7.1" class="indexterm"></a>
   <a id="id-1.5.10.5.7.2" class="indexterm"></a>
GiSTインデックスは単一種類のインデックスではなく、多くの異なるインデックス戦略を実装することができる基盤です。
したがって、具体的なGiSTインデックスで使用できる演算子はインデックス戦略（<em class="firstterm">演算子クラス</em>）によって異なります。
例えば、<span class="productname">PostgreSQL</span>の標準配布物には、複数の二次元幾何データ型用のGiST演算子クラスが含まれており、以下の演算子を使用してインデックス付けされた問い合わせをサポートします。

   </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">&lt;&lt;</code></td></tr><tr><td><code class="literal">&amp;&lt;</code></td></tr><tr><td><code class="literal">&amp;&gt;</code></td></tr><tr><td><code class="literal">&gt;&gt;</code></td></tr><tr><td><code class="literal">&lt;&lt;|</code></td></tr><tr><td><code class="literal">&amp;&lt;|</code></td></tr><tr><td><code class="literal">|&amp;&gt;</code></td></tr><tr><td><code class="literal">|&gt;&gt;</code></td></tr><tr><td><code class="literal">@&gt;</code></td></tr><tr><td><code class="literal">&lt;@</code></td></tr><tr><td><code class="literal">~=</code></td></tr><tr><td><code class="literal">&amp;&amp;</code></td></tr></table><p>

（これらの演算子の意味については<a class="xref" href="functions-geometry.html" title="9.11. 幾何関数と演算子">Section 9.11</a>を参照してください。）
標準配布物に含まれるGiST演算子クラスは<a class="xref" href="gist-builtin-opclasses.html#GIST-BUILTIN-OPCLASSES-TABLE" title="Table 62.1. 組み込みGiST演算子クラス">Table 62.1</a>に記載されています。
他の多くのGiST演算子クラスが<code class="literal">contrib</code>群や別のプロジェクトとして利用可能です。
詳細は<a class="xref" href="gist.html" title="Chapter 62. GiSTインデックス">Chapter 62</a>を参照してください。
  </p><p>GiSTインデックスは以下のような<span class="quote">“<span class="quote">最近傍</span>”</span>検索を最適化する機能も持ちます。
</p><pre class="programlisting">SELECT * FROM places ORDER BY location &lt;-&gt; point '(101,456)' LIMIT 10;</pre><p>
これは指定された対象地点に最も近い１０箇所を見つけ出します。
この場合も、これができるかどうかは使用される特定の演算子クラスに依存します。
このように利用できる演算子は<a class="xref" href="gist-builtin-opclasses.html#GIST-BUILTIN-OPCLASSES-TABLE" title="Table 62.1. 組み込みGiST演算子クラス">Table 62.1</a>の<span class="quote">“<span class="quote">順序付け演算子</span>”</span>列に表示されています。
  </p><p>   <a id="id-1.5.10.5.9.1" class="indexterm"></a>
   <a id="id-1.5.10.5.9.2" class="indexterm"></a>
SP-GiSTインデックスは、GiSTインデックスと同様に様々な種類の検索を支援する基盤を提供します。
SP-GiSTインデックスは広域な異なる不均衡でディスクベースのデータ構造、つまり、四分木,kd木、基数木のような実装を認めます。
例えば、<span class="productname">PostgreSQL</span>標準配布物には、以下の演算子を使用する問い合わせに対するインデックスをサポートする2次元の点用のSP-GiST用の演算子クラスが含まれています。

   </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">&lt;&lt;</code></td></tr><tr><td><code class="literal">&gt;&gt;</code></td></tr><tr><td><code class="literal">~=</code></td></tr><tr><td><code class="literal">&lt;@</code></td></tr><tr><td><code class="literal">&lt;^</code></td></tr><tr><td><code class="literal">&gt;^</code></td></tr></table><p>

(演算子の意味は以下を参照してください<a class="xref" href="functions-geometry.html" title="9.11. 幾何関数と演算子">Section 9.11</a> )
標準配布物に含まれるSP-GiSTクラスは<a class="xref" href="spgist-builtin-opclasses.html#SPGIST-BUILTIN-OPCLASSES-TABLE" title="Table 63.1. 組み込みSP-GiST演算子クラス">Table 63.1</a>に記載されています。
詳細は <a class="xref" href="spgist.html" title="Chapter 63. SP-GiSTインデックス">Chapter 63</a>を参照してください。
  </p><p>   <a id="id-1.5.10.5.10.1" class="indexterm"></a>
   <a id="id-1.5.10.5.10.2" class="indexterm"></a>
GINは<span class="quote">“<span class="quote">転置インデックス</span>”</span>であり、配列などのように複数の要素を持つデータ値に適しています。
転置インデックスは各要素値に対して別々のエントリを持っており、特定の要素値の存在について検査する問い合わせを効率的に処理できます。
  </p><p>GiSTやSP-GiST同様、GINも多くの異なるユーザ定義のインデックス戦略を持つことができ、GINが使用できる具体的な演算子はインデックス戦略によって変化します。
例えば、<span class="productname">PostgreSQL</span>標準配布物には、配列用のGIN演算子クラスが含まれており、これらは、以下の演算子を使用するインデックスによる問い合わせをサポートします。

   </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">&lt;@</code></td></tr><tr><td><code class="literal">@&gt;</code></td></tr><tr><td><code class="literal">=</code></td></tr><tr><td><code class="literal">&amp;&amp;</code></td></tr></table><p>

（これらの演算子の意味については<a class="xref" href="functions-array.html" title="9.18. 配列関数と演算子">Section 9.18</a>を参照してください。）
標準配布物に含まれるGIN演算子クラスは<a class="xref" href="gin-builtin-opclasses.html#GIN-BUILTIN-OPCLASSES-TABLE" title="Table 64.1. 組み込みGIN演算子クラス">Table 64.1</a>に記載されています。
他の多くのGIN演算子クラスは<code class="literal">contrib</code>群または別のプロジェクトで利用可能です。
詳細は<a class="xref" href="gin.html" title="Chapter 64. GINインデックス">Chapter 64</a>を参照してください。
  </p><p>   <a id="id-1.5.10.5.12.1" class="indexterm"></a>
   <a id="id-1.5.10.5.12.2" class="indexterm"></a>
BRINインデックス(ブロックレンジインデックス(Block Range INdex)を縮めたものです)はテーブルの連続的な物理ブロックの範囲に格納された値についての要約を格納します。
GiST、SP-GiST、GINと同じように、BRINは多くの異なるインデックス戦略をサポートし、BRINインデックスが使用できる具体的な演算子はインデックス戦略によって変化します。
線形のソート順を持つデータ型では、インデックス付けされたデータは各ブロックレンジの列の中の値の最小値と最大値に対応しています。
これは以下の演算子を使用したインデックスによる問い合わせをサポートします。

   </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">&lt;</code></td></tr><tr><td><code class="literal">&lt;=</code></td></tr><tr><td><code class="literal">=</code></td></tr><tr><td><code class="literal">&gt;=</code></td></tr><tr><td><code class="literal">&gt;</code></td></tr></table><p>

標準配布物に含まれるBRIN演算子クラスは<a class="xref" href="brin-builtin-opclasses.html#BRIN-BUILTIN-OPCLASSES-TABLE" title="Table 65.1. 組み込みBRIN演算子クラス">Table 65.1</a>.に記載されています。
詳細は<a class="xref" href="brin.html" title="Chapter 65. BRINインデックス">Chapter 65</a>を参照してください。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="indexes-intro.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="indexes.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="indexes-multicolumn.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">11.1. 序文 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 11.3. 複数列インデックス</td></tr></table></div></body></html>