<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>53.3. エラーメッセージのスタイルガイド</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="error-message-reporting.html" title="53.2. サーバ内部からのエラーの報告" /><link rel="next" href="source-conventions.html" title="53.4. その他のコーディング規約" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">53.3. エラーメッセージのスタイルガイド</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="error-message-reporting.html" title="53.2. サーバ内部からのエラーの報告">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="source.html" title="Chapter 53. PostgreSQLコーディング規約">Up</a></td><th width="60%" align="center">Chapter 53. PostgreSQLコーディング規約</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="source-conventions.html" title="53.4. その他のコーディング規約">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="ERROR-STYLE-GUIDE"><div class="titlepage"><div><div><h2 class="title" style="clear: both">53.3. エラーメッセージのスタイルガイド</h2></div></div></div><p>このスタイルガイドでは、<span class="productname">PostgreSQL</span>で生成されるすべてのメッセージに対する、一貫性維持、ユーザに親切なスタイルについての希望を説明します。
   </p><div class="simplesect" id="id-1.10.6.4.3"><div class="titlepage"><div><div><h3 class="title">何がどこで起こったか</h3></div></div></div><p>主メッセージは、簡潔に事実を示すものにすべきです。
特定の関数名など実装の詳細への参照は止めるべきです。
<span class="quote">“<span class="quote">簡潔</span>”</span>は<span class="quote">“<span class="quote">ごく普通の条件下で1行に収まる</span>”</span>ことを意味します。
主メッセージを簡潔にするために必要であれば、また、特定のシステムコールが失敗したなど実装の詳細について記載したいのであれば、詳細メッセージを使用してください。
主メッセージ、詳細メッセージの両方は事実を示すものにすべきです。
どうすれば問題を解決できるかに関する提言には、その提言が常に適切とは限らない場合は特に、ヒントメッセージを使用してください。
   </p><p>例えば、
</p><pre class="programlisting">IpcMemoryCreate: shmget(key=%d, size=%u, 0%o) failed: %m
(plus a long addendum that is basically a hint)</pre><p>
ではなく、以下のように記述してください。
</p><pre class="programlisting">Primary:    could not create shared memory segment: %m
Detail:     Failed syscall was shmget(key=%d, size=%u, 0%o).
Hint:       the addendum</pre><p>
   </p><p>理論的根拠：
主メッセージを簡潔にすることは、要点を維持することを助けます。
そして、クライアントは、エラーメッセージ用に1行分確保すれば十分であるという仮定の下で画面設計を行うことができます。
詳細メッセージやヒントメッセージを冗長モードに格下げしたり、エラーの詳細を表示するウィンドウをポップアップさせることもできます。
また、詳細メッセージやヒントメッセージは通常ディスク容量を節約するためにサーバログには出力されません。
ユーザがその詳細を知っているとは期待できないので、実装の詳細への参照を避けることが最善です。
   </p></div><div class="simplesect" id="id-1.10.6.4.4"><div class="titlepage"><div><div><h3 class="title">整形</h3></div></div></div><p>メッセージテキストの整形に関して、特定の前提を行わないでください。
クライアントやサーバログでは、自身の必要性に合わせて行を改行すると想定してください。
長めのメッセージでは、改行文字（\n）を推奨する段落の区切りを示すものとして使用することができます。
メッセージの終わりに改行を付けないでください。
タブや他の整形用文字を使用しないでください。
（エラーの内容の表示では、関数呼び出しなどのコンテキストのレベルを区切るために、改行が自動的に追加されます。）
   </p><p>理論的根拠：
メッセージは必ずしも端末型のディスプレイに表示されるとは限りません。
GUIのディスプレイやブラウザでは、こうした書式指示はうまくいったとしても無視されます。
   </p></div><div class="simplesect" id="id-1.10.6.4.5"><div class="titlepage"><div><div><h3 class="title">引用符</h3></div></div></div><p>英文では、引用が適切な場合には二重引用符を使用すべきです。
他の言語でのテキストは、出版上の慣習や他のプログラムのコンピュータ出力と矛盾しない種類の引用符の1つを一貫して使用してください。
   </p><p>理論的根拠：
二重引用符と単一引用符の選択はどちらかでもよいものですが、推奨する方がよく使われています。
SQL規約（すなわち文字列には単一引用符、識別子には二重引用符）に従って、オブジェクトの種類に応じて引用符を選択することを推奨する人もいます。
しかし、これは言語内部の技術的な事項であり、多くのユーザが理解できるものではありません。
また、他の種類の引用手法には拡張できません。
他の言語へ翻訳できません。
ですので、あまり意味がありません。
   </p></div><div class="simplesect" id="id-1.10.6.4.6"><div class="titlepage"><div><div><h3 class="title">引用符の使用</h3></div></div></div><p>ファイル名、ユーザ提供の識別子、複数の単語を含む変数を区切るために引用符を使用してください。
複数の単語を含まない変数（例えば演算子名）には引用符を使用しないでください。
   </p><p>バックエンドには必要に応じて出力に二重引用符を付与する関数(例えば<code class="function">format_type_be()</code>)があります。
こうした関数の出力の前後にさらに引用符を追加しないでください。
   </p><p>理論的根拠：
オブジェクトの名前をメッセージ内に埋め込む際に曖昧さが生じることがあります。
埋め込む名前がどこから始まりどこで終わるかついての表記には一貫性を持たせてください。
しかし、不必要にメッセージをまとめたり、引用符を二重にすることは止めてください。
   </p></div><div class="simplesect" id="id-1.10.6.4.7"><div class="titlepage"><div><div><h3 class="title">文法と句読点</h3></div></div></div><p>この規則は、主エラーメッセージと詳細/ヒントメッセージとで異なります。
   </p><p>主エラーメッセージ：
最初の文字を大文字にしないでください。
メッセージの最後にピリオドを付けないでください。
メッセージの終わりに感嘆符を付けようとは考えないでください。
   </p><p>詳細メッセージとヒントメッセージ：
完全な文章を使用し、終わりにピリオドを付けてください。
文章の最初の単語は大文字にしてください。
他の文が続く場合はピリオドの後に空白を2つ入れてください（英文の場合です。他の言語では不適切かもしれません）。
   </p><p>エラー文脈文字列:
先頭文字を大文字にせず、また、終わりにはピリオドを付けないでください。
文脈文字列は通常完全な文章にすべきではありません。
   </p><p>理論的根拠：
句読点の禁止により、クライアントアプリケーションでは、そのメッセージを各種文法的なコンテキストに埋め込みやすくなります。
主メッセージはしばしば文法的に完全な文章になっていません。
（そして、1行以上の長さになりそうであれば、主メッセージと詳細メッセージに分割すべきです。）
しかし、詳細メッセージとヒントメッセージは、より長く、かつ複数の文章を持つ必要があるかもしれません。
一貫性のため、これらは、たとえ文章が1つだけであっても、完全な文章形式に従うべきです。
   </p></div><div class="simplesect" id="id-1.10.6.4.8"><div class="titlepage"><div><div><h3 class="title">大文字と小文字</h3></div></div></div><p>メッセージの言葉使いでは小文字を使用してください。
主エラーメッセージの場合は先頭文字も含みます。
SQLコマンドとキーワードがメッセージ内に出現する場合は大文字を使用してください。
   </p><p>理論的根拠：
メッセージは完全な文章かもしれませんし、そうではないかもしれませんので、この方法は、より簡単にすべての見た目の一貫性を向上します。
   </p></div><div class="simplesect" id="id-1.10.6.4.9"><div class="titlepage"><div><div><h3 class="title">受動態の禁止</h3></div></div></div><p>能動態を使用してください。
能動的な主語がある（<span class="quote">“<span class="quote">AはBを行うことができない</span>”</span>）場合は完全な文章を使用してください。
主語がプログラム自体である場合は、主語を付けずに電報様式を使用してください。
プログラムに<span class="quote">“<span class="quote">I（私）</span>”</span>を使用しないでください。
   </p><p>理論的根拠：
プログラムは人間ではありません。
他を真似ないでください。
   </p></div><div class="simplesect" id="id-1.10.6.4.10"><div class="titlepage"><div><div><h3 class="title">現在形と過去形</h3></div></div></div><p>試行が失敗したが、次は（何らかの問題を修正した後に）成功するかもしれない場合は過去形を使用してください。
失敗が永続するようであれば、現在形を使用してください。
   </p><p>以下の2つの意味には無視できないほどの違いがあります。
</p><pre class="programlisting">could not open file "%s": %m</pre><p>
および
</p><pre class="programlisting">cannot open file "%s"</pre><p>
最初のものは、ファイルを開くことに失敗したことを意味します。
メッセージには、<span class="quote">“<span class="quote">ディスクが一杯</span>”</span>や<span class="quote">“<span class="quote">ファイルが存在しない</span>”</span>といった、その理由を付けるべきです。
次回はディスクに空きがあるかもしれませんし、問題のファイルが存在するかもしれませんので過去形が適切です。
   </p><p>2番目の形式は、そのプログラム内の指名されたファイルを開く機能が存在しない、あるいは、概念的に不可能であることを示します。
この条件は永遠に続きますので現在形が適切です。
   </p><p>理論的根拠：
仮定ですが、一般的なユーザは単なるメッセージの時制から多くの意味を引き出すことはできないでしょう。
しかし、言語が文法を提供してくれますので、それを正確に使用すべきでしょう。
   </p></div><div class="simplesect" id="id-1.10.6.4.11"><div class="titlepage"><div><div><h3 class="title">オブジェクトの種類</h3></div></div></div><p>オブジェクトの名前を引用する時、そのオブジェクトの種類を記載してください。
   </p><p>理論的根拠：
さもないと、<span class="quote">“<span class="quote">foo.bar.baz</span>”</span>が何なのか誰もわかりません。
   </p></div><div class="simplesect" id="id-1.10.6.4.12"><div class="titlepage"><div><div><h3 class="title">角括弧</h3></div></div></div><p>角括弧は、（1）コマンドの概要にて省略可能な引数を表す、（2）配列の添字を表す、ためだけに使用されます。
   </p><p>理論的根拠：
広く知られる慣習に対応するものがなく、人々を混乱させることになります。
   </p></div><div class="simplesect" id="id-1.10.6.4.13"><div class="titlepage"><div><div><h3 class="title">エラーメッセージの組み立て</h3></div></div></div><p>メッセージに、他で生成されるテキストを含める場合、以下の様式で埋め込んでください。
</p><pre class="programlisting">could not open file %s: %m</pre><p>
   </p><p>理論的根拠：
すべての起こり得るエラーコードを単一のなめらかな文章に埋め込むことを考えることは困難です。
ですので、何らかの句読点が必要とされます。
括弧の中にテキストを埋め込むこともまた推奨されていますが、よくあるように埋め込むテキストがそのメッセージの最も重要となる場合は不自然です。
   </p></div><div class="simplesect" id="id-1.10.6.4.14"><div class="titlepage"><div><div><h3 class="title">エラーの理由</h3></div></div></div><p>メッセージは常にエラーが発生した理由を記述すべきです。
以下に例を示します。
</p><pre class="programlisting">BAD:    could not open file %s
BETTER: could not open file %s (I/O failure)</pre><p>
理由がわからない場合はコードを直すべきです。
   </p></div><div class="simplesect" id="id-1.10.6.4.15"><div class="titlepage"><div><div><h3 class="title">関数名</h3></div></div></div><p>エラーテキストには、それを報告したルーチンの名前を含めないでください。
必要に応じて、そのルーチンを見つける他の機構がありますし、また、ほとんどのユーザにとって役に立つ情報ではありません。
関数名がないと、エラーメッセージにあまり意味がないのであれば、言葉使いを変えてください。
</p><pre class="programlisting">BAD:    pg_atoi: error in "z": cannot parse "z"
BETTER: invalid input syntax for integer: "z"</pre><p>
   </p><p>同時に呼び出した関数名の記述も止めてください。
代わりにそのコードが何をしようとしたのかを記述してください。
</p><pre class="programlisting">BAD:    open() failed: %m
BETTER: could not open file %s: %m</pre><p>
もし本当に必要であれば、詳細メッセージにそのシステムコールを記載してください
（詳細メッセージの情報としてシステムコールに実際に渡した値を与えることが適切な場合もあります）。
   </p><p>理論的根拠：
ユーザはその関数が何を行うのかを知りません。
   </p></div><div class="simplesect" id="id-1.10.6.4.16"><div class="titlepage"><div><div><h3 class="title">ややこしい単語の防止</h3></div></div></div><p><strong>Unable. </strong><span class="quote">“<span class="quote">Unable</span>”</span>はほとんど受動態です。
<span class="quote">“<span class="quote">cannot</span>”</span>または<span class="quote">“<span class="quote">could not</span>”</span>の適切な方を使用してください。
   </p><p><strong>Bad. </strong><span class="quote">“<span class="quote">bad result</span>”</span>といったエラーメッセージは、知的に解釈することが非常に困難です。
結果が<span class="quote">“<span class="quote">bad</span>”</span>である理由、例えば<span class="quote">“<span class="quote">invalid format</span>”</span>を記述してください。
   </p><p><strong>Illegal. </strong><span class="quote">“<span class="quote">Illegal</span>”</span>は規則違反を表します。
他は<span class="quote">“<span class="quote">invalid</span>”</span>です。
より良くするために、なぜ無効なのかについても記述してください。
   </p><p><strong>Unknown. </strong><span class="quote">“<span class="quote">unknown</span>”</span>は極力使用しないでください。
<span class="quote">“<span class="quote">error: unknown response</span>”</span>について考えてみましょう。
どんな応答であるかわからなければ、どうやって何がエラーなのかわかるでしょうか。
<span class="quote">“<span class="quote">Unrecognized</span>”</span>を選んだ方が良い場合がしばしばあります。
また、その警告の中に値が含まれていることを確認してください。
</p><pre class="programlisting">BAD:    unknown node type
BETTER: unrecognized node type: 42</pre><p>
   </p><p><strong>Find対Exists. </strong>プログラムがリソースの場所について無視できないアルゴリズム（例えばパスの検索）を使用し、そのアルゴリズムが失敗した場合、プログラムがリソースを<span class="quote">“<span class="quote">find</span>”</span>できなかったと記述すべきでしょう。
一方、想定したリソースの場所はわかっているが、プログラムがアクセスできなかった場合は、リソースが<span class="quote">“<span class="quote">exist</span>”</span>しなかったと記述してください。
この場合に<span class="quote">“<span class="quote">find</span>”</span>を使用すると、弱く取られ、問題が混乱します。
   </p><p><strong>May、Can、Might. </strong><span class="quote">“<span class="quote">May</span>”</span>は許可を示し、文書やエラーメッセージではあまり使われません（たとえば、熊手を借りられます）。
<span class="quote">“<span class="quote">Can</span>”</span>は能力を示し（たとえば、丸太を持ち上げることができます）、<span class="quote">“<span class="quote">might</span>”</span>は可能性を示します（たとえば、雨が降るかもしれません）。
意味を明確にし、翻訳を補助するために適切に使用してください。
   </p><p><strong>短縮. </strong><span class="quote">“<span class="quote">can't</span>”</span>などの短縮は避けてください。
代わりに<span class="quote">“<span class="quote">cannot</span>”</span>を使用してください。
   </p></div><div class="simplesect" id="id-1.10.6.4.17"><div class="titlepage"><div><div><h3 class="title">適切なスペル</h3></div></div></div><p>単語の完全なスペルを使用してください。
例えば、以下は止めてください。
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>     spec
    </p></li><li class="listitem"><p>     stats
    </p></li><li class="listitem"><p>     parens
    </p></li><li class="listitem"><p>     auth
    </p></li><li class="listitem"><p>     xact
    </p></li></ul></div><p>
   </p><p>理論的根拠：
これは一貫性を向上します。
   </p></div><div class="simplesect" id="id-1.10.6.4.18"><div class="titlepage"><div><div><h3 class="title">地域化</h3></div></div></div><p>エラーメッセージは他の言語に翻訳される必要があることを忘れないでください。
<a class="xref" href="nls-programmer.html#NLS-GUIDELINES" title="54.2.2. メッセージ記述の指針">Section 54.2.2</a>のガイドラインに従い、翻訳者に苦労を強いることを防いでください。
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="error-message-reporting.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="source.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="source-conventions.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">53.2. サーバ内部からのエラーの報告 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 53.4. その他のコーディング規約</td></tr></table></div></body></html>