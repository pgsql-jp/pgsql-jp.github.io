<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>19.7. 問い合わせ計画</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="runtime-config-replication.html" title="19.6. レプリケーション" /><link rel="next" href="runtime-config-logging.html" title="19.8. エラー報告とログ取得" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">19.7. 問い合わせ計画</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="runtime-config-replication.html" title="19.6. レプリケーション">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="runtime-config.html" title="Chapter 19. サーバの設定">Up</a></td><th width="60%" align="center">Chapter 19. サーバの設定</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="runtime-config-logging.html" title="19.8. エラー報告とログ取得">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RUNTIME-CONFIG-QUERY"><div class="titlepage"><div><div><h2 class="title" style="clear: both">19.7. 問い合わせ計画</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="runtime-config-query.html#RUNTIME-CONFIG-QUERY-ENABLE">19.7.1. プランナメソッド設定</a></span></dt><dt><span class="sect2"><a href="runtime-config-query.html#RUNTIME-CONFIG-QUERY-CONSTANTS">19.7.2. プランナコスト定数</a></span></dt><dt><span class="sect2"><a href="runtime-config-query.html#RUNTIME-CONFIG-QUERY-GEQO">19.7.3. 遺伝的問い合わせオプティマイザ</a></span></dt><dt><span class="sect2"><a href="runtime-config-query.html#RUNTIME-CONFIG-QUERY-OTHER">19.7.4. その他のプランナオプション</a></span></dt></dl></div><div class="sect2" id="RUNTIME-CONFIG-QUERY-ENABLE"><div class="titlepage"><div><div><h3 class="title">19.7.1. プランナメソッド設定</h3></div></div></div><p>      
以下の設定パラメータは、問い合わせオプティマイザが選択する問い合わせ計画に影響する大雑把な手法を提供します。
ある問い合わせに対してオプティマイザが選択したデフォルト計画が最適でない場合、<span class="emphasis"><em>暫定的な</em></span>解決策は、これらの設定パラメータの1つを使用し、オプティマイザに異なる計画を選択するように仕向けることです。
オプティマイザが選択する計画の品質を改善するためのより良い方法には、プランナコスト定数を調節する（<a class="xref" href="runtime-config-query.html#RUNTIME-CONFIG-QUERY-CONSTANTS" title="19.7.2. プランナコスト定数">Section 19.7.2</a>を参照）、<a class="xref" href="sql-analyze.html" title="ANALYZE"><span class="refentrytitle">ANALYZE</span></a>を手作業で実行する、<a class="xref" href="runtime-config-query.html#GUC-DEFAULT-STATISTICS-TARGET">default_statistics_target</a>設定パラメータの値を大きくする、<code class="command">ALTER TABLE SET STATISTICS</code>を使用して、特定の列に対して収集される統計情報を増やす、などがあります。
      </p><div class="variablelist"><dl class="variablelist"><dt id="GUC-ENABLE-BITMAPSCAN"><span class="term"><code class="varname">enable_bitmapscan</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.1.1.3" class="indexterm"></a>
      <a id="id-1.6.6.10.2.3.1.1.4" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナがビットマップスキャン計画型を選択することを有効もしくは無効にします。デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-GATHERMERGE"><span class="term"><code class="varname">enable_gathermerge</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.2.1.3" class="indexterm"></a>
      </span></dt><dd><p>問い合わせプランナがギャザーマージ計画型を選択することを有効もしくは無効にします。
デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-HASHAGG"><span class="term"><code class="varname">enable_hashagg</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.3.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
問い合わせプランナがハッシュ集約計画型を選択することを有効もしくは無効にします。
デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-HASHJOIN"><span class="term"><code class="varname">enable_hashjoin</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.4.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナがハッシュ結合計画型を選択することを有効もしくは無効にします。デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-INDEXSCAN"><span class="term"><code class="varname">enable_indexscan</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.5.1.3" class="indexterm"></a>
      <a id="id-1.6.6.10.2.3.5.1.4" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナがインデックス走査計画型を選択することを有効もしくは無効にします。デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-INDEXONLYSCAN"><span class="term"><code class="varname">enable_indexonlyscan</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.6.1.3" class="indexterm"></a>
      </span></dt><dd><p>問い合わせプランナがインデックスオンリースキャン計画型を選択することを有効もしくは無効にします。
(<a class="xref" href="indexes-index-only-scans.html" title="11.11. インデックスオンリースキャン">Section 11.11</a>を参照してください)
デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-MATERIAL"><span class="term"><code class="varname">enable_material</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.7.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナの具体化の使用を有効、または無効にします。
       全体にわたって具体化を差し止めることはできませんが、この値をoffにすることにより、正確性が要求される場合を除いて、具体化ノードをプランナが挿入することを防止します。デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-MERGEJOIN"><span class="term"><code class="varname">enable_mergejoin</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.8.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナがマージ結合計画型を選択することを有効もしくは無効にします。デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-NESTLOOP"><span class="term"><code class="varname">enable_nestloop</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.9.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナがネステッドループ結合計画を選択することを有効もしくは無効にします。
       ネステッドループ結合を完全に禁止することは不可能ですが、この変数をオフにすると、もし他の方法が利用できるのであれば、プランナはその使用を行わないようになります。
       デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-SEQSCAN"><span class="term"><code class="varname">enable_seqscan</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.10.1.3" class="indexterm"></a>
      <a id="id-1.6.6.10.2.3.10.1.4" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナがシーケンシャル走査計画を選択することを有効もしくは無効にします。
       シーケンシャル走査を完全に禁止することは不可能ですが、この変数をオフにすると、もし他の方法が利用できるのであれば、プランナはその使用を行わないようになります。デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-SORT"><span class="term"><code class="varname">enable_sort</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.11.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナが明示的並び替え手順を選択することを有効もしくは無効にします。
       明示的並び替えを完全に禁止することは不可能ですが、この変数をオフにすると、もし他の方法が利用できるのであれば、プランナはその使用を行わないようになります。デフォルトは<code class="literal">on</code>です。
       </p></dd><dt id="GUC-ENABLE-TIDSCAN"><span class="term"><code class="varname">enable_tidscan</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.2.3.12.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせプランナが<acronym class="acronym">TID</acronym>走査計画型を選択することを有効もしくは無効にします。デフォルトは<code class="literal">on</code>です。
       </p></dd></dl></div></div><div class="sect2" id="RUNTIME-CONFIG-QUERY-CONSTANTS"><div class="titlepage"><div><div><h3 class="title">19.7.2. プランナコスト定数</h3></div></div></div><p>    
本節で扱う<em class="firstterm">コスト</em>変数は、任意の尺度で測られます。
これらは相対的な値のみが意味を持つため、それらの値をすべて同じ係数で大きく、あるいは小さくしても、プランナの選択は結果として変わりません。
デフォルトではこれらのコスト変数はシーケンシャルなページ取り込みに基づいています。
つまり、<code class="varname">seq_page_cost</code>を慣習的に<code class="literal">1.0</code>とし、他のコスト変数はそれを参考にして設定されています。
しかし望むなら、特定のマシンにおけるミリ秒単位の実行時間など、異なる尺度を使用することができます。
    </p><div class="note"><h3 class="title">Note</h3><p>    
残念ながら、コスト変数に対する理想的な値を決定する、上手く定義された方法がありません。
特定のインストレーションが受け取る問い合わせ全体を混在させたものの平均として扱うのが最善でしょう。
数回の実験のみを根拠にこの値を変更することは危険であるといえます。
    </p></div><div class="variablelist"><dl class="variablelist"><dt id="GUC-SEQ-PAGE-COST"><span class="term"><code class="varname">seq_page_cost</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.3.4.1.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
シーケンシャルな一連の取り出しの一部となる、ディスクページ取り出しに関する、プランナの推定コストを設定します。
デフォルトは1.0です。
この値は同じ名前のテーブル空間パラメータを設定することで、特定のテーブル空間の中にあるテーブルとインデックスに対して上書きできます（<a class="xref" href="sql-altertablespace.html" title="ALTER TABLESPACE"><span class="refentrytitle">ALTER TABLESPACE</span></a>を参照してください）。
       </p></dd><dt id="GUC-RANDOM-PAGE-COST"><span class="term"><code class="varname">random_page_cost</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.3.4.2.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
非シーケンシャル的に取り出されるディスクページのコストに対するプランナの推測を設定します。
デフォルトは4です。
この値は同じ名前のテーブル空間パラメータを設定することで、特定のテーブル空間の中にあるテーブルとインデックスに対して上書きできます（<a class="xref" href="sql-altertablespace.html" title="ALTER TABLESPACE"><span class="refentrytitle">ALTER TABLESPACE</span></a>を参照してください）。
       </p><p>       
この値を<code class="varname">seq_page_cost</code>と比較して小さくすると、システムはなるべくインデックススキャンを使用するようになります。
大きくすると、インデックススキャンが相対的に高価になります。
両方の値を増減させることで、CPUコストに対するディスクI/Oコストの重要性を変更させることができます。
これについては、後述のパラメータで説明します。
       </p><p>       
機械的ディスク記憶装置に対するランダムアクセスは通常はシーケンシャルアクセスの4倍よりもかなり高価です。
しかし、より低いデフォルト（4.0）が使用されます。というのはインデックスのついた読み取りのようなディスクに対するランダムアクセスのほとんどはキャッシュにあると想定されるからです。
このデフォルト値は、ランダムアクセスがシーケンシャルアクセスより40倍遅い一方で、ランダム読み込みの90%はキャッシュされていることが期待されるというモデルとして考えることができます。
       </p><p>       
自環境の作業負荷において、90％のキャッシュ率は誤った仮定と考えられるのであれば、ランダム記憶装置読み込みのコストをより良く反映するため random_page_cost を大きくすることができます。
反対に、データが完全にキャッシュされていると思われるのであれば、random_page_cost を小さくすることが適切です。例えば、データベースの容量がサーバのメモリより小さい場合などです。
例えばSSDのような、シーケンシャルアクセスに比べてランダム読み込みコストがあまり大きくない記憶装置の場合も、random_page_cost に対しより低い値のモデル化の方が良いでしょう。
       </p><div class="tip"><h3 class="title">Tip</h3><p>       
システムは<code class="varname">random_page_cost</code>を<code class="varname">seq_page_cost</code>よりも小さな値に設定することを許しますが、そのようにすることは物理的にはおかしなことです。
しかし、データベースが完全にRAMにキャッシュされる場合、同じ値に設定することは意味を持ちます。
この場合、順序通りではないページアクセスに対するペナルティが存在しないからです。
また、多くがキャッシュされるデータベースでは、CPUパラメータに対して両値を小さく設定すべきです。
RAM内に存在するページの取り出しコストは通常よりもかなり小さくなるためです。
        </p></div></dd><dt id="GUC-CPU-TUPLE-COST"><span class="term"><code class="varname">cpu_tuple_cost</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.3.4.3.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
問い合わせ時のそれぞれの行の処理コストに対するプランナの推測を設定します。
デフォルトは0.01です。
       </p></dd><dt id="GUC-CPU-INDEX-TUPLE-COST"><span class="term"><code class="varname">cpu_index_tuple_cost</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.3.4.4.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
インデックス走査時のそれぞれのインデックス行の処理コストに対するプランナの推測を設定します。
デフォルトは0.005です。
       </p></dd><dt id="GUC-CPU-OPERATOR-COST"><span class="term"><code class="varname">cpu_operator_cost</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.3.4.5.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせ時に実行される各演算子や関数の処理コストに対するプランナの推測を設定します。デフォルトは0.0025です。
       </p></dd><dt id="GUC-PARALLEL-SETUP-COST"><span class="term"><code class="varname">parallel_setup_cost</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.3.4.6.1.3" class="indexterm"></a>
      </span></dt><dd><p>パラレルワーカープロセスを起動するためのコストに対するプランナの推測値を設定します。
デフォルトは1000です。
       </p></dd><dt id="GUC-PARALLEL-TUPLE-COST"><span class="term"><code class="varname">parallel_tuple_cost</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.3.4.7.1.3" class="indexterm"></a>
      </span></dt><dd><p>あるパラレルワーカープロセスから、1行を他のプロセスに転送するためのコストに対するプランナの推測値を設定します。
デフォルトは0.1です。
       </p></dd><dt id="GUC-MIN-PARALLEL-TABLE-SCAN-SIZE"><span class="term"><code class="varname">min_parallel_table_scan_size</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.3.4.8.1.3" class="indexterm"></a>
      </span></dt><dd><p>パラレルスキャンを考慮する最小のテーブルデータのサイズを指定します。
パラレル順スキャンでは、スキャンされるテーブルのデータ量は、常にテーブルのサイズと同じです。
しかし、インデックスが使われる場合は、スキャンされるテーブルの量は通常少なくなるでしょう。
デフォルトは8メガバイト（ <code class="literal">8MB</code>）です。
       </p></dd><dt id="GUC-MIN-PARALLEL-INDEX-SCAN-SIZE"><span class="term"><code class="varname">min_parallel_index_scan_size</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.3.4.9.1.3" class="indexterm"></a>
      </span></dt><dd><p>パラレルスキャンが考慮されるために、スキャンされなければならないインデックスデータの最小量を設定します。
通常パラレルインデックススキャンは、典型的にはインデックス全体をアクセスしないことに注意してください。
これは、関連するスキャンにより、プランナが実際にアクセスされると信じるページ数です。
デフォルトは512キロバイト（<code class="literal">512kB</code>）です。
       </p></dd><dt id="GUC-EFFECTIVE-CACHE-SIZE"><span class="term"><code class="varname">effective_cache_size</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.3.4.10.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
単一の問い合わせで利用できるディスクキャッシュの実効容量に関するプランナの条件を設定します。
これは、インデックスを使用するコスト推定値の要素となります。
より高い値にすれば、よりインデックススキャンが使用されるようになり、より小さく設定すれば、シーケンシャルスキャンがより使用されるようになります。
このパラメータを設定する時には、<span class="productname">PostgreSQL</span>の共有バッファと<span class="productname">PostgreSQL</span>データファイルに使用されるカーネルのディスクキャッシュの量の両方を考慮しなければなりません。
また、利用可能な領域を共有しますので、異なるテーブルに対して同時に実行される問い合わせの想定数も考慮してください。
このパラメータは、<span class="productname">PostgreSQL</span>で割り当てられる共有メモリの大きさには影響を与えません。また、カーネルのディスクキャッシュを予約したりもしません。
これは推定目的のみで使用されます。
同時に、システムは問い合わせの間のディスクキャッシュ内のデータの残滓を想定していません。
デフォルトは4ギガバイト（<code class="literal">4GB</code>）です。
       </p></dd></dl></div></div><div class="sect2" id="RUNTIME-CONFIG-QUERY-GEQO"><div class="titlepage"><div><div><h3 class="title">19.7.3. 遺伝的問い合わせオプティマイザ</h3></div></div></div><p>     
      遺伝的問い合わせオプティマイザ（GEQO）はヒューリスティック（発見的）検索法を用いた問い合わせ計画を行なう演算手法です。
      通常のしらみつぶしの検索演算手法で見いだされる計画よりも時として劣った計画を作成するという代償を払いますが、この手法は（多くのリレーションを結合するような）複雑な問い合わせに対し計画時間を軽減します。
      より詳細は<a class="xref" href="geqo.html" title="Chapter 59. 遺伝的問い合わせ最適化">Chapter 59</a>を参照してください。
     </p><div class="variablelist"><dl class="variablelist"><dt id="GUC-GEQO"><span class="term"><code class="varname">geqo</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.10.4.3.1.1.3" class="indexterm"></a>
      <a id="id-1.6.6.10.4.3.1.1.4" class="indexterm"></a>
      <a id="id-1.6.6.10.4.3.1.1.5" class="indexterm"></a>
      </span></dt><dd><p>       
       遺伝的問い合わせ最適化を有効もしくは無効にします。デフォルトは有効です。
       運用時には無効にしないことが通常最善です。<code class="varname">geqo_threshold</code>変数は、GEQOを制御するためよりきめ細かな方法を提供します。
       </p></dd><dt id="GUC-GEQO-THRESHOLD"><span class="term"><code class="varname">geqo_threshold</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.4.3.2.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
少なくともこれだけの数の<code class="literal">FROM</code>項目数があるときに、問い合わせを計画するのに遺伝的問い合わせ最適化を使用します。
（<code class="literal">FULL OUTER JOIN</code>の生成子は、<code class="literal">FROM</code>項目が１つだけとして計算することに注意してください。）
デフォルトは12です。
もっと単純な問い合わせでは、通常の、そしてしらみつぶしの検索プランナを使用するのが最善ですが、多くのテーブルを持つ問い合わせでは、しらみつぶしの検索は非常に時間がかかり、しばしば次善の計画を実行する代償より長くなります。
従って、問い合わせの大きさに対する閾値はGEQOの使用を管理するのに便利な方法です。
       </p></dd><dt id="GUC-GEQO-EFFORT"><span class="term"><code class="varname">geqo_effort</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.4.3.3.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       GEQOにおける計画時間と問い合わせ計画の品質間のトレードオフを制御します。この変数は1から10までの範囲の整数でなければなりません。
       デフォルトの値は5です。値を大きくすると、問い合わせ計画作成により多くの時間を費すことになりますが、より効率的な問い合わせ計画が選択される可能性が増加します。
       </p><p>       
       実際<code class="varname">geqo_effort</code>は直接何も行いません。それはGEQOの動作に影響を与える他の変数に対し、デフォルトの値を計算するためにのみ使用されます（以下で説明します）。もしよければ、代わりに手作業で他のパラメータを設定できます。
       </p></dd><dt id="GUC-GEQO-POOL-SIZE"><span class="term"><code class="varname">geqo_pool_size</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.4.3.4.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       GEQOで使用されるプール容量を管理します。それは遺伝的個体群内の個体数です。最低でも2つはなければならず、よく100から1000までの値が使用されます。もし（デフォルトの設定である）零に設定されると、<code class="varname">geqo_effort</code>および問い合わせの中のテーブル数に基づいて、適切な値が選択されます。
       </p></dd><dt id="GUC-GEQO-GENERATIONS"><span class="term"><code class="varname">geqo_generations</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.4.3.5.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       GEQOで使用される世代の数を管理します。それはアルゴリズムの反復数です。最低でも1はなければならず、よくプールサイズと同じ範囲の値が使用されます。これを0に設定（デフォルトの設定）すると、適切な値が<code class="varname">geqo_effort</code>に基づいて選択されます。
       </p></dd><dt id="GUC-GEQO-SELECTION-BIAS"><span class="term"><code class="varname">geqo_selection_bias</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.4.3.6.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       GEQOで使用される淘汰の偏りを管理します。淘汰の偏りは個体群内の（遺伝的な）自然淘汰です。値は1.50から2.00で、2.00がデフォルトです。
       </p></dd><dt id="GUC-GEQO-SEED"><span class="term"><code class="varname">geqo_seed</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.4.3.7.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
結合順序検索空間にわたって、GEQOが無作為のパスを選択するために使用される乱数発生器の初期値を制御します。
値は0（デフォルト）から1までの範囲です。
値を変動させると探査される結合パスの集合が変化するため、見つかる最善のパスが良くなる場合も悪くなる場合もあります。
       </p></dd></dl></div></div><div class="sect2" id="RUNTIME-CONFIG-QUERY-OTHER"><div class="titlepage"><div><div><h3 class="title">19.7.4. その他のプランナオプション</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt id="GUC-DEFAULT-STATISTICS-TARGET"><span class="term"><code class="varname">default_statistics_target</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.5.2.1.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       <code class="command">ALTER TABLE SET STATISTICS</code>で列特定の目的セットの無いテーブル列に対し、デフォルトの統計対象を設定します。
より大きい値は<code class="command">ANALYZE</code>に必要な時間を増加させますが、プランナの予測の品質を向上させます。
デフォルトは100です。
<span class="productname">PostgreSQL</span>の問い合わせプランナによる統計情報の使用方法に関するより詳細な情報は、<a class="xref" href="planner-stats.html" title="14.2. プランナで使用される統計情報">Section 14.2</a>を参照してください。
       </p></dd><dt id="GUC-CONSTRAINT-EXCLUSION"><span class="term"><code class="varname">constraint_exclusion</code> (<code class="type">enum</code>)
      <a id="id-1.6.6.10.5.2.2.1.3" class="indexterm"></a>
      <a id="id-1.6.6.10.5.2.2.1.4" class="indexterm"></a>
      </span></dt><dd><p>       
       問い合わせを最適化するため、テーブル制約に対しての問い合わせプランナの使用を制御します。<code class="varname">constraint_exclusion</code>に許容される値は、<code class="literal">on</code>（全てのテーブルに対し制約を検査する）、<code class="literal">off</code>（決して制約を検査しない）、および<code class="literal">partition</code>（継承された子テーブルおよび<code class="literal">UNION ALL</code>副問い合わせのみ制約を検査する）です。<code class="literal">partition</code>がデフォルトです。
継承テーブルと分割されたテーブルの性能向上のためしばしば使用されます。
      </p><p>       
       このパラメータが特定のテーブルに対して許される時、プランナはそのテーブルの<code class="literal">CHECK</code>制約で問い合わせ条件を比較し、制約と矛盾する条件のテーブルの走査を省きます。
例えば以下のようになります。

</p><pre class="programlisting">CREATE TABLE parent(key integer, ...);
CREATE TABLE child1000(check (key between 1000 and 1999)) INHERITS(parent);
CREATE TABLE child2000(check (key between 2000 and 2999)) INHERITS(parent);
...
SELECT * FROM parent WHERE key = 2400;</pre><p>

       制約排除が有効であると、この<code class="command">SELECT</code>は全く<code class="structname">child1000</code>を走査せず、性能を向上させます。
       </p><p>       
       現在<code class="varname">constraint_exclusion</code>はデフォルトで、テーブルパーティショニングを実装するためによく使用される場合のみで有効です。
       すべてのテーブルを有効にすることは、計画作成において単純な問い合わせでは無視できない程の余計なオーバーヘッドをもたらします。
       パーティショニングされたテーブルがない場合、完全に無効にする方が良いでしょう。
       </p><p>       
       制約排除とテーブル分割についてのより進んだ情報は<a class="xref" href="ddl-partitioning.html#DDL-PARTITIONING-CONSTRAINT-EXCLUSION" title="5.10.4. パーティショニングと制約による除外">Section 5.10.4</a>を参照ください。
       </p></dd><dt id="GUC-CURSOR-TUPLE-FRACTION"><span class="term"><code class="varname">cursor_tuple_fraction</code> (<code class="type">floating point</code>)
      <a id="id-1.6.6.10.5.2.3.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       検索されるカーソル行の割合のプランナの見積もりを設定します。
       デフォルトは0.1です。
       この設定をより小さくすると、プランナはカーソルに対し<span class="quote">“<span class="quote">起動を高速にする</span>”</span>計画を使用するようになりがちになります。
       この場合先頭の数行の取り出しは高速になりますが、行全体を取り出す場合に時間がかかるようになる可能性があります。
       この値をより大きくすると、推定時間全体がより強調されるようになります。
       最大の設定である1.0の場合、カーソルは通常の問い合わせとまったく同様に計画されます。
       つまり、推定時間全体のみが考慮され、先頭の行の取り出しにかかる時間は考慮されなくなります。
       </p></dd><dt id="GUC-FROM-COLLAPSE-LIMIT"><span class="term"><code class="varname">from_collapse_limit</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.5.2.4.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       プランナは、<code class="literal">FROM</code>リストがこの数の項目より少ない結果の場合、副問い合わせを上位の問い合わせに併合します。
より小さい値は計画時間を縮小させますが、劣った問い合わせ計画をもたらす可能性があります。
デフォルトは8です。
詳細は<a class="xref" href="explicit-joins.html" title="14.3. 明示的なJOIN句でプランナを制御する">Section 14.3</a>を参照してください。
       </p><p>       
       この値を<a class="xref" href="runtime-config-query.html#GUC-GEQO-THRESHOLD">geqo_threshold</a>か、それ以上に設定するとGEQOプランナ使用の誘引となり、最適ではない計画をもたらします。<a class="xref" href="runtime-config-query.html#RUNTIME-CONFIG-QUERY-GEQO" title="19.7.3. 遺伝的問い合わせオプティマイザ">Section 19.7.3</a>を参照してください。
       </p></dd><dt id="GUC-JOIN-COLLAPSE-LIMIT"><span class="term"><code class="varname">join_collapse_limit</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.10.5.2.5.1.3" class="indexterm"></a>
      </span></dt><dd><p>       
       最終的にリストがこの項目数以下になる時、プランナは、明示的な<code class="literal">JOIN</code>構文（<code class="literal">FULL JOIN</code>を除く）を<code class="literal">FROM</code>項目のリストに直します。
この値を小さくすれば計画作成時間は減少しますが、劣った問い合わせ計画が作成される可能性があります。
       </p><p>       
       デフォルトでは、この値は<code class="varname">from_collapse_limit</code>と同じ値に設定されており、殆どの場合に適切です。
これを1に設定すると明示的な<code class="literal">JOIN</code>の再順序付けは行われなくなります。
したがって、問い合わせで指定された明示的結合順序は、関係（リレーション）が結合される実際の順序となります。
問い合わせプランナは常に最適な結合順序を選択するとは限らないので、
上級ユーザなら暫定的にこの変数を1に設定し、明示的に希望とする結合順序を指定してもよいでしょう。
詳細は<a class="xref" href="explicit-joins.html" title="14.3. 明示的なJOIN句でプランナを制御する">Section 14.3</a>を参照してください。
       </p><p>       
       この値を<a class="xref" href="runtime-config-query.html#GUC-GEQO-THRESHOLD">geqo_threshold</a>か、それ以上に設定するとGEQOプランナ使用の誘引となり、最適ではない計画をもたらします。<a class="xref" href="runtime-config-query.html#RUNTIME-CONFIG-QUERY-GEQO" title="19.7.3. 遺伝的問い合わせオプティマイザ">Section 19.7.3</a>を参照してください。
       </p></dd><dt id="GUC-FORCE-PARALLEL-MODE"><span class="term"><code class="varname">force_parallel_mode</code> (<code class="type">enum</code>)
      <a id="id-1.6.6.10.5.2.6.1.3" class="indexterm"></a>
      </span></dt><dd><p>性能改善が期待できなくても、テスト目的のためにパラレルクエリを利用できるようにします。
<code class="varname">force_parallel_mode</code>に設定できる値は、<code class="literal">off</code>（性能改善が期待できるときにだけパラレルクエリを使用する）、<code class="literal">on</code>（安全なクエリに対しては常にパラレルクエリを強制する）、<code class="literal">regress</code>（<code class="literal">on</code>と同様だが、下記のような振る舞いの変更を伴う）です。
       </p><p>正確に言えば、この値を<code class="literal">on</code>にすると、安全と見なされるすべての問い合わせ計画の上に<code class="literal">Gather</code>ノードを追加し、クエリをパラレルワーカー上で実行するようにします。
プランナがこれによってクエリが失敗すると思わない限り、パラレルワーカーが利用できない、あるいは使用できないような場合でも、たとえばサブトランザクションの開始のように、パラレルクエリコンテキストでは許可されない操作は不許可となります。
このオプションを設定することによって、エラーとなったり、あるいは期待していなかった結果がもたらされる場合には、クエリで使用されている関数は<code class="literal">PARALLEL UNSAFE</code>（もしくは、<code class="literal">PARALLEL RESTRICTED</code>）と印を付ける必要があるかもしません。
       </p><p>この設定値を<code class="literal">regress</code>とすると、<code class="literal">on</code>とするのに加え、自動リグレッションテストを助けるための付加的な効果が現れます。
通常パラレルワーカーからのメッセージは、そのことを表すコンテキスト行を表示しますが、<code class="literal">regress</code>と設定すると、非パラレル実行と同じ出力になるように、これを抑止します。
また、プランに追加された<code class="literal">Gather</code>ノードは、<code class="literal">EXPLAIN</code>出力から隠され、<code class="literal">off</code>に設定したときと同じ出力が得られるようにします。
       </p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-config-replication.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-config-logging.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">19.6. レプリケーション </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 19.8. エラー報告とログ取得</td></tr></table></div></body></html>