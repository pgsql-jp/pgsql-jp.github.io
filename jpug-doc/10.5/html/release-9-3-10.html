<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.67. リリース9.3.10</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-9-3-11.html" title="E.66. リリース9.3.11" /><link rel="next" href="release-9-3-9.html" title="E.68. リリース9.3.9" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.67. リリース9.3.10</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-9-3-11.html" title="E.66. リリース9.3.11">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-9-3-9.html" title="E.68. リリース9.3.9">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-9-3-10"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.67. リリース9.3.10</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-9-3-10.html#id-1.11.6.71.4">E.67.1. バージョン9.3.10への移行</a></span></dt><dt><span class="sect2"><a href="release-9-3-10.html#id-1.11.6.71.5">E.67.2. 変更点</a></span></dt></dl></div><p><strong>リリース日: </strong>2015-10-08</p><p>このリリースは9.3.9に対し、各種不具合を修正したものです。
9.3メジャーリリースにおける新機能については、<a class="xref" href="release-9-3.html" title="E.77. リリース9.3">Section E.77</a>を参照してください。
  </p><div class="sect2" id="id-1.11.6.71.4"><div class="titlepage"><div><div><h3 class="title">E.67.1. バージョン9.3.10への移行</h3></div></div></div><p>9.3.Xからの移行ではダンプ/リストアは不要です。
   </p><p>しかしながら、9.3.9よりも前のバージョンからアップグレードする場合には、<a class="xref" href="release-9-3-9.html" title="E.68. リリース9.3.9">Section E.68</a>を参照してください。
   </p></div><div class="sect2" id="id-1.11.6.71.5"><div class="titlepage"><div><div><h3 class="title">E.67.2. 変更点</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="type">json</code>のパースでのスタックオーバーフローを防止しました。
(Oskari Saarenmaa)
     </p><p>アプリケーションが任意のユーザ入力からPostgreSQLの<code class="type">json</code>や<code class="type">jsonb</code>の値を構成する場合、アプリケーションユーザはPostgreSQLサーバを確実にクラッシュさせることができて、一時的なサービス不能を引き起こせます。
(CVE-2015-5289)
     </p></li><li class="listitem"><p>短すぎる<code class="function">crypt()</code>のソルトを検出して報告するように<code class="filename">contrib/pgcrypto</code>を修正しました。
(Josh Kupershmidt)
     </p><p>ある種の無効なソルト引数はサーバをクラッシュさせるか、わずかなバイト数のサーバメモリを露出させました。機密情報を露出するバイト列に在るように配置する攻撃の可能性は排除しませんが、ありそうにないと考えられます。
(CVE-2015-5288)
     </p></li><li class="listitem"><p>外側サブトランザクションに属するポータル（カーソル）がエラーになった後の、サブトランザクションのクリーンアップ処理を修正しました。
(Tom Lane, Michael Paquier)
     </p><p>外側サブトランザクションのカーソルで実行された関数が、内側サブトランザクションで作られたリレーションを参照することで、アサート失敗かクラッシュを引き起こすことがありました。
     </p></li><li class="listitem"><p>UPDATE実行時に更新可能ビューに参照されてる全てのリレーションが確実に正しくロックされるようにしました。
(Dean Rasheed)
     </p></li><li class="listitem"><p>リレーションキャッシュ<span class="quote">“<span class="quote">initファイル</span>”</span>へのリレーションの書き込みを修正しました。
(Tom Lane)
     </p><p>直近のマイナーリリースでの修正の誤りにより、<code class="structname">pg_trigger_tgrelid_tgname_index</code>をinitファイルから除外していました。
その後のセッションはこのことを検出して、initファイルが壊れているとみなして黙ってファイルを無視します。結果としてセッション開始時間が顕著に劣化しました。
本バグの修正に加えて、似たような将来の誤りが見つかりやすくなるように防止策をいくつか導入しました。
     </p></li><li class="listitem"><p>SPIクエリ結果に多数のタプルを挿入するときの O(N^2) の振る舞いを防止しました。
(Neil Conway)
     </p></li><li class="listitem"><p>読まれていない通知が多数あるときの<code class="command">LISTEN</code>開始時間を改善しました。
(Matt Newell)
     </p></li><li class="listitem"><p>一つの接続で多数の外部キー制約を変更するときの性能問題を修正しました。
(Jan Wieck, Tom Lane)
     </p><p>主として数千テーブルを持つデータベースの<span class="application">pg_dump</span>出力をリストアするときに見られます。
     </p></li><li class="listitem"><p>SSL再ネゴシエーションをデフォルトで無効にしました。
(Michael Paquier, Andres Freund)
     </p><p>SSL再ネゴシエーションの使用は理論的には良い考えですが、OpenSSLライブラリに因るものと私たちのライブラリの使い方に因るものの両方で実際のところ多くのバグが見られました。
再ネゴシエーションは9.5以降では完全に取り除く予定です。古いバージョン系列では
<code class="varname">ssl_renegotiation_limit</code>のデフォルト値をゼロ（無効）に変更するだけとします。
     </p></li><li class="listitem"><p><code class="literal">*_freeze_max_age</code>パラメータの下限値を下げました。
(Andres Freund)
     </p><p>これは主として関連する振る舞いのテストの所要時間を短くするものですが、限られたディスク領域でインストールする際にも有益と思われます。
     </p></li><li class="listitem"><p>サーバクラッシュを防ぐため、<code class="varname">wal_buffers</code>の最大値を2GBに制限しました。
(Josh Berkus)
     </p></li><li class="listitem"><p>サーバ開始時にしか設定できないパラメータが<code class="filename">postgresql.conf</code>に複数回現れたときに苦情のログがでないようにしました。
また、<code class="literal">include_dir</code>命令後の行番号カウントを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><code class="type">numeric</code>値の掛け算における稀な内部オーバーフローを修正しました。
(Dean Rasheed)
     </p></li><li class="listitem"><p>レコード型、範囲型、<code class="type">json</code>、<code class="type">jsonb</code>、<code class="type">tsquery</code>、<code class="type">ltxtquery</code>、および、<code class="type">query_int</code>に含まれる起こりにくいスタックオーバーフローを予防しました。
(Noah Misch)
     </p></li><li class="listitem"><p>日付時刻の入力で<code class="literal">DOW</code>と<code class="literal">DOY</code>の扱いを修正しました。
(Greg Stark)
     </p><p>これらのトークンは日付時刻値では使えないはずですが、これまでは<span class="quote">“<span class="quote">invalid input syntax</span>”</span>でなく、意味の分からない内部エラーメッセージになっていました。
     </p></li><li class="listitem"><p>正規表現照合処理中における、問い合わせのキャンセルの検査を更に追加しました
(Tom Lane)
     </p></li><li class="listitem"><p>正規表現、<code class="literal">SIMILAR TO</code>、および、<code class="literal">LIKE</code>の照合に再帰深度の保護を加えました。
(Tom Lane)
     </p><p>ある種の検索パターンと低いスタック深度制限によりスタックオーバーランクラッシュを引き起こすことがありました。
     </p></li><li class="listitem"><p>正規表現の実行での無限ループの可能性を修正しました。
(Tom Lane)
     </p><p>一見ゼロ長文字列にマッチできそうで実際には後方参照のためにマッチしない検索パターンで、無限ループになるおそれがありました。
     </p></li><li class="listitem"><p>正規表現の実行で、たとえマッチがゼロ長であったとしても、量指定子を含む括弧で補足されたマッチデータを正しく記録するようにました。
(Tom Lane)
     </p></li><li class="listitem"><p>正規表現のコンパイルでメモリ不足による障害を修正しました。
(Andreas Seltenreich)
     </p></li><li class="listitem"><p>正規表現実行での稀なメモリリークを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p>トランザクションがアボートした際のロック解放処理における稀なメモリ不足時の障害を修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p>小さい<code class="varname">work_mem</code>設定でタプルストアを使用するときに、<span class="quote">“<span class="quote">unexpected out-of-memory situation during sort</span>”</span>エラーになるのを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><code class="function">qsort</code>での大変稀なスタックオーバーランを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p>大きな<code class="varname">work_mem</code>設定でハッシュジョインの際に<span class="quote">“<span class="quote">invalid memory alloc request size</span>”</span>エラーになるのを修正しました。
(Tomas Vondra, Tom Lane)
     </p></li><li class="listitem"><p>プランナに関するいくつかのバグを修正しました。
(Tom Lane)
     </p><p>これらの誤りは間違ったクエリプランを導き、不適切な結果やアサート有効ビルドにおけるアサート失敗、あるいは、
<span class="quote">“<span class="quote">could not devise a query plan for the given query</span>”</span>、
<span class="quote">“<span class="quote">could not find pathkey item to sort</span>”</span>、
<span class="quote">“<span class="quote">plan should not reference subplan's variable</span>”</span>、
<span class="quote">“<span class="quote">failed to assign all NestLoopParams to plan nodes</span>”</span>
などの奇妙なプランナエラーになりました。
問題を明らかにしたファズテストを行ったAndreas SeltenreichとPiotr Stefaniakに感謝しなければいけません。
     </p></li><li class="listitem"><p>大きな継承セット上の<code class="command">UPDATE</code>/<code class="command">DELETE</code>に対するプランナの性能を改善しました。
(Tom Lane, Dean Rasheed)
     </p></li><li class="listitem"><p>スタンバイ昇格のトリガファイルがpostmaster起動時に確実に削除されるようにしました。
(Michael Paquier, Fujii Masao)
     </p><p>新たなスタンバイサーバを初期化するのに使われるデータベースバックアップにトリガファイルが在ったとき、望まない昇格が起きるのを防ぎます。
     </p></li><li class="listitem"><p>postmasterシャットダウンの際、<code class="filename">postmaster.pid</code>ファイルを削除する前に、確実にソケット毎のロックファイルが削除され、リッスンソケットが閉じられるようにしました。
(Tom Lane)
     </p><p>外部スクリプトが<code class="literal">pg_ctl stop</code>が戻ってすぐに新たなpostmasterを起動しようとする場合の、競合状態による失敗を防ぎます。
     </p></li><li class="listitem"><p>postmasterにおけるクラッシュリカバリ中のスタートアッププロセスのクラッシュの扱いを修正しました。
(Tom Lane)
     </p><p>クラッシュリカバリサイクルの中で、スタートアッププロセスがデータベース一貫性の復旧無しにクラッシュした場合、一般的に再クラッシュとなるだけの新たなスタートアッププロセスを起動しようとして無限ループをもたらしていました。
     </p></li><li class="listitem"><p>マルチトランザクション周回のための緊急自動バキュームをより頑健にしました。
(Andres Freund)
     </p></li><li class="listitem"><p>自動バキュームワーカにシグナルを送ろうとしてそのプロセスが既にいなくなっていた場合に<code class="literal">WARNING</code>を出さないようにしました。
また、そのようなシグナルに関連するログ冗長性を減らしました。
(Tom Lane)
     </p></li><li class="listitem"><p>サーバ時計の時刻が大幅に戻ったときに自動バキュームランチャーが過度に長く休止するのを防止しました。
(Álvaro Herrera)
     </p></li><li class="listitem"><p>GINインデックスの挿入保留リストのクリーンアップがキャンセル要求により割り込みできることを確実にしました。
(Jeff Janes)
     </p></li><li class="listitem"><p>GINインデックスで全ゼロページを再利用可能にしました。
(Heikki Linnakangas)
     </p><p>そのようなページはクラッシュ後に取り残されるかもしれませんでした。
     </p></li><li class="listitem"><p>SP-GiSTインデックスで全ゼロページの扱いを修正しました。
(Heikki Linnakangas)
     </p><p><code class="command">VACUUM</code>はこのようなページを再利用しようとしていましたが、クラッシュ安全ではない方法で行っていました。
     </p></li><li class="listitem"><p>subtrans/multixactの切捨て処理で、<span class="quote">“<span class="quote">apparent wraparound</span>”</span>に関する警告となる以外には無害な境界条件エラーを修正しました
(Thomas Munro)
     </p></li><li class="listitem"><p><span class="application">PL/pgSQL</span>のエラーコンテキストメッセージにて、文の種類<code class="command">CONTINUE</code>、<code class="command">MOVE</code>の誤報告を修正しました。
(Pavel Stehule, Tom Lane)
     </p></li><li class="listitem"><p>非<acronym class="acronym">ASCII</acronym>のエラーメッセージ文面を正しく扱うように <span class="application">PL/Perl</span>を修正しました。
(Alex Hunsaker)
     </p></li><li class="listitem"><p><code class="type">record</code>結果の文字列表現を返すときの <span class="application">PL/Python</span>のクラッシュを修正しました。
(Tom Lane)
     </p></li><li class="listitem"><p><span class="application">PL/Tcl</span>にて<code class="function">malloc()</code>呼び出しの失敗チェックを怠っているいくつかの箇所を修正しました。
(Michael Paquier, Álvaro Herrera)
     </p></li><li class="listitem"><p><code class="filename">contrib/isn</code>で、979で始まるISBN-13番号の出力を修正しました。
(Fabien Coelho)
     </p><p>（9790ではなく）979から始まるEANはISBNと見做せますが、それらは10桁形式ではなく、新しい13桁形式で出力されなければいけません。
     </p></li><li class="listitem"><p><code class="filename">contrib/postgres_fdw</code>で照合に関するの判断を改善しました。
(Tom Lane)
     </p><p>ユーザに見える主な効果は、<code class="type">varchar</code>カラムを含む比較が以前より多くのケースでリモートサーバに送られて実行されるようになることと思われます。
     </p></li><li class="listitem"><p><span class="application">libpq</span>のメモリ不足状態の扱いを改善しました。
(Michael Paquier, Heikki Linnakangas)
     </p></li><li class="listitem"><p><span class="application">ecpg</span>において、メモリリークとメモリ不足チェックの欠落を修正しました。
(Michael Paquier)
     </p></li><li class="listitem"><p>数値出力のロケールを意識した書式整形について、<span class="application">psql</span>のコードを修正しました。
(Tom Lane)
     </p><p><code class="literal">\pset numericlocale on</code> で実行される書式整形のコードは、べき指数を持つけれども小数点を持たない数値など、一部のまれなケースで誤っていました。
<code class="type">money</code>データ型の既にローカライズされた出力を壊すこともありました。
     </p></li><li class="listitem"><p>現在の接続が無いときの<code class="command">\c</code>コマンドで<span class="application">psql</span>がクラッシュするのを防止しました。
(Noah Misch)
     </p></li><li class="listitem"><p><span class="application">pg_dump</span>が継承されたテーブルの<code class="literal">NOT VALID</code>のCHECK制約を正しく扱うようにしました。
(Tom Lane)
     </p></li><li class="listitem"><p><span class="application">pg_dump</span>のディレクトリ出力フォーマットにおいて、デフォルトの<span class="application">zlib</span>圧縮レベルの選択を修正しました。
(Andrew Dunstan)
     </p></li><li class="listitem"><p><acronym class="acronym">tar</acronym>形式出力での<span class="application">pg_dump</span>で作られる一時ファイルを全ユーザから読み取り可能にしないようにしました。
(Michael Paquier)
     </p></li><li class="listitem"><p><code class="literal">postgres</code>または<code class="literal">template1</code>データベースがデフォルトテーブルスペース以外にある場合に対応するように、<span class="application">pg_dump</span>と<span class="application">pg_upgrade</span>を修正しました。
(Marti Raudsepp, Bruce Momjian)
     </p></li><li class="listitem"><p>特定の権限タイプを持つには古すぎるサーバからダンプするときに、<span class="application">pg_dump</span>がオブジェクト権限を正常に扱うように修正しました。
(Tom Lane)
     </p><p>9.2以前のサーバからデータ型をダンプするとき、および、関数や手続き言語を7.3以前のサーバからダンプするとき、<span class="application">pg_dump</span>は所有者の付与できる権限を剥奪して、代わりに<code class="literal">PUBLIC</code>に全ての権限を与えるような<code class="command">GRANT</code>/<code class="command">REVOKE</code>コマンドを生成していました。
ここでの権限に含まれるのは<code class="literal">USAGE</code>と<code class="literal">EXECUTE</code>だけなので、これはセキュリティ問題ではありませんが、まったく驚くべき旧システム挙動の表現です。
この場合はデフォルト権限状態のままにするように修正しました。
     </p></li><li class="listitem"><p><span class="application">pg_dump</span>がシェル型をダンプするように修正しました。
(Tom Lane)
     </p><p>シェル型(未定義のデータ型)は大して有用ではありませんが、それでも<span class="application">pg_dump</span>はダンプすべきでした。
     </p></li><li class="listitem"><p><span class="application">pg_dump</span>とその他いくつかのクライアント側プログラムの、様々なちょっとしたメモリリークを修正しました。
(Michael Paquier)
     </p></li><li class="listitem"><p><acronym class="acronym">AIX</acronym>のネイティブアセンブラと互換性を持つように、PPCハードウェアむけのスピンロックのアセンブラコードを修正しました。
     </p><p><span class="application">gcc</span>が一般的になりつつあるネイティブアセンブラを使う構成である場合に、<span class="application">gcc</span>でのビルドができませんでした。
     </p></li><li class="listitem"><p><acronym class="acronym">AIX</acronym>で、単にそれが安全に使えるとみなすのでなく、<code class="literal">-qlonglong</code>コンパイラオプションのテストをします。
(Noah Misch)
     </p></li><li class="listitem"><p><acronym class="acronym">AIX</acronym>で、実行時に解決されるシンボルを許可する<code class="literal">-Wl,-brtllib</code>リンクオプションを使います。
(Noah Misch)
     </p><p>Perlでは5.8.0以降からこの機能に依存しています。
     </p></li><li class="listitem"><p>コンパイラバグのため、32bit <span class="application">xlc</span>でインライン関数展開を使わないようにしました。
(Noah Misch)
     </p></li><li class="listitem"><p>いくつかのSolarisバージョン上で、必要に応じて<code class="function">sched_yield()</code>のために<code class="filename">librt</code>を使用します。
(Oskari Saarenmaa)
     </p></li><li class="listitem"><p>Windowsの<code class="filename">install.bat</code>スクリプトが空白文字を含む対象ディレクトリ名を扱えるように修正しました。
(Heikki Linnakangas)
     </p></li><li class="listitem"><p><span class="productname">PostgreSQL</span>バージョン番号の数値形式(<code class="literal">90405</code>など)を拡張モジュールのMakefileで変数<code class="varname">VERSION_NUM</code>として容易に利用可能にしました。
(Michael Paquier)
     </p></li><li class="listitem"><p>タイムゾーンデータファイルを、ケイマン諸島、フィジー、モルドバ、モロッコ、ノーフォーク島、北朝鮮、トルコ、ウルグアイの夏時間規則を変更した<span class="application">tzdata</span> release 2015gに更新しました。また、カナダ・ノーザンロッキーのための新しいタイムゾーン名<code class="literal">America/Fort_Nelson</code>が加わっています。
     </p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-9-3-11.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-9-3-9.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.66. リリース9.3.11 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.68. リリース9.3.9</td></tr></table></div></body></html>