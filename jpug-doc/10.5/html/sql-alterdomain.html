<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ALTER DOMAIN</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="sql-alterdefaultprivileges.html" title="ALTER DEFAULT PRIVILEGES" /><link rel="next" href="sql-altereventtrigger.html" title="ALTER EVENT TRIGGER" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">ALTER DOMAIN</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="sql-alterdefaultprivileges.html" title="ALTER DEFAULT PRIVILEGES">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="SQLコマンド">Up</a></td><th width="60%" align="center">SQLコマンド</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="sql-altereventtrigger.html" title="ALTER EVENT TRIGGER">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="SQL-ALTERDOMAIN"><div class="titlepage"></div><a id="id-1.9.3.9.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">ALTER DOMAIN</span></h2><p>ALTER DOMAIN — ドメイン定義を変更する
  </p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="synopsis">ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    { SET DEFAULT <em class="replaceable"><code>expression</code></em> | DROP DEFAULT }
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    { SET | DROP } NOT NULL
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    ADD <em class="replaceable"><code>domain_constraint</code></em> [ NOT VALID ]
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    DROP CONSTRAINT [ IF EXISTS ] <em class="replaceable"><code>constraint_name</code></em> [ RESTRICT | CASCADE ]
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
     RENAME CONSTRAINT <em class="replaceable"><code>constraint_name</code></em> TO <em class="replaceable"><code>new_constraint_name</code></em>
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    VALIDATE CONSTRAINT <em class="replaceable"><code>constraint_name</code></em>
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    OWNER TO { <em class="replaceable"><code>new_owner</code></em> | CURRENT_USER | SESSION_USER }
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    RENAME TO <em class="replaceable"><code>new_name</code></em>
ALTER DOMAIN <em class="replaceable"><code>name</code></em>
    SET SCHEMA <em class="replaceable"><code>new_schema</code></em></pre></div><div class="refsect1" id="id-1.9.3.9.5"><h2>説明</h2><p><code class="command">ALTER DOMAIN</code>は既存ドメインの定義を変更します。
以下に示す副構文があります。
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">SET</code>/<code class="literal">DROP DEFAULT</code></span></dt><dd><p>この構文はドメインのデフォルト値の設定または削除を行います。
指定したデフォルト値は、その後の<code class="command">INSERT</code>コマンドのみに適用されることに注意してください。
そのドメインを使用したテーブルの既存の行には影響を与えません。
     </p></dd><dt><span class="term"><code class="literal">SET</code>/<code class="literal">DROP NOT NULL</code></span></dt><dd><p>この構文はドメインがNULL値を持つことができるかどうかを変更します。
<code class="literal">SET NOT NULL</code>を実行できるのは、ドメインを使用する列にNULL値が含まれていない場合のみです。
     </p></dd><dt><span class="term"><code class="literal">ADD <em class="replaceable"><code>domain_constraint</code></em> [ NOT VALID ]</code></span></dt><dd><p>この構文は<a class="xref" href="sql-createdomain.html" title="CREATE DOMAIN"><span class="refentrytitle">CREATE DOMAIN</span></a>と同一の構文を使って、ドメインに新しい制約を付与します。
新しい制約がドメインに追加された時、そのドメインを使用するすべての列が新しく追加された制約に対して検査されます。
<code class="literal">NOT VALID</code>オプションを使用して新しい制約を追加することでこれらの検査を抑制することができます。
<code class="command">ALTER DOMAIN ... VALIDATE CONSTRAINT</code>を使用することで、後で制約を有効にすることができます。
新しく挿入または更新される行については、<code class="literal">NOT VALID</code>と印が付いていたとしても、常にすべての制約が検査されます。
<code class="literal">NOT VALID</code>は<code class="literal">CHECK</code>制約でのみ受け付けられます。
     </p></dd><dt><span class="term"><code class="literal">DROP CONSTRAINT [ IF EXISTS ]</code></span></dt><dd><p>この構文はドメイン上の制約を削除します。
<code class="literal">IF EXISTS</code>が指定された場合、制約が存在しなくてもエラーになりません。
この場合は代わりに注意メッセージが発生します。
     </p></dd><dt><span class="term"><code class="literal">RENAME CONSTRAINT</code></span></dt><dd><p>この構文はドメイン上の制約名を変更します。
     </p></dd><dt><span class="term"><code class="literal">VALIDATE CONSTRAINT</code></span></dt><dd><p>この構文は、以前に<code class="literal">NOT VALID</code>として追加された制約を検証します。
つまり、そのドメインを使用する列の中のすべてのデータが指定された制約を満たすかどうかを検証します。
     </p></dd><dt><span class="term"><code class="literal">OWNER</code></span></dt><dd><p>この構文はドメインの所有者を指定したユーザに変更します。
     </p></dd><dt><span class="term"><code class="literal">RENAME</code></span></dt><dd><p>この構文はドメインの名前を変更します。
     </p></dd><dt><span class="term"><code class="literal">SET SCHEMA</code></span></dt><dd><p>この構文はドメインのスキーマを変更します。
ドメインに関連する制約もすべて新しいスキーマに移動します。
     </p></dd></dl></div><p><code class="command">ALTER DOMAIN</code>を使用するにはドメインを所有していなければなりません。
ドメインのスキーマを変更するには、新しいスキーマにおける<code class="literal">CREATE</code>権限を持たなければなりません。
所有者を変更するには、直接または間接的に新しいロールのメンバでなければなりません。
また、そのロールはドメインのスキーマにおいて<code class="literal">CREATE</code>を持たなければなりません。
（この制限により、所有者の変更により、ドメインの削除と再作成でできないことは何もできないようにしています。
しかし、スーパーユーザはすべてのドメインの所有者を変更することができます。）
  </p></div><div class="refsect1" id="id-1.9.3.9.6"><h2>パラメータ</h2><p>    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>name</code></em></span></dt><dd><p>変更対象となる既存のドメインの名前です（スキーマ修飾名も可）。
       </p></dd><dt><span class="term"><em class="replaceable"><code>domain_constraint</code></em></span></dt><dd><p>ドメイン用の新しいドメイン制約です。
       </p></dd><dt><span class="term"><em class="replaceable"><code>constraint_name</code></em></span></dt><dd><p>削除または名前を変更する既存の制約名です。
       </p></dd><dt><span class="term"><em class="replaceable"><code>NOT VALID</code></em></span></dt><dd><p>既存の列について制約の妥当性を検証しません。
       </p></dd><dt><span class="term"><code class="literal">CASCADE</code></span></dt><dd><p>その制約に依存するオブジェクトを自動的に削除し、さらにそれらのオブジェクトに依存するすべてのオブジェクトも削除します（<a class="xref" href="ddl-depend.html" title="5.13. 依存関係の追跡">Section 5.13</a>参照）。
       </p></dd><dt><span class="term"><code class="literal">RESTRICT</code></span></dt><dd><p>依存するオブジェクトがある場合、制約の削除要求を拒否します。
これがデフォルトの動作です。
       </p></dd><dt><span class="term"><em class="replaceable"><code>new_name</code></em></span></dt><dd><p>ドメインの新しい名前です。
       </p></dd><dt><span class="term"><em class="replaceable"><code>new_constraint_name</code></em></span></dt><dd><p>制約の新しい名前です。
       </p></dd><dt><span class="term"><em class="replaceable"><code>new_owner</code></em></span></dt><dd><p>ドメインの新しい所有者となるユーザの名前です。
       </p></dd><dt><span class="term"><em class="replaceable"><code>new_schema</code></em></span></dt><dd><p>ドメインの新しいスキーマです。
       </p></dd></dl></div><p>
   </p></div><div class="refsect1" id="id-1.9.3.9.7"><h2>注釈</h2><p>今のところ、<code class="command">ALTER DOMAIN ADD CONSTRAINT</code>、<code class="command">ALTER DOMAIN VALIDATE CONSTRAINT</code>および<code class="command">ALTER DOMAIN SET NOT NULL</code>は、検証された指定ドメインまたは任意の派生ドメインがデータベース内のいずれかのテーブルの複合型の列で使用されていた場合、失敗します。
これは将来的には、こうした入れ子になった列に対する新しい制約を検証できるように改良されるべきです。
  </p></div><div class="refsect1" id="id-1.9.3.9.8"><h2>例</h2><p>ドメインに<code class="literal">NOT NULL</code>制約を付与します。
</p><pre class="programlisting">ALTER DOMAIN zipcode SET NOT NULL;</pre><p>
ドメインから<code class="literal">NOT NULL</code>制約を削除します。
</p><pre class="programlisting">ALTER DOMAIN zipcode DROP NOT NULL;</pre><p>
  </p><p>ドメインにCHECK制約を付与します。
</p><pre class="programlisting">ALTER DOMAIN zipcode ADD CONSTRAINT zipchk CHECK (char_length(VALUE) = 5);</pre><p>
  </p><p>ドメインからCHECK制約を削除します。
</p><pre class="programlisting">ALTER DOMAIN zipcode DROP CONSTRAINT zipchk;</pre><p>
  </p><p>ドメイン上の検査制約の名前を変更します。
</p><pre class="programlisting">ALTER DOMAIN zipcode RENAME CONSTRAINT zipchk TO zip_check;</pre><p>
  </p><p>ドメインを新しいスキーマに移動します。
</p><pre class="programlisting">ALTER DOMAIN zipcode SET SCHEMA customers;</pre></div><div class="refsect1" id="SQL-ALTERDOMAIN-COMPATIBILITY"><h2>互換性</h2><p><code class="command">ALTER DOMAIN</code>文は標準<acronym class="acronym">SQL</acronym>に準拠しています。
ただし、<code class="literal">OWNER</code>、<code class="literal">RENAME</code>、<code class="literal">SET SCHEMA</code>、<code class="literal">VALIDATE CONSTRAINT</code>構文は例外で、<span class="productname">PostgreSQL</span>の拡張です。
<code class="literal">ADD CONSTRAINT</code>構文の<code class="literal">NOT VALID</code>句も<span class="productname">PostgreSQL</span>の拡張です。
  </p></div><div class="refsect1" id="SQL-ALTERDOMAIN-SEE-ALSO"><h2>関連項目</h2><span class="simplelist"><a class="xref" href="sql-createdomain.html" title="CREATE DOMAIN"><span class="refentrytitle">CREATE DOMAIN</span></a>, <a class="xref" href="sql-dropdomain.html" title="DROP DOMAIN"><span class="refentrytitle">DROP DOMAIN</span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql-alterdefaultprivileges.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="sql-commands.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="sql-altereventtrigger.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">ALTER DEFAULT PRIVILEGES </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> ALTER EVENT TRIGGER</td></tr></table></div></body></html>