<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>37.2. PostgreSQLの型システム</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="extend-how.html" title="37.1. 拡張の作用法" /><link rel="next" href="xfunc.html" title="37.3. ユーザ定義関数" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">37.2. <span xmlns="http://www.w3.org/1999/xhtml" class="productname">PostgreSQL</span>の型システム</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="extend-how.html" title="37.1. 拡張の作用法">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="extend.html" title="Chapter 37. SQLの拡張">Up</a></td><th width="60%" align="center">Chapter 37. <acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">SQL</acronym>の拡張</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="xfunc.html" title="37.3. ユーザ定義関数">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="EXTEND-TYPE-SYSTEM"><div class="titlepage"><div><div><h2 class="title" style="clear: both">37.2. <span class="productname">PostgreSQL</span>の型システム</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="extend-type-system.html#id-1.8.3.5.7">37.2.1. 基本型</a></span></dt><dt><span class="sect2"><a href="extend-type-system.html#id-1.8.3.5.8">37.2.2. 複合型</a></span></dt><dt><span class="sect2"><a href="extend-type-system.html#EXTEND-TYPE-SYSTEM-DOMAINS">37.2.3. ドメイン</a></span></dt><dt><span class="sect2"><a href="extend-type-system.html#id-1.8.3.5.10">37.2.4. 疑似型</a></span></dt><dt><span class="sect2"><a href="extend-type-system.html#EXTEND-TYPES-POLYMORPHIC">37.2.5. 多様型</a></span></dt></dl></div><a id="id-1.8.3.5.2" class="indexterm"></a><a id="id-1.8.3.5.3" class="indexterm"></a><a id="id-1.8.3.5.4" class="indexterm"></a><a id="id-1.8.3.5.5" class="indexterm"></a><p><span class="productname">PostgreSQL</span>のデータ型は、基本型、複合型、ドメイン、疑似型に分類されます。
   </p><div class="sect2" id="id-1.8.3.5.7"><div class="titlepage"><div><div><h3 class="title">37.2.1. 基本型</h3></div></div></div><p>基本型は<code class="type">int4</code>のように、<acronym class="acronym">SQL</acronym>言語レベル以下で実装されたものです
（通常はCのような低レベル言語で作成されます）。
一般的にこれらは抽象データ型とも呼ばれるものに対応します。
<span class="productname">PostgreSQL</span>は、ユーザによって提供された関数を通して、こうした型に対する操作のみが可能です。
そして、こうした型の動作のみをユーザが記述する範囲まで理解することができます。
さらに基本型は、スカラと配列型に分類されます。
各スカラ型に対応する配列型は自動的に作成され、そこにはそのスカラ型の可変長の配列を保持できます。
    </p></div><div class="sect2" id="id-1.8.3.5.8"><div class="titlepage"><div><div><h3 class="title">37.2.2. 複合型</h3></div></div></div><p>ユーザがテーブルを作成すると、複合型、もしくは行型が作成されます。
関連するテーブルを持たない<span class="quote">“<span class="quote">スタンドアローン</span>”</span>の複合型を<a class="xref" href="sql-createtype.html" title="CREATE TYPE"><span class="refentrytitle">CREATE TYPE</span></a>を使用して定義することもできます。
複合型は関連したフィールド名を持つ基本型の単なるリストです。
複合型の値は行もしくはフィールド値のレコードです。
ユーザは<acronym class="acronym">SQL</acronym>問い合わせによってその構成フィールドにアクセスすることができます。
複合型のより詳細については<a class="xref" href="rowtypes.html" title="8.16. 複合型">Section 8.16</a>を参照してください。
    </p></div><div class="sect2" id="EXTEND-TYPE-SYSTEM-DOMAINS"><div class="titlepage"><div><div><h3 class="title">37.2.3. ドメイン</h3></div></div></div><p>ドメインは、特定の基本型に基づいたもので、多くの目的では、その基本型と交換可能です。
しかし、ドメインは背後にある基本型で許可される範囲内で値の有効範囲を制限する制約を持つことができます。
    </p><p>ドメインは<a class="xref" href="sql-createdomain.html" title="CREATE DOMAIN"><span class="refentrytitle">CREATE DOMAIN</span></a> <acronym class="acronym">SQL</acronym>コマンドを使用して作成可能です。
ドメインの作成と使用については本章では説明しません。
    </p></div><div class="sect2" id="id-1.8.3.5.10"><div class="titlepage"><div><div><h3 class="title">37.2.4. 疑似型</h3></div></div></div><p>特殊な目的用に数個の<span class="quote">“<span class="quote">疑似型</span>”</span>があります。
疑似型はテーブルの列や複合型の属性として現れることはありません。
しかし、関数の引数や結果型を宣言する際に使用することができます。
これは、型システム内で特殊な関数クラスを識別するための機構を提供します。
<a class="xref" href="datatype-pseudo.html#DATATYPE-PSEUDOTYPES-TABLE" title="Table 8.25. 疑似データ型">Table 8.25</a>に既存の疑似型を列挙します。
    </p></div><div class="sect2" id="EXTEND-TYPES-POLYMORPHIC"><div class="titlepage"><div><div><h3 class="title">37.2.5. 多様型</h3></div></div></div><a id="id-1.8.3.5.11.2" class="indexterm"></a><a id="id-1.8.3.5.11.3" class="indexterm"></a><a id="id-1.8.3.5.11.4" class="indexterm"></a><a id="id-1.8.3.5.11.5" class="indexterm"></a><p>特殊な用途を持つ疑似型には、<code class="type">anyelement</code>と<code class="type">anyarray</code>、<code class="type">anynonarray</code>、<code class="type">anyenum</code>および<code class="type">anyrange</code>の５つがあります。
これらはまとめて<em class="firstterm">多様型</em>と呼ばれます。
これらの型を使用すると宣言された関数は全て、<em class="firstterm">多様関数</em>と呼ばれます。
多様関数は多くの異なるデータ型を操作することができます。
データ型の指定は、特定の呼び出しに実際に渡されるデータ型によって決定されます。
    </p><p>多様引数と結果は互いに結び付いており、多様関数を呼び出す問い合わせが解析される時に特定のデータ型が決定されます。
<code class="type">anyelement</code>として宣言された位置（引数もしくは戻り値）にはそれぞれ、任意の実データ型を指定することができますが、1つの呼び出しでは、これらはすべて<span class="emphasis"><em>同一の</em></span>実データ型でなければなりません。
<code class="type">anyarray</code>として宣言された位置には、任意の配列データ型を持つことができます。
しかし、同様にこれらはすべて同じデータ型でなければなりません。
また同様に<code class="type">anyrange</code>として宣言された位置はすべて同じ範囲型でなければなりません。
さらに<code class="type">anyarray</code>と宣言された位置と<code class="type">anyelement</code>と宣言された位置の両方がある場合、<code class="type">anyarray</code>の位置の実際の配列型は、その要素の型が<code class="type">anyelement</code>位置に現れる型と同じでなければなりません。
同様に<code class="type">anyrange</code>と宣言された位置と<code class="type">anyelement</code>と宣言された位置の両方がある場合、<code class="type">anyrange</code>の位置の実際の範囲型は、その範囲の派生元型が<code class="type">anyelement</code>位置に現れる型と同じでなければなりません。
<code class="type">anynonarray</code>は、実際の型が配列型であってはならないという制限が加わっている点を除き、<code class="type">anyelement</code>とまったく同様に扱われます。
<code class="type">anyenum</code>は、実際の型が列挙型でなければならないという制約が加わっている点を除き、<code class="type">anyelement</code>とまったく同様に扱われます。
    </p><p>このように、2つ以上の引数位置が多様型と宣言されると、全体の効果として、実引数型の特定の組み合わせのみが許されるようになります。
例えば、<code class="literal">equal(anyelement, anyelement)</code>と宣言された関数は、2つの引数が同じデータ型である限り、任意の入力値を2つ取ることになります。
    </p><p>関数の戻り値を多様型として宣言する時、少なくとも1つの引数位置も多様でなければなりません。
そして引数として与えられる実データ型がその呼び出しの実結果型を決定します。
例えば、配列添字機構がなかったとすると、<code class="literal">subscript(anyarray, integer) returns anyelement</code>として添字機構を実装する関数を定義できます。
この宣言には、最初の実引数は配列型になり、パーサはこの最初の実引数の型より正しい結果型を推論することができます。
他にも例えば、<code class="literal">f(anyarray) returns anyenum</code>と宣言された関数は列挙型の配列のみを受け付けます。
    </p><p><code class="type">anynonarray</code>型と<code class="type">anyenum</code>型が、別個の型変数を表していないことに注意してください。
これは<code class="type">anyelement</code>と同じ型で、追加の制約が付いているだけです。
例えば、<code class="literal">f(anyelement, anyenum)</code>として関数を宣言することは、<code class="literal">f(anyenum, anyenum)</code>と宣言することと同一です。
両方の実引数は同じ列挙型でなければなりません。
    </p><p>可変長引数の関数（<a class="xref" href="xfunc-sql.html#XFUNC-SQL-VARIADIC-FUNCTIONS" title="37.4.5. 可変長引数を取るSQL関数">Section 37.4.5</a>で説明する可変個の引数を取る関数）を多様とすることができます。
最後のパラメータを<code class="literal">VARIADIC</code> <code class="type">anyarray</code>と宣言することで実現されます。
引数を一致させ、実際の結果型を決めるために、こうした関数は<code class="type">anynonarray</code>パラメータを適切な個数記述した場合と同様に動作します
    </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="extend-how.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="extend.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="xfunc.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">37.1. 拡張の作用法 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 37.3. ユーザ定義関数</td></tr></table></div></body></html>