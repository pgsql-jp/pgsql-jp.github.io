<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7.3. 選択リスト</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="queries-table-expressions.html" title="7.2. テーブル式" /><link rel="next" href="queries-union.html" title="7.4. 問い合わせの結合" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">7.3. 選択リスト</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="queries-table-expressions.html" title="7.2. テーブル式">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="queries.html" title="Chapter 7. 問い合わせ">Up</a></td><th width="60%" align="center">Chapter 7. 問い合わせ</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="queries-union.html" title="7.4. 問い合わせの結合">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="QUERIES-SELECT-LISTS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.3. 選択リスト</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="queries-select-lists.html#QUERIES-SELECT-LIST-ITEMS">7.3.1. 選択リスト項目</a></span></dt><dt><span class="sect2"><a href="queries-select-lists.html#QUERIES-COLUMN-LABELS">7.3.2. 列ラベル</a></span></dt><dt><span class="sect2"><a href="queries-select-lists.html#QUERIES-DISTINCT">7.3.3. <code class="literal">DISTINCT</code></a></span></dt></dl></div><a id="id-1.5.6.7.2" class="indexterm"></a><p>前節で示したように、<code class="command">SELECT</code>コマンド中のテーブル式は、テーブルやビューの結合、行の抽出、グループ化などにより中間の仮想テーブルを作ります。
このテーブルは最終的に<em class="firstterm">選択リスト</em>による処理に渡されます。
選択リストは、中間のテーブルのどの<span class="emphasis"><em>列</em></span>を実際に出力するかを決めます。
  </p><div class="sect2" id="QUERIES-SELECT-LIST-ITEMS"><div class="titlepage"><div><div><h3 class="title">7.3.1. 選択リスト項目</h3></div></div></div><a id="id-1.5.6.7.4.2" class="indexterm"></a><p>テーブル式が生成するすべての列を出力する<code class="literal">*</code>が最も簡単な選択リストです。
そうでなければ、選択リストは、カンマで区切られた（<a class="xref" href="sql-expressions.html" title="4.2. 評価式">Section 4.2</a>で定義された）評価式のリストです。
例えば、以下のような列名のリストであっても構いません。
</p><pre class="programlisting">SELECT a, b, c FROM ...</pre><p>
<code class="literal">a</code>、<code class="literal">b</code>、<code class="literal">c</code>という列名は、<code class="literal">FROM</code>句で参照されるテーブルの実際の列名か、あるいは<a class="xref" href="queries-table-expressions.html#QUERIES-TABLE-ALIASES" title="7.2.1.2. テーブルと列の別名">Section 7.2.1.2</a>で説明したような列名に対する別名です。
グループ化されていなければ、選択リストで使用可能な名前空間は<code class="literal">WHERE</code>句と同じです。
グループ化されている場合は、<code class="literal">HAVING</code>句と同じとなります。
   </p><p>もし、2つ以上のテーブルで同じ名前の列がある場合は、次のように、テーブル名を必ず指定しなければいけません。
</p><pre class="programlisting">SELECT tbl1.a, tbl2.a, tbl1.b FROM ...</pre><p>
複数のテーブルを使用する場合、特定のテーブルのすべての列を求める方法も便利かもしれません。
</p><pre class="programlisting">SELECT tbl1.*, tbl2.a FROM ...</pre><p>
<em class="replaceable"><code>table_name</code></em><code class="literal">.*</code>という指定方法の詳細については、<a class="xref" href="rowtypes.html#ROWTYPES-USAGE" title="8.16.5. 問い合わせでの複合型の使用">Section 8.16.5</a>を参照してください。
   </p><p>任意の評価式が選択リストで使われる場合、返されるテーブルは、概念的には新たに仮想的な列を追加したものとなります。
評価式は、それぞれの結果行で、その列参照を置換した行の値としていったん評価されます。
しかし、選択リストの式は<code class="literal">FROM</code>句で指定されたテーブル式内の列を参照するものである必要はありません。例えば、定数算術式であっても構いません。
   </p></div><div class="sect2" id="QUERIES-COLUMN-LABELS"><div class="titlepage"><div><div><h3 class="title">7.3.2. 列ラベル</h3></div></div></div><a id="id-1.5.6.7.5.2" class="indexterm"></a><p>選択リスト中の項目は、<code class="literal">ORDER BY</code>句の中での参照、もしくはクライアントアプリケーションによる表示での使用など、それに続く処理のために名前を割り当てることができます。
例を示します。
</p><pre class="programlisting">SELECT a AS value, b + c AS sum FROM ...</pre><p>
   </p><p><code class="literal">AS</code>を使った出力列名の指定がない場合、システムはデフォルトの列名を割り当てます。
単純な列参照では参照された列名となります。
関数呼び出しでは関数名となります。
複雑な表現についてはシステムが汎用の名前を生成します。
   </p><p><code class="literal">AS</code>キーワードは省略することができますが、新規列名が<span class="productname">PostgreSQL</span>キーワード（<a class="xref" href="sql-keywords-appendix.html" title="Appendix C. SQLキーワード">Appendix C</a>を参照）のいかなるものとも一致しない場合のみです。
あるキーワードと予測外の一致を防ぐために、列名を二重引用符で囲むことができます。
例えば、<code class="literal">VALUE</code>はキーワードですのでうまく動作しません。
</p><pre class="programlisting">SELECT a value, b + c AS sum FROM ...</pre><p>
しかしこれは動きます。
</p><pre class="programlisting">SELECT a "value", b + c AS sum FROM ...</pre><p>
将来のキーワードの追加に対する保護のため、<code class="literal">AS</code>を記述するか、出力列名を二重引用符で囲むかのどちらかを推奨します。
   </p><div class="note"><h3 class="title">Note</h3><p>ここでの出力列の名前の指定は、<code class="literal">FROM</code>句での名前の指定（<a class="xref" href="queries-table-expressions.html#QUERIES-TABLE-ALIASES" title="7.2.1.2. テーブルと列の別名">Section 7.2.1.2</a>を参照）とは異なります。
同じ列の名前を2度変更することができますが、渡されるのは選択リストの中で割り当てられたものです。
    </p></div></div><div class="sect2" id="QUERIES-DISTINCT"><div class="titlepage"><div><div><h3 class="title">7.3.3. <code class="literal">DISTINCT</code></h3></div></div></div><a id="id-1.5.6.7.6.2" class="indexterm"></a><a id="id-1.5.6.7.6.3" class="indexterm"></a><p>選択リストが処理された後、結果テーブルの重複行を削除の対象にすることもできます。
これを指定するためには、<code class="literal">SELECT</code>の直後に<code class="literal">DISTINCT</code>キーワードを記述します。
</p><pre class="synopsis">SELECT DISTINCT <em class="replaceable"><code>select_list</code></em> ...</pre><p>
（<code class="literal">DISTINCT</code>の代わりに<code class="literal">ALL</code>キーワードを使用して、すべての行が保持されるというデフォルトの動作を指定することができます。）
   </p><a id="id-1.5.6.7.6.5" class="indexterm"></a><p>少なくとも1つの列の値が異なる場合、もちろん、それら2行は異なるとみなされます。
NULL値同士は、この比較において等しいとみなされます。
   </p><p>また、任意の式を使用して、どの行が別であるかを決定することもできます。
</p><pre class="synopsis">SELECT DISTINCT ON (<em class="replaceable"><code>expression</code></em> [<span class="optional">, <em class="replaceable"><code>expression</code></em> ...</span>]) <em class="replaceable"><code>select_list</code></em> ...</pre><p>
ここで<em class="replaceable"><code>expression</code></em>は、すべての行で評価される任意の評価式です。
すべての式が等しくなる行の集合は、重複しているとみなされ、集合の最初の行だけが出力内に保持されます。
<code class="literal">DISTINCT</code>フィルタに掛けられる行の順序の一意性を保証できるよう十分な数の列で問い合わせを並べ替えない限り、出力される集合の<span class="quote">“<span class="quote">最初の行</span>”</span>は予想不可能であることに注意してください。
（<code class="literal">DISTINCT ON</code>処理は、<code class="literal">ORDER BY</code>による並べ替えの後に行われます。）
   </p><p><code class="literal">DISTINCT ON</code>句は標準SQLではありません。
さらに、結果が不定となる可能性があるため、好ましくないスタイルとみなされることもあります。
<code class="literal">GROUP BY</code>と<code class="literal">FROM</code>中の副問い合わせをうまく使うことにより、この構文を使わずに済みますが、<code class="literal">DISTINCT ON</code>句はしばしば非常に便利な代案となります。
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="queries-table-expressions.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="queries.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="queries-union.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">7.2. テーブル式 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 7.4. 問い合わせの結合</td></tr></table></div></body></html>