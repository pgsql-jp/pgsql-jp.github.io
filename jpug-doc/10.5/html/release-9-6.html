<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.17. リリース9.6</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-9-6-1.html" title="E.16. リリース9.6.1" /><link rel="next" href="release-9-5-14.html" title="E.18. Release 9.5.14" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.17. リリース9.6</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-9-6-1.html" title="E.16. リリース9.6.1">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-9-5-14.html" title="E.18. Release 9.5.14">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-9-6"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.17. リリース9.6</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-9-6.html#id-1.11.6.21.3">E.17.1. 概要</a></span></dt><dt><span class="sect2"><a href="release-9-6.html#id-1.11.6.21.4">E.17.2. バージョン9.6への移行</a></span></dt><dt><span class="sect2"><a href="release-9-6.html#id-1.11.6.21.5">E.17.3. 変更点</a></span></dt></dl></div><p><strong>Release date: </strong>2016-09-29</p><div class="sect2" id="id-1.11.6.21.3"><div class="titlepage"><div><div><h3 class="title">E.17.1. 概要</h3></div></div></div><p>    <span class="productname">PostgreSQL</span>9.6の主な強化点には以下のものがあります。
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>シーケンシャルスキャン、結合、集約の並列実行
     </p></li><li class="listitem"><p>バキューム凍結処理で不要なページスキャンを回避しました
     </p></li><li class="listitem"><p>同期レプリケーションで信頼性向上のための複数スタンバイサーバが可能になりました
     </p></li><li class="listitem"><p>全文検索でフレーズ（隣接した複数単語）を検索できるようになりました
     </p></li><li class="listitem"><p><code class="filename">postgres_fdw</code>がリモートでの結合、ソート、<code class="command">UPDATE</code>、<code class="command">DELETE</code>に対応しました
     </p></li><li class="listitem"><p>特にマルチ<code class="literal">CPU</code>ソケットサーバでのスケーラビリティの領域における、相当な性能改善をしました
     </p></li></ul></div><p>上記の項目について以下でより詳細に説明します。
   </p></div><div class="sect2" id="id-1.11.6.21.4"><div class="titlepage"><div><div><h3 class="title">E.17.2. バージョン9.6への移行</h3></div></div></div><p>以前のリリースからデータを移行したい時は、どのリリースについても、
<a class="xref" href="app-pg-dumpall.html" title="pg_dumpall"><span class="refentrytitle"><span class="application">pg_dumpall</span></span></a>を利用したダンプとリストア、
あるいは<a class="xref" href="pgupgrade.html" title="pg_upgrade"><span class="refentrytitle"><span class="application">pg_upgrade</span></span></a>の利用が必要です。
   </p><p>バージョン9.6には、以前のバージョンとの互換性に影響する多数の変更点が含まれています。
以下の非互換性に注意してください。
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="monitoring-stats.html#PG-STAT-ACTIVITY-VIEW" title="Table 28.3. pg_stat_activityビュー"><code class="structname">pg_stat_activity</code></a>ビューの、プロセスが何を待機しているかの情報を改善しました。
(Amit Kapila, Ildus Kurbangaliev)
       </p><p>歴史的には重量ロックを待機している場合だけプロセスは待機中と示されていました。
これからは軽量ロックとバッファピンの待機も<code class="structname">pg_stat_activity</code>で示されます。
また、待機しているロックのタイプも見えるようになります。
これらの変更は<code class="structfield">waiting</code>列を<code class="structfield">wait_event_type</code>と<code class="structfield">wait_event</code>で置き換えます。
       </p></li><li class="listitem"><p><a class="link" href="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE" title="Table 9.23. 書式設定関数"><code class="function">to_char()</code></a>で時間関連のフィールドにおいて（必要ならば）マイナス符号をフィールド幅の一部としてカウントしません。
(Bruce Momjian)
       </p><p>例えば<code class="literal">to_char('-4 years'::interval, 'YY')</code>は<code class="literal">-4</code>でなく<code class="literal">-04</code>を返すようになります。
       </p></li><li class="listitem"><p>無限値の入力に対して<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="Table 9.30. 日付/時刻関数"><code class="function">extract()</code></a>が、より合理的に動作するようにしました。
(Vitaly Burovoy)
       </p><p>歴史的には<code class="function">extract()</code>関数は与えられたフィールド名が何であっても、無限大のタイムスタンプが与えられたなら単に0を返していました。
これを、要求フィールドが単調増加するもの（例：<code class="literal">year</code>、<code class="literal">epoch</code>）なら適切に<code class="literal">infinity</code>または<code class="literal">-infinity</code>を返し、そうでないもの（例：<code class="literal">day</code>、<code class="literal">hour</code>）なら<code class="literal">NULL</code>を返すようにしました。
また、誤ったフィールド名には期待されるエラーを投げます。
       </p></li><li class="listitem"><p>PL/pgSQLの<code class="command">RAISE</code>コマンドで出力されるメッセージにて<code class="literal">CONTEXT</code>の最も内側の行を抑制する<span class="quote">“<span class="quote">機能</span>”</span>を取り除きました。
(Pavel Stehule)
       </p><p>この古くからの後方互換性のための作り込みは、もはや役に立たなくなっていると認められました。
       </p></li><li class="listitem"><p>デフォルトのテキスト検索パーサを<code class="literal">email</code>および<code class="literal">host</code>トークンが数字から始まるのを許すように修正しました。
(Artur Zakirov)
       </p><p>ほとんどの場合、これはテキスト解析に僅かな違いしかもたらしません。
しかし、このようなアドレスが頻繁に生じるデータを持っているなら、テキスト検索でこの形のアドレスを適切に見つけられるようにするために、従属する<code class="type">tsvector</code>列とインデックスを再構築するだけの価値があるでしょう。
       </p></li><li class="listitem"><p><a class="link" href="unaccent.html" title="F.44. unaccent"><code class="filename">contrib/unaccent</code></a>の標準<code class="filename">unaccent.rules</code>ファイルをユニコードむけに知られている全ての発音区別符号を扱うように、また、合字を正しく展開するように拡張しました。
(Thomas Munro, Léonard Benedetti)
       </p><p>従来バージョンでは一部の一般的でない発音区別符号を伴う文字を変換するのを怠っていました。
また、これからは合字は別々の文字に展開されます。
このルールファイルを使うインストレーションは<code class="type">tsvector</code>列とその結果に依存するインデックスを再構築するのがよいでしょう。
       </p></li><li class="listitem"><p><code class="command">CREATE ROLE</code>および同種のコマンド群から、長く非推奨とされてきた<code class="literal">CREATEUSER</code>/<code class="literal">NOCREATEUSER</code>オプションを取り除きました。
(Tom Lane)
       </p><p>古い後方互換性を理由として、<code class="literal">CREATEUSER</code>は実際のところ<code class="literal">SUPERUSER</code>を意味しました。
このことは常にこれは<code class="literal">CREATEROLE</code>の意味だろうと（合理的に）予想するユーザの混乱の元となっていました。
現時点で10年にわたって非推奨でしたので、除去することでこの問題を解決します。
       </p></li><li class="listitem"><p><code class="literal">pg_</code>で始まるロール名を予約済みとして扱うようにしました。
(Stephen Frost)
       </p><p>これからはこのようなロール名のユーザ作成は禁止されます。
これにより<span class="application">initdb</span>で作られた組み込みロールとの競合を防ぎます。
       </p></li><li class="listitem"><p><code class="structname">information_schema</code>.<code class="structname">routines</code>ビュー内の列名を<code class="structfield">result_cast_character_set_name</code>から<code class="structfield">result_cast_char_set_name</code>に変更しました。
(Clément Prévost)
       </p><p>SQL:2011標準には長い方の名前が記載されていますが、隣の列名では他の<code class="structname">information_schema</code>ビューと同様に短い方の書き方を使っていることから、これは誤りと見られます。
       </p></li><li class="listitem"><p><span class="application">psql</span>の<code class="option">-c</code>オプションはもはや<code class="option">--no-psqlrc</code>の意味を含まなくなりました。
(Pavel Stehule, Catalin Iacob)
       </p><p>古い動作を得るには<code class="option">--no-psqlrc</code>（または短縮形の<code class="option">-X</code>）を明示的に書いてください。
このように修正されたスクリプトは古いバージョンの<span class="application">psql</span>でも引き続き動作するでしょう。
       </p></li><li class="listitem"><p><span class="application">pg_restore</span>の<code class="option">-t</code>オプションを普通のテーブルだけでなく全てのタイプのリレーションに対応するように改善しました。
(Craig Ringer)
       </p></li><li class="listitem"><p><span class="application">pg_controldata</span>および関連する箇所で<code class="literal">NextXID</code>の表示形式を変更しました。
(Joe Conway, Bruce Momjian)
       </p><p><em class="replaceable"><code>number</code></em><code class="literal">:</code><em class="replaceable"><code>number</code></em>形式でエポックとトランザクションIDの値を表示します。
これまでの<em class="replaceable"><code>number</code></em><code class="literal">/</code><em class="replaceable"><code>number</code></em>形式は、<acronym class="acronym">LSN</acronym>に使われる形式と紛らわしく似ていました。
       </p></li><li class="listitem"><p>拡張の関数を適切なものについてパラレルセーフと印付けされるように改定しました。
(Andreas Karlsson)
       </p><p>多くの標準拡張はそれらの関数がパラレルクエリーのワーカプロセスで実行できるように改定されました。
これらの変更は、（クラスタの各データベースの）各拡張に<code class="command">ALTER EXTENSION UPDATE</code>を適用しない限り、前バージョンから<span class="application">pg_upgrade</span>されたデータベースには効力がありません。
       </p></li></ul></div></div><div class="sect2" id="id-1.11.6.21.5"><div class="titlepage"><div><div><h3 class="title">E.17.3. 変更点</h3></div></div></div><p>以下に<span class="productname">PostgreSQL</span> 9.6と前のメジャーリリースとの詳細な変更点を記載します。
   </p><div class="sect3" id="id-1.11.6.21.5.3"><div class="titlepage"><div><div><h4 class="title">E.17.3.1. サーバ</h4></div></div></div><div class="sect4" id="id-1.11.6.21.5.3.2"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.1. 並列問い合わせ</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>並列問い合わせ。
(Robert Haas, Amit Kapila, David Rowley, many others)
       </p><p>9.6で<span class="productname">PostgreSQL</span>は大きな問い合わせに対する並列実行の最初のサポートを導入しました。
厳密に駆動テーブルをシーケンシャルスキャンで処理する参照問い合わせの場合だけ、並列化できます。
ハッシュ結合とネステッドループも、また（サポートされている集約について）集約処理も同様に並列実行できます。
やるべきことは沢山残っていますが、これはすでに役立つ機能セットです。
       </p><p>並列問い合わせの実行は（未だ）デフォルトでは有効ではありません。
有効にするには、新たな設定パラメータ<a class="xref" href="runtime-config-resource.html#GUC-MAX-PARALLEL-WORKERS-PER-GATHER">max_parallel_workers_per_gather</a>を0より大きい値に設定します。
その他の新たな設定パラメータ<a class="xref" href="runtime-config-query.html#GUC-FORCE-PARALLEL-MODE">force_parallel_mode</a>、<a class="xref" href="runtime-config-query.html#GUC-PARALLEL-SETUP-COST">parallel_setup_cost</a>、<a class="xref" href="runtime-config-query.html#GUC-PARALLEL-TUPLE-COST">parallel_tuple_cost</a>、<code class="literal">min_parallel_relation_size</code>を通してさらなる並列処理の制御を行うことができます。
       </p></li><li class="listitem"><p>関数のパラレル安全状態を印付けするための基盤を用意しました。
(Robert Haas, Amit Kapila)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.3"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.2. インデックス</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="gin.html" title="Chapter 64. GINインデックス"><acronym class="acronym">gin</acronym></a>インデックス作成で、1GBより大きい<a class="xref" href="runtime-config-resource.html#GUC-MAINTENANCE-WORK-MEM">maintenance_work_mem</a>設定の効果的な活用ができるようにしました。
(Robert Abraham, Teodor Sigaev)
       </p></li><li class="listitem"><p>GINインデックスのペンディングリストから削除されたページを空き領域マップに即座に追加するようにしました。
(Jeff Janes, Teodor Sigaev)
       </p><p>これはテーブルのバキューム頻度が低いときの膨張を減らします。
       </p></li><li class="listitem"><p>GINインデックスのペンディングリストのクリーンアップを手動で実行できるように<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-INDEX" title="9.26.8. インデックス保守関数"><code class="function">gin_clean_pending_list()</code></a>関数を追加しました。
(Jeff Janes)
       </p><p>以前は、このクリーンアップは親テーブルのバキュームやアナライズの副次効果としてのみ生じました。
       </p></li><li class="listitem"><p><a class="link" href="gist.html" title="Chapter 62. GiSTインデックス">GiST</a>インデックスにおける dead(削除済み)インデックスタプルの扱いを改善しました。
(Anastasia Lubennikova)
       </p><p>deadインデックスタプルは、あるインデックスキャンが対応するヒープタプルがdeadであると気づくとき、そのように印付けされるようになります。
タプルを挿入するとき、ページ上に空間を作るために必要ならdeadとマークされたタプルは削除されます。
       </p></li><li class="listitem"><p><code class="type">box</code>型むけの<a class="link" href="spgist.html" title="Chapter 63. SP-GiSTインデックス">SP-GiST</a>演算子クラスを追加しました。
(Alexander Lebedev)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.4"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.3. ソート</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>外部ソート方式を行うときに置換選択ソートでなくクイックソートを使うことでソートの性能を改善しました。
(Peter Geoghegan)
       </p><p>この新しい方法では典型的なキャッシュサイズとデータ量に対して<acronym class="acronym">CPU</acronym>キャッシュをより良く使用します。
必要に応じて、この動作は新たな設定パラメータ<code class="literal">replacement_sort_tuples</code>を通して調整されます。
       </p></li><li class="listitem"><p>同じ文字列が複数回現れる場合のテキストソートを高速化しました。
(Peter Geoghegan)
       </p></li><li class="listitem"><p><span class="quote">“<span class="quote">短縮</span>”</span>キーを使うことで、<code class="type">uuid</code>、<code class="type">bytea</code>、<code class="type">char(n)</code>のソートを高速化しました。
(Peter Geoghegan)
       </p><p>短縮キーのサポートでは非デフォルト演算子クラス<a class="link" href="indexes-opclass.html" title="11.9. 演算子クラスと演算子族"><code class="literal">text_pattern_ops</code></a>、<code class="literal">varchar_pattern_ops</code>、<code class="literal">bpchar_pattern_ops</code>も追加されました。
順序集合集約を処理して短縮キーをうまく利用できるようになりました。
       </p></li><li class="listitem"><p>ソートのときに<acronym class="acronym">TID</acronym>を64bit整数として扱うことで<code class="command">CREATE INDEX CONCURRENTLY</code>を高速化しました。
(Peter Geoghegan)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.5"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.4. ロック</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">ProcArrayLock</code>の競合を減らしました。
(Amit Kapila, Robert Haas)
       </p></li><li class="listitem"><p>バッファ内容のロックをバッファデスクリプタに移すことで性能を改善しました。
(Andres Freund, Simon Riggs)
       </p></li><li class="listitem"><p>スケーラビリティ改善のため、共有バッファヘッダのスピンロックを原子的操作に置き換えました。
       </p></li><li class="listitem"><p><code class="literal">LWLock</code>の待ちキューを保護するため、スピンロックでなく原子的操作を使います。
(Andres Freund)
       </p></li><li class="listitem"><p>マルチ<acronym class="acronym">CPU</acronym>ソケットのサーバ上で競合を減らすため共有ハッシュテーブルのフリーリストを分割しました。
(Aleksander Alekseev)
       </p></li><li class="listitem"><p>Btreeインデックスのバキューム操作の再生中のスタンバイサーバ上のインターロックを減らしました。
(Simon Riggs)
       </p><p>この変更はこのような操作の再生で時々発生するかなりのレプリケーション遅延を回避します。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.6"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.5. オプティマイザ統計</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="command">ANALYZE</code>の多数のNULLを持つ列の推定を改善しました。
(Tomas Vondra, Alex Shulgin)
       </p><p>これまで<code class="command">ANALYZE</code>は多数<code class="literal">NULL</code>を持つ列では、非<code class="literal">NULL</code>の個別値数を過小評価する傾向があり、また、頻出値の計算でも不正確でした。
       </p></li><li class="listitem"><p>プランナの問い合わせ結果での個別値数の推定を改善しました。
(Tomas Vondra)
       </p></li><li class="listitem"><p>結合述語における選択度の推測に外部キー関係を使用するようにしました。
(Tomas Vondra, David Rowley)
       </p><p>もしテーブル<code class="literal">t</code>が、<code class="literal">(a,b) REFERENCES r (x,y)</code> という外部キー制約を持つなら、<code class="literal">t.a = r.x AND t.b = r.y</code>などの<code class="literal">WHERE</code>条件は<code class="literal">t</code>の各行に対して1行より多い<code class="literal">r</code>の行を選択することはありえません。
プランナは以前はこれら<code class="literal">AND</code>条件を独立しているとみなし、結果として、しばしば選択度を大幅に誤って推定していました。
これからは、<code class="literal">WHERE</code>条件を当てはまる外部キー制約と比較し、より良い推定を出します。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.7"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.6. <code class="command">VACUUM</code></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>凍結済みタプルだけを含むページの再バキュームを回避しました。
(Masahiko Sawada, Robert Haas, Andres Freund)
       </p><p>以前は、周回防止用のバキュームは、たとえ何もすることがないページであっても、テーブルのすべてのページを巡回しなければなりませんでした。
これからは、凍結済みタプルのみを含むページはテーブルの可視性マップで識別され、たとえトランザクション周回予防を行っているときでもスキップすることができます。
これは大部分のデータが変化しない大きいテーブルを保守するコストを大幅に削減するでしょう。
       </p><p>必要であれば、新たな<code class="literal">DISABLE_PAGE_SKIPPING</code>オプションを使ってバキュームで全ての凍結済みページを処理することを強制できます。
通常これは全く必要ありませんが、可視性マップの破損を復旧するのに役立つかもしれません。
       </p></li><li class="listitem"><p><code class="command">VACUUM</code>中の無駄なヒープ切り捨ての試行を回避しました。
(Jeff Janes, Tom Lane)
       </p><p>本変更は有効な切り捨てが不可能である場合の排他テーブルロックの取得を回避します。
主な利点はスタンバイサーバ上での不要な問い合わせキャンセルを回避できることです。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.8"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.7. 性能全般</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>古い<acronym class="acronym">MVCC</acronym>スナップショットを設定可能なタイムアウトの後に無効にできるようにしました。
(Kevin Grittner)
       </p><p>通常、削除されたタプルは、それを<span class="quote">“<span class="quote">見る</span>”</span>かもしれない最後のトランザクションがいなくなるまでは、バキュームによる物理的な除去がされません。
長時間オープンしたままのトランザクションは、このため、空間が再利用できないので相当なテーブル膨張を引き起こす可能性があります。
この機能は、<acronym class="acronym">MVCC</acronym>スナップショットをどれだけの間、有効と保証するかを指定する新たな設定パラメータ<a class="xref" href="runtime-config-resource.html#GUC-OLD-SNAPSHOT-THRESHOLD">old_snapshot_threshold</a>を通して、時間に基づく制限を設定可能にします。
上限時間後、デッドタプルは除去候補になります。
古いスナップショットを使うトランザクションは潜在的にこのようなデータが含まれているかもしれないページを読もうとしたならエラーを受け取るはずです。
       </p></li><li class="listitem"><p><code class="literal">GROUP BY</code>の他の列に機能的に従属している列を無視するようにしました。
(David Rowley)
       </p><p><code class="literal">GROUP BY</code>句が、同テーブルの他の列と共に遅延されていない主キーのすべての列を含むなら、主キー以外の列は冗長でグルーピングから外すことができます。
これは多くのよくある場合に計算を節約します。
       </p></li><li class="listitem"><p><code class="literal">WHERE</code>句がインデックスされていない列を参照している部分インデックスで、<a class="link" href="indexes-index-only-scans.html" title="11.11. インデックスオンリースキャン">インデックスオンリースキャン</a>を利用可能にしました。
(Tomas Vondra, Kyotaro Horiguchi)
       </p><p>例えば、<code class="command">CREATE INDEX tidx_partial ON t(b) WHERE a &gt; 0</code>で定義されたインデックスを、<code class="literal">WHERE a &gt; 0</code>と指定する問い合わせで、インデックスオンリースキャンに使うことができるようになりました。
これまでは、<code class="literal">a</code>がインデックス列にあらわれないために、これは許されませんでした。
       </p></li><li class="listitem"><p>チェックポイント書き込みをソートされた順で行うようにしました。
(Fabien Coelho, Andres Freund)
       </p><p>これまでチェックポイントは、通常ランダムに近い、とにかく共有バッファにたまたま出てきた順にダーティページを書き出していました。
これは特に回転メディアで性能がよくありません。
本変更はチェックポイント駆動の書き込みがファイルとブロック番号の順で行われるように、また、テーブルスペース間で偏りが無いようにします。
       </p></li><li class="listitem"><p>可能なところでは、カーネルディスクバッファにダーティデータが蓄積されるのを防ぐため、設定可能な書き込み数の後にカーネルライトバックを起動するようにしました。
(Fabien Coelho, Andres Freund)
       </p><p><span class="productname">PostgreSQL</span>はデータをカーネルのディスクキャッシュに書き、それはやがて物理ストレージにフラッシュされます。
多くのOSはこれを賢く管理せず、大量のダーティデータを一度にフラッシュすると判断するまで蓄積させておきます。これはフラッシュが終わるまでの間、新たなI/O要求に大きな遅延を引き起こします。
本変更は設定可能な間隔の後に明示的にデータフラッシュを要求することで、この問題を緩和しようとします。
       </p><p>Linuxにおいては、この用途に<code class="function">sync_file_range()</code>が使われ、この関数にほとんどマイナス面が無いため本機能はデフォルトで有効です。
このフラッシュする機能は、<code class="function">msync()</code>または<code class="function">posix_fadvise()</code>があるなら他のプラットフォームでも使用可能ですが、これらのインタフェースには若干の望ましくない副作用がありるため、Linux以外のプラットフォームでは本機能はデフォルトでは無効です。
       </p><p>新たな設定パラメータ<a class="xref" href="runtime-config-resource.html#GUC-BACKEND-FLUSH-AFTER">backend_flush_after</a>, <a class="xref" href="runtime-config-resource.html#GUC-BGWRITER-FLUSH-AFTER">bgwriter_flush_after</a>, <a class="xref" href="runtime-config-wal.html#GUC-CHECKPOINT-FLUSH-AFTER">checkpoint_flush_after</a>, and <a class="xref" href="runtime-config-wal.html#GUC-WAL-WRITER-FLUSH-AFTER">wal_writer_flush_after</a>が本動作を制御します。
       </p></li><li class="listitem"><p>複数の集約が同じ引数と遷移関数を持っているなら、それらの間で計算を共有することで集約関数の性能を改善しました。
(David Rowley)
       </p><p>例えば、<code class="command">SELECT AVG(x), VARIANCE(x) FROM tab</code>は行ごとに二つの集約に対して対して単一の計算を用いることができます。
       </p></li><li class="listitem"><p>元トランザクションがコミット済みかを判断するのに<code class="structname">pg_clog</code>ではなく現在トランザクションのスナップショットを調べることにより、最近に作られたタプルに対する可視性の検査を高速化しました。
(Jeff Janes, Tom Lane)
       </p></li><li class="listitem"><p>タプルのヒントビットが以前より早くセットされるようにしました。
(Andres Freund)
       </p></li><li class="listitem"><p>短命な準備されたトランザクションの性能を改善しました。
(Stas Kelvich, Simon Riggs, Pavan Deolasee)
       </p><p>二相コミットの情報は<code class="command">PREPARE TRANSACTION</code>の際に<acronym class="acronym">WAL</acronym>のみに書かれ、<code class="command">COMMIT PREPARED</code>の際には、それがすぐ後に生じたなら、<acronym class="acronym">WAL</acronym>から読み戻されるようになりました。
分離状態ファイルは、保留しているトランザクションが次のチェックポイントの時までコミットにもアボートにもならなかった場合のみ作られます。
       </p></li><li class="listitem"><p>メモリコンテキストの廃棄の性能を改善しました。
(Jan Wieck)
       </p></li><li class="listitem"><p>多数のオブジェクトを追跡するリソースオーナーの性能を改善しました。
(Aleksander Alekseev)
       </p></li><li class="listitem"><p><code class="type">timestamp</code>、<code class="type">time</code>、および<code class="type">date</code>データ型の出力関数の速度を改善しました。
(David Rowley, Andres Freund)
       </p></li><li class="listitem"><p><code class="literal">AccessExclusive</code>ロックを取得する操作のリプレイ中の、ホットスタンバイ問い合わせの不要なキャンセルを回避しました。
(Jeff Janes)
       </p></li><li class="listitem"><p>リレーション拡張のロックに競合があるとき、リレーションを複数ブロック一度に拡張するようにしました。
(Dilip Kumar)
       </p><p>これは競合を減らすことでスケーラビリティを改善します。
       </p></li><li class="listitem"><p>よりよいスケーラビリティのためにclogバッファの数を増やしました。
(Amit Kapila, Andres Freund)
       </p></li><li class="listitem"><p>常に単純な変数むけの<code class="literal">ParamListInfo</code>エントリを有効な状態に留めておくことで、<span class="application">PL/pgSQL</span>で式の評価を高速化しました。
(Tom Lane)
       </p></li><li class="listitem"><p>最近のWindowsバージョンで、<code class="literal">SO_SNDBUF</code>設定をそのデフォルトよりも減らすことを回避しました。
(Chen Huajun)
       </p></li><li class="listitem"><p>Windowsにおいて<a class="xref" href="runtime-config-logging.html#GUC-UPDATE-PROCESS-TITLE">update_process_title</a>をデフォルトで無効にしました。
(Takayuki Tsunakawa)
       </p><p>Windowsでは大部分の他プラットフォームよりもプロセスタイトルを更新するオーバーヘッドが大きく、また、大部分のWindowsユーザはプロセスタイトルを表示できるツールを持っていないことから、更新してもあまり役に立ちません。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.9"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.8. モニタリング</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="command">VACUUM</code>操作の進捗報告を提供する<a class="link" href="progress-reporting.html#PG-STAT-PROGRESS-VACUUM-VIEW" title="Table 28.21. pg_stat_progress_vacuumビュー"><code class="structname">pg_stat_progress_vacuum</code></a>システムビューを追加しました。
(Amit Langote, Robert Haas, Vinayak Pokale, Rahila Syed)
       </p></li><li class="listitem"><p><acronym class="acronym">SQL</acronym>に<code class="filename">pg_control</code>のフィールドを見せる<a class="link" href="functions-info.html#FUNCTIONS-CONTROLDATA" title="Table 9.72. 制御データ関数"><code class="function">pg_control_system()</code></a>、<code class="function">pg_control_checkpoint()</code>、<code class="function">pg_control_recovery()</code>、および、<code class="function">pg_control_init()</code>関数を追加しました。
(Joe Conway, Michael Paquier)
       </p></li><li class="listitem"><p><a class="link" href="view-pg-config.html" title="51.67. pg_config"><code class="structname">pg_config</code></a>システムビューを追加しました。
(Joe Conway)
       </p><p>このビューは<span class="application">pg_config</span>コマンドラインユーティリティから参照できるものと同様の情報、すなわち様々な<span class="productname">PostgreSQL</span>のコンパイル時の設定情報を見せます。
       </p></li><li class="listitem"><p><a class="link" href="view-pg-replication-slots.html" title="51.80. pg_replication_slots"><code class="structname">pg_replication_slots</code></a>システムビューに<code class="structfield">confirmed_flush_lsn</code>列を追加しました。
(Marko Tiikkaja)
       </p></li><li class="listitem"><p>ホットスタンバイサーバの<acronym class="acronym">WAL</acronym>レシーバプロセスに関する情報を提供する<a class="link" href="monitoring-stats.html#PG-STAT-WAL-RECEIVER-VIEW" title="Table 28.6. pg_stat_wal_receiverビュー"><code class="structname">pg_stat_wal_receiver</code></a>システムビューを追加しました。
(Michael Paquier)
       </p></li><li class="listitem"><p>どのセッションがどの他セッションをブロックしているかを確実に識別する<a class="link" href="functions-info.html#FUNCTIONS-INFO-SESSION-TABLE" title="Table 9.60. セッション情報関数"><code class="function">pg_blocking_pids()</code></a>関数を追加しました。
(Tom Lane)
       </p><p>この関数は与えられたプロセスIDのセッションをブロックしている全てのセッションのプロセスIDの配列を返します。
歴史的にはユーザは<code class="structname">pg_locks</code>ビューの自己結合を使ってこのような情報を取得するしていました。
しかしながら、いくらかの僅かな正確さに対してこのように実施するのことは不合理に面倒です。また、並列問い合わせの追加は、セッションの主プロセスでなくワーカ子プロセスによってロックが取得・待機されるかもしれないことから、この古い方法を完全に非実用的にしました。
       </p></li><li class="listitem"><p>現在のトランザクションログのフラッシュ位置を見せる関数<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE" title="Table 9.79. バックアップ制御関数"><code class="function">pg_current_xlog_flush_location()</code></a>を追加しました。
(Tomas Vondra)
       </p></li><li class="listitem"><p><code class="command">NOTIFY</code>がどのくらいいっぱいであるかを報告する関数<a class="link" href="functions-info.html#FUNCTIONS-INFO-SESSION-TABLE" title="Table 9.60. セッション情報関数"><code class="function">pg_notification_queue_usage()</code></a>を追加しました。
(Brendan Jurd)
       </p></li><li class="listitem"><p>メモリコンテキスト統計のダンプの冗長さを制限しました。
(Tom Lane)
       </p><p>メモリ不足エラーの際にポストマスタのログに出力されるメモリ使用のダンプは、多数のメモリコンテキストがあるとき、ことによると巨大なレポートを生成するのでなく、統計を要約するようになります。
<span class="quote">“<span class="quote">grand total(総計)</span>”</span>要約行も追加されます。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.10"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.9. <acronym class="acronym">認証</acronym></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="productname">PostgreSQL</span>クライアント認証に<span class="systemitem">BSD</span>認証サービスを使用できる<a class="link" href="auth-methods.html#AUTH-BSD" title="20.3.11. BSD認証"><acronym class="acronym">BSD</acronym>認証方式</a>を追加しました。
(Marisa Emerson)
       </p><p>BSD認証は今のところ<span class="systemitem">OpenBSD</span>でのみ使用できます。
       </p></li><li class="listitem"><p><a class="link" href="auth-methods.html#AUTH-PAM" title="20.3.10. PAM認証"><acronym class="acronym">PAM</acronym>認証</a>を使うとき、クライアントIPアドレスやホスト名を<code class="literal">PAM_RHOST</code>要素を通して<acronym class="acronym">PAM</acronym>モジュールに供給するようにしました。
(Grzegorz Sampolski)
       </p></li><li class="listitem"><p>ポストマスタのログでパスワード認証失敗のより多くの類型について詳細を出力するようにしました。
(Tom Lane)
       </p><p>全ての普通に起きうるパスワード認証失敗の場合に、ログに詳細な<code class="literal">DETAIL</code>フィールドが提供されます。
       </p></li><li class="listitem"><p><a class="link" href="auth-methods.html#AUTH-RADIUS" title="20.3.8. RADIUS認証"><acronym class="acronym">RADIUS</acronym>パスワード</a>を128文字の長さまでサポートしました。
(Marko Tiikkaja)
       </p></li><li class="listitem"><p><a class="link" href="auth-methods.html#SSPI-AUTH" title="20.3.4. SSPI認証"><acronym class="acronym">SSPI</acronym>認証</a>のときに<span class="productname">NetBIOS</span>か<span class="productname">Kerberos</span>のレルム名とユーザ名を制御する<a class="link" href="auth-methods.html#SSPI-AUTH" title="20.3.4. SSPI認証"><acronym class="acronym">SSPI</acronym>認証</a>の新たなパラメータ<code class="varname">compat_realm</code>と<code class="varname">upn_username</code>が追加されました。
(Christian Ullrich)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.11"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.10. Server Configuration</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>長すぎるアイドルイントランザクション状態のとき、セッションを自動的に終了できるようにしました。
(Vik Fearing)
       </p><p>この動作は新たな設定パラメータ<a class="xref" href="runtime-config-client.html#GUC-IDLE-IN-TRANSACTION-SESSION-TIMEOUT">idle_in_transaction_session_timeout</a>で制御されます。
これは忘れられたトランザクションが長期にロックを保持したり、バキュームクリーンアップを阻害したりするのを防止するのに役立ちます。
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-wal.html#GUC-CHECKPOINT-TIMEOUT">checkpoint_timeout</a>の許容される最大値を24時間に引き上げました。
(Simon Riggs)
       </p></li><li class="listitem"><p>異なるテーブルスペースが各々異なるI/O特性を持つ場合に対応するため、<code class="varname">effective_io_concurrency</code>をテーブルスペースごとに設定できるようにしました。
(Julien Rouhaud)
       </p></li><li class="listitem"><p>現在時刻をミリ秒付きのUnixエポック形式で出力する<a class="xref" href="runtime-config-logging.html#GUC-LOG-LINE-PREFIX">log_line_prefix</a>のオプション<code class="literal">%n</code>を追加しました。
(Tomas Vondra, Jeff Davis)
       </p></li><li class="listitem"><p><span class="systemitem">syslog</span>へログ出力するとき、メッセージ形式により多くの制御を提供する<a class="xref" href="runtime-config-logging.html#GUC-SYSLOG-SEQUENCE-NUMBERS">syslog_sequence_numbers</a>および<a class="xref" href="runtime-config-logging.html#GUC-SYSLOG-SPLIT-MESSAGES">syslog_split_messages</a>設定パラメータを追加しました。
(Peter Eisentraut)
       </p></li><li class="listitem"><p><a class="xref" href="runtime-config-wal.html#GUC-WAL-LEVEL">wal_level</a>設定パラメータの値である<code class="literal">archive</code>と<code class="literal">hot_standby</code>を一つの新たな値<code class="literal">replica</code>に合併しました。
(Peter Eisentraut)
       </p><p>これら設定値を区別することはもはや役に立たず、また、これらを合併することはレプリケーションのセットアップの計画された将来の平易化への一歩です。
古い名前はまだ受け付けられますが、内部的に<code class="literal">replica</code>に変換されます。
       </p></li><li class="listitem"><p>サーバの起動、停止で<code class="function">sd_notify()</code>の呼び出しを可能にする設定オプション<code class="option">--with-systemd</code>を追加しました。
(Peter Eisentraut)
       </p><p>これは、<span class="application">systemd</span>下の<span class="productname">PostgreSQL</span>の管理を大幅に簡単にする<code class="literal">notify</code>タイプの<span class="application">systemd</span>サービスユニットを利用できるようにします。
       </p></li><li class="listitem"><p>
サーバの<acronym class="acronym">SSL</acronym>キーファイルが<code class="literal">root</code>に所有されている場合には、グループ読み込みアクセスを持てるようにしました。
(Christoph Berg)
       </p><p>以前は、キーファイルは<span class="productname">PostgreSQL</span>サーバを実行するユーザに所有されるべきと主張していましたが、これは証明書を集中管理するように構成されている一部システム（<span class="systemitem">Debian</span>など）で不便です。
それゆえ、キーファイルが<code class="literal">root</code>に所有されていてグループ参照アクセスを持っている場合を許容しました。
そのグループに信頼できないユーザが決して含まれないようにするのは、OS管理者の責任です。
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.3.12"><div class="titlepage"><div><div><h5 class="title">E.17.3.1.11. 信頼性</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ポストマスタがダウンしたならバックエンドを強制的に終了させるようにしました。
(Rajeev Rastogi, Robert Haas)
       </p><p>通常の状況下ではポストマスタは常に子プロセスより長く生き残るはずです。
もし何らか理由でポストマスタがダウンしたなら、バックエンドセッションをエラーと共に強制的に終了させます。
以前は、現存するバックエンドはクライアントの切断まで実行し続けましたが、危険で非効率的です。
これはまた、前の古いバックエンドが終了するまでは新たなポストマスタが起動しないようにします。
バックエンドはクライアントI/Oを待つときにポストマスタのダウンを検知するでしょうから、終了は即時ではありませんが、クライアント問い合わせの終了よりも遅くなることはないはずです。
       </p></li><li class="listitem"><p>直列化可能かを、制約違反エラーを報告する前に検査するようにしました。
(Thomas Munro)
       </p><p>シリアライザブルトランザクション隔離を使っているとき、同時トランザクションを原因とするいかなるエラーも直列化の失敗として表明するのが望ましく、それによりアプリケーションにリトライが成功するかもしれないという手がかりを与えます。
残念ながら、キー重複の失敗が同時挿入で引き起こされた場合には、これは確実には生じません。
本変更は、アプリケーションがトランザクションのより早くに明示的に競合するキーの存在をチェックした（そして見つからなかった）なら、このようなエラーが直列化のエラーとして報告されることを保証します。
       </p></li><li class="listitem"><p>たとえ<acronym class="acronym">XID</acronym>をもたないトランザクションから発行されたときでも、無効化メッセージが<acronym class="acronym">WAL</acronym>記録されることを保証しました。
(Andres Freund)
       </p><p>これはスタンバイサーバのトランザクションが新たなインデックスのような変化に気づくのに失敗するという一部の稀な場合について修正します。
       </p></li><li class="listitem"><p>複数プロセスが<acronym class="acronym">GIN</acronym>インデックスのペンディングリストを同時にクリーンアップしようとするのを防ぎます。
       </p><p>意図的に許容されていいましたが、これは結果としてバキュームが削除を要するインデックスエントリの見落しに帰着する可能性のある競合状態を引き起こします。
       </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.21.5.4"><div class="titlepage"><div><div><h4 class="title">E.17.3.2. レプリケーションとリカバリ</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>同期レプリケーションで1つだけでなく複数同時の同期スタンバイサーバに対応しました。
(Masahiko Sawada, Beena Emerson, Michael Paquier, Fujii Masao, Kyotaro Horiguchi)
       </p><p>完了したとみなす前にコミットを確認しなければいけないスタンバイサーバの数は、<a class="xref" href="runtime-config-replication.html#GUC-SYNCHRONOUS-STANDBY-NAMES">synchronous_standby_names</a>パラメータの一部で設定します。
       </p></li><li class="listitem"><p>設定パラメータ<a class="xref" href="runtime-config-wal.html#GUC-SYNCHRONOUS-COMMIT">synchronous_commit</a>に新たな設定<code class="literal">remote_apply</code>を加えました。
(Thomas Munro)
       </p><p>このモードでは、マスタはスタンバイサーバでトランザクションがディスクに書かれるだけでなく<span class="emphasis"><em>適用済み</em></span>になるまで待ちます。
このことは、それより前にマスタで認識されたすべてのコミットが、スタンバイサーバで開始したトランザクションから見えると期待できることを意味します。
       </p></li><li class="listitem"><p>レプリケーションスロットを作ったときに<acronym class="acronym">WAL</acronym>の確保を直ちに行うため、レプリケーションプロトコルに機能を追加し、対応するオプションを<a class="link" href="functions-admin.html#FUNCTIONS-REPLICATION-TABLE" title="Table 9.83. レプリケーションSQL関数"><code class="function">pg_create_physical_replication_slot()</code></a>に追加しました。
(Gurjeet Singh, Michael Paquier)
       </p><p>これはレプリケーションスロット作成でベースバックアップで必要とされる全ての<acronym class="acronym">WAL</acronym>を保証できるようにします。
       </p></li><li class="listitem"><p><a class="link" href="app-pgbasebackup.html" title="pg_basebackup"><span class="application">pg_basebackup</span></a>に<code class="option">--slot</code>オプションを追加しました。
(Peter Eisentraut)
       </p><p>これは<span class="application">pg_basebackup</span>に<acronym class="acronym">WAL</acronym>ストリーミング向けに定義されたレプリケーションスロットを使わせます。
ベースバックアップ完了後、同じスロットを通常のストリーミングレプリケーションに選ぶことでシームレスに新たなスタンバイサーバの起動が可能です。
       </p></li><li class="listitem"><p>非排他のバックアップのために<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-BACKUP-TABLE" title="Table 9.79. バックアップ制御関数"><code class="function">pg_start_backup()</code></a>と<code class="function">pg_stop_backup()</code>を拡張しました。
(Magnus Hagander)
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.5"><div class="titlepage"><div><div><h4 class="title">E.17.3.3. 問い合わせ</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>タプルの集合を返す関数が単なる<code class="literal">NULL</code>を返せるようにしました。
(Andrew Gierth, Tom Lane)
       </p><p><code class="literal">SELECT FROM function(...)</code>の文脈において、以前は複合値の集合を返す関数は単なる<code class="literal">NULL</code>値を集合の一部として返すことを許していませんでした。
これからはこれが可能になり、要素が皆<code class="literal">NULL</code>の行として解釈されます。
これは例えば複合値の配列をunnestするなどのまれなケースでのエラーを回避します。
       </p></li><li class="listitem"><p>複数の<code class="literal">VALUES</code>行を伴う<code class="command">INSERT</code>のターゲット列リストにおける配列添え字とフィールド選択に完全に対応しました。
(Tom Lane)
       </p><p>これまで、このような場合は同じターゲット列が2回以上でてくるとき、例えば<code class="literal">INSERT INTO tab (x[1], x[2]) VALUES (...)</code>などで、失敗していました。
       </p></li><li class="listitem"><p>適切なとき、<code class="command">SELECT</code>出力式の評価を<code class="literal">ORDER BY</code>ソート後まで後回しにするようにしました。
(Konstantin Knizhnik)
       </p><p>この変更は出力リスト内の揮発性あるいは高コストの関数が<code class="literal">ORDER BY</code>で示される順序で実行されること、また、<code class="literal">LIMIT</code>句があるとき必要とされる回数以上に評価されないことを保証します。
これまで、並び替えがインデックススキャンやマージ結合前のソートで実行されるときには、これらの特性を持っていましたが、トップレベルのソートで実行されるときにはそうなっていませんでした。
       </p></li><li class="listitem"><p>処理したタプル数を記録するカウンタを64bitに拡張しました。
(Andreas Scherbaum)
       </p><p>この変更は<code class="command">SELECT</code>などのコマンドタグで40億件以上のタプルカウントを正しく報告できるようにします。
これはPL/pgSQLの<code class="command">GET DIAGNOSTICS ... ROW_COUNT</code>コマンドにも適用されます。
       </p></li><li class="listitem"><p><code class="literal">MULE_INTERNAL</code>エンコーディングを通した変換でエンコーディング変換をするのを回避しました。
(Tom Lane)
       </p><p>これまではキリル文字と中央ヨーロッパのシングルバイトのエンコーディングに対する多くの変換は、関連する<code class="literal">MULE_INTERNAL</code>コーディング方式に変換して、それから目的のエンコーディングに変換することで実行されていました。
非効率であることと別にこれは、変換できない文字に遭遇したときにエラーメッセージが、ユーザに見えるエンコーディングではなく<code class="literal">MULE_INTERNAL</code>との間で変換できないと混乱を招きやすい苦情を言うことを意味します。
       </p></li><li class="listitem"><p>テーブルが同じロールIDのもとでアクセスされる場合のみ、外部テーブルの結合をリモートで行うことを検討するようにしました。
(Shigeru Hanada, Ashutosh Bapat, Etsuro Fujita)
       </p><p>これまで外部結合プッシュダウン基盤はセキュリティの課題を完全に各外部データラッパに任せていました、これは<acronym class="acronym">FDW</acronym>に意図せぬ微妙なセキュリティホールをあまりに容易に作らせてしまいます。
そこで、どのロールIDが各テーブルにアクセスするか決定することを本体コードの役割としました。
また、関わるすべてのリレーションについてロールが同じでない限り、結合プッシュダウンを試みないようにしました。
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.6"><div class="titlepage"><div><div><h4 class="title">E.17.3.4. ユーティリティコマンド</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="command">COPY</code>が<code class="literal">INSERT</code>/<code class="literal">UPDATE</code>/<code class="literal">DELETE</code> ... <code class="literal">RETURNING</code>問い合わせの出力をコピーできるようにしました。
(Marko Tiikkaja)
       </p><p>これまでは、実現するのに中継する<acronym class="acronym">CTE</acronym>を書く必要がありました。
       </p></li><li class="listitem"><p><code class="command">ALTER <em class="replaceable"><code>object</code></em> DEPENDS ON EXTENSION</code>を導入しました。
(Abhijit Menon-Sen)
       </p><p>本コマンドはデータベースオブジェクトに拡張に依存していると印付けできるようにします。
これにより、拡張が削除されたならオブジェクトは（<code class="literal">CASCADE</code>は必要なしに）自動的に削除されます。
しかしながら、このオブジェクトは拡張の一部ではないので、<span class="application">pg_dump</span>では別にダンプされます。
       </p></li><li class="listitem"><p>オブジェクトがすでに要求されたスキーマにあるときには<code class="command">ALTER <em class="replaceable"><code>object</code></em> SET SCHEMA</code>が、歴史的に大部分のオブジェクトタイプに対してそうであったようにエラーを投げるのではなく、何もしないようにしました。
(Marti Raudsepp)
       </p></li><li class="listitem"><p><code class="command">ALTER OPERATOR</code>に既存の演算子に関連付けられた選択度の関数を変更できるオプションを追加しました。
(Yury Zhuravlev)
       </p></li><li class="listitem"><p><code class="command">ALTER TABLE ADD COLUMN</code>に<code class="option">IF NOT EXISTS</code>オプションを追加しました。
(Fabrízio de Royes Mello)
       </p></li><li class="listitem"><p>フィルファクタと自動バキューム関連のリレーションオプションを設定するとき、<code class="command">ALTER TABLE</code>が必要とするロック強度を減らしました。
(Fabrízio de Royes Mello, Simon Riggs)
       </p></li><li class="listitem"><p>拡張でインデックスアクセスメソッドを作ることを可能にする、<a class="link" href="sql-create-access-method.html" title="CREATE ACCESS METHOD"><code class="command">CREATE ACCESS METHOD</code></a>を導入しました。
(Alexander Korotkov, Petr Jelínek)
       </p></li><li class="listitem"><p><code class="command">CREATE EXTENSION</code>に、要求された拡張が依存するすべての拡張を自動的に作成する<code class="literal">CASCADE</code>オプションを追加しました。
(Petr Jelínek)
       </p></li><li class="listitem"><p>元テーブルが<code class="type">OID</code>列を持つとき、<code class="command">CREATE TABLE ... LIKE</code>でそれを含めるようにしました。
(Bruce Momjian)
       </p></li><li class="listitem"><p><code class="literal">CHECK</code>制約がテーブル作成コマンドで<code class="literal">NOT VALID</code>と宣言されている場合、自動的に有効と印付けするようにしました。
(Amit Langote, Amul Sul)
       </p><p>テーブルには行が存在しないので安全です。
これは以前からの<code class="literal">FOREIGN KEY</code>制約の動作と一致します。
       </p></li><li class="listitem"><p><code class="command">DROP OPERATOR</code>を削除された演算子とリンクしている<code class="structname">pg_operator</code>.<code class="structfield">oprcom</code>と<code class="structname">pg_operator</code>.<code class="structfield">oprnegate</code>をクリアするように修正しました。
(Roma Sokolov)
       </p><p>これまではこのようなリンクはそのまま残されて、削除した演算子の<code class="type">OID</code>が他の演算子に再利用されるという、あまりなさそうな事象で問題がでるかもしれません。
       </p></li><li class="listitem"><p><code class="command">EXPLAIN</code>出力で同じサブプランを二度見せないようにしました。
(Tom Lane)
       </p><p>ある種の、典型的にはインデックス条件でSubPlanノードを伴う場合、<code class="command">EXPLAIN</code>は同じサブプランのデータを二回出力していました。
       </p></li><li class="listitem"><p><code class="type">OID</code>列を除くシステム列へのインデックス作成を禁止しました。
(David Rowley)
       </p><p>このようなインデックスはサポートされているとみなされませんし、システムがタプルのシステム列フィールドをインデックス更新無しに変えるかもしれないため、高い可能性で誤動作するでしょう。
しかしながら、これまではこれが作られないように防ぐエラーチェックがありませんでした。
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.7"><div class="titlepage"><div><div><h4 class="title">E.17.3.5. 権限管理</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>注意を要する関数へのアクセス管理に権限システムを使うようにしました。
(Stephen Frost)
       </p><p>これまでは、多くの安全に注意を要する関数は非スーパーユーザから呼び出されるとエラーを投げる固定実装のチェックを含んでいました。
これはやや退屈な仕事としてスーパーユーザロールを使うことを強制していました。
これからは固定実装のエラーチェックは無くなり、<span class="application">initdb</span>にデフォルトのpublicの<code class="literal">EXECUTE</code>権限を取り上げさせるようにしました。
このことで、必ずしも全てのスーパーユーザ権限を必要としない信頼されたロールに、これらの関数の使用を認めることをインストレーションは選択できます。
       </p></li><li class="listitem"><p>従来スーパーユーザ専用だった関数へのアクセスを与えるのに使える<a class="link" href="default-roles.html" title="21.5. デフォルトロール">組み込みロール</a>を作成しました。
(Stephen Frost)
       </p><p>いまのところそのようなロールは<code class="literal">pg_signal_backend</code>だけですが、より多くが将来に追加される見通しです。
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.8"><div class="titlepage"><div><div><h4 class="title">E.17.3.6. データ型</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="textsearch.html" title="Chapter 12. 全文検索">全文検索</a>をフレーズ、すなわち特定順序あるいは指定された間隔で互いに隣接して現れる複数の語彙素、の検索に対応するように改善しました。
(Teodor Sigaev, Oleg Bartunov, Dmitry Ivanov)
       </p><p><code class="type">tsquery</code>入力で新たな演算子<code class="literal">&lt;-&gt;</code>と<code class="literal">&lt;<em class="replaceable"><code>N</code></em>&gt;</code>を使ってフレーズ検索問い合わせを指定できます。
前者は前後の語彙素が互いに隣接してその順に現れなければいけないことを意味します。後者は前後の語彙素がちょうどN<em class="replaceable"><code>N</code></em>だけ離れていなければいけないことを意味します。
       </p></li><li class="listitem"><p>配列スライス指定子で範囲の片方あるいは両方を（例えば<code class="literal">array_col[3:]</code>と）省略できるようにしました。
(Yury Zhuravlev)
       </p><p>省略された範囲は対応する配列の添え字の上限または下限と受け取られます。
これは多くの一般的なユースケースでよりシンプルな指定を可能にします。
       </p></li><li class="listitem"><p>範囲外の日付やタイムスタンプについてより注意深くしました。
(Vitaly Burovoy)
       </p><p>この変更は<code class="type">timestamp with time zone</code>の実装の限界に極めて近い値に対する予期せぬ範囲外エラーを防ぎます。
これまでは、<span class="quote">“<span class="quote">同じ</span>”</span>値が<code class="varname">timezone</code>設定によって、受け入れられたり、受け入れられなかったりしました。これは現在受け付けられている値のダンプ、リストアが失敗するかもしれないことを意味します。
これからは、値の限界はローカルタイムでなく、<code class="varname">timezone</code>とは無関係にするため、同等の<acronym class="acronym">UTC</acronym>時間に従って制限されます。
       </p><p>また、<span class="productname">PostgreSQL</span>は、<code class="type">date</code> <code class="literal">+</code> <code class="type">integer</code>などの新たな日付やタイムスタンプ値を計算する処理でも、より注意深くオーバーフローを検出するようになりました。
       </p></li><li class="listitem"><p>幾何データ型について、<code class="literal">infinity</code>と<code class="literal">NaN</code>の複合値が入出力の際に確実に一貫した扱いをされるようにしました。
(Tom Lane)
       </p><p>これからはこのような値は常にシンプルな<code class="type">float8</code>列と同様に出力し、入力で同様に受け入れられます。
これまではプラットフォームに依存した動作をしていました。
       </p></li><li class="listitem"><p>現代的な<span class="productname">Hunspell</span>ファイルを扱うように、また、より多くの言語に対応するように<a class="link" href="textsearch-dictionaries.html#TEXTSEARCH-ISPELL-DICTIONARY" title="12.6.5. Ispell辞書"><code class="literal">ispell</code></a>辞書タイプを更新しました。
(Artur Zakirov)
       </p></li><li class="listitem"><p><a class="link" href="functions-matching.html#FUNCTIONS-POSIX-REGEXP" title="9.7.3. POSIX正規表現">正規表現</a>で後方検索制約を実装しました。
(Tom Lane)
       </p><p>後方検索制約はテキストを消費せず既存の先行検索制約と似ていますが、
文字列の現在位置から始まるのでなく、現在位置で終わるマッチが在ること（あるいは無いこと）をチェックします。
同様の機能は既存の他の多くの正規表現エンジンに存在します。
       </p></li><li class="listitem"><p>正規表現で、見たところ3桁8進数のエスケープ<code class="literal">\</code><em class="replaceable"><code>nnn</code></em>が
377（10進数で255)を超えた場合、代わりに2桁8進数のエスケープとみなすようにしました。
(Tom Lane)
       </p><p>これにより現在の<span class="application">Tcl</span>リリースと振る舞いが一致します。
       </p></li><li class="listitem"><p>対応する等価演算子との一貫性のため、トランザクションID演算子<code class="type">xid</code> <code class="literal">&lt;&gt;</code> <code class="type">xid</code>と<code class="type">xid</code> <code class="literal">&lt;&gt;</code> <code class="type">int4</code>を追加しました。
(Michael Paquier)
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.9"><div class="titlepage"><div><div><h4 class="title">E.17.3.7. 関数</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="type">jsonb</code>配列に新たな要素を挿入したり、未だ無いキーを<code class="type">jsonb</code>オブジェクト挿入したりする<a class="link" href="functions-json.html#FUNCTIONS-JSON-PROCESSING-TABLE" title="Table 9.46. JSON処理関数"><code class="function">jsonb_insert()</code></a>関数を追加しました。
(Dmitry Dolgov)
       </p></li><li class="listitem"><p><code class="type">numeric</code>型むけの<code class="function">ln()</code>、<code class="function">log()</code>、<code class="function">exp()</code>、および、<code class="function">pow()</code>関数の精度を改善しました。
(Dean Rasheed)
       </p></li><li class="listitem"><p><code class="type">numeric</code>値の表示スケールを取り出す<a class="link" href="functions-math.html#FUNCTIONS-MATH-FUNC-TABLE" title="Table 9.5. 算術関数"><code class="function">scale(numeric)</code></a>関数を追加しました。
(Marko Tiikkaja)
       </p></li><li class="listitem"><p>度で動作する三角関数が追加されました。
(Dean Rasheed)
       </p><p>例えば、<code class="function">sin()</code>は引数をラジアンで評価しますが、<a class="link" href="functions-math.html#FUNCTIONS-MATH-TRIG-TABLE" title="Table 9.7. 三角関数"><code class="function">sind()</code></a>では度で評価します。
これらの関数は、例えば<code class="literal">sind(30) = 0.5</code>のように、いくつか予測可能な値でちょうどの結果値をもたらすように動作します。
       </p></li><li class="listitem"><p>三角関数が<code class="literal">infinity</code>および<code class="literal">NaN</code>の入力を<acronym class="acronym">POSIX</acronym>標準によって扱うことを保証しました。
(Dean Rasheed)
       </p><p><acronym class="acronym">POSIX</acronym>標準にはこれら関数は<code class="literal">NaN</code>入力には<code class="literal">NaN</code>を返し、<code class="literal">infinity</code>を含む範囲外の入力にはエラーを投げるべきと書かれています。
これまでの振る舞いはプラットフォームによって様々でした。
       </p></li><li class="listitem"><p><a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="Table 9.30. 日付/時刻関数"><code class="function">to_timestamp(float8)</code></a>が浮動小数点の<code class="literal">infinity</code>をタイムスタンプの<code class="literal">infinity</code>に変換するようにしました。
(Vitaly Burovoy)
       </p><p>以前は無限大の入力では単に失敗していました。
       </p></li><li class="listitem"><p><code class="type">tsvector</code>データむけの関数を追加しました。
(Stas Kelvich)
       </p><p>新たな関数<a class="link" href="functions-textsearch.html#TEXTSEARCH-FUNCTIONS-TABLE" title="Table 9.41. テキスト検索関数"><code class="function">ts_delete()</code></a>、<code class="function">ts_filter()</code>、<code class="function">unnest()</code>、<code class="function">tsvector_to_array()</code>、<code class="function">array_to_tsvector()</code>、および、特定語彙素にだけ重みを付ける<code class="function">setweight()</code>の別形を追加しました。
       </p></li><li class="listitem"><p><a class="link" href="textsearch-features.html#TEXTSEARCH-STATISTICS" title="12.4.4. 文書の統計情報の収集"><code class="function">ts_stat()</code></a>と<a class="link" href="textsearch-features.html#TEXTSEARCH-UPDATE-TRIGGERS" title="12.4.3. 自動更新のためのトリガ"><code class="function">tsvector_update_trigger()</code></a>を期待される引数型そのものでなく、そのバイナリ互換の型の値でも動作するようにしました。
例えば<code class="type">text</code>が期待されているところに<code class="type">citext</code>を可能にします。
(Teodor Sigaev)
       </p></li><li class="listitem"><p>引数の中のNULLまたは非NULLを数える可変引数関数<a class="link" href="functions-comparison.html#FUNCTIONS-COMPARISON-FUNC-TABLE" title="Table 9.3. 比較関数"><code class="function">num_nulls()</code></a>と<code class="function">num_nonnulls()</code>を追加しました。
(Marko Tiikkaja)
       </p><p>a、b、c の内ちょうど一つだけ非<code class="literal">NULL</code>であることを主張する<code class="literal">CHECK(num_nonnulls(a,b,c) = 1)</code>は、一つの使用例です。
これら関数は配列の中のNULLや非NULLを数えるのにも使用できます。
       </p></li><li class="listitem"><p>修飾され、クオートされているかもしれないSQL識別子を部品に分解する関数<a class="link" href="functions-string.html#FUNCTIONS-STRING-OTHER" title="Table 9.9. その他の文字列関数"><code class="function">parse_ident()</code></a>を追加しました。
(Pavel Stehule)
       </p></li><li class="listitem"><p><a class="link" href="functions-formatting.html#FUNCTIONS-FORMATTING-TABLE" title="Table 9.23. 書式設定関数"><code class="function">to_number()</code></a>で、<code class="literal">V</code>フォーマットコードを10の<code class="literal">V</code>に続く数字の数のべき乗で割るものと解釈するようにしました。
(Bruce Momjian)
       </p><p>このことで<code class="function">to_char()</code>の逆関数として動作させます。

       </p></li><li class="listitem"><p><a class="link" href="functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE" title="Table 9.63. システムカタログ情報関数"><code class="function">to_reg*()</code></a>関数群が
<code class="type">cstring</code>でなく<code class="type">text</code>型を受け付けるようにしました。
(Petr Korobeinikov)
       </p><p>これは引数がシンプルなリテラル定数でない箇所のほとんどの場合で明示的なキャストの必要をなくします。
       </p></li><li class="listitem"><p>サイズを示す人間に読みやすい文字列を数値に変換する<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-DBSIZE" title="Table 9.84. データベースオブジェクト容量関数"><code class="function">pg_size_bytes()</code></a>関数を追加しました。
(Pavel Stehule, Vitaly Burovoy, Dean Rasheed)
       </p><p>本関数は文字列を<code class="function">pg_size_pretty()</code>で生成されたような文字列をバイトに変換します。
<code class="literal">SELECT oid::regclass FROM pg_class WHERE pg_total_relation_size(oid) &gt; pg_size_bytes('10 GB')</code>が使用例です。
       </p></li><li class="listitem"><p><a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-DBSIZE" title="Table 9.84. データベースオブジェクト容量関数"><code class="function">pg_size_pretty()</code></a>で、負の値を正の値と同様に整形するようにしました。
(Adrian Vondendriesch)
       </p><p>これまでは負の値は短縮されず、バイトで出力されていました。
       </p></li><li class="listitem"><p><a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-SET-TABLE" title="Table 9.77. 構成設定関数"><code class="function">current_setting()</code></a>関数にオプションの<em class="replaceable"><code>missing_ok</code></em>引数を追加しました。
(David Christensen)
       </p><p>これは認識できないパラメータ名に対してエラーを回避できるようにします。代わりに<code class="literal">NULL</code>が返ります。
       </p></li><li class="listitem"><p>様々なシステムカタログ情報関数が不正な入力に対して<code class="literal">NULL</code>を返すように変更しました。
(Michael Paquier)
       </p><p>これからは<a class="link" href="functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE" title="Table 9.63. システムカタログ情報関数"><code class="function">pg_get_viewdef()</code></a>関数は無効なビューの<code class="type">OID</code>が与えられたなら<code class="literal">NULL</code>を返します。また、いくつかの同種の関数も不正な入力に対して同様に<code class="literal">NULL</code>を返します。
以前は、このような場合にたいてい、ユーザ側の問題で起きたことを意味しない<span class="quote">“<span class="quote">cache lookup failed</span>”</span>エラーになっていました。
       </p></li><li class="listitem"><p><a class="link" href="functions-admin.html#PG-REPLICATION-ORIGIN-XACT-RESET"><code class="function">pg_replication_origin_xact_reset()</code></a>を引数を一切持たないように修正しました。
(Fujii Masao)
       </p><p>ドキュメントには引数を持たないと書かれていて、Cコードも引数を想定していませんが、<code class="structname">pg_proc</code>のエントリでは誤って2つの引数が指定されていました。
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.10"><div class="titlepage"><div><div><h4 class="title">E.17.3.8. サーバサイド言語</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="plpgsql.html" title="Chapter 42. PL/pgSQL - SQL手続き言語">PL/pgSQL</a>で実行時でなく関数をコンパイルするときに、<code class="command">CONTINUE</code>文と<code class="command">EXIT</code>文の不一致を検出するようにしました。
(Jim Nasby)
       </p></li><li class="listitem"><p><span class="application">PL/Python</span>のエラー報告とメッセージ報告の関数を、主エラーメッセージの他に追加メッセージフィールドも指定できるように拡張しました。
(Pavel Stehule)
       </p></li><li class="listitem"><p>PL/Python関数が<span class="application">SPI</span>を通して自身を再帰的に呼び出しできるようにしました。
また、複数の集合を返すPL/Python関数が一つの問い合わせから呼び出されたときの動作を修正しました。
(Alexey Grishchenko, Tom Lane)
       </p></li><li class="listitem"><p>PL/Pythonでのセッション有効期間のメモリリークを修正しました。
(Heikki Linnakangas, Haribabu Kommi, Tom Lane)
       </p></li><li class="listitem"><p><span class="application">PL/Tcl</span>をシンプル文字列ではなく、Tclの<span class="quote">“<span class="quote">object</span>”</span> <acronym class="acronym">API</acronym>を使うように現代化しました。
(Jim Nasby, Karl Lehenbauer)
       </p><p>これは一部のケースで性能をかなり改善できます。
今後は<span class="application">PL/Tcl</span>はTcl 8.4以上を必要とすることに注意してください。
       </p></li><li class="listitem"><p><span class="application">PL/Tcl</span>でデータベースの報告するエラーが、Tclの<code class="varname">errorCode</code>グローバル変数で追加情報を返すようにしました。
(Jim Nasby, Tom Lane)
       </p><p>この機能はエラーについての補助データを返すときのTclの習慣に従っています。
       </p></li><li class="listitem"><p>データベースエンコーディングとTclが期待する<code class="literal">UTF-8</code>との間でエンコーディング変換をするように<span class="application">PL/Tcl</span>を修正しました。
(Tom Lane)
       </p><p>これまでは、文字列が変換無しに素通しで渡されていて、データベースエンコーディングが<code class="literal">UTF-8</code>でないとき、非<code class="literal">ASCII</code>文字で誤動作の原因となりました。
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.11"><div class="titlepage"><div><div><h4 class="title">E.17.3.9. クライアントインタフェース</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>エラーおよび通知メッセージに<a class="link" href="protocol-error-fields.html" title="52.8. エラーおよび警報メッセージフィールド">深刻度フィールド</a>の非ローカライズ版を加えました。
(Tom Lane)
       </p><p>この変更はクライアントコードが深刻度をあらわす文字列のローカライズ変形を懸念することなくエラーまたは通知の深刻度を判断できるようにします。
       </p></li><li class="listitem"><p>常に、あるいは非エラーメッセージ限定、のいずれかでメッセージの<code class="literal">CONTEXT</code>フィールドを抑止できる機能を<span class="application">libpq</span>に導入しました。
(Pavel Stehule)
       </p><p><a class="link" href="libpq-status.html#LIBPQ-PQERRORMESSAGE"><code class="function">PQerrorMessage()</code></a>の現在のデフォルト動作では、エラーについてのみ<code class="literal">CONTEXT</code>を出力します。
新たな関数<a class="link" href="libpq-control.html#LIBPQ-PQSETERRORCONTEXTVISIBILITY"><code class="function">PQsetErrorContextVisibility()</code></a>でこれを調節できます。
       </p></li><li class="listitem"><p><span class="application">libpq</span>で異なる冗長度でのエラーメッセージ再生成に対応しました。
(Alex Shulgin)
       </p><p>これは新たな関数<a class="link" href="libpq-exec.html#LIBPQ-PQRESULTVERBOSEERRORMESSAGE"><code class="function">PQresultVerboseErrorMessage()</code></a>で行われます。
これは<span class="application">psql</span>の新たな<code class="literal">\errverbose</code>機能を下支えします。また、他のクライアントにとってもおそらく有益でしょう。
       </p></li><li class="listitem"><p>デフォルトのUnixソケット接続において有益なデータを返すように、<span class="application">libpq</span>の<a class="link" href="libpq-status.html#LIBPQ-PQHOST"><code class="function">PQhost()</code></a>関数を改善しました。
(Tom Lane)
       </p><p>明示的なホスト指定が与えられていない場合、これまでは<code class="literal">NULL</code>を返していましたが、これからはデフォルトのソケットディレクトリのパスを返します。
       </p></li><li class="listitem"><p><span class="application">ecpg</span>の字句解析が、プリプロセッサディレクティブの行のコメント文字列内の改行を扱えるように修正しました。
(Michael Meskes)
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.12"><div class="titlepage"><div><div><h4 class="title">E.17.3.10. クライアントアプリケーション</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="app-pgdump.html" title="pg_dump"><span class="application">pg_dump</span></a>と<a class="link" href="app-pgrestore.html" title="pg_restore"><span class="application">pg_restore</span></a>に<code class="option">--strict-names</code>オプションを加えました。
(Pavel Stehule)
       </p><p>このオプションはプログラムに<code class="option">-t</code>または<code class="option">-n</code>にマッチするものが無いなら、静かに何もしないのではなく苦情を言うようにさせます。
       </p></li><li class="listitem"><p><span class="application">pg_dump</span>で、システムオブジェクトへの権限割り当てのローカルな変更をダンプするようにしました。
(Stephen Frost)
       </p><p>組み込みの、あるいは、拡張で作られたオブジェクトの権限割り当てを変更することはスーパーユーザで常に可能でしたが、そのような変更は以前はダンプとリストアで失われました。
これからは、<span class="application">pg_dump</span>がそのような変更を認識してダンプします。
（しかしながら、これは9.6以降のサーバからダンプするときだけ動作します。）
       </p></li><li class="listitem"><p><span class="application">pg_dump</span>で、拡張が所有するスキーマに含まれる、拡張が所有していないオブジェクトをダンプできるようにしました。
(Martín Marqués)
       </p><p>これまでは誤ってスキーマを所有している拡張に属しているとみなされて、このようなオブジェクトは無視されました。
       </p></li><li class="listitem"><p><span class="application">pg_dump</span>の出力で、テーブル毎においてだけ一意の名前がつくオブジェクトタイプ（例えばトリガー）のオブジェクトタグにテーブル名を含めるようにしました。
(Peter Eisentraut)
       </p></li></ul></div><div class="sect4" id="id-1.11.6.21.5.12.3"><div class="titlepage"><div><div><h5 class="title">E.17.3.10.1. <a class="xref" href="app-psql.html" title="psql"><span class="refentrytitle"><span class="application">psql</span></span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>複数の<code class="option">-c</code>と<code class="option">-f</code>コマンドラインオプションに対応しました。
(Pavel Stehule, Catalin Iacob)
       </p><p>指定した操作は与えられたオプションの順に実行され、その後<span class="application">psql</span>が終了します。
       </p></li><li class="listitem"><p>問い合わせ結果をクロス表表示で出力する<code class="command">\crosstabview</code>コマンドを追加しました。
       </p><p>クロス表表示では、ひとつの問い合わせの結果列のデータ値が出力表に配置されます。出力表の行、列のヘッダは問い合わせの別の結果列からきています。
       </p></li><li class="listitem"><p>最大の冗長度で最後のサーバエラーを表示する<code class="literal">\errverbose</code>コマンドを追加しました。
(Alex Shulgin)
       </p><p>予期せぬエラーを受け取った後、これは便利です。
もはや、<code class="varname">VERBOSITY</code>変数を調整してデフォルトでは見られないエラーフィールドを見るために失敗を再現する必要はありません。
       </p></li><li class="listitem"><p>ビュー定義の編集と表示をする<code class="literal">\ev</code>および<code class="literal">\sv</code>コマンドを追加しました。
(Petr Korobeinikov)
       </p><p>これらは関数に対する既存の<code class="literal">\ef</code>および<code class="literal">\sf</code>コマンドに対応するものです。
       </p></li><li class="listitem"><p>問い合わせを実行して、その結果を新たな問い合わせとして再実行する<code class="command">\gexec</code>コマンドを追加しました。
(Corey Huinker)
       </p></li><li class="listitem"><p><code class="literal">\C <em class="replaceable"><code>string</code></em></code>との一貫性のため、<code class="literal">\pset C <em class="replaceable"><code>string</code></em></code>でテーブルタイトルを設定できるようにしました。
(Bruce Momjian)
       </p></li><li class="listitem"><p><code class="literal">\pset expanded auto</code>モードで、一つだけの列からなる問い合わせ結果については拡張書式を使わないようにしました。
(Andreas Karlsson, Robert Haas)
       </p></li><li class="listitem"><p><code class="command">\watch</code>コマンドによるヘッダ出力を改善しました。
(Michael Paquier, Tom Lane)
       </p><p><code class="command">\pset title</code>の文字列がセットされていたならをそれをヘッダ出力に含めます。また、ヘッダの規格通りの部分を<code class="literal"><em class="replaceable"><code>timestamp</code></em> (every <em class="replaceable"><code>N</code></em>s)</code>と、短くしました。
また、タイムスタンプ書式は<span class="application">psql</span>のロケール環境に従うようになります。
       </p></li><li class="listitem"><p>現在行だけでなく入力の問い合わせ全体を考慮するようにタブ補完ロジックを改善しました。
(Tom Lane)
       </p><p>これまではコマンドが複数行に分かれることで、手前の行の語を見る必要のある全てのタブ補完ルールが無効になっていました。
       </p></li><li class="listitem"><p>タブ補完動作の多数の細かな改善。
(Peter Eisentraut, Vik Fearing, Kevin Grittner, Kyotaro Horiguchi, Jeff Janes, Andreas Karlsson, Fujii Masao, Thomas Munro, Masahiko Sawada, Pavel Stehule)
       </p></li><li class="listitem"><p>接続されたバックエンドのプロセスIDを挿入する<code class="literal">PROMPT</code>オプション<code class="literal">%p</code>を追加しました。
(Julien Rouhaud)
       </p></li><li class="listitem"><p>常に、あるいは非エラーメッセージ限定、のいずれかでメッセージの<code class="literal">CONTEXT</code>フィールドを抑止できる機能を導入しました。
(Pavel Stehule)
       </p><p>現在のデフォルト動作ではエラーの場合のみ<code class="literal">CONTEXT</code>を出力します。
特別変数<code class="varname">SHOW_CONTEXT</code>を設定することでこれを変更できます。
       </p></li><li class="listitem"><p><code class="command">\df+</code>が関数のアクセス権限とパラレルセーフ属性を表示するようにしました。
(Michael Paquier)
       </p></li></ul></div></div><div class="sect4" id="id-1.11.6.21.5.12.4"><div class="titlepage"><div><div><h5 class="title">E.17.3.10.2. <a class="xref" href="pgbench.html" title="pgbench"><span class="refentrytitle"><span class="application">pgbench</span></span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">pgbench</span>スクリプト内のSQLコマンドは改行ではなく、セミコロンで終了するものとしました。
(Kyotaro Horiguchi, Tom Lane)
       </p><p>この変更はスクリプト内の複数行にわたるSQLコマンドを可能にします。
現存のカスタムスクリプトは、各行末にセミコロンが未だ無ければ加える修正が必要でしょう。
（そのようにすることは、旧バージョン<span class="application">pgbench</span>むけのスクリプトを壊しません）
       </p></li><li class="listitem"><p>バックスラッシュコマンドの式で<a class="link" href="pgbench.html#PGBENCH-BUILTIN-FUNCTIONS" title="組み込み関数">組み込み関数</a>、および、浮動小数点演算に対応しました。
(Fabien Coelho)
       </p></li><li class="listitem"><p><code class="command">\setrandom</code>を組み込み関数で置き換えました。
(Fabien Coelho)
       </p><p>新たに組み込み関数<a class="link" href="pgbench.html#PGBENCH-FUNCTIONS" title="Table 242. pgbenchの関数"><code class="function">random()</code></a>、<code class="function">random_exponential()</code>、<code class="function">random_gaussian()</code>を追加しました。
これらは<code class="command">\setrandom</code>と同じ働きをしますが、大きい式に組み入れることができるのでより使いやすいです。
これら関数の追加で不要になったため、<code class="command">\setrandom</code>を除去しました。
       </p></li><li class="listitem"><p>カスタムスクリプトだけでなく、組み込みのスクリプトの複数の複製を起動できるようにしました。
(Fabien Coelho)
       </p><p>これは<code class="option">-f</code>と似たように働く、カスタムスクリプトむけの新たな<code class="option">-b</code>スイッチにより実行されます。
       </p></li><li class="listitem"><p>スクリプトの選択率（重み）を変更できるようにしました。
(Fabien Coelho)
       </p><p>複数スクリプトが指定されたとき、各<span class="application">pgbench</span>トランザクションは実行するものをランダムに選びます。
これまでこれは常に均等な確率で行われていましたが、これからは異なるスクリプトに異なる選択率を指定することができます。
       </p></li><li class="listitem"><p>複数スクリプトの実行において、各スクリプトむけに統計情報を収集するようにしました。
(Fabien Coelho)
       </p><p>この機能は既にある全体統計とコマンド毎統計に対して、中間の詳細度を追加します。
       </p></li><li class="listitem"><p>実行開始からの時間の代わりにUnixエポックタイムスタンプで進行を報告する<code class="option">--progress-timestamp</code>オプションを追加しました。
(Fabien Coelho)
       </p></li><li class="listitem"><p>クライアント接続数(<code class="option">-c</code>)がスレッド数(<code class="option">-j</code>)の倍数でなくてもよくしました。
(Fabien Coelho)
       </p></li><li class="listitem"><p><code class="option">-T</code>オプションが使われているとき、指定時間の終わりで直ちに終了するようにしました。
(Fabien Coelho)
       </p><p>これまでは、低いトランザクションレートが指定されていると<span class="application">pgbench</span>が指定よりもかなり長く待つ可能性がありました。
       </p></li></ul></div></div></div><div class="sect3" id="id-1.11.6.21.5.13"><div class="titlepage"><div><div><h4 class="title">E.17.3.11. サーバアプリケーション</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">initdb</span>のブートストラップ後フェーズにおけるエラー報告を改善しました。
(Tom Lane)
       </p><p>これまでは、ここでのエラーは入力ファイル全体を<span class="quote">“<span class="quote">失敗している問い合わせ</span>”</span>として報告するものになっていました。
これからは、現在の問い合わせだけが報告されます。
この望まれる動作を得るため、<span class="application">initdb</span>の入力ファイルの問い合わせは空行で区切られなければなりません。
       </p></li><li class="listitem"><p>ブートストラップ後の処理の全てに単一のスタンドアローンバックエンドセッションを使うことで<span class="application">initdb</span>を高速化しました。
       </p></li><li class="listitem"><p>ターゲットタイムラインが変化するときでも動作するように<a class="link" href="app-pgrewind.html" title="pg_rewind"><span class="application">pg_rewind</span></a>を改善しました。
(Alexander Korotkov)
       </p><p>例えば、昇格したスタンバイを旧マスタのタイムラインのどこかの状態に巻き戻すことができます。
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.14"><div class="titlepage"><div><div><h4 class="title">E.17.3.12. ソースコード</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>廃れた<code class="function">heap_formtuple</code>/<code class="function">heap_modifytuple</code>/<code class="function">heap_deformtuple</code>関数を除去しました。
(Peter Geoghegan)
       </p></li><li class="listitem"><p><code class="function">AllocSetContextCreate()</code>呼び出しをシンプルで安全にするマクロを追加しました。
(Tom Lane)
       </p><p>新たなマクロ<code class="symbol">ALLOCSET_DEFAULT_SIZES</code>、<code class="symbol">ALLOCSET_SMALL_SIZES</code>、<code class="symbol">ALLOCSET_START_SMALL_SIZES</code>の一つを使うことが推奨され、メモリコンテキストむけに個別のサイズパラメータを書き出すことは非推奨となりました。
しかしながら、既存のコードは引き続き動作します。
       </p></li><li class="listitem"><p>ヘッダファイルに無条件で<code class="literal">static inline</code>関数を使うようにしました。
(Andres Freund)
       </p><p>これはとても古いコンパイラでは警告および/または無駄なコードスペースをもたらすかもしれませんが、表記法の改善はそうするだけの価値があると思われます。
       </p></li><li class="listitem"><p><span class="application">TAP</span>テスト基盤を改善しました。
(Michael Paquier, Craig Ringer, Álvaro Herrera, Stephen Frost)
       </p><p>特に、この基盤を使ってリカバリシナリオをテストできるようになりました。
       </p></li><li class="listitem"><p><code class="varname">trace_lwlocks</code>が各ロックを名前で識別するようにしました。
(Robert Haas)
       </p></li><li class="listitem"><p><span class="application">psql</span>のタブ補完のコード基盤を改善しました。
(Thomas Munro, Michael Paquier)
       </p><p>タブ補完規則がかなり容易に書けるようになり、また、よりコンパクトになりました。
       </p></li><li class="listitem"><p>接続認証の間のアクセスで利用可能になるように、<code class="structname">pg_shseclabel</code>システムカタログをキャッシュに釘づけにしました。
(Adam Brightwell)
       </p><p>コアコードはこのカタログを認証に使いませんが、拡張が参照したいかもしれません。
       </p></li><li class="listitem"><p><span class="application">C</span>レベルの大部分を隠すように<a class="link" href="indexam.html" title="Chapter 60. インデックスアクセスメソッドのインタフェース定義">インデックスアクセスメソッド<acronym class="acronym">API</acronym></a>再構築しました。
(Alexander Korotkov, Andrew Gierth)
       </p><p>本変更はインデックス<acronym class="acronym">AM API</acronym>を外部データラッパーやテーブルサンプルハンドラに適用したデザインと同様に現代化します。
これは<span class="application">C</span>コードをシンプルにし、組み込み可能な拡張でインデックスアクセスメソッドを定義することをより実用的にします。
結果として、大部分の<code class="structname">pg_am</code>システムカタログの列はなくなりました。
インデックスAMのこれまで<code class="structname">pg_am</code>にあった属性情報をSQL問い合わせで調べることができる新たな<a class="link" href="functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE" title="Table 9.63. システムカタログ情報関数">検査関数</a>が追加されました。
       </p></li><li class="listitem"><p><span class="application">initdb</span>や拡張で作られたオブジェクトの元の権限を保持する<a class="link" href="catalog-pg-init-privs.html" title="51.28. pg_init_privs"><code class="structname">pg_init_privs</code></a>システムカタログを追加しました。
(Stephen Frost)
       </p><p>この基盤は<span class="application">pg_dump</span>がインストレーションでシステムオブジェクトに加えられた権限の変更をダンプできるようにします。
以前はこのような変更はダンプとリロードで失われていましたが、これからは保存されます。
       </p></li><li class="listitem"><p>拡張がカスタム<code class="literal">LWLocks</code>を割り当てる方法を変更しました。
(Amit Kapila, Robert Haas)
       </p><p><code class="function">RequestAddinLWLocks()</code>関数は削除され、<code class="function">RequestNamedLWLockTranche()</code>に置き換えられました。
これによりカスタム<code class="literal">LWLocks</code>の識別を改善し、間違いやすさを軽減します。
       </p></li><li class="listitem"><p>複数セッションが同時に待機できるように隔離テスタを改善して、デッドロックシナリオのテストが可能になります。
(Robert Haas)
       </p></li><li class="listitem"><p>拡張可能なノードタイプを導入しました。
(KaiGai Kohei)
       </p><p>本変更は<span class="application">FDW</span>あるいはカスタムスキャンプロバイダがプランツリーに従来可能なものよりも便利な形式でデータを置けるようにします。
       </p></li><li class="listitem"><p>プランナがスキャン/結合後の問い合わせ処理段階で<code class="literal">Paths</code>を生成比較することで処理するようにし、多数のアドホックなロジックと置き換えました。
(Tom Lane)
       </p><p>この変更は現時点ではユーザに見える改善は僅かしかもたらしませんが、古いコード構造を用いた取り組みでは現実的でなかった、将来の多数の上位プランナ改良を可能にします。
       </p></li><li class="listitem"><p>部分的な集約に対応しました。
(David Rowley, Simon Riggs)
       </p><p>本変更は、集約関数の計算を分割された部分に分けることを可能にし、それにより例えばパラレルワーカープロセスが一つの集約の計算を協力して実行できるようにします。
将来的には、ローカルとリモートのデータを横断した集約を部分的にリモート先で行うことが可能になるかもしれません。
       </p></li><li class="listitem"><p>汎用のコマンド進捗報告基盤を追加しました。
(Vinayak Pokale, Rahila Syed, Amit Langote, Robert Haas)
       </p></li><li class="listitem"><p>他のクライアントプログラムから使えるようにするため、<span class="application">psql</span>の<span class="application">flex</span>字句解析を分離しました。
(Tom Lane, Kyotaro Horiguchi)
       </p><p>これはコマンド境界を識別するSQLコマンド解析を要するプログラムからコード重複を排除します。
完全な普遍性をもってこれを行うことは望まれているものと比べ困難で、実際いまのところはサポートされるクライアントプログラムの中で<span class="application">psql</span>だけがうまく対応しました。
       </p><p>これと他のクライアントプログラム間で共有されるコードを置くため新たなソースコードのサブディレクトリ<code class="filename">src/fe_utils/</code>が作られました。
以前はこのような共有は、見苦しく重複したコンパイルを要する、シンボリックリンクやビルド時のソースファイルのコピーで実現されていました。
       </p></li><li class="listitem"><p>ある待機から次にたいてい変化しないイベントセットの効果的な待機を可能とする<code class="literal">WaitEventSet</code> <acronym class="acronym">API</acronym>を導入しました。
(Andres Freund, Amit Kapila)
       </p></li><li class="listitem"><p><acronym class="acronym">WAL</acronym>レコード書き込みの一般インタフェースを追加しました。
(Alexander Korotkov, Petr Jelínek, Markus Nullmeier)
       </p><p>本変更は拡張が標準レイアウトでページ変更の<acronym class="acronym">WAL</acronym>レコードを書くことを可能にします。
拡張にアクセスすることなく<acronym class="acronym">WAL</acronym>のリプレイを要する問題は、一般リプレイコードを持つことで解決されました。
これは例えばインデックスアクセスメソッドとその<acronym class="acronym">WAL</acronym>対応など、拡張での実装を可能にします。
       </p></li><li class="listitem"><p>ロジカルデコーディングの一般<acronym class="acronym">WAL</acronym>メッセージに対応しました。
(Petr Jelínek, Andres Freund)
       </p><p>この機能は拡張がロジカルデコーディングプラグインで読み取り可能なデータを<acronym class="acronym">WAL</acronym>ストリームに挿入できるようにしますが、物理データ再構築には関係しません。
       </p></li><li class="listitem"><p>SP-GiST演算子クラスがインデックスをたどるときに任意の<span class="quote">“<span class="quote">横断値</span>”</span>を置けるようにしました。
(Alexander Lebedev, Teodor Sigaev)
       </p><p>これは<span class="quote">“<span class="quote">再構築された値</span>”</span>に似たものですが、任意のデータチャンクにできて、インデックス列と同じデータ型の必要がありません。
       </p></li><li class="listitem"><p><code class="function">ereport()</code>に<code class="literal">LOG_SERVER_ONLY</code>メッセージレベルを導入しました。
(David Steele)
       </p><p>本レベルはメッセージが決してクライアントに送られない点を除き、<code class="literal">LOG</code>のように動作します。
これは監査等の用途で使う想定です。
       </p></li><li class="listitem"><p>全ての生成されるヘッダファイルをビルドする<code class="filename">Makefile</code>ターゲットを提供しました。
(Michael Paquier, Tom Lane)
       </p><p><code class="literal">submake-generated-headers</code>を実行して、バックエンドヘッダファイルを確実に最新状態にすることができます。
これは<span class="quote">“<span class="quote">スタンドアローン</span>”</span>でビルドされるサブディレクトリにおいて便利です。
       </p></li><li class="listitem"><p>OpenSSL 1.1.0に対応しました。
(Andreas Karlsson, Heikki Linnakangas)
       </p></li></ul></div></div><div class="sect3" id="id-1.11.6.21.5.15"><div class="titlepage"><div><div><h4 class="title">E.17.3.13. 追加モジュール</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="auto-explain.html" title="F.4. auto_explain"><code class="filename">contrib/auto_explain</code></a>で全問い合わせのうち設定可能な少量だけを採取できるようにする設定パラメータ<code class="literal">auto_explain.sample_rate</code>を追加しました。
(Craig Ringer, Julien Rouhaud)
       </p><p>これにより重い問い合わせ流量のオーバーヘッドが軽減できる一方、概してなお有用な情報を取得できます。
       </p></li><li class="listitem"><p>ブルームフィルタリングに基づくインデックスアクセスメソッドを実装した<a class="link" href="bloom.html" title="F.5. bloom"><code class="filename">contrib/bloom</code></a>モジュールを追加しました。
(Teodor Sigaev, Alexander Korotkov)
       </p><p>これは主として本体以外のインデックスアクセスメソッドの概念実証ですが、多数の列を検索する問い合わせに対するこのモジュール本来の能力が有用であるかもしれません。
       </p></li><li class="listitem"><p><a class="link" href="cube.html" title="F.10. cube"><code class="filename">contrib/cube</code></a>で立体の距離演算子を導入し、また、立体列のGiSTインデックスでkNN方式の検索に対応しました。
(Stas Kelvich)
       </p></li><li class="listitem"><p><code class="filename">contrib/hstore</code>の<a class="link" href="hstore.html#HSTORE-FUNC-TABLE" title="Table F.9. hstoreの関数"><code class="function">hstore_to_jsonb_loose()</code></a>および<code class="function">hstore_to_json_loose()</code>関数で何が数値であるかの認識を一致させました。
(Tom Lane)
       </p><p>これまで、<code class="function">hstore_to_jsonb_loose()</code>は、<acronym class="acronym">JSON</acronym>構文の数値の仕様に厳密に一致していなくとも、数値に見える文字列を文字列でなく<acronym class="acronym">JSON</acronym>数値に変換していました。
この動作は<code class="function">hstore_to_json_loose()</code>と一致せず、それで<acronym class="acronym">JSON</acronym>構文に合わせるように厳格化しました。
       </p></li><li class="listitem"><p><a class="link" href="intarray.html" title="F.19. intarray"><code class="filename">contrib/intarray</code></a>の演算子に、これら演算子を使ったプランを改善するため、選択度推定関数を追加しました。
(Yury Zhuravlev, Alexander Korotkov)
       </p></li><li class="listitem"><p><a class="link" href="pageinspect.html" title="F.23. pageinspect"><code class="filename">contrib/pageinspect</code></a>の<code class="function">heap_page_items()</code>関数が各タプルの生データを表示するようにしました。
また、各タプルフィールドを調べる新たな関数<code class="function">tuple_data_split()</code>および<code class="function">heap_page_item_attrs()</code>を追加しました。
(Nikolay Shaplov)
       </p></li><li class="listitem"><p><a class="link" href="pgcrypto.html" title="F.26. pgcrypto"><code class="filename">contrib/pgcrypto</code></a>の<code class="function">pgp_sym_encrypt()</code>関数にオプションとして<code class="literal">S2K</code>イテレーションカウントパラメータを追加しました。
(Jeff Janes)
       </p></li><li class="listitem"><p><a class="link" href="pgtrgm.html" title="F.32. pg_trgm"><code class="filename">contrib/pg_trgm</code></a>に<span class="quote">“<span class="quote">単語類似度</span>”</span>のサポートを加えました。
(Alexander Korotkov, Artur Zakirov)
       </p><p>これらの関数と演算子はある文字列と別の文字列の中のもっとも類似した一つの単語との類似度を測ります。
       </p></li><li class="listitem"><p><code class="filename">contrib/pg_trgm</code>の類似度の閾値を指定する設定パラメータ<code class="varname">pg_trgm.similarity_threshold</code>を追加しました。
(Artur Zakirov)
       </p><p>この閾値は以前から設定可能でしたが、これまでは専用の関数<code class="function">set_limit()</code>、<code class="function">show_limit()</code>で制御されていました。
これらは非推奨となります。
       </p></li><li class="listitem"><p>よくあるキーと稀なキーが両方現れる場合のインデックス検索の速度を上げるように<code class="filename">contrib/pg_trgm</code>のGIN演算子クラスを改善しました。
(Jeff Janes)
       </p></li><li class="listitem"><p><code class="filename">contrib/pg_trgm</code>のGINインデックスで類似度検索の性能を改善しました。
(Christophe Fornaroli)
       </p></li><li class="listitem"><p>テーブルの可視性マップを検査できる<a class="link" href="pgvisibility.html" title="F.33. pg_visibility"><code class="filename">contrib/pg_visibility</code></a>モジュールを追加しました。
(Robert Haas)
       </p></li><li class="listitem"><p><code class="filename">contrib/sslinfo</code>に<a class="link" href="sslinfo.html" title="F.38. sslinfo"><code class="function">ssl_extension_info()</code></a>関数を追加しました。
現在の接続に使われている<code class="literal">X509</code>証明書に含まれる<acronym class="acronym">SSL</acronym>拡張情報を出力します。
(Dmitry Voronin)
       </p></li></ul></div><div class="sect4" id="id-1.11.6.21.5.15.3"><div class="titlepage"><div><div><h5 class="title">E.17.3.13.1. <a class="link" href="postgres-fdw.html" title="F.34. postgres_fdw"><code class="filename">postgres_fdw</code></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>外部サーバのオプションでホワイトリストに含まれている拡張であれば、拡張で提供される演算子と関数をリモート実行に送れるようにしました。
(Paul Ramsey)
       </p><p>互換性のあるバージョンの拡張がリモートサーバに在るとき、ユーザはこの機能を有効にできます。
これは拡張の演算子を伴う問い合わせのより効果的な実行を可能にします。
       </p></li><li class="listitem"><p>リモートサーバ上でのソートを検討するようにしました。
(Ashutosh Bapat)
       </p></li><li class="listitem"><p>リモートサーバ上での結合を検討するようにしました。
(Shigeru Hanada, Ashutosh Bapat)
       </p></li><li class="listitem"><p>可能であれば<code class="command">UPDATE</code>や<code class="command">DELETE</code>を全面的にリモートサーバ上で実行するようにしました。
(Etsuro Fujita)
       </p><p>これまではリモート更新は<code class="command">SELECT FOR UPDATE</code>コマンドの送信とその後の選択された行の一行ずつの更新や削除を伴いました。
問い合わせのすべての要素がリモートサーバに送って差し支えないならリモートで実行できるようになりますが、一方で演算が何等かローカル処理を必要とするならこの動作はなお必要です。
       </p></li><li class="listitem"><p>取り出しサイズをサーバやテーブルのオプションとして設定可能にしました。
(Corey Huinker)
       </p><p>これまでは<code class="filename">postgres_fdw</code>は常にリモート問い合わせから一度に100行を取り出ししていました。この動作が調整可能になりました。
       </p></li><li class="listitem"><p>全て同じリモートユーザにマップしている複数ローカルユーザIDが単一の外部サーバ接続を使うようにしました。
(Ashutosh Bapat)
       </p></li><li class="listitem"><p>リモートサーバに問い合わせキャンセル要求を伝播するようにしました。
(Michael Paquier, Etsuro Fujita)
       </p><p>これまでは、ローカル問い合わせのキャンセル要求は送信済みのリモート問い合わせを早く終了させませんでした。
       </p></li></ul></div></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-9-6-1.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-9-5-14.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.16. リリース9.6.1 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.18. Release 9.5.14</td></tr></table></div></body></html>