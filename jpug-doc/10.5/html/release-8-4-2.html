<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.172. リリース8.4.2</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-8-4-3.html" title="E.171. リリース8.4.3" /><link rel="next" href="release-8-4-1.html" title="E.173. リリース8.4.1" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.172. リリース8.4.2</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-8-4-3.html" title="E.171. リリース8.4.3">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-8-4-1.html" title="E.173. リリース8.4.1">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-8-4-2"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.172. リリース8.4.2</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-8-4-2.html#id-1.11.6.176.4">E.172.1. バージョン8.4.2への移行</a></span></dt><dt><span class="sect2"><a href="release-8-4-2.html#id-1.11.6.176.5">E.172.2. 変更点</a></span></dt></dl></div><p><strong>リリース日: </strong>2009-12-14</p><p>このリリースは8.4.1に対し、各種の不具合を修正したものです。
8.4メジャーリリースにおける新機能については<a class="xref" href="release-8-4.html" title="E.174. リリース8.4">Section E.174</a>を参照してください。
  </p><div class="sect2" id="id-1.11.6.176.4"><div class="titlepage"><div><div><h3 class="title">E.172.1. バージョン8.4.2への移行</h3></div></div></div><p>8.4.Xからの移行ではダンプ/リストアは不要です。
しかしながら、ハッシュインデックスが存在する場合、8.4.2に移行した後に、破損している可能性があるためそれを修復するために<code class="command">REINDEX</code>を行わなければなりません。
   </p></div><div class="sect2" id="id-1.11.6.176.5"><div class="titlepage"><div><div><h3 class="title">E.172.2. 変更点</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>セッション固有の状態を変更するインデックス関数により引き起こされる間接的なセキュリティ脅威から保護します。(Gurjeet Singh、Tom)
     </p><p>この変更により不変インデックス関数がスーパーユーザのセッションを破壊できることを防ぎます。(CVE-2009-4136)
     </p></li><li class="listitem"><p>ヌルバイトが埋め込まれたコモンネーム（CN）フィールドをもつSSL証明書を拒絶します。(Magnus)
     </p><p>これは、SSL検証においてサーバまたはクライアント名に対する証明書が不正に一致しないようにします。(CVE-2009-4034)
     </p></li><li class="listitem"><p>ハッシュインデックス破損を修正しました。 (Tom)
     </p><p>8.4では、ハッシュインデックスはハッシュ値でソートして項目を保持するように変更されましたが、順序を保持するためにバケット分割および圧縮処理の更新に失敗します。
このためこうした操作を行うアプリケーションは、永続的なインデックスの破損をもたらす可能性がありました。
これをうまく扱うためには、更新をインストールした後にハッシュインデックスすべてを<code class="literal">REINDEX</code>することを推奨します。
     </p></li><li class="listitem"><p>バックエンド起動時のキャッシュ初期化の間でクラッシュする可能性を修正しました。(Tom)
     </p></li><li class="listitem"><p>空のシソーラス辞書におけるクラッシュを防止しました。(Tom)
     </p></li><li class="listitem"><p>安全ではない時点での<code class="literal">VACUUM</code>を中断するシグナルを防止します。 (Alvaro)
     </p><p>この修正により、<code class="literal">VACUUM FULL</code>がすでにタプルの移動をコミットした後にキャンセルされた場合のパニックや、通常の<code class="literal">VACUUM</code>がテーブルを切り詰めた後に割り込みを受けた場合の一時的なエラーを防止します。
     </p></li><li class="listitem"><p>ハッシュテーブルサイズの計算における整数オーバーフローによるクラッシュの可能性を修正しました。(Tom)
     </p><p>これは、ハッシュ結合の結果のプランナの推定サイズが極端に大きい場合に発生することがありました。
     </p></li><li class="listitem"><p>内部的な依存関係をもつオブジェクトに対する <code class="literal">DROP</code>が試行された場合のクラッシュを修正しました。(Tom)
     </p></li><li class="listitem"><p><code class="type">inet</code>/<code class="type">cidr</code>の比較における非常にまれなクラッシュを修正しました。 (Chris Mikkelson)
     </p></li><li class="listitem"><p>準備されたトランザクションで保持されるタプルレベルの共有ロックを確実に無視しないようにしました。 (Heikki)
     </p></li><li class="listitem"><p>副トランザクション内でアクセスされるカーソルで使用される一時ファイルの早すぎる削除を修正しました。 (Heikki)
     </p></li><li class="listitem"><p>新しいCSVログファイルに変更する時のsysloggerプロセスのメモリリークを修正しました。(Tom)
     </p></li><li class="listitem"><p><code class="filename">pg_hba.conf</code>の再解析時のpostmasterのメモリリークを修正しました。(Tom)
     </p></li><li class="listitem"><p>Windowsにおける権限ダウングレードロジックを修正しました。(Jesse Morris)
     </p><p>これは、Windowsにおいて<span class="quote">“<span class="quote">could not locate matching postgres executable</span>”</span>といった誤解を招くエラーメッセージでよくデータベースの起動が失敗する状況の一部を修正します。

     </p></li><li class="listitem"><p>主問い合わせにおける<code class="literal">FOR UPDATE/SHARE</code>が <code class="literal">WITH</code>問い合わせに伝搬されないようにしました。(Tom)
     </p><p>たとえば
</p><pre class="programlisting">WITH w AS (SELECT * FROM foo) SELECT * FROM w, bar ... FOR UPDATE</pre><p>
では、<code class="literal">FOR UPDATE</code>は<code class="literal">bar</code>に影響し、 <code class="literal">foo</code>には影響しなくなります。
これは、以前の8.4の動作より有用かつ一貫性があります。
以前は<code class="literal">FOR UPDATE</code>を<code class="literal">WITH</code>まで伝搬させようとし、常に雑多な実装上の制限により失敗していました。
また、<code class="literal">WITH</code>問い合わせは主問い合わせと独立して実行されるという設計規則にも従います。
     </p></li><li class="listitem"><p>そのすぐ内側に別の<code class="literal">WITH RECURSIVE</code>を持つ<code class="literal">WITH RECURSIVE</code>問い合わせの不具合を修正しました。 (Tom)
     </p></li><li class="listitem"><p>ハッシュインデックスにおける同時実行性に関する不具合を修正しました。(Tom)
     </p><p>同時実行の挿入によりインデックス走査が一時的に間違った結果を報告することがありました。
     </p></li><li class="listitem"><p>GiSTインデックスページ分割において、分割がインデックスの最初の列以外に依存する場合の不正なロジックを修正しました。(Paul Ramsey)
     </p></li><li class="listitem"><p><code class="literal">fastupdate</code>が有効な場合、複数列に対するGINインデックスの検索結果が不正となる点を修正しました。(Teodor)
     </p></li><li class="listitem"><p>GINインデックスにおけるWAL項目の生成における不具合を修正しました。(Tom)
     </p><p>これらの不具合は、 <code class="varname">full_page_writes</code>が有効な場合は現れることはありませんが、無効にした場合、次のチェックポイント以前にクラッシュが起きた場合、WAL再生は確実に失敗しました。
     </p></li><li class="listitem"><p>チェックポイントの最後で古いWALファイルの回収や削除が失敗した場合にエラーを出力しません。(Heikki)
     </p><p>致命的ではないものと扱い、チェックポイントを完了させることができるようにする方が優れています。
将来のチェックポイントでは削除を再試行します。
こうした問題は通常の操作では想定されませんが、うまく設計されていないWindowsのアンチウィルスソフトウェアやバックアップソフトウェアにより現れることがあります。
     </p></li><li class="listitem"><p>WindowsにおいてWALファイルが繰り返しアーカイブされないようにしました。 (Heikki)
     </p><p>別の症状として、一部の他のプロセスが不要となったファイルの削除に干渉する場合にも発生します。
     </p></li><li class="listitem"><p>PAMパスワード処理をより堅牢に修正しました。(Tom)
     </p><p>以前のコードでは、Linuxの<code class="literal">pam_krb5</code> PAMモジュールとドメインコントローラとしてのMicrosoft Active Directoryを組み合わせると失敗することが知られていました。
PAMスタックに渡される引数に関する正当ではない仮定を作成することであるため、どこかで問題になるかもしれません。
     </p></li><li class="listitem"><p>GSSAPIおよびSSPI認証方式における認証トークン（Kerberosチケット）の最大サイズを上げました。(Ian Turner)
     </p><p>以前の2000バイトという制限はUnix Kerberosの実装では十分でしたが、Windowsドメインコントローラで発行されるチケットではより大きくなることがあります。
     </p></li><li class="listitem"><p>ドメインが配列型を管理する場合、ドメイン制約が<code class="literal">ARRAY[...]::domain</code>のような式として確実に強制されるようにしました。 (Heikki)
     </p></li><li class="listitem"><p>複合型の列を外部キーとして含む一部の場合における外部キーのロジックを修正しました。 (Tom)
     </p></li><li class="listitem"><p>カーソルのスナップショットが生成後、確実に変更されないようにしました。(Alvaro)
     </p><p>これは、同じトランザクション内で後の操作が、そのカーソルが返すものと想定するデータを変更する場合、カーソルが間違った結果をもたらすようになります。
     </p></li><li class="listitem"><p><code class="literal">CREATE TABLE</code>が別の継承する親テーブル由来のデフォルト式を適切にマージするように修正しました。(Tom)
     </p><p>これは動作していましたが、8.4では壊れていました。
     </p></li><li class="listitem"><p>シーケンスのアクセス統計情報の収集を再度有効にしました。 (Akira Kurosawa)
     </p><p>これは動作していましたが、8.3では壊れていました。
     </p></li><li class="listitem"><p><code class="literal">CREATE OR REPLACE FUNCTION</code>における所有権限の依存関係の処理を修正しました。(Tom)
     </p></li><li class="listitem"><p><code class="literal">WHERE</code> <em class="replaceable"><code>x</code></em>=<em class="replaceable"><code>x</code></em>条件の不正な処理を修正しました。(Tom)
     </p><p>一部の場合、これらは冗長なものとして無視されることがありましたが、そうではありません。
— これらは<em class="replaceable"><code>x</code></em> <code class="literal">IS NOT NULL</code>と等価です。
     </p></li><li class="listitem"><p>テキスト等価性に関する揮発式においてハッシュ集約を使用して<code class="literal">DISTINCT</code>を実装する場合における不正な計画生成を修正しました。(Tom)
     </p></li><li class="listitem"><p>揮発<code class="literal">SELECT DISTINCT ON</code>式におけるアサート失敗を修正しました。(Tom)
     </p></li><li class="listitem"><p>空の<code class="type">tsvector</code>値に対して<code class="function">ts_stat()</code>が失敗しないように改修しました。 (Tom)
     </p></li><li class="listitem"><p>全文検索パーサがXML属性内のアンダースコアを受け付けるようにしました。(Peter)
     </p></li><li class="listitem"><p><code class="type">xml</code>バイナリ入力における符号化方式の扱いを修正しました。(Heikki)
     </p><p>XMLヘッダにて符号化方式の指定がない場合、デフォルトでUTF-8を仮定するようになります。
以前の扱いには一貫性がありませんでした。
     </p></li><li class="listitem"><p><code class="literal">plperlu</code>から<code class="literal">plperl</code>の呼び出し、またはその逆における不具合を修正しました。(Tom)
     </p><p>内部の関数からのエラー終了が、外側の関数用のPerlインタプリタを正しく再選択できずにクラッシュをもたらす可能性がありました。
     </p></li><li class="listitem"><p>PL/Perl関数が再定義された時のセッション有効期間のメモリリークを修正しました。(Tom)
     </p></li><li class="listitem"><p>集合を返すPL/Perl関数により返される場合Perl配列が適切に<span class="productname">PostgreSQL</span>配列に返還されることを確実にしました。(Andrew Dunstan、Abhijit Menon-Sen)
     </p><p>集合以外を返す関数ではすでに正しく動作しました。
     </p></li><li class="listitem"><p>PL/Pythonの例外処理におけるまれなクラッシュを修正しました。(Peter)
     </p></li><li class="listitem"><p><code class="literal">DECLARE CURSOR</code>文におけるコメントに関する<span class="application">ecpg</span>問題を修正しました。(Michael)
     </p></li><li class="listitem"><p><span class="application">ecpg</span>が最近追加されたキーワードを予約語と扱わない問題を修正しました。(Tom)
     </p><p>これは、<code class="literal">CALLED</code>、<code class="literal">CATALOG</code>、<code class="literal">DEFINER</code>、<code class="literal">ENUM</code>、<code class="literal">FOLLOWING</code>、<code class="literal">INVOKER</code>、<code class="literal">OPTIONS</code>、<code class="literal">PARTITION</code>、<code class="literal">PRECEDING</code>、<code class="literal">RANGE</code>、<code class="literal">SECURITY</code>、<code class="literal">SERVER</code>、<code class="literal">UNBOUNDED</code>、<code class="literal">WRAPPER</code>キーワードに影響します。
     </p></li><li class="listitem"><p><span class="application">psql</span>の<code class="literal">\df</code>関数名パラメータにおいて正規表現特殊文字を再度許します。(Tom)
     </p></li><li class="listitem"><p><code class="filename">contrib/fuzzystrmatch</code>において、デフォルト以外のコストによる<code class="function">levenshtein</code>距離の計算を正しくしました。(Marcin Mank)
     </p></li><li class="listitem"><p><code class="filename">contrib/pg_standby</code>にて、Windowsのシグナルを使用したフェイルオーバの通知を無効にしました。(Fujii Masao)
     </p><p>WindowsではUnixのようなシグナルを持ちませんので、これはまったく役に立っていませんでした。
さらに最近の変更により実際にクラッシュしてしまいます。
     </p></li><li class="listitem"><p><code class="literal">FREEZE</code>および<code class="literal">VERBOSE</code>オプションを<code class="filename">contrib/vacuumdb</code>が生成する<code class="literal">VACUUM</code>コマンドの右側につけました。(Heikki)
     </p></li><li class="listitem"><p><code class="filename">contrib/dblink</code>がエラーになった場合の接続が漏えいする可能性を修正しました。(Tatsuhito Kasahara)
     </p></li><li class="listitem"><p><span class="application">psql</span>のflexモジュールが正しいシステムヘッダファイルを使用してコンパイルされることを確実にしました。(Tom)
     </p><p>これは、<code class="literal">--enable-largefile</code>が生成されたコード内に非互換の変更を引き起こすプラットフォームにおける構築失敗を修正します。
     </p></li><li class="listitem"><p>今後のバージョンのlibpqとの互換性を高めるために、postmasterが接続要求パケットにおける<code class="literal">application_name</code>パラメータをすべて無視するようにしました。(Tom)
     </p></li><li class="listitem"><p>最新の現実に合うように時間帯省略形ファイルを更新しました。(Joachim Wieland)
     </p><p>デフォルト時間帯群に<code class="literal">IDT</code>の追加が含まれます。
     </p></li><li class="listitem"><p>タイムゾーンデータファイルを<span class="application">tzdata</span> release 2009sまで更新しました。
南極、アルゼンチン、バングラデシュ、フィジー、ノヴォクズネツク、パキスタン、パレスチナ、サモア、シリアにおける夏時間規則の変更、および香港に関する歴史的な修正が含まれます。
     </p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-8-4-3.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-8-4-1.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.171. リリース8.4.3 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.173. リリース8.4.1</td></tr></table></div></body></html>