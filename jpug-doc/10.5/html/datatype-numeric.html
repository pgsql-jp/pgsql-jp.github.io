<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.1. 数値データ型</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="datatype.html" title="Chapter 8. データ型" /><link rel="next" href="datatype-money.html" title="8.2. 通貨型" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.1. 数値データ型</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype.html" title="Chapter 8. データ型">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="Chapter 8. データ型">Up</a></td><th width="60%" align="center">Chapter 8. データ型</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-money.html" title="8.2. 通貨型">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="DATATYPE-NUMERIC"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.1. 数値データ型</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-INT">8.1.1. 整数データ型</a></span></dt><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-NUMERIC-DECIMAL">8.1.2. 任意の精度を持つ数</a></span></dt><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-FLOAT">8.1.3. 浮動小数点データ型</a></span></dt><dt><span class="sect2"><a href="datatype-numeric.html#DATATYPE-SERIAL">8.1.4. 連番型</a></span></dt></dl></div><a id="id-1.5.7.9.2" class="indexterm"></a><p>数値データ型には2、4、8バイト整数と、4、8バイト浮動小数点および精度設定が可能な数があります。
<a class="xref" href="datatype-numeric.html#DATATYPE-NUMERIC-TABLE" title="Table 8.2. 数値データ型">Table 8.2</a>に使用可能な型を列挙します。
   </p><div class="table" id="DATATYPE-NUMERIC-TABLE"><p class="title"><strong>Table 8.2. 数値データ型</strong></p><div class="table-contents"><table class="table" summary="数値データ型" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>型名</th><th>格納サイズ</th><th>説明</th><th>範囲</th></tr></thead><tbody><tr><td><code class="type">smallint</code></td><td>2バイト</td><td>狭範囲の整数</td><td>-32768から+32767</td></tr><tr><td><code class="type">integer</code></td><td>4バイト</td><td>典型的に使用する整数</td><td>-2147483648から+2147483647</td></tr><tr><td><code class="type">bigint</code></td><td>8バイト</td><td>広範囲整数</td><td>-9223372036854775808から+9223372036854775807</td></tr><tr><td><code class="type">decimal</code></td><td>可変長</td><td>ユーザ指定精度、正確</td><td>小数点より上は131072桁まで、小数点より下は16383桁まで</td></tr><tr><td><code class="type">numeric</code></td><td>可変長</td><td>ユーザ指定精度、正確</td><td>小数点より上は131072桁まで、小数点より下は16383桁まで</td></tr><tr><td><code class="type">real</code></td><td>4バイト</td><td>可変精度、不正確</td><td>6桁精度</td></tr><tr><td><code class="type">double precision</code></td><td>8バイト</td><td>可変精度、不正確</td><td>15桁精度</td></tr><tr><td><code class="type">smallserial</code></td><td>2バイト</td><td>狭範囲自動整数</td><td>1から32767</td></tr><tr><td><code class="type">serial</code></td><td>4バイト</td><td>自動増分整数</td><td>1から2147483647</td></tr><tr><td><code class="type">bigserial</code></td><td>8バイト</td><td>広範囲自動増分整数</td><td>1から9223372036854775807</td></tr></tbody></table></div></div><br class="table-break" /><p>数値データ型に対する定数の構文は<a class="xref" href="sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS" title="4.1.2. 定数">Section 4.1.2</a>で説明しています。
数値データ型には対応する算術演算子と関数の一式が揃っています。
詳細は<a class="xref" href="functions.html" title="Chapter 9. 関数と演算子">Chapter 9</a>を参照してください。
次節でデータ型について詳しく説明します。
   </p><div class="sect2" id="DATATYPE-INT"><div class="titlepage"><div><div><h3 class="title">8.1.1. 整数データ型</h3></div></div></div><a id="id-1.5.7.9.6.2" class="indexterm"></a><a id="id-1.5.7.9.6.3" class="indexterm"></a><a id="id-1.5.7.9.6.4" class="indexterm"></a><a id="id-1.5.7.9.6.5" class="indexterm"></a><a id="id-1.5.7.9.6.6" class="indexterm"></a><a id="id-1.5.7.9.6.7" class="indexterm"></a><p><code class="type">smallint</code>、<code class="type">integer</code>、<code class="type">bigint</code>は各種範囲の整数、つまり小数点以下の端数がない数を保持します。
許容範囲から外れた値を保存しようとするとエラーになります。
    </p><p><code class="type">integer</code>型は数値の範囲、格納サイズおよび性能において最も釣合いが取れていますので、一般的に使用されます。
<code class="type">smallint</code>型は通常はディスク容量に制限が付いている場合にのみ使用します。
<code class="type">bigint</code>型は<code class="type">integer</code>の許容範囲では十分ではない場合に使用されるよう設計されています。
    </p><p><acronym class="acronym">SQL</acronym>では整数の型として<code class="type">integer</code>（または<code class="type">int</code>）と<code class="type">smallint</code>、<code class="type">bigint</code>のみを規定しています。
<code class="type">int2</code>、<code class="type">int4</code>および<code class="type">int8</code>は拡張ですが、いくつか他の<acronym class="acronym">SQL</acronym>データベースシステムでも使われています。
    </p></div><div class="sect2" id="DATATYPE-NUMERIC-DECIMAL"><div class="titlepage"><div><div><h3 class="title">8.1.2. 任意の精度を持つ数</h3></div></div></div><a id="id-1.5.7.9.7.2" class="indexterm"></a><a id="id-1.5.7.9.7.3" class="indexterm"></a><a id="id-1.5.7.9.7.4" class="indexterm"></a><p><code class="type">numeric</code>型は、非常に大きな桁数で数値を格納できます。
通貨金額やその他正確性が求められる数量を保存する時は特に、この型を推奨します。
<code class="type">numeric</code>の値での計算は、可能なところ、例えば、足し算、引算、掛け算では、正確な結果（訳注：10進の小数で誤差が生じない、ということ）になります。
とは言っても、<code class="type">numeric</code>の値に対する計算は整数型、もしくは次節で説明する浮動小数点データ型に比較し非常に遅くなります。
    </p><p>この後の説明では、次の用語を使用します。
<code class="type">numeric</code>の<em class="firstterm">位取り</em>とは、小数点の右側の小数部分の桁数をいいます。
<code class="type">numeric</code>の<em class="firstterm">精度</em>とは数字全体の有効桁数です。
すなわち、小数点をはさんでいる両側の桁数の合計です。
そのため、23.5141という数値の精度は6で位取りは4となります。
整数の位取りは、ゼロであるとみなすことができます。
    </p><p><code class="type">numeric</code>列の数値の最大精度と最大位取りの両方を設定することができます。
<code class="type">numeric</code>型の列を宣言するには次の構文を使います。
</p><pre class="programlisting">NUMERIC(<em class="replaceable"><code>precision</code></em>, <em class="replaceable"><code>scale</code></em>)</pre><p>
精度は正数、位取りは0もしくは正数でなければなりません。
他の記述方法として、
</p><pre class="programlisting">NUMERIC(<em class="replaceable"><code>precision</code></em>)</pre><p>
は位取りが0であることを選択します。
精度も位取りも指定せず、
</p><pre class="programlisting">NUMERIC</pre><p>
と記述すると、実装されている限界の精度まで、いかなる精度あるいは位取りの値も格納できる列が作られます。
この類の列は入力値をいかなる特定の位取りにも変換しませんが、宣言された位取りを持つ<code class="type">numeric</code>列は入力値をその位取りに変換します。
（標準<acronym class="acronym">SQL</acronym>はデフォルトとして位取り0を要求していて、つまり、整数の精度に変換されます。
しかし、この方法はあまり役に立たないと思われます。
もし移植性を心配するなら、常に精度と位取りを明示的に設定してください。）
    </p><div class="note"><h3 class="title">Note</h3><p>明示的に型宣言で指定される場合に許される最大精度は1000です。
精度の指定がない<code class="type">NUMERIC</code>は<a class="xref" href="datatype-numeric.html#DATATYPE-NUMERIC-TABLE" title="Table 8.2. 数値データ型">Table 8.2</a>で説明する制限に従います。
     </p></div><p>格納される値の位取りが宣言された列の位取りより大きかった場合、システムは指定された小数部の桁まで値を丸めます。
そして、小数点の左側の桁数が、宣言された精度から宣言された位取りを差し引いた数を超える場合にエラーとなります。
    </p><p>数値は物理的に先頭や末尾に0を付与されることなく格納されます。
したがって、列の宣言された精度と位取りは最大であり、固定的に割り当てられていません。
（この意味では<code class="type">numeric</code>は<code class="type">char(<em class="replaceable"><code>n</code></em>)</code>よりも<code class="type">varchar(<em class="replaceable"><code>n</code></em>)</code>に似ています。）
実際の格納に必要な容量は、10進数4桁のそれぞれのグループに対して2バイトと、3から8バイトのオーバヘッドです。
    </p><a id="id-1.5.7.9.7.11" class="indexterm"></a><a id="id-1.5.7.9.7.12" class="indexterm"></a><p>通常の数値に加え、<code class="type">numeric</code>型は、<span class="quote">“<span class="quote">非数値</span>”</span>を意味する<code class="literal">NaN</code>という特別な値を取ることができます。
<code class="literal">NaN</code>に対する操作はすべて、別の<code class="literal">NaN</code>を生成します。
この値をSQLコマンドの定数として記述する場合は、例えば<code class="literal">UPDATE table SET x = 'NaN'</code>のように、引用符でくくらなければなりません。
入力の際は、<code class="literal">NaN</code>という文字列は大文字小文字の区別なく認識されます。
    </p><div class="note"><h3 class="title">Note</h3><p>ほとんどの<span class="quote">“<span class="quote">非数</span>”</span>の概念の実装において、<code class="literal">NaN</code>は（<code class="literal">NaN</code>を含む）他の数値と等価にならないとみなされています。
<code class="type">numeric</code>値をソートできる、また、ツリーを基にしたインデックスで使用できるように、<span class="productname">PostgreSQL</span>は<code class="literal">NaN</code>同士は等しく、すべての<code class="literal">NaN</code>以外の値よりも大きな値となるものとして扱います。
     </p></div><p><code class="type">decimal</code>と<code class="type">numeric</code>型は等価です。
2つのデータ型はともに標準<acronym class="acronym">SQL</acronym>に含まれます。
    </p><p>値を丸める際、<code class="type">numeric</code>型は0から離れるように丸めますが、一方で（ほとんどのマシンでは）<code class="type">real</code>や<code class="type">double precision</code>型ではその値に最も近い偶数に丸めます。
以下に例を示します。:

</p><pre class="programlisting">SELECT x,
  round(x::numeric) AS num_round,
  round(x::double precision) AS dbl_round
FROM generate_series(-3.5, 3.5, 1) as x;
  x   | num_round | dbl_round
------+-----------+-----------
 -3.5 |        -4 |        -4
 -2.5 |        -3 |        -2
 -1.5 |        -2 |        -2
 -0.5 |        -1 |        -0
  0.5 |         1 |         0
  1.5 |         2 |         2
  2.5 |         3 |         2
  3.5 |         4 |         4
(8 rows)</pre><p>
    </p></div><div class="sect2" id="DATATYPE-FLOAT"><div class="titlepage"><div><div><h3 class="title">8.1.3. 浮動小数点データ型</h3></div></div></div><a id="id-1.5.7.9.8.2" class="indexterm"></a><a id="id-1.5.7.9.8.3" class="indexterm"></a><a id="id-1.5.7.9.8.4" class="indexterm"></a><a id="id-1.5.7.9.8.5" class="indexterm"></a><a id="id-1.5.7.9.8.6" class="indexterm"></a><p><code class="type">real</code>と<code class="type">double precision</code>は不正確な（訳注：10進の小数で誤差が生じる、ということ）可変精度の数値データ型です。
実際にはこれらのデータ型は、使用しているプロセッサ、オペレーティングシステムおよびコンパイラがサポートしていれば、通常は（それぞれ単精度および倍精度の）バイナリ浮動小数点演算用の<acronym class="acronym">IEEE</acronym>規格754の実装です。
    </p><p>不正確というのは、ある値はそのままで内部形式に変換されずに近似値として保存されるということです。
ですから、保存しようとする値と抽出しようとする値の間に多少の差異が認められます。
これらのエラーを管理し計算によって補正をどうするかについては、数学とコンピュータ科学の系統すべてに関わることで、以下の点を除き触れません。
     </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>（金銭金額など）正確な記録と計算が必要な時は代わりに<code class="type">numeric</code>を使用してください。
       </p></li><li class="listitem"><p>これらのデータ型で何か重要な件に対し複雑な計算を必要とする時、特に（無限大やアンダーフローのような）境界線におけるある種の振舞いについて信頼を置かなければならないのであれば、実装を注意深く検証しなければなりません。
       </p></li><li class="listitem"><p>2つの浮動小数点値が等価であるのかどうかの比較は予想通りに行かない時もあります。
       </p></li></ul></div><p>
    </p><p>ほとんどのプラットフォームでは<code class="type">real</code>は最低6桁の精度を持ち、少なくとも1E-37から1E+37までの範囲です。
<code class="type">double precision</code>は通常最低15桁の精度でおよそ1E-307から1E+308までの範囲です。
大き過ぎたり小さ過ぎる値はエラーの原因となります。
入力値の精度が高過ぎる場合は丸められることがあります。
ゼロに限りなく近い値で、しかもゼロと異なる値として表現できない数値はアンダーフローエラーを引き起こします。
    </p><div class="note"><h3 class="title">Note</h3><p>浮動小数点を含む値が出力用のテキストに変換される場合、<a class="xref" href="runtime-config-client.html#GUC-EXTRA-FLOAT-DIGITS">extra_float_digits</a>によって有効数字を制御します。
デフォルト値の<code class="literal">0</code>が指定されている場合、出力はPostgreSQLをサポートする全てのプラットフォームで同じです。
この値を大きくすることで格納された値をより精密に表現できますが、プラットフォーム間の移植性が失われるかもしれません。
     </p></div><a id="id-1.5.7.9.8.11" class="indexterm"></a><p>通常の数値に加え、浮動小数点型では以下の特殊な値を取ります。
</p><div class="literallayout"><p><code class="literal">Infinity</code><br />
<code class="literal">-Infinity</code><br />
<code class="literal">NaN</code></p></div><p>
これらはそれぞれ、IEEE 754の特殊な値、<span class="quote">“<span class="quote">無限大</span>”</span>、<span class="quote">“<span class="quote">負の無限大</span>”</span>、<span class="quote">“<span class="quote">非数値</span>”</span>を表します。
（浮動小数点計算がIEEE 754に従わないマシンでは、これらの値はおそらく正しく動作しません。）
これらの値をSQLコマンドの定数として記述する場合、例えば<code class="literal">UPDATE table SET x = '-Infinity'</code>のように引用符でくくる必要があります。
入力の際、これらの文字列は大文字小文字の区別なく認識されます。
    </p><div class="note"><h3 class="title">Note</h3><p>IEEE754では、<code class="literal">NaN</code>は（<code class="literal">NaN</code>を含む）他のすべての浮動小数点値と比べた時に不等でなければならないと規定しています。
浮動小数点値をソートできる、また、ツリーを基にしたインデックスで使用できるように、<span class="productname">PostgreSQL</span>は<code class="literal">NaN</code>同士は等しく、すべての<code class="literal">NaN</code>以外の値よりも大きな値となるものとして扱います。
     </p></div><p>また、<span class="productname">PostgreSQL</span>では不正確な数値型についての標準SQLの表記である<code class="type">float</code>と<code class="type">float(<em class="replaceable"><code>p</code></em>)</code>をサポートしています。
ここで、<em class="replaceable"><code>p</code></em>は<span class="emphasis"><em>2進数</em></span>桁数で最低限、許容可能な精度を指定します。
<span class="productname">PostgreSQL</span>は<code class="type">float(1)</code>から<code class="type">float(24)</code>を<code class="type">real</code>を選択するものとして受け付け、<code class="type">float(25)</code>から<code class="type">float(53)</code>を<code class="type">double precision</code>を選択するものとして受け付けます。
許容範囲外の<em class="replaceable"><code>p</code></em>の値はエラーになります。
精度指定のない<code class="type">float</code>は<code class="type">double precision</code>として解釈されます。
    </p><div class="note"><h3 class="title">Note</h3><p><code class="type">real</code>と<code class="type">double precision</code>の仮数がそれぞれ24ビットと53ビットであるという前提は、IEEE標準浮動小数点の実装では正しいものです。
非IEEEのプラットフォームでは、若干、異なる可能性がありますが、単純化のためにすべてのプラットフォームで<em class="replaceable"><code>p</code></em>の範囲は同一です。
     </p></div></div><div class="sect2" id="DATATYPE-SERIAL"><div class="titlepage"><div><div><h3 class="title">8.1.4. 連番型</h3></div></div></div><a id="id-1.5.7.9.9.2" class="indexterm"></a><a id="id-1.5.7.9.9.3" class="indexterm"></a><a id="id-1.5.7.9.9.4" class="indexterm"></a><a id="id-1.5.7.9.9.5" class="indexterm"></a><a id="id-1.5.7.9.9.6" class="indexterm"></a><a id="id-1.5.7.9.9.7" class="indexterm"></a><a id="id-1.5.7.9.9.8" class="indexterm"></a><a id="id-1.5.7.9.9.9" class="indexterm"></a><div class="note"><h3 class="title">Note</h3><p>このセクションではPostgreSQL固有の自動増分列の作成方法について記述します。
SQL標準の識別列を作成する方法は、<a class="xref" href="sql-createtable.html" title="CREATE TABLE"><span class="refentrytitle">CREATE TABLE</span></a>に記述されています。
     </p></div><p><code class="type">smallserial</code>、<code class="type">serial</code>および<code class="type">bigserial</code>データ型は正確にはデータ型ではなく、テーブルの列に一意の識別子を作成する簡便な表記法です
（他のデータベースでサポートされる<code class="literal">AUTO_INCREMENT</code>プロパティに似ています）。
現在の実装では、

</p><pre class="programlisting">CREATE TABLE <em class="replaceable"><code>tablename</code></em> (
    <em class="replaceable"><code>colname</code></em> SERIAL
);</pre><p>

は以下を指定することと同じです。

</p><pre class="programlisting">CREATE SEQUENCE <em class="replaceable"><code>tablename</code></em>_<em class="replaceable"><code>colname</code></em>_seq;
CREATE TABLE <em class="replaceable"><code>tablename</code></em> (
    <em class="replaceable"><code>colname</code></em> integer NOT NULL DEFAULT nextval('<em class="replaceable"><code>tablename</code></em>_<em class="replaceable"><code>colname</code></em>_seq')
);
ALTER SEQUENCE <em class="replaceable"><code>tablename</code></em>_<em class="replaceable"><code>colname</code></em>_seq OWNED BY <em class="replaceable"><code>tablename</code></em>.<em class="replaceable"><code>colname</code></em>;</pre><p>

このように整数列を作成し、その列のデフォルト値が連番ジェネレータから割り当てられるようにしました。
また、<code class="literal">NOT NULL</code>制約を適用することによって、NULL値が挿入されないようにします。
（たいていの場合は、重複する値を間違って挿入しないように、<code class="literal">UNIQUE</code>制約または<code class="literal">PRIMARY KEY</code>制約も追加することになるでしょうが、これは自動的には行われません。）
最後に、シーケンスは列に<span class="quote">“<span class="quote">より所有</span>”</span>されるものと印が付きます。
したがって、テーブルの列が削除された場合にシーケンスは削除されます。
    </p><div class="note"><h3 class="title">Note</h3><p><code class="type">smallserial</code>、 <code class="type">serial</code>および<code class="type">bigserial</code>はシーケンスを使って実装されているため、行の削除が行われていなくとも、列に"穴"や連番の抜けが発生するかもしれません。また、テーブルへ正常に挿入されていないにも関わらず、シーケンスの値を"消費してしまう"こともあります。これは、例えば挿入したトランザクションがロールバックされた時に発生することがあります。詳細は<a class="xref" href="functions-sequence.html" title="9.16. シーケンス操作関数">Section 9.16</a>の<code class="literal">nextval()</code>を参照してください。
      </p></div><p><code class="type">serial</code>列にシーケンスの次の値を挿入するには、<code class="type">serial</code>列にそのデフォルト値を割り当てるよう指定してください。
これは、<code class="command">INSERT</code>文の列リストからその列を除外する、もしくは<code class="literal">DEFAULT</code>キーワードを使用することで行うことができます。
    </p><p><code class="type">serial</code>と<code class="type">serial4</code>という型の名称は等価です。
ともに<code class="type">integer</code>列を作成します。
<code class="type">bigserial</code>と<code class="type">serial8</code>という型の名称も<code class="type">bigint</code>列を作成することを除いて同じ振舞いをします。
もしテーブルを使用する期間で2<sup>31</sup>以上の識別子を使用すると予測される場合、<code class="type">bigserial</code>を使用すべきです。
<code class="type">smallserial</code>と<code class="type">serial2</code>という型の名称もまた、<code class="type">smallint</code>列を作成することを除いて同じ振舞いをします。
    </p><p><code class="type">serial</code>列用に作成されたシーケンスは、それを所有する列が削除された時に自動的に削除されます。
列を削除せずにシーケンスを削除することができますが、これにより強制的に列のデフォルト式が削除されます。
    </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-money.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 8. データ型 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 8.2. 通貨型</td></tr></table></div></body></html>