<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.5. バイナリ文字列関数と演算子</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="functions-string.html" title="9.4. 文字列関数と演算子" /><link rel="next" href="functions-bitstring.html" title="9.6. ビット文字列関数と演算子" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">9.5. バイナリ文字列関数と演算子</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-string.html" title="9.4. 文字列関数と演算子">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="Chapter 9. 関数と演算子">Up</a></td><th width="60%" align="center">Chapter 9. 関数と演算子</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="functions-bitstring.html" title="9.6. ビット文字列関数と演算子">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="FUNCTIONS-BINARYSTRING"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.5. バイナリ文字列関数と演算子</h2></div></div></div><a id="id-1.5.8.10.2" class="indexterm"></a><p>本節では<code class="type">bytea</code>型の値を調べたり操作するための関数と演算子について説明します。
   </p><p><acronym class="acronym">SQL</acronym>では、引数の区切りにカンマではなくキーワードを使う文字列関数を、いくつか定義しています。
詳細は<a class="xref" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-SQL" title="Table 9.11. SQLバイナリ文字列関数と演算子">Table 9.11</a>を参照してください。
また<span class="productname">PostgreSQL</span>は、これらの関数に対して通常の関数呼び出し構文を使用するバージョンを提供します（<a class="xref" href="functions-string.html#FUNCTIONS-STRING-OTHER" title="Table 9.9. その他の文字列関数">Table 9.9</a>を参照してください）。
   </p><div class="note"><h3 class="title">Note</h3><p>このページで示されるサンプル結果は、サーバパラメータである<a class="link" href="runtime-config-client.html#GUC-BYTEA-OUTPUT"><code class="varname">bytea_output</code></a>が<code class="literal">escape</code>に設定されていることを想定しています(この設定はPostgreSQLの伝統的な形式です)。
    </p></div><div class="table" id="FUNCTIONS-BINARYSTRING-SQL"><p class="title"><strong>Table 9.11. <acronym class="acronym">SQL</acronym>バイナリ文字列関数と演算子</strong></p><div class="table-contents"><table class="table" summary="SQLバイナリ文字列関数と演算子" border="1"><colgroup><col /><col /><col /><col /><col /></colgroup><thead><tr><th>関数</th><th>戻り値型</th><th>説明</th><th>例</th><th>結果</th></tr></thead><tbody><tr><td><code class="literal"><em class="parameter"><code>string</code></em> <code class="literal">||</code>
        <em class="parameter"><code>string</code></em></code></td><td> <code class="type">bytea</code> </td><td>        文字列結合
        <a id="id-1.5.8.10.6.2.2.1.3.1" class="indexterm"></a>
       </td><td><code class="literal">E'\\\\Post'::bytea || E'\\047gres\\000'::bytea</code></td><td><code class="literal">\\Post'gres\000</code></td></tr><tr><td>        <a id="id-1.5.8.10.6.2.2.2.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">octet_length(<em class="parameter"><code>string</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>バイナリ文字列中のバイト数</td><td><code class="literal">octet_length(E'jo\\000se'::bytea)</code></td><td><code class="literal">5</code></td></tr><tr><td>        <a id="id-1.5.8.10.6.2.2.3.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">overlay(<em class="parameter"><code>string</code></em> placing <em class="parameter"><code>string</code></em> from <code class="type">int</code> [<span class="optional">for <code class="type">int</code></span>])</code></code>
       </td><td><code class="type">bytea</code></td><td>        部分文字列の置換
       </td><td><code class="literal">overlay(E'Th\\000omas'::bytea placing E'\\002\\003'::bytea from 2 for 3)</code></td><td><code class="literal">T\\002\\003mas</code></td></tr><tr><td>        <a id="id-1.5.8.10.6.2.2.4.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">position(<em class="parameter"><code>substring</code></em> in <em class="parameter"><code>string</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>指定した部分文字列の位置</td><td><code class="literal">position(E'\\000om'::bytea in E'Th\\000omas'::bytea)</code></td><td><code class="literal">3</code></td></tr><tr><td>        <a id="id-1.5.8.10.6.2.2.5.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">substring(<em class="parameter"><code>string</code></em> [<span class="optional">from <code class="type">int</code></span>] [<span class="optional">for <code class="type">int</code></span>])</code></code>
       </td><td><code class="type">bytea</code></td><td>        部分文字列の抽出
       </td><td><code class="literal">substring(E'Th\\000omas'::bytea from 2 for 3)</code></td><td><code class="literal">h\000o</code></td></tr><tr><td>        <a id="id-1.5.8.10.6.2.2.6.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">trim([<span class="optional">both</span>]
        <em class="parameter"><code>bytes</code></em> from
        <em class="parameter"><code>string</code></em>)</code></code>
       </td><td><code class="type">bytea</code></td><td>文字列<em class="parameter"><code>string</code></em>の先頭および末尾から<em class="parameter"><code>bytes</code></em>に含まれるバイトのみを含む最長の文字列を削除します。
       </td><td><code class="literal">trim(E'\\000\\001'::bytea from E'\\000Tom\\001'::bytea)</code></td><td><code class="literal">Tom</code></td></tr></tbody></table></div></div><br class="table-break" /><p>この他、<a class="xref" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-OTHER" title="Table 9.12. その他のバイナリ文字列関数">Table 9.12</a>に列挙するバイナリ列操作関数が使えます。
そのいくつかは、<a class="xref" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-SQL" title="Table 9.11. SQLバイナリ文字列関数と演算子">Table 9.11</a>で説明した標準<acronym class="acronym">SQL</acronym>の文字列関数を実装するために内部的に使用されています。
   </p><div class="table" id="FUNCTIONS-BINARYSTRING-OTHER"><p class="title"><strong>Table 9.12. その他のバイナリ文字列関数</strong></p><div class="table-contents"><table class="table" summary="その他のバイナリ文字列関数" border="1"><colgroup><col /><col /><col /><col /><col /></colgroup><thead><tr><th>関数</th><th>戻り値型</th><th>説明</th><th>例</th><th>結果</th></tr></thead><tbody><tr><td>        <a id="id-1.5.8.10.8.2.2.1.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">btrim(<em class="parameter"><code>string</code></em>
        <code class="type">bytea</code>, <em class="parameter"><code>bytes</code></em> <code class="type">bytea</code>)</code></code>
       </td><td><code class="type">bytea</code></td><td><em class="parameter"><code>bytes</code></em>に含まれるバイトのみを有する最長の文字列を<em class="parameter"><code>string</code></em>の先頭と末尾から削除します。
      </td><td><code class="literal">btrim(E'\\000trim\\001'::bytea, E'\\000\\001'::bytea)</code></td><td><code class="literal">trim</code></td></tr><tr><td>        <a id="id-1.5.8.10.8.2.2.2.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">decode(<em class="parameter"><code>string</code></em> <code class="type">text</code>,
       <em class="parameter"><code>format</code></em> <code class="type">text</code>)</code></code>
      </td><td><code class="type">bytea</code></td><td><em class="parameter"><code>string</code></em>で表現されているテキストデータをバイナリデータに復号します。
<em class="parameter"><code>format</code></em>のオプションは<code class="function">encode</code>と同じです。
      </td><td><code class="literal">decode(E'123\\000456', 'escape')</code></td><td><code class="literal">123\000456</code></td></tr><tr><td>        <a id="id-1.5.8.10.8.2.2.3.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">encode(<em class="parameter"><code>data</code></em> <code class="type">bytea</code>,
       <em class="parameter"><code>format</code></em> <code class="type">text</code>)</code></code>
      </td><td><code class="type">text</code></td><td>バイナリデータをテキスト表現形式に符号化します。
サポートされている形式は、<code class="literal">base64</code>、<code class="literal">hex</code>、<code class="literal">escape</code>です。
<code class="literal">escape</code>は0のバイトと最上位ビットがセットされているバイトを8進数のシーケンス(<code class="literal">\</code><em class="replaceable"><code>nnn</code></em>)に変換し 、バックスラッシュを二重化します。
      </td><td><code class="literal">encode(E'123\\000456'::bytea, 'escape')</code></td><td><code class="literal">123\000456</code></td></tr><tr><td>        <a id="id-1.5.8.10.8.2.2.4.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">get_bit(<em class="parameter"><code>string</code></em>, <em class="parameter"><code>offset</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>        文字列から1ビット抽出します。
       </td><td><code class="literal">get_bit(E'Th\\000omas'::bytea, 45)</code></td><td><code class="literal">1</code></td></tr><tr><td>        <a id="id-1.5.8.10.8.2.2.5.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">get_byte(<em class="parameter"><code>string</code></em>, <em class="parameter"><code>offset</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>        文字列から1バイト抽出します。
       </td><td><code class="literal">get_byte(E'Th\\000omas'::bytea, 4)</code></td><td><code class="literal">109</code></td></tr><tr><td>       <a id="id-1.5.8.10.8.2.2.6.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">length(<em class="parameter"><code>string</code></em>)</code></code>
      </td><td><code class="type">int</code></td><td>       バイナリ文字列の長さ
       <a id="id-1.5.8.10.8.2.2.6.3.1" class="indexterm"></a>
       <a id="id-1.5.8.10.8.2.2.6.3.2" class="indexterm"></a>
      </td><td><code class="literal">length(E'jo\\000se'::bytea)</code></td><td><code class="literal">5</code></td></tr><tr><td>       <a id="id-1.5.8.10.8.2.2.7.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">md5(<em class="parameter"><code>string</code></em>)</code></code>
      </td><td><code class="type">text</code></td><td>       <em class="parameter"><code>string</code></em>のMD5のハッシュを計算し、結果を16進数で返します。
      </td><td><code class="literal">md5(E'Th\\000omas'::bytea)</code></td><td><code class="literal">8ab2d3c9689aaf18 b4958c334c82d8b1</code></td></tr><tr><td>        <a id="id-1.5.8.10.8.2.2.8.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">set_bit(<em class="parameter"><code>string</code></em>,
        <em class="parameter"><code>offset</code></em>, <em class="parameter"><code>newvalue</code></em>)</code></code>
       </td><td><code class="type">bytea</code></td><td>        文字列内のビットを設定します。
       </td><td><code class="literal">set_bit(E'Th\\000omas'::bytea, 45, 0)</code></td><td><code class="literal">Th\000omAs</code></td></tr><tr><td>        <a id="id-1.5.8.10.8.2.2.9.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">set_byte(<em class="parameter"><code>string</code></em>,
        <em class="parameter"><code>offset</code></em>, <em class="parameter"><code>newvalue</code></em>)</code></code>
       </td><td><code class="type">bytea</code></td><td>        文字列内の1バイトを設定します。
       </td><td><code class="literal">set_byte(E'Th\\000omas'::bytea, 4, 64)</code></td><td><code class="literal">Th\000o@as</code></td></tr></tbody></table></div></div><br class="table-break" /><p><code class="function">get_byte</code>と<code class="function">set_byte</code>はバイナリ列の先頭バイトを0バイトとして数えます。
<code class="function">get_bit</code>と<code class="function">set_bit</code>は各バイト内を右からビットを数えます。例えばビット0は先頭バイトの最下位ビットとなり、ビット15は第二バイトの最上位ビットとなります。
  </p><p><a class="xref" href="functions-aggregate.html" title="9.20. 集約関数">Section 9.20</a>における<code class="function">string_agg</code>集約関数や<a class="xref" href="lo-funcs.html" title="34.4. サーバ側の関数">Section 34.4</a>のラージオブジェクト関数も参照してください。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-string.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-bitstring.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">9.4. 文字列関数と演算子 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 9.6. ビット文字列関数と演算子</td></tr></table></div></body></html>