<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.246. リリース8.1</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-8-1-1.html" title="E.245. リリース8.1.1" /><link rel="next" href="release-8-0-26.html" title="E.247. リリース8.0.26" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.246. リリース8.1</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-8-1-1.html" title="E.245. リリース8.1.1">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="Appendix E. リリースノート">Up</a></td><th width="60%" align="center">Appendix E. リリースノート</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="release-8-0-26.html" title="E.247. リリース8.0.26">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-8-1"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.246. リリース8.1</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-8-1.html#id-1.11.6.250.3">E.246.1. 概要</a></span></dt><dt><span class="sect2"><a href="release-8-1.html#id-1.11.6.250.4">E.246.2. バージョン8.1への移行</a></span></dt><dt><span class="sect2"><a href="release-8-1.html#id-1.11.6.250.5">E.246.3. その他の変更点</a></span></dt></dl></div><p><strong>リリース日: </strong>2005-11-08</p><div class="sect2" id="id-1.11.6.250.3"><div class="titlepage"><div><div><h3 class="title">E.246.1. 概要</h3></div></div></div><p>このリリースの主な変更点を以下に示します。
   </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">共有バッファキャッシュへの同時アクセスの改良(Tom)
     </span></dt><dd><p>共有バッファキャッシュへのアクセスが、特に、マルチCPUシステムにおいて深刻なスケーラビリティ問題であることは分かっていました。
本リリースでは、バッファマネージャ内で行われていたロックの方法を見直し、ロックの競合を軽減し、スケーラビリティを向上しました。
また、バッファマネージャは<span class="quote">“<span class="quote">clock sweep</span>”</span>置換ポリシーを使用するように変更されました。
      </p></dd><dt><span class="term">インデックススキャンが中間でメモリ内ビットマップを使用することができるようになりました。(Tom)
     </span></dt><dd><p>過去のリリースでは、テーブル検索の実行において単一インデックスのみを使用することができました。
この機能により、<code class="command">WHERE tab.col1 = 4 and tab.col2 = 9</code>を持つ問い合わせで、<code class="literal">col1</code>と<code class="literal">col2</code>に対する複数列インデックスが存在しない場合、<code class="literal">col1</code>に対するインデックスと<code class="literal">col2</code>に対するインデックスがあれば、両方のインデックスを検索し、結果をメモリ内で組み合わせ、<code class="literal">col1</code>と<code class="literal">col2</code>に関する両方の制約に一致する行のみをヒープから取り出すことができるようになります。
これは、問い合わせが構造化されておらず、すべての起こり得るアクセス条件に一致するインデックスを前もって作成できないような状況では、非常に有用です。
必要なランダムアクセスの総数を減少させるため、ビットマップスキャンは単一のインデックスの場合でも有用です。
ビットマップインデックススキャンはテーブル全体で多くの割合を占める部分を取り出す際に効率的です。
この場合、通常のインデックススキャンでは非効率的です。
      </p></dd><dt><span class="term">二相コミットの追加(Heikki Linnakangas, Alvaro, Tom)
     </span></dt><dd><p>二相コミットを使用して、トランザクションを複数のコンピュータで"準備"することができます。
すべてのコンピュータでトランザクションの準備を（失敗することなく）行った後、すべてのトランザクションをコミットすることができます。
準備した後でマシンがクラッシュしたとしても、マシンの再起動後に準備したトランザクションをコミットすることができます。
<code class="command">PREPARE TRANSACTION</code>および<code class="command">COMMIT/ROLLBACK PREPARED</code>という新しい構文があります。
また、新しい<code class="literal">pg_prepared_xacts</code>システムビューも追加されました。
      </p></dd><dt><span class="term">ユーザとグループを置き換える、新しいロールシステムの作成(Stephen Frost)
     </span></dt><dd><p>ロールとは、ユーザとグループを組み合わせたものです。
ユーザのようにロールはログイン機能を持つことができますし、グループのようにロールは他のロールをメンバとして持つこともできます。
基本的にロールは、ユーザとグループの区別を取り除きました。
例えば、ロールは以下のことを行うことができます。
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ログイン機能を有す（省略可能）
        </p></li><li class="listitem"><p>オブジェクトを所有する
        </p></li><li class="listitem"><p>データベースオブジェクトに対するアクセス権限を保持する
        </p></li><li class="listitem"><p>属している他のロールの権限を継承する
        </p></li></ul></div><p>ユーザがあるロールにログインした後、そのユーザはログインロールの能力の他、継承したロールの能力も持つことになります。
また、<code class="command">SET ROLE</code>を使用して、属している他のロールに変わることもできます。
この機能は、標準SQLのロールの概念を汎用化したものです。
またこの変更により、<code class="structname">pg_shadow</code>と<code class="structname">pg_group</code>は、新しいロール機能の付いたカタログ<code class="structname">pg_authid</code>と<code class="structname">pg_auth_members</code>に置き換わりました。
古いテーブルは、新しいロールテーブルに対する読み取りのみのビューとして再定義されています。
      </p></dd><dt><span class="term"><code class="function">MIN()</code> と<code class="function">MAX()</code>におけるインデックスの自動使用 (Tom)
     </span></dt><dd><p>過去のリリースでは、<code class="function">MIN()</code>または<code class="function">MAX()</code>でインデックスを使用する方法は、問い合わせを<code class="command">SELECT col FROM tab ORDER BY col LIMIT 1</code>に書き換える方法しかありませんでした。
インデックスが自動的に使用されるようになりました。
      </p></dd><dt><span class="term"><code class="filename">/contrib/pg_autovacuum</code>を主サーバに移動しました。(Alvaro)
     </span></dt><dd><p>autovacuumをサーバに統合することで、データベースサーバと同期して自動的にautovacuumが起動、停止できるようになりました。
また、<code class="filename">postgresql.conf</code>でautovacuumの設定を行うことができるようになりました。
      </p></dd><dt><span class="term"><code class="command">SELECT ... FOR SHARE</code>を使用した共有行レベルロックの追加(Alvaro)
     </span></dt><dd><p><span class="productname">PostgreSQL</span>のMVCCロックにより<code class="command">SELECT</code>は書き込みによってブロックされることはありません。
そのため、通常の操作では共有行レベルロックは不要ですが、共有行ロックを必要とするアプリケーションでは共有ロックは有用です。
特に、これにより参照性合成検査で発生するロック要求が減少します。
      </p></dd><dt><span class="term">共有オブジェクト、特にロールへの依存性を追加(Alvaro)
     </span></dt><dd><p>依存性機構の拡張により、データベースオブジェクトを所有するロールが削除されることを防ぎます。
これまでは、所有者の削除により<span class="quote">“<span class="quote">親のいない</span>”</span>オブジェクトができてしまう可能性がありました。
これは復旧させることができましたが、厄介で好まれないものでした。
      </p></dd><dt><span class="term">テーブルパーティションによる性能向上(Simon)
     </span></dt><dd><p>新しい<code class="varname">constraint_exclusion</code>設定パラメータは、子テーブルに一致する行が存在しないことを制約が示している場合、子テーブルの検索を防ぎます。
      </p><p>これにより、テーブルパーティションの基本的な種類を実現できます。
子テーブルが別々のキー範囲を格納し、これを適切な<code class="command">CHECK</code>制約で強制している場合、オプティマイザは、この制約により子テーブル内に一致することがないことが保証されている時にその子テーブルへのアクセスを飛ばします。
      </p></dd></dl></div></div><div class="sect2" id="id-1.11.6.250.4"><div class="titlepage"><div><div><h3 class="title">E.246.2. バージョン8.1への移行</h3></div></div></div><p>全ての以前のリリースからデータの移行を行うためには、<span class="application">pg_dump</span>を使用したダンプ、リストアが必要です。
   </p><p>8.0リリースでは、8.1でintervalに対する<code class="function">to_char()</code>を削除するとアナウンスしましたが、より優れたAPIの提案がありませんでしたので、<code class="function">to_char(interval)</code>は強化され、サーバに残りました。
   </p><p>以下の非互換性に注意してください。
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="varname">add_missing_from</code>のデフォルトがfalseになりました(Neil)
     </p><p><code class="literal">FROM</code>参照を持たない問い合わせでテーブルが使用された場合、デフォルトでエラーとなるようになりました。
まだ過去の動作を使用することができますが、そのためにはこのパラメータを'true'にしなければなりません。
     </p><p>ダンプに暗黙的な<code class="literal">FROM</code>構文を使用して作成したビューやルールがある場合、既存のダンプファイルをロードするために、<code class="varname">add_missing_from</code>を真に設定しなければならないかもしれません。
これに悩まされるのは一回だけのはずです。
<span class="productname">PostgreSQL</span> 8.1は、こうしたビューやルールを標準の明示的な<code class="literal">FROM</code>構文に変換するためです。
したがって、今後のダンプではこの問題は起こりません。
     </p></li><li class="listitem"><p><code class="type">float4</code>/<code class="type">float8</code>/<code class="type">oid</code>に長さが0の文字列(<code class="literal">''</code>)が入力された場合、ゼロとして扱わずエラーとなるようになりました(Neil)
     </p><p>この変更により、現行の整数に対する長さが0の文字列の扱いと矛盾がなくなりました。
この変更の時期については8.0でアナウンスしていました。
     </p></li><li class="listitem"><p><code class="varname">default_with_oids</code>のデフォルトがfalseになりました(Neil)
     </p><p>このオプションをfalseに設定した場合、<code class="command">CREATE TABLE</code>で<code class="command">WITH OIDS</code>を指定しない限り、ユーザが作成したテーブルはOID列を持たなくなります。
すべての<span class="productname">PostgreSQL</span>リリースでOIDは存在していましたが、4バイト長しかなく、インストールされたデータベース全体で共有アクセスされていることから、OIDの利用は制限されてきました。
一意に行を識別するには、シーケンスまたは<code class="type">SERIAL</code>型を使用することを勧めます。
これは<span class="productname">PostgreSQL</span> 6.4からサポートされています。
     </p></li><li class="listitem"><p><code class="literal">E''</code>構文が追加されました。
そのため、普通の文字列でバックスラッシュ文字を扱うことができます。(Bruce)
     </p><p>現在の<span class="productname">PostgreSQL</span>は文字列リテラル内のバックスラッシュを、特別なエスケープシーケンスの始まりとして扱います。
例えば、<code class="literal">\n</code>や<code class="literal">\010</code>です。
これで簡単に特別な値を埋め込むことができますが、非標準であり、他のデータベースからのアプリケーションの移植を困難にしています。
このため、<span class="productname">PostgreSQL</span>プロジェクトでは、文字列内のバックスラッシュが特別な意味を持たないようにすることを計画しています。
後方互換性と、特別なバックスラッシュ処理を使用したいユーザのために、新しい文字列構文を作成しました。
この新しい文字列構文は、例えば<code class="literal">E'hi\n'</code>のように、<code class="literal">E</code>、直後に単一引用符、そして文字列を始めるという形です。
このリリースでは文字列内のバックスラッシュの扱いに変更はありませんが、今後のリリースに向けたアプリケーションの移行を補助するために、以下の設定パラメータが追加されました。
     </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">standard_conforming_strings</code>。
このリリースで普通の文字列内のバックスラッシュをそのまま扱うかどうかを指定します。
       </p></li><li class="listitem"><p><code class="varname">escape_string_warning</code>。
普通の文字列（非E）内でバックスラッシュが存在した場合に警告する。
      </p></li></ul></div><p><code class="varname">standard_conforming_strings</code>の値は読み取りのみです。
アプリケーションでは、この値を読み取ることで、どのようにバックスラッシュが解釈されるかが分かります。
（また、このパラメータが存在するかどうかで、<code class="literal">E''</code>文字列構文がサポートされているかどうかが分かります。）
今後のリリースでは、<code class="varname">standard_conforming_strings</code>は真になる予定です。
つまり、非E文字列でのバックスラッシュは文字そのものとして扱われます。
この変更に備えて、バックスラッシュの特別処理が必要な場所に<code class="literal">E''</code>を使用し、かつ、<code class="literal">E''</code>を使用するように変換しなければならない文字列を更に検出するために<code class="varname">escape_string_warning</code>を有効にしてください。
また、文字列内に単一引用符そのものを埋め込む場合には、<span class="productname">PostgreSQL</span>がサポートするバックスラッシュ+単一引用符（<code class="literal">\'</code>）という構文ではなく、2つの単一引用符（<code class="literal">''</code>）を使用してください。
後者は標準に準拠しており、また、<code class="literal">E''</code>文字列構文を使用する必要がありません。
また、バックスラッシュを特別に扱わない、<code class="literal">$$</code>文字列構文も使用することができます。
     </p></li><li class="listitem"><p><code class="command">REINDEX DATABASE</code>がデータベース内のすべてのインデックスの再作成を行うようになりました。(Tom)
     </p><p>これまでは、<code class="command">REINDEX DATABASE</code>はシステムテーブルのみのインデックスを再作成しました。
この新しい動作の方がより直感的です。
新しい<code class="command">REINDEX SYSTEM</code>コマンドが、システムテーブルのみのインデックス再作成という以前の機能を提供します。
     </p></li><li class="listitem"><p>読みとりのみのラージオブジェクト記述子がMVCCスナップショットセマンティックスに従うようになりました。
     </p><p>ラージオブジェクトが<code class="literal">INV_READ</code> (かつ<code class="literal">INV_WRITE</code>なし)で開かれた場合、
その記述子から読みとられるデータが、<code class="function">lo_open()</code>を呼び出した問い合わせで使用するトランザクションスナップショットの時点のラージオブジェクトの状態<span class="quote">“<span class="quote">スナップショット</span>”</span>を反映するようになりました。
常に最新のコミットされたデータを返すという以前の動作に戻すには、<code class="function">lo_open()</code>のモードフラグに<code class="literal">INV_WRITE</code>を付与して下さい。
     </p></li><li class="listitem"><p>シーケンス関数の引数に対して、適切な依存性を追加しました。(Tom)
     </p><p>以前のリリースでは、<code class="function">nextval()</code>、<code class="function">currval()</code>、<code class="function">setval()</code>に渡されるシーケンス名は、単なるテキスト文字列として保持されていました。
つまり、<code class="literal">DEFAULT</code>句で使用中のシーケンスの名称変更や削除により、<code class="literal">DEFAULT</code>句が無効となりました。
このリリースでは、すべて新しく作成した、内部用OIDを引数として持つシーケンス関数を保持します。
これにより、シーケンス名の変更を追跡できるようになり、また、不適切なシーケンスの削除を防ぐために依存情報も追加されました。
また、これにより、スキーマ名称の変更や検索パスの変更から、こうした<code class="literal">DEFAULT</code>句を保護できるようになりました。
     </p><p>アプリケーションの中には、以前の実行時にシーケンス名を検索する動作に依存しているものがあるかもしれません。
これは、<code class="literal">nextval('myseq'::text)</code>のように、明示的に引数を<code class="type">text</code>にキャストすることで実現することができます。
     </p><p>8.1より前のデータベースダンプを8.1にロードした場合、古いテキストを基とした表現が使用されますので、OIDを引数として保持させる機能は持てません。
しかし、テキスト版の<code class="literal">DEFAULT</code>句を持つデータベースを更新することができます。
まず、以下の問い合わせを<code class="filename">fixseq.sql</code>などという名前のファイルに保存してください。
</p><pre class="programlisting">SELECT  'ALTER TABLE ' ||
   pg_catalog.quote_ident(n.nspname) || '.' ||
   pg_catalog.quote_ident(c.relname) ||
   ' ALTER COLUMN ' || pg_catalog.quote_ident(a.attname) ||
   ' SET DEFAULT ' ||
   regexp_replace(d.adsrc,
                  $$val\(\(('[^']*')::text\)::regclass$$,
                  $$val(\1$$,
                  'g') ||
   ';'
FROM    pg_namespace n, pg_class c, pg_attribute a, pg_attrdef d
WHERE   n.oid = c.relnamespace AND
   c.oid = a.attrelid AND
   a.attrelid = d.adrelid AND
   a.attnum = d.adnum AND
   d.adsrc ~ $$val\(\('[^']*'::text\)::regclass$$;</pre><p>
次に、調整が必要であることが分かったデータベースに対してこの問い合わせを実行してください。
以下では<code class="literal">db1</code>というデータベースに対して実行しています。
</p><pre class="programlisting">psql -t -f fixseq.sql db1</pre><p>
これにより、データベースを新しいOID版の表現に変換するための<code class="command">ALTER TABLE</code>コマンドが表示されます。
このコマンドが問題ないことを確認した後に、以下を実行してデータベースを更新してください。
</p><pre class="programlisting">psql -t -f fixseq.sql db1 | psql -e db1</pre><p>
この手続きを更新すべきデータベースそれぞれに対して繰り返し実行しなければなりません。
     </p></li><li class="listitem"><p><span class="application">psql</span>において、引用符で括られていない<code class="literal">\{digit}+</code>という並びを8進数として扱うようになりました。(Bruce)
     </p><p>以前のリリースでは、<code class="literal">\{digit}+</code>という並びは10進数として扱われ、<code class="literal">\0{digit}+</code>のみが8進数として扱われました。
この変更は一貫性のために行われました。
     </p></li><li class="listitem"><p><code class="literal">%</code>および<code class="literal">^</code>演算子の接頭辞と接尾辞の文法積を削除しました。
     </p><p>これは文書化されておらず、また、負値の剰余演算子 (<code class="literal">%</code>)の使用を複雑にしていました。
     </p></li><li class="listitem"><p>多角形用の<code class="literal">&amp;&lt;</code>と<code class="literal">&amp;&gt;</code>をボックス型の"over"演算子と矛盾がないようにしました。(Tom)
     </p></li><li class="listitem"><p><code class="command">CREATE LANGUAGE</code>は、<code class="structname">pg_pltemplate</code>の情報によって指定された引数を無視することができます。(Tom)
     </p><p>新しい<code class="structname">pg_pltemplate</code>システムカタログが、手続き言語の好みの定義（検証関数をもつかどうかなど）についての情報を保持するために定義されました。
作成しようとする言語に関する項目がこのカタログに存在する場合、<code class="command">CREATE LANGUAGE</code>は言語名以外のパラメータをすべて無視し、カタログの情報を使用します。
古いダンプファイルからロードされる古い言語定義に伴う問題が増大したため、この方式が取られました。
8.1では、ロード時にテンプレート項目が存在することに依存し、<span class="application">pg_dump</span>は手続き言語定義を単なる <code class="command">CREATE LANGUAGE <em class="replaceable"><code>name</code></em></code>としてダンプします。
これがより将来を見込んだ表現になることを期待しています。
     </p></li><li class="listitem"><p><code class="function">pg_cancel_backend(int)</code>が<code class="type">integer</code>ではなく<code class="type">boolean</code>を返すようになりました。(Neil)
     </p></li><li class="listitem"><p>UTF-8のデータを8.1.Xにロードする場合に問題が起きる可能性があります。
これは、
以前のバージョンでは無効なUTF-8のバイト列をデータベースに投入することができましたが、今回のリリースでは正しく有効なUTF-8列のみを受付けるようになったことが原因です。
ダンプファイルを修正する方法の1つとして、<code class="command">iconv -c -f UTF-8 -t UTF-8 -o cleanfile.sql dumpfile.sql</code>を実行することがあります。
<code class="literal">-c</code>オプションにより無効な文字列が削除されます。
この2つのファイルの違いを見ることで、無効な列を表示することができます。
<code class="command">iconv</code>は入力ファイル全体をメモリに読み込みますので、この処理のためにダンプを複数の小さなファイルに分割する必要があるかもしれません。
     </p></li></ul></div></div><div class="sect2" id="id-1.11.6.250.5"><div class="titlepage"><div><div><h3 class="title">E.246.3. その他の変更点</h3></div></div></div><p><span class="productname">PostgreSQL</span>8.1と以前のメジャーリリースとの間でなされた、その他の変更点について詳細を以下に示します。
   </p><div class="sect3" id="id-1.11.6.250.5.3"><div class="titlepage"><div><div><h4 class="title">E.246.3.1. 性能向上</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>GiSTとR-treeインデックスの性能を向上しました。(Neil)
      </p></li><li class="listitem"><p>ハッシュ結合の自動サイズ変更を含む、オプティマイザの改良を行いました。
       (Tom)
      </p></li><li class="listitem"><p>様々な所で内部用のAPIを見直しました。
      </p></li><li class="listitem"><p>WALレコードのCRCを64ビットから32ビットに変更しました。(Tom)
      </p><p>64ビットのCRCを計算するコストが過大で、信頼性に関する長所は無視できるものであると考えました。
      </p></li><li class="listitem"><p>WALページに巨大な空のギャップを書き出さないように変更しました。(Tom)
      </p></li><li class="listitem"><p>SMPマシン、特にOpteronマシンにおけるスピンロック動作を改良しました。(Tom)
      </p></li><li class="listitem"><p>連続していないインデックス列を複数列に対するインデックスで使用できるようにしました。(Tom)
      </p><p>例えば、これによりa,b,c列に対するインデックスを<code class="command">WHERE a = 4 and c = 10</code>といった問い合わせで使用することができます。
      </p></li><li class="listitem"><p><code class="command">CREATE TABLE AS</code>/<code class="command">SELECT INTO</code>に対するWALロギングを飛ばします。(Simon)
      </p><p><code class="command">CREATE TABLE AS</code>実行中のクラッシュにより復旧中にテーブルが削除されてしまいますので、そのテーブルをロードするためにWALに記録する意味がありません。
（しかし、WALアーカイブが有効な場合はロギングを行います。）
      </p></li><li class="listitem"><p>GiSTインデックスへの同時アクセスを可能にしました。(Teodor, Oleg)
      </p></li><li class="listitem"><p><code class="varname">full_page_writes</code>設定パラメータを追加し、WALへページ全体を書き出すかどうか制御できるようになりました。(Bruce)
      </p><p>破損したデータベースから部分的なディスク書き出しを防ぐために、チェックポイントの後に変更されたディスクページを最初に書き出す時に、<span class="productname">PostgreSQL</span>は各データベースディスクページ全体のコピーをWALに書き出します。
このオプションにより、この機能を無効にすることができ、より高速になります。
部分的なページ書き出しが起こることがない、バッテリでバックアップされたディスクキャッシュを持つ場合、これは安全です。
      </p></li><li class="listitem"><p><code class="varname">wal_sync_method</code>で<code class="literal">O_SYNC</code>を使用している場合、利用できるのであれば<code class="literal">O_DIRECT</code>を使用します。
       (Itagaki Takahiro)
      </p><p><code class="literal">O_DIRECT</code>によりディスクへの書き出しがカーネルキャッシュを介さずに行われます。
そのため、WALへの書き出しが高速になり、性能が向上します。
      </p></li><li class="listitem"><p><code class="command">COPY FROM</code>の性能を向上しました。(Alon Goldshuv)
      </p><p><code class="command">COPY</code>入力を一文字ずつではなくより巨大なまとまり内に読み込むことで実現しました。
      </p></li><li class="listitem"><p><code class="function">COUNT()</code>、<code class="function">SUM</code>、<code class="function">AVG()</code>、<code class="function">STDDEV()</code>、<code class="function">VARIANCE()</code>を改良しました。(Neil, Tom)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.4"><div class="titlepage"><div><div><h4 class="title">E.246.3.2. サーバの変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>トランザクションID(XID)周回問題を防止しました。(Tom)
      </p><p>トランザクションカウンタが周回点に近づいた時にサーバは警告を発します。
カウンタが周回点に近づき過ぎている場合、サーバは問い合わせの受付を停止します。
これにより、必要なバキューム処理の実行を行う前にデータが失われることは確実になくなります。
      </p></li><li class="listitem"><p>OIDカウンタが周回した後に生じる、既存のシステムオブジェクトとオブジェクトID（OID）が競合する問題を修正しました。
      </p></li><li class="listitem"><p><code class="command">VACUUM</code>時に<code class="varname">max_fsm_relations</code>と<code class="varname">max_fsm_pages</code>を増大させる必要がある場合の警告を追加しました。
      </p></li><li class="listitem"><p><code class="varname">temp_buffers</code>設定パラメータを追加し、一時テーブルアクセス用のローカルバッファのサイズをユーザが決定できるようになりました。
      </p></li><li class="listitem"><p><code class="literal">pg_stat_activity</code>にセッションの開始時刻とクライアントIPアドレスを追加しました。(Magnus)
      </p></li><li class="listitem"><p>ビットマップスキャンのために<code class="literal">pg_stat</code>ビューを調整しました。(Tom)
      </p><p>一部のフィールドの意味が少し変わりました。
      </p></li><li class="listitem"><p><code class="literal">pg_locks</code>ビューを改良しました。(Tom)
      </p></li><li class="listitem"><p>クライアント側における<code class="command">PREPARE</code>および<code class="command">EXECUTE</code>のログを記録するようにしました。(Simon)
      </p></li><li class="listitem"><p>Kerberos名とユーザ名に関する大文字小文字の区別を<code class="filename">postgresql.conf</code>で指定できるようにしました。(Magnus)
      </p></li><li class="listitem"><p><code class="varname">krb_server_hostname</code>設定パラメータを追加し、サービスプリンシパルの一部としてサーバのホスト名を指定できるようになりました。(Todd Kover)
      </p><p>設定されていない場合、keytab内の一致するサービスプリンシパルが使用されます。
これは本リリースにおける新しいKerberosの検索動作です。
      </p></li><li class="listitem"><p><code class="varname">log_line_prefix</code>オプションにミリ秒(<code class="literal">%m</code>)とリモートホスト(<code class="literal">%h</code>)を追加しました。(Ed L.)
      </p></li><li class="listitem"><p>GiSTインデックスに対するWALロギングを追加しました。(Teodor, Oleg)
      </p><p>GiSTインデックスはクラッシュに対してもポイントインタイムリカバリに対しても安全になりました。
      </p></li><li class="listitem"><p><code class="function">pg_stop_backup()</code>を実行した時に古い<code class="filename">*.backup</code>ファイルを削除するようにしました。(Bruce)
      </p><p>これにより、多くの<code class="filename">*.backup</code>ファイルが<code class="filename">pg_xlog</code>に残らないようになります。
      </p></li><li class="listitem"><p>TCP/IPキープアライブ時間について待機、間隔、個数を制御する設定パラメータを追加しました。(Oliver Jowett)
      </p><p>これらの値を変更することで、クライアント接続の喪失を素早く検知できるようになります。
      </p></li><li class="listitem"><p>ユーザ毎およびデータベース毎の接続上限を追加しました。(Petr Jelinek)
      </p><p><code class="command">ALTER USER</code>および<code class="command">ALTER DATABASE</code>を使用して、特定ユーザが同時に接続できる、もしくは特定のデータベースへ同時に接続できる、最大セッション数に制限をかけることができるようになりました。
この制限をゼロにすると、ユーザからの接続またはデータベースへの接続が無効になります。
      </p></li><li class="listitem"><p>64ビットマシンにおいて、2ギガバイト以上の共有メモリとバックエンド単位の作業メモリを使用できるようになりました。(Koichi Suzuki)
      </p></li><li class="listitem"><p>新しい<code class="structname">pg_pltemplate</code>によりダンプファイル内の廃止された手続き言語定義を上書きできるようになりました。(Tom)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.5"><div class="titlepage"><div><div><h4 class="title">E.246.3.3. 問い合わせの変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>一時ビューを追加しました。(Koju Iijima, Neil)
      </p></li><li class="listitem"><p>集約関数や<code class="command">GROUP BY</code>を持たない<code class="command">HAVING</code>を、単一グループを返すように修正しました。(Tom)
      </p><p>これまでこうした状況では、<code class="command">HAVING</code>句を<code class="command">WHERE</code>句と同様に扱っていました。
これは仕様に従っていませんでした。
      </p></li><li class="listitem"><p><code class="command">DELETE</code>にテーブルを追加指定できるように<code class="command">USING</code>句を追加しました。(Euler Taveira de Oliveira, Neil)
      </p><p>以前のリリースでは、<code class="command">DELETE</code>文内で結合に使用するテーブルを追加指定する明確な方法はありませんでした。
<code class="command">UPDATE</code>には、すでにこの目的のための<code class="literal">FROM</code>があります。
      </p></li><li class="listitem"><p>バックエンドおよびecpg文字列における<code class="literal">\x</code>16進数エスケープのサポートを追加しました。(Bruce)
      </p><p>これは、標準Cの<code class="literal">\x</code>エスケープ構文そのものです。
8進数エスケープはサポート済みです。
      </p></li><li class="listitem"><p><code class="command">BETWEEN SYMMETRIC</code>問い合わせ構文を追加しました。(Pavel Stehule)
      </p><p>この機能により<code class="command">BETWEEN</code>比較で、1番目の値が2番目より小さいことを必要としなくなりました。
例えば、<code class="command">2 BETWEEN [ASYMMETRIC] 3 AND 1</code>は偽を返しますが、<code class="command">2 BETWEEN SYMMETRIC 3 AND 1</code>は真を返します。
<code class="command">BETWEEN ASYMMETRIC</code>はすでにサポート済みです。
      </p></li><li class="listitem"><p><code class="command">SELECT ... FOR UPDATE/SHARE</code>のオプションに<code class="command">NOWAIT</code>を追加しました。(Hans-Juergen Schoenig)
      </p><p><code class="varname">statement_timeout</code>設定パラメータにより、一定以上の時間がかかる問い合わせをキャンセルすることができますが、この<code class="command">NOWAIT</code>オプションにより、<code class="command">SELECT ... FOR UPDATE/SHARE</code>が即座に行ロックを獲得できなかった時、すぐに問い合わせをキャンセルすることができます。
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.6"><div class="titlepage"><div><div><h4 class="title">E.246.3.4. オブジェクト操作の変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>共有オブジェクトの依存関係の追跡(Alvaro)
      </p><p><span class="productname">PostgreSQL</span>では、グローバルテーブル（ユーザ、データベース、テーブル空間）の情報を複数のデータベースから参照することができます。
今回の変更でグローバルテーブルに関する依存性情報が追加されました。
従って、例えば、ユーザの所有権をデータベースに跨って確認できますので、他のデータベースで何かを所有しているユーザを削除できないようにすることができます。
データベースに局所的なオブジェクトに関する依存関係の追跡はすでに存在します。
      </p></li><li class="listitem"><p>オブジェクト所有者が制限付きの<code class="command">ALTER OWNER</code>コマンドを実行できるようになりました。(Stephen Frost)
      </p><p>以前のリリースでは、スーパーユーザのみがオブジェクトの所有権を変更できました。
今では、コマンドを実行したユーザがオブジェクトを所有し、かつ、新しい所有者として作成できる場合（つまり、そのユーザが新しい所有者のロールのメンバであり、そのロールが新規にオブジェクトを作成する時に必要なCREATE権限を持つ場合）、所有権を移すことができます。
      </p></li><li class="listitem"><p>一部のオブジェクト型（テーブル、関数、型）に対する<code class="command">ALTER</code> object <code class="command">SET SCHEMA</code>機能を追加しました。(Bernd Helmle)
      </p><p>これによりオブジェクトを異なるスキーマに移すことができるようになります。
      </p></li><li class="listitem"><p>トリガを無効にする<code class="command">ALTER TABLE ENABLE/DISABLE TRIGGER</code>を追加しました。(Satoshi Nagayasu)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.7"><div class="titlepage"><div><div><h4 class="title">E.246.3.5. ユーティリティコマンドの変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>単一の<code class="command">TRUNCATE</code>コマンドで複数のテーブルの消去ができるようになりました。(Alvaro)
      </p><p>参照整合性検査のため、参照整合性制約の一部となるテーブルを消去することはできません。
この新しい機能を使用することで、参照整合性制約に含まれる両テーブルが単一の<code class="command">TRUNCATE</code>コマンドで消去される場合、<code class="command">TRUNCATE</code>を使用してこうしたテーブルを消去できるようになりました。
      </p></li><li class="listitem"><p><code class="command">COPY CSV</code>モードにおける復帰コード、改行コードの処理が適切になりました。(Andrew)
      </p><p>8.0リリースでは、<code class="command">CSV COPY TO</code>における復帰コードと改行コードは一貫性のある方法で処理されていませんでした。
（これはTODOリストに記載されていました。）
      </p></li><li class="listitem"><p><code class="command">COPY</code>にて、先頭行にヘッダ行を記載できるように<code class="command">COPY WITH CSV HEADER</code>を追加しました。(Andrew)
      </p><p>これにより、データファイルの先頭行に列名を記載するという一般的な<code class="command">CSV</code>の使用方法を扱うことができます。
<code class="command">COPY TO</code>では先頭行には列名が記載され、 <code class="command">COPY FROM</code>では先頭行は無視されます。
      </p></li><li class="listitem"><p>Windowsにおいて、<code class="command">EXPLAIN ANALYZE</code>の表示を秒以下の精度にしました。 (Magnus)
      </p></li><li class="listitem"><p><code class="command">EXPLAIN ANALYZE</code>の表示にトリガ期間を追加しました。
       (Tom)
      </p><p>以前のリリースではトリガの実行時間は総実行時間に含まれていました。
各トリガで費やされる時間がどのくらいかがわかるようになりました。
      </p></li><li class="listitem"><p><code class="command">COPY</code>にて、<code class="literal">\x</code>16進数エスケープのサポートを追加しました。
       (Sergey Ten)
      </p><p>以前のリリースでは8進数エスケープのみをサポートしていました。
      </p></li><li class="listitem"><p><code class="command">SHOW ALL</code>が変数の説明を含むようにしました。
       (Matthias Schmidt)
      </p><p><code class="command">SHOW</code> varname はまだ変数の値のみを表示し、説明を表示しません。
      </p></li><li class="listitem"><p><span class="application">initdb</span>が<code class="literal">postgres</code>という新しい標準データベースを作成するようになりました。
このためユーティリティが標準データベースを検索する時に<code class="literal">template1</code>ではなく<code class="literal">postgres</code>を使用するように変更されました。(Dave)
      </p><p>以前のリリースでは、<span class="application">createuser</span>などのユーティリティのデフォルト接続用、および、新規データベースのテンプレート用として、<code class="literal">template1</code>が使用されていました。
テンプレートデータベースにだれかが接続しているために新しいデータベースを作成することができず、<code class="command">CREATE DATABASE</code>の失敗の原因となることがありました。
この変更により、デフォルトの接続データベースが<code class="literal">postgres</code>になりました。
つまり、<code class="command">CREATE DATABASE</code>時にだれかが<code class="literal">template1</code>を使用している可能性がかなり減少しました。
      </p></li><li class="listitem"><p><code class="filename">/contrib/reindexdb</code>をサーバへ移動し、新しく<span class="application">reindexdb</span>コマンドラインユーティリティを作成しました。(Euler Taveira de Oliveira)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.8"><div class="titlepage"><div><div><h4 class="title">E.246.3.6. データ型および関数の変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>配列型に対する<code class="function">MAX()</code>および<code class="function">MIN()</code>集約を追加しました。(Koju Iijima)
      </p></li><li class="listitem"><p><code class="literal">CC</code>、<code class="literal">YY</code>、またはこの両方のフィールドが使用されている場合に合理的な動作を行うように<code class="function">to_date()</code>および<code class="function">to_timestamp()</code>を修正しました。(Karel Zak)
      </p><p><code class="literal">CC</code> が書式指定にあり、<code class="literal">YYY</code>以上の長さが年指定にあると、<code class="literal">CC</code> を無視します。
年指定の長さが<code class="literal">YY</code>以下の場合、<code class="literal">CC</code>を直前の世紀であると解釈します。
      </p></li><li class="listitem"><p><code class="function">md5(bytea)</code>を追加しました。 (Abhijit Menon-Sen)
      </p><p><code class="function">md5(text)</code>はすでに存在していました。
      </p></li><li class="listitem"><p><code class="function">power(numeric, numeric)</code>を基にした<code class="command">numeric ^ numeric</code>のサポートを追加しました。
      </p><p>関数はすでに存在していましたが、対応する演算子がありませんでした。
      </p></li><li class="listitem"><p>計算処理中に適切に商を除去するように<code class="type">NUMERIC</code>の剰余を修正しました。
      </p><p>以前のリリースでは、巨大な値に対する剰余が商の丸めにより負の値を返すことがありました。
      </p></li><li class="listitem"><p><code class="function">lastval()</code>関数を追加しました。(Dennis Björklund)
      </p><p><code class="function">lastval()</code>は<code class="function">currval()</code>を簡単にしたものです。
これは、現在のセッションで実行されたもっとも最近の<code class="function">nextval()</code>または<code class="function">setval()</code>に基づいて自動的に適切なシーケンス名を決定します。
      </p></li><li class="listitem"><p><code class="function">to_timestamp(DOUBLE PRECISION)</code>を追加しました。(Michael Glaesemann)
      </p><p>1970年からのUnix秒を<code class="type">TIMESTAMP WITH TIMEZONE</code>に変換します。
      </p></li><li class="listitem"><p><code class="function">pg_postmaster_start_time()</code>関数を追加しました。(Euler Taveira de Oliveira, Matthias Schmidt)
      </p></li><li class="listitem"><p><code class="command">AT TIME ZONE</code>で完全なゾーン名を使用できるようになりました。
以前は省略形のみが使用できました。(Magnus)
      </p><p>以前は、定義済みのタイムゾーン名の一覧のみが<code class="command">AT TIME ZONE</code>でサポートされていました。
現在では、サポート済みのタイムゾーン名すべてを使用することができます。
以下に例を示します。
</p><pre class="programlisting">SELECT CURRENT_TIMESTAMP AT TIME ZONE 'Europe/London';</pre><p>
上の問い合わせでは、タイムゾーンは指定した日付に影響する夏時間規則に従って調整されます。
      </p></li><li class="listitem"><p><code class="function">GREATEST()</code>および<code class="function">LEAST()</code>可変長引数関数を追加しました。(Pavel Stehule)
      </p><p>これらの関数は可変数の引数を取り、引数の中で最大もしくは最小の値を返します。
      </p></li><li class="listitem"><p><code class="function">pg_column_size()</code>を追加しました。 (Mark Kirkwood)
      </p><p>これは列の格納サイズを返します。圧縮が使用されている場合もあります。
      </p></li><li class="listitem"><p><code class="function">regexp_replace()</code>を追加しました。 (Atsushi Ogawa)
      </p><p>これによりsedのように正規表現による置換を行うことができます。
省略可能なフラグ引数により、全領域の選択（全置換）や大文字小文字の区別モードを指定することができます。
      </p></li><li class="listitem"><p>intervalの除算、乗算を修正しました。(Bruce)
      </p><p>以前のバージョンでは、
<code class="command">'4 months'::interval / 5</code>が<code class="command">'1 mon -6 days'</code>といった不揃いの結果を返すことがありました。
      </p></li><li class="listitem"><p>timestamp、time、interval出力における端数処理を修正しました。(Tom)
      </p><p>上位部分を増加させずに秒部分が<code class="literal">60</code>と表示される問題を修正したものです。
      </p></li><li class="listitem"><p><code class="type">INTERVAL</code>に別途日フィールドを追加し、1日という間隔と24時間という間隔を区別できるようになりました。(Michael Glaesemann)
      </p><p>夏時間による時間調整を含む日にちは24時間ではなく、よく23時間や25時間となります。
この変更により、<span class="quote">“<span class="quote">何日間</span>”</span>という時間間隔と<span class="quote">“<span class="quote">何時間</span>”</span>という時間間隔の間に概念的な違いが生じます。
timestampに<code class="literal">1 day</code>を加えると、その間に夏時間による時間調整があったとしても、同じローカル時間における次の日になるようになりました。
一方で<code class="literal">24 hours</code>を加えると、時間調整があると異なるローカル時間となります。
US DSTの例を以下に示します。
</p><pre class="programlisting">'2005-04-03 00:00:00-05' + '1 day' = '2005-04-04 00:00:00-04'
'2005-04-03 00:00:00-05' + '24 hours' = '2005-04-04 01:00:00-04'</pre><p>
      </p></li><li class="listitem"><p><code class="function">justify_days()</code>および<code class="function">justify_hours()</code>を追加しました。
       (Michael Glaesemann)
      </p><p>これらの関数はそれぞれ、日数を適切な月数と日数に、時間数を適切な日数と時間数に調整します。
      </p></li><li class="listitem"><p><code class="filename">/contrib/dbsize</code>をバックエンドに移し、一部の関数の名前を変更しました。 (Dave Page, Andreas Pflug)
      </p><p>       </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>           <code class="function">pg_tablespace_size()</code>
         </p></li><li class="listitem"><p>          <code class="function">pg_database_size()</code>
         </p></li><li class="listitem"><p>          <code class="function">pg_relation_size()</code>
         </p></li><li class="listitem"><p>          <code class="function">pg_total_relation_size()</code>
         </p></li><li class="listitem"><p>          <code class="function">pg_size_pretty()</code>
         </p></li></ul></div><p>
      </p><p><code class="function">pg_total_relation_size()</code>にはインデックスとTOASTテーブルが含まれます。
      </p></li><li class="listitem"><p>クラスタディレクトリへの読み取りのみのファイルアクセス用の関数を追加しました。(Dave Page, Andreas Pflug)
      </p><p>       </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>          <code class="function">pg_stat_file()</code>
         </p></li><li class="listitem"><p>          <code class="function">pg_read_file()</code>
         </p></li><li class="listitem"><p>          <code class="function">pg_ls_dir()</code>
         </p></li></ul></div><p>
      </p></li><li class="listitem"><p>設定ファイルを強制的に再読み込みする<code class="function">pg_reload_conf()</code>を追加しました。(Dave Page, Andreas Pflug)
      </p></li><li class="listitem"><p>サーバログファイルを強制的にローテートする<code class="function">pg_rotate_logfile()</code>を追加しました。(Dave Page, Andreas Pflug)
      </p></li><li class="listitem"><p>TOASTテーブルを含めるように<code class="literal">pg_stat_*</code>ビューを変更しました。(Tom)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.9"><div class="titlepage"><div><div><h4 class="title">E.246.3.7. 符号化方式およびロケールの変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>より一貫性を高め、かつ、国際的な標準に従うように一部の符号化方式の名前を変更しました。
      </p><p>       </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="literal">UNICODE</code> は<code class="literal">UTF8</code>になりました。
         </p></li><li class="listitem"><p><code class="literal">ALT</code>は<code class="literal">WIN866</code>になりました。
         </p></li><li class="listitem"><p><code class="literal">WIN</code>は<code class="literal">WIN1251</code>になりました。
         </p></li><li class="listitem"><p><code class="literal">TCVN</code>は<code class="literal">WIN1258</code>になりました。
         </p></li></ul></div><p>
      </p><p>以前の名前もまだ使用できます。
      </p></li><li class="listitem"><p><code class="literal">WIN1252</code>符号化方式のサポートを追加しました。(Roland Volkmann)
      </p></li><li class="listitem"><p>4バイトの<code class="literal">UTF8</code>文字のサポートを追加しました。(John Hansen)
      </p><p>これまでは1バイト、2バイトおよび3バイトの<code class="literal">UTF8</code>文字がサポートされていました。
これは特に一部の中国語文字セットをサポートするために重要です。
      </p></li><li class="listitem"><p><code class="literal">EUC_JP</code>、<code class="literal">SJIS</code>間の直接変換を可能とし、性能を向上しました。(Atsushi Ogawa)
      </p></li><li class="listitem"><p>WindowsにおいてUTF8符号化方式が動作できるようになりました。(Magnus)
      </p><p>これはUTF8をWindows独自のUTF16実装に対応付けすることでなされました。
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.10"><div class="titlepage"><div><div><h4 class="title">E.246.3.8. サーバサイド言語の一般的な変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="command">ALTER LANGUAGE RENAME</code>を修正しました。(Sergey Yatskevich)
      </p></li><li class="listitem"><p>厳密性、揮発性などの関数特性を<code class="command">ALTER FUNCTION</code>で変更できるようにしました。(Neil)
      </p></li><li class="listitem"><p>関数引数の最大数を100まで増加しました。(Tom)
      </p></li><li class="listitem"><p>SQL関数およびPL/pgSQL関数で<code class="command">OUT</code>および<code class="command">INOUT</code>パラメータを使用できるようにしました。(Tom)
      </p><p><code class="command">OUT</code>は、関数の戻り値をあらわす別の方法です。
<code class="command">RETURN</code>の代わりに使用して、<code class="command">OUT</code>または<code class="command">INOUT</code>で宣言されたパラメータに割り当てて、値を返します。
これにより、特に複数の値を返さなければならない場合、記述がより簡単になる場合があります。
以前のリリースでも関数から複数の値を返すことは可能でしたが、これによりその手続きが非常に簡単になりました
（今後のリリースでこの機能は他のサーバサイド言語にも拡張される予定です）。
      </p></li><li class="listitem"><p>言語ハンドラ関数を<code class="literal">pg_catalog</code>スキーマに移動しました。
      </p><p>これによりpublicスキーマの削除が簡単にできるようになりました。
      </p></li><li class="listitem"><p><code class="function">SPI_getnspname()</code>をSPIに追加しました。(Neil)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.11"><div class="titlepage"><div><div><h4 class="title">E.246.3.9. PL/pgSQLサーバサイド言語の変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>PL/pgSQL関数のメモリ管理を全面的に見直しました。(Neil)
      </p><p>各関数の解析ツリーが異なるメモリコンテキストに保存されるようになりました。
これにより、不要になった時にメモリの回収が簡単にできるようになりました。
      </p></li><li class="listitem"><p>実行時ではなく、<code class="command">CREATE FUNCTION</code>時に関数の構文を検査します。(Neil)
      </p><p>以前は、構文エラーのほとんどが関数を実行した時にのみ報告されていました。
      </p></li><li class="listitem"><p><code class="command">OPEN</code>により、<code class="command">EXPLAIN</code> や<code class="command">SHOW</code>などの<code class="command">SELECT</code>以外の問い合わせを開くことができるようになりました。(Tom)
      </p></li><li class="listitem"><p>関数で<code class="command">RETURN</code>文を実行する必要がなくなりました。(Tom)
      </p><p>これは<code class="command">OUT</code>および<code class="command">INOUT</code>機能の新規追加に伴う副産物です。
関数の戻り値を提供する必要がない場合<code class="command">RETURN</code>を省略することができます。
      </p></li><li class="listitem"><p>PL/pgSQLの<code class="command">EXECUTE</code>文における省略可能な<code class="command">INTO</code>句サポートを追加しました。(Pavel Stehule, Neil)
      </p></li><li class="listitem"><p><code class="command">CREATE TABLE AS</code>が<code class="command">ROW_COUNT</code>を設定するようにしました。(Tom)
      </p></li><li class="listitem"><p>現在の例外に関する<code class="literal">SQLSTATE</code>とエラーメッセージを返す<code class="literal">SQLSTATE</code>と<code class="literal">SQLERRM</code>を定義しました。(Pavel Stehule, Neil)
      </p><p>これらの変数は、例外ブロック内でのみ定義されます。
      </p></li><li class="listitem"><p><code class="command">RAISE</code>文のパラメータを式とすることが可能になりました。 (Pavel Stehule, Neil)
      </p></li><li class="listitem"><p>ループの<code class="command">CONTINUE</code>文を追加しました。(Pavel Stehule, Neil)
      </p></li><li class="listitem"><p>ブロックラベルとループラベルを追加しました。(Pavel Stehule)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.12"><div class="titlepage"><div><div><h4 class="title">E.246.3.10. PL/Perlサーバサイド言語の変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>大規模な結果セットを効率的に返すことが可能になりました。(Abhijit Menon-Sen)
      </p><p>これにより関数で、結果セット全体をメモリ内に構築することなく<code class="function">return_next()</code>が使用できるようになりました。
      </p></li><li class="listitem"><p>一度に一行という形で、問い合わせ結果の取り出しが可能になりました。(Abhijit Menon-Sen)
      </p><p>これにより関数で、結果セット全体をメモリ内に保存することなく<code class="function">spi_query()</code>と<code class="function">spi_fetchrow()</code>が使用できるようになりました。
      </p></li><li class="listitem"><p>サーバの符号化方式が<code class="literal">UTF8</code>の場合、PL/Perlは文字列を強制的に<code class="literal">UTF8</code> として扱うようになりました。(David Kamholz)
      </p></li><li class="listitem"><p>PL/Perlで検証関数を追加しました。(Andrew)
      </p><p>これにより、構文エラーを実行時ではなく定義時に報告できるようになりました。
      </p></li><li class="listitem"><p>関数が配列型を返す場合にPL/PerlがPerlの配列を返すことができるようになりました。(Andrew)
      </p><p>これは基本的には<span class="productname">PostgreSQL</span>配列をPerl配列に対応付けします。
      </p></li><li class="listitem"><p>Perlの非致命的警告で<code class="command">NOTICE</code>メッセージを生成できるようになりました。(Andrew)
      </p></li><li class="listitem"><p>Perlの<code class="literal">strict</code>モードを有効にできるようになりました。(Andrew)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.13"><div class="titlepage"><div><div><h4 class="title">E.246.3.11. <span class="application">psql</span>の変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>トランザクション内の文がトランザクションの残りに影響することなくエラーになることができるように、<code class="command">\set ON_ERROR_ROLLBACK</code>を追加しました。(Greg Sabino Mullane)
      </p><p>これは、基本的に、すべての文を副トランザクション内で行うことで実装しています。
      </p></li><li class="listitem"><p><span class="application">psql</span>変数内で<code class="literal">\x</code>16進数文字列のサポートを追加しました。(Bruce)
      </p><p>8進数エスケープはすでにサポートされていました。
      </p></li><li class="listitem"><p> <code class="command">troff -ms</code>出力書式のサポートを追加しました。(Roger
       Leigh)
      </p></li><li class="listitem"><p>履歴ファイルの格納場所を<code class="envar">HISTFILE</code>で制御可能にしました。 (Andreas Seltenreich)
      </p><p>これによりデータベースごとに履歴ファイルの格納設定が可能になります。
      </p></li><li class="listitem"><p><code class="command">\x</code> (拡張モード)が<code class="command">\d tablename</code>の結果に影響しないようにしました。(Neil)
      </p></li><li class="listitem"><p>セッションのログを記録するための<code class="option">-L</code>オプションを<span class="application">psql</span>に追加しました。 (Lorne Sunley)
      </p><p>オペレーティングシステムの中には簡単にコマンドライン操作をログ記録する機能がないものがありましたので、このオプションが追加されました。
      </p></li><li class="listitem"><p><code class="command">\d</code>がインデックスのテーブル空間を表示できるようにしました。(Qingqing
       Zhou)
      </p></li><li class="listitem"><p><span class="application">psql</span>のヘルプ（<code class="command">\h</code>）が適切なヘルプ情報について最善の推測を行うようになりました。
(Greg Sabino Mullane)
      </p><p>これによりユーザは単に構文エラーとなった問い合わせの前に<code class="command">\h</code>を付けるだけで、サポートしている構文のヘルプ情報を得ることができるようになりました。
これまでは、<code class="command">\h</code>を使用する前にコマンド名以外の問い合わせテキストを削除しなければなりませんでした。
      </p></li><li class="listitem"><p>ロケールを考慮した書式で数値を出力できるように<code class="command">\pset numericlocale</code>を追加しました。(Eugen Nedelcu)
      </p><p>例えば、<code class="literal">C</code>ロケールでは<code class="literal">100000</code>は<code class="literal">100,000.0</code>として、Europeanロケールでは <code class="literal">100.000,0</code>として出力されます。
      </p></li><li class="listitem"><p>起動時のバナーでサーバのバージョン番号と<span class="application">psql</span>のバージョン番号が異なる場合に両方とも表示するようにしました。(Bruce)
      </p><p>また、サーバと<span class="application">psql</span>との間でメジャーリリース番号が異なる場合に警告を発します。
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.14"><div class="titlepage"><div><div><h4 class="title">E.246.3.12. <span class="application">pg_dump</span>の変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="application">pg_restore</span>に<code class="option">-n</code>および<code class="option">--schema</code>スイッチを追加しました。 (Richard van den Berg)
      </p><p>これにより指定したスキーマのオブジェクトのみをリストアすることができます。
      </p></li><li class="listitem"><p>テキストモードでも<span class="application">pg_dump</span>がラージオブジェクトをダンプできるようになりました。(Tom)
      </p><p>この変更により、ラージオブジェクトが常にダンプできるようになりました。
以前の<code class="option">-b</code>スイッチは何も行いません。
      </p></li><li class="listitem"><p><span class="application">pg_dump</span>が一貫性を持ったラージオブジェクトのスナップショットをダンプできるようになりました。(Tom)
      </p></li><li class="listitem"><p>ラージオブジェクトのコメントをダンプします。(Tom)
      </p></li><li class="listitem"><p>       <span class="application">pg_dump</span> に<code class="option">--encoding</code> を追加しました。
       (Magnus Hagander)
      </p><p>これにより、サーバの符号化方式と異なる符号化方式でデータベースをダンプできるようになりました。
これは、異なる符号化方式のマシンでダンプを転送する時有用です。
      </p></li><li class="listitem"><p>手続き言語の<code class="structname">pg_pltemplate</code>に依存します。(Tom)
      </p><p>手続き言語用の呼び出しハンドラが<code class="literal">pg_catalog</code>スキーマ内に存在する場合、<span class="application">pg_dump</span>はそのハンドラをダンプしません。
代わりに、ロード時に言語の生成パラメータを提供する<code class="structname">pg_pltemplate</code>カタログに依存した、単なる<code class="command">CREATE LANGUAGE <em class="replaceable"><code>name</code></em></code>を使用してその言語をダンプします。
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.15"><div class="titlepage"><div><div><h4 class="title">E.246.3.13. <span class="application">libpq</span>の変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>パスワードファイルのファイル名を指定する<code class="envar">PGPASSFILE</code>環境変数を追加しました。(Andrew)
      </p></li><li class="listitem"><p><code class="function">lo_create()</code>を追加しました。
これは<code class="function">lo_creat()</code>と同じですが、ラージオブジェクトのOIDを指定することができます。(Tom)
      </p></li><li class="listitem"><p><span class="application">libpq</span>が<code class="function">malloc()</code>失敗に関するエラーを一貫性を持ってクライアントアプリケーションに返すようにしました。 (Neil)
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.16"><div class="titlepage"><div><div><h4 class="title">E.246.3.14. ソースコードの変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>場所を変更したインストレーションに対して構築をサポートするように<span class="application">pgxs</span>を修正しました。
      </p></li><li class="listitem"><p>Intelコンパイラを使用するItaniumプロセッサをサポートするスピンロックを追加しました。 (Vikram Kalsi)
      </p></li><li class="listitem"><p>Windows用のKerberos 5サポートを追加しました。(Magnus)
      </p></li><li class="listitem"><p>中国語版FAQを追加しました。(laser@pgsqldb.com)
      </p></li><li class="listitem"><p>OS/Xの機能名称変更に合わせ、RendezvousをBonjourに名前を変更しました。(Bruce)
      </p></li><li class="listitem"><p>macOSにおける<code class="literal">fsync_writethrough</code>のサポートを追加しました。(Chris Campbell)
      </p></li><li class="listitem"><p>サーバ、オプティマイザ、ロックシステム内の情報の渡し方を合理化しました。 (Tom)
      </p></li><li class="listitem"><p><span class="application">pg_config</span>がMSVCを使用してコンパイルできるようになりました。(Andrew)
      </p><p>これには、<span class="application">MSVC</span>を使用した DBD::Pgの構築が必要です。
      </p></li><li class="listitem"><p>Kerberos V4のサポートをやめました。(Magnus)
      </p><p>Kerberos 4 にはセキュリティ上の欠陥があり、保守もされていません。
      </p></li><li class="listitem"><p>コードを整理しました。（EnterpriseDBを使用してカバレッジに関する静的解析を行いました。）
      </p></li><li class="listitem"><p><code class="filename">postgresql.conf</code>のドキュメント上のデフォルトを、<code class="literal">true</code>/<code class="literal">false</code>ではなく<code class="literal">on</code>/<code class="literal">off</code>に変更しました。(Bruce)
      </p></li><li class="listitem"><p><span class="application">pg_config</span>を改良し、より多くの構築時の値を報告できるようにしました。(Tom)
      </p></li><li class="listitem"><p>Windowsにおいてスレッドセーフな<span class="application">libpq</span>を構築できるようにしました。(Dave Page)
      </p></li><li class="listitem"><p>WindowsにおいてIPv6接続が利用できるようになりました。(Andrew)
      </p></li><li class="listitem"><p>I/Oサブシステムの信頼性に関するサーバ管理用文書を追加しました。(Bruce)
      </p></li><li class="listitem"><p>秘匿可能な宣言を<code class="filename">gist.h</code>から<code class="filename">gist_private.h</code>に移しました。(Neil)
      </p><p>以前のリリースでは、<code class="filename">gist.h</code>には公開GiST API（GiSTインデックス実装者向け）とGiST自体を実装するために使用する秘匿可能な宣言が混在していました。
後者が<code class="filename">gist_private.h</code>という別のファイルに移りました。
ほとんどのGiSTインデックス実装には影響がないはずです。
      </p></li><li class="listitem"><p>GiSTメモリ管理を再作成しました。(Neil)
      </p><p>GiSTのメソッドが常に短命のメモリコンテキスト内で呼び出されるようになりました。
そのため、<code class="function">palloc()</code>で割り当てられたメモリは自動的に回収されます。
これにより、GiSTインデックス実装では<code class="function">pfree()</code>を使用して割り当てられたメモリを解放する必要がなくなりました。
      </p></li></ul></div></div><div class="sect3" id="id-1.11.6.250.5.17"><div class="titlepage"><div><div><h4 class="title">E.246.3.15. Contribの変更</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">/contrib/pg_buffercache</code> contribモジュールを追加しました。(Mark Kirkwood)
      </p><p>これはデバッグや性能の調整を目的としたもので、バッファキャッシュの内容を表示します。
      </p></li><li class="listitem"><p>古くなりましたので<code class="filename">/contrib/array</code>が削除されました。(Tom)
      </p></li><li class="listitem"><p><code class="filename">/contrib/lo</code>モジュールを整理しました。(Tom)
      </p></li><li class="listitem"><p><code class="filename">/contrib/findoidjoins</code>を<code class="filename">/src/tools</code>に移動しました。(Tom)
      </p></li><li class="listitem"><p><code class="filename">/contrib/cube</code>から<code class="literal">&lt;&lt;</code>、<code class="literal">&gt;&gt;</code>、<code class="literal">&amp;&lt;</code>、<code class="literal">&amp;&gt;</code> 演算子を削除しました。
      </p><p>これらの演算子が有用ではないからです。
      </p></li><li class="listitem"><p><code class="filename">/contrib/btree_gist</code>を改良しました。(Janko Richter)
      </p></li><li class="listitem"><p><code class="filename">/contrib/pgbench</code>を改良しました。 (Tomoaki Sato, Tatsuo)
      </p><p>固定のコマンド群だけではなく、ユーザが用意したSQLコマンドスクリプトで試験を行なう機能が追加されました。
      </p></li><li class="listitem"><p><code class="filename">/contrib/pgcrypto</code>を改良しました。(Marko Kreen)
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>OpenPGP対称キーと公開キー暗号の実装。
        </p><p>RSAおよびElgamal公開キーアルゴリズムの両方をサポートします。
        </p></li><li class="listitem"><p>単体での構築。SHA256/384/512ハッシュ、Fortuna PRNGを含みます。
        </p></li><li class="listitem"><p>OpenSSLの構築。3DESのサポート。OpenSSL &lt; 0.9.7での内部AESの利用。
        </p></li><li class="listitem"><p><code class="filename">configure</code>の結果を使用した構築パラメータ（OpenSSL、zlib）の取得。
        </p><p><code class="filename">Makefile</code>を編集する必要がまったくなくなりました。
        </p></li><li class="listitem"><p><code class="filename">libmhash</code>および<code class="filename">libmcrypt</code>サポートの削除。
        </p></li></ul></div></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-8-1-1.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="release-8-0-26.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.245. リリース8.1.1 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.247. リリース8.0.26</td></tr></table></div></body></html>