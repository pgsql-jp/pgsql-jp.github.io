<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.3. 文字型</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="datatype-money.html" title="8.2. 通貨型" /><link rel="next" href="datatype-binary.html" title="8.4. バイナリ列データ型" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.3. 文字型</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype-money.html" title="8.2. 通貨型">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="Chapter 8. データ型">Up</a></td><th width="60%" align="center">Chapter 8. データ型</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-binary.html" title="8.4. バイナリ列データ型">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="DATATYPE-CHARACTER"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.3. 文字型</h2></div></div></div><a id="id-1.5.7.11.2" class="indexterm"></a><a id="id-1.5.7.11.3" class="indexterm"></a><a id="id-1.5.7.11.4" class="indexterm"></a><a id="id-1.5.7.11.5" class="indexterm"></a><a id="id-1.5.7.11.6" class="indexterm"></a><a id="id-1.5.7.11.7" class="indexterm"></a><a id="id-1.5.7.11.8" class="indexterm"></a><div class="table" id="DATATYPE-CHARACTER-TABLE"><p class="title"><strong>Table 8.4. 文字型</strong></p><div class="table-contents"><table class="table" summary="文字型" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>型名</th><th>説明</th></tr></thead><tbody><tr><td><code class="type">character varying(<em class="replaceable"><code>n</code></em>)</code>, <code class="type">varchar(<em class="replaceable"><code>n</code></em>)</code></td><td>上限付き可変長</td></tr><tr><td><code class="type">character(<em class="replaceable"><code>n</code></em>)</code>, <code class="type">char(<em class="replaceable"><code>n</code></em>)</code></td><td>空白で埋められた固定長</td></tr><tr><td><code class="type">text</code></td><td>制限なし可変長</td></tr></tbody></table></div></div><br class="table-break" /><p><a class="xref" href="datatype-character.html#DATATYPE-CHARACTER-TABLE" title="Table 8.4. 文字型">Table 8.4</a>は<span class="productname">PostgreSQL</span>で使用可能な汎用文字型を示したものです。
   </p><p><acronym class="acronym">SQL</acronym>は2つの主要な文字データ型を定義しています。
<code class="type">character varying(<em class="replaceable"><code>n</code></em>)</code>と<code class="type">character(<em class="replaceable"><code>n</code></em>)</code>です。
ここで<em class="replaceable"><code>n</code></em>は正の整数です。
これらのデータ型は2つとも<em class="replaceable"><code>n</code></em>文字長（バイト数ではなく）までの文字列を保存できます。
上限を越えた文字列をこれらの型の列に保存しようとするとエラーになります。
ただし、上限を超えた部分にある文字がすべて空白の場合はエラーにはならず、文字列の最大長にまで切り詰められます。
（この一風変わった例外は標準<acronym class="acronym">SQL</acronym>で要求されています。）
もし宣言された上限よりも文字列が短い時は<code class="type">character</code>の値は空白で埋められ、<code class="type">character varying</code>の値は単にその短い文字列で保存されます。
   </p><p>明示的に値を<code class="type">character varying(<em class="replaceable"><code>n</code></em>)</code>または<code class="type">character(<em class="replaceable"><code>n</code></em>)</code>にキャストした場合、指定長を超えるとエラーなしで<em class="replaceable"><code>n</code></em>文字まで切り詰められます。
（これもまた標準<acronym class="acronym">SQL</acronym>の仕様です。）
   </p><p><code class="type">char(<em class="replaceable"><code>n</code></em>)</code>および<code class="type">varchar(<em class="replaceable"><code>n</code></em>)</code>という表記法はそれぞれ<code class="type">character(<em class="replaceable"><code>n</code></em>)</code>と<code class="type">character varying(<em class="replaceable"><code>n</code></em>)</code>の別名です。
長さ指定がない<code class="type">character</code>は<code class="type">character(1)</code>と同じです。
<code class="type">character varying</code>が長さ指定なしで使われた時は、いかなる長さの文字列でも受け付けます。
後者は<span class="productname">PostgreSQL</span>の拡張です。
   </p><p>さらに<span class="productname">PostgreSQL</span>は、いかなる長さの文字列でも格納できる<code class="type">text</code>をサポートします。
<code class="type">text</code>型は標準<acronym class="acronym">SQL</acronym>にはありませんが、多くの他のSQLデータベース管理システムも同様にサポートしています。
   </p><p><code class="type">character</code>型の値は、指定長<em class="replaceable"><code>n</code></em>になるまで物理的に空白で埋められ、そのまま格納、表示されます。
しかし、最後の空白は、重要ではないものとして扱われ、2つの<code class="type">character</code>型の値を比べる際には無視されます。
空白が重要な照合順序では、この挙動は予期しない結果を返す可能性があります。例えば、<code class="command">SELECT 'a '::CHAR(2) collate "C" &lt; E'a\n'::CHAR(2)</code>は<code class="literal">C</code>ロケールでスペースが改行よりも大きいにも関わらず真を返します。
<code class="type">character</code>値を他の文字列型に変換する際は、文字列の終わりの空白は除去されます。
<code class="type">character varying</code>型と<code class="type">text</code>型の値の中や、パターンマッチを行なう際、すなわち<code class="literal">LIKE</code>や正規表現では、最後の空白は意味的に重要なもの<span class="emphasis"><em>です</em></span>ので、注意してください。
   </p><p>短い文字列（126バイトまで）の保存には、実際の文字列に１バイト加えたサイズが必要です。
<code class="type">character</code>では空白埋め込み分もこれに含まれます。
より長い文字列では１バイトではなく４バイトのオーバーヘッドになります。
長い文字列はシステムにより自動的に圧縮されますので、ディスク上の物理的必要容量サイズはより小さくなるかもしれません。
また、非常に長い値はより短い列の値への高速アクセスに干渉しないように、バックグラウンドテーブルに格納されます。
いずれの場合にあっても保存できる最長の文字列は約1ギガバイトです。
（データ型宣言に使われる<em class="replaceable"><code>n</code></em>に許される最大値はこれより小さいものです。
マルチバイト文字符号化方式においては文字数とバイト数はまったく異なっているため、この値の変更は便利ではありません。
特定の上限を設けずに長い文字列を保存したい場合は、適当な上限を設けるよりも、<code class="type">text</code>もしくは長さの指定がない<code class="type">character varying</code>を使用してください。）
   </p><div class="tip"><h3 class="title">Tip</h3><p>空白で埋められる型を使用した場合の保存領域の増加、および、長さ制限付きの列に格納する際に長さを検査するためにいくつか余計なCPUサイクルが加わる点を別にして、これら3つの型の間で性能に関する差異はありません。
他の一部のデータベースシステムでは<code class="type">character(<em class="replaceable"><code>n</code></em>)</code>には性能的な優位性がありますが、<span class="productname">PostgreSQL</span>ではこうした利点はありません。
実際には、格納の際に追加のコストがあるため、<code class="type">character(<em class="replaceable"><code>n</code></em>)</code>は3つの中でもっとも低速です。
多くの場合、代わりに<code class="type">text</code>か<code class="type">character varying</code>を使うのがお薦めです。
    </p></div><p>文字列リテラルの構文については<a class="xref" href="sql-syntax-lexical.html#SQL-SYNTAX-STRINGS" title="4.1.2.1. 文字列定数">Section 4.1.2.1</a>、利用可能な演算子と関数については<a class="xref" href="functions.html" title="Chapter 9. 関数と演算子">Chapter 9</a>を参照してください。
データベースの文字セットは、テキストの値を格納する時に使用される文字セットを決定します。
文字セットのサポートに関する詳細については<a class="xref" href="multibyte.html" title="23.3. 文字セットサポート">Section 23.3</a>を参照してください。
   </p><div class="example" id="id-1.5.7.11.19"><p class="title"><strong>Example 8.1. 文字データ型の使用</strong></p><div class="example-contents"><pre class="programlisting">CREATE TABLE test1 (a character(4));
INSERT INTO test1 VALUES ('ok');
SELECT a, char_length(a) FROM test1; -- <span id="co.datatype-char"></span>(1)
<code class="computeroutput">  a   | char_length
------+-------------
 ok   |           2</code>

CREATE TABLE test2 (b varchar(5));
INSERT INTO test2 VALUES ('ok');
INSERT INTO test2 VALUES ('good      ');
INSERT INTO test2 VALUES ('too long');
<code class="computeroutput">ERROR:  value too long for type character varying(5)</code>
INSERT INTO test2 VALUES ('too long'::varchar(5)); -- 明示的な切り捨て
SELECT b, char_length(b) FROM test2;
<code class="computeroutput">   b   | char_length
-------+-------------
 ok    |           2
 good  |           5
 too l |           5</code></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co.datatype-char">(1)</a> </p></td><td valign="top" align="left"><p><code class="function">char_length</code>関数は<a class="xref" href="functions-string.html" title="9.4. 文字列関数と演算子">Section 9.4</a>で説明されています。
      </p></td></tr></table></div></div></div><br class="example-break" /><p><span class="productname">PostgreSQL</span>には、<a class="xref" href="datatype-character.html#DATATYPE-CHARACTER-SPECIAL-TABLE" title="Table 8.5. 特別な文字データ型">Table 8.5</a>に示すように、この他2つの固定長文字型があります。
<code class="type">name</code>型は内部のシステムカタログ内の識別子の格納のために<span class="emphasis"><em>のみ</em></span>存在するもので、一般ユーザによって使用されることを意図していません。
現在長さは64バイト（63バイトの利用可能文字と終止文字）と定義されていますが、<code class="literal">C</code>ソースコードにある<code class="symbol">NAMEDATALEN</code>定数を使って参照される必要があります。
この長さはコンパイル時に設定されます（そのため特別な用途に合わせ調整できます）。
デフォルトの最大長は今後のリリースで変更される可能性があります。
<code class="type">"char"</code>（二重引用符に注意）は、<code class="type">char(1)</code>とは異なり、1バイトの領域しか使用しません。
過度に単純化した列挙型としてシステムカタログで内部的に使用されます。
   </p><div class="table" id="DATATYPE-CHARACTER-SPECIAL-TABLE"><p class="title"><strong>Table 8.5. 特別な文字データ型</strong></p><div class="table-contents"><table class="table" summary="特別な文字データ型" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>型名</th><th>格納サイズ</th><th>説明</th></tr></thead><tbody><tr><td><code class="type">"char"</code></td><td>1バイト</td><td>単一バイト内部データ型</td></tr><tr><td><code class="type">name</code></td><td>64バイト</td><td>オブジェクト名用の内部データ型</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype-money.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-binary.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">8.2. 通貨型 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 8.4. バイナリ列データ型</td></tr></table></div></body></html>