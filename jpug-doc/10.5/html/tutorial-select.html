<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>2.5. テーブルへの問い合わせ</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="tutorial-populate.html" title="2.4. テーブルに行を挿入" /><link rel="next" href="tutorial-join.html" title="2.6. テーブル間を結合" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">2.5. テーブルへの問い合わせ</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="tutorial-populate.html" title="2.4. テーブルに行を挿入">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="tutorial-sql.html" title="Chapter 2. SQL言語">Up</a></td><th width="60%" align="center">Chapter 2. <acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">SQL</acronym>言語</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="tutorial-join.html" title="2.6. テーブル間を結合">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="TUTORIAL-SELECT"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2.5. テーブルへの問い合わせ</h2></div></div></div><p>    <a id="id-1.4.4.6.2.1" class="indexterm"></a>
    <a id="id-1.4.4.6.2.2" class="indexterm"></a>

テーブルからデータを取り出すために、テーブルへ<em class="firstterm">問い合わせ</em>をします。
このために<acronym class="acronym">SQL</acronym>の<code class="command">SELECT</code>文が使用されます。
この文は選択リスト（返される列のリスト部分）とテーブルリスト（データを取り出すテーブルのリスト部分）、および、省略可能な条件（制限を指定する部分）に分けることができます。
例えば、<code class="structname">weather</code>の全ての行を取り出すには、以下を入力します。
</p><pre class="programlisting">SELECT * FROM weather;</pre><p>
ここで<code class="literal">*</code>は<span class="quote">“<span class="quote">全ての列</span>”</span>の省略形です。
     <a href="#ftn.id-1.4.4.6.2.10" class="footnote"><sup class="footnote" id="id-1.4.4.6.2.10">[2]</sup></a>
したがって、以下のようにしても同じ結果になります。
</p><pre class="programlisting">SELECT city, temp_lo, temp_hi, prcp, date FROM weather;</pre><p>

出力は、以下のようになります。

</p><pre class="screen">     city      | temp_lo | temp_hi | prcp |    date
---------------+---------+---------+------+------------
 San Francisco |      46 |      50 | 0.25 | 1994-11-27
 San Francisco |      43 |      57 |    0 | 1994-11-29
 Hayward       |      37 |      54 |      | 1994-11-29
(3 rows)</pre><p>
   </p><p>選択リストには、単なる列参照だけではなく式を指定することもできます。
例えば、以下を行うことができます。
</p><pre class="programlisting">SELECT city, (temp_hi+temp_lo)/2 AS temp_avg, date FROM weather;</pre><p>
この結果は次のようになります。
</p><pre class="screen">     city      | temp_avg |    date
---------------+----------+------------
 San Francisco |       48 | 1994-11-27
 San Francisco |       50 | 1994-11-29
 Hayward       |       45 | 1994-11-29
(3 rows)</pre><p>
<code class="literal">AS</code>句を使用した出力列の再ラベル付けの部分に注意してください
（<code class="literal">AS</code>句は省略することができます）。
   </p><p>必要な行が何かを指定する<code class="literal">WHERE</code>句を追加して問い合わせに<span class="quote">“<span class="quote">条件付け</span>”</span>することができます。
<code class="literal">WHERE</code>句は論理（真値）式を持ち、この論理式が真となる行のみを返します。
よく使われる論理演算子（<code class="literal">AND</code>、<code class="literal">OR</code>、<code class="literal">NOT</code>）を条件付けに使用することができます。
例えば以下は、San Franciscoの雨天時の気象データを取り出します。

</p><pre class="programlisting">SELECT * FROM weather
    WHERE city = 'San Francisco' AND prcp &gt; 0.0;</pre><p>
結果は次のようになります。
</p><pre class="screen">     city      | temp_lo | temp_hi | prcp |    date
---------------+---------+---------+------+------------
 San Francisco |      46 |      50 | 0.25 | 1994-11-27
(1 row)</pre><p>
   </p><p>    <a id="id-1.4.4.6.5.1" class="indexterm"></a>

問い合わせの結果をソートして返すように指定することができます。

</p><pre class="programlisting">SELECT * FROM weather
    ORDER BY city;</pre><p>

</p><pre class="screen">     city      | temp_lo | temp_hi | prcp |    date
---------------+---------+---------+------+------------
 Hayward       |      37 |      54 |      | 1994-11-29
 San Francisco |      43 |      57 |    0 | 1994-11-29
 San Francisco |      46 |      50 | 0.25 | 1994-11-27</pre><p>

この例では、ソート順は十分に指定されていません。
ですので、San Franciscoの行は順序が異なるかも知れません。
しかし、次のようにすれば常に上記の結果になります。

</p><pre class="programlisting">SELECT * FROM weather
    ORDER BY city, temp_lo;</pre><p>
   </p><p>    <a id="id-1.4.4.6.6.1" class="indexterm"></a>
    <a id="id-1.4.4.6.6.2" class="indexterm"></a>

問い合わせの結果から重複行を除くように指定することができます。

</p><pre class="programlisting">SELECT DISTINCT city
    FROM weather;</pre><p>

</p><pre class="screen">     city
---------------
 Hayward
 San Francisco
(2 rows)</pre><p>

ここでも、結果行の順序は変動するかもしれません。
<code class="literal">DISTINCT</code>と<code class="literal">ORDER BY</code>を一緒に使用することで確実に一貫した結果を得ることができます。
     <a href="#ftn.id-1.4.4.6.6.7" class="footnote"><sup class="footnote" id="id-1.4.4.6.6.7">[3]</sup></a>

</p><pre class="programlisting">SELECT DISTINCT city
    FROM weather
    ORDER BY city;</pre><p>
   </p><div class="footnotes"><br /><hr style="width:100; text-align:left;margin-left: 0" /><div id="ftn.id-1.4.4.6.2.10" class="footnote"><p><a href="#id-1.4.4.6.2.10" class="para"><sup class="para">[2] </sup></a><code class="literal">SELECT *</code>は即興的な問い合わせで有用ですが、テーブルに列を追加することにより結果が変わってしまいますので、実用システムのコードでは悪いやり方であると一般的には考えられています。
      </p></div><div id="ftn.id-1.4.4.6.6.7" class="footnote"><p><a href="#id-1.4.4.6.6.7" class="para"><sup class="para">[3] </sup></a><span class="productname">PostgreSQL</span>の古めのバージョンを含む一部のデータベースシステムでは、<code class="literal">DISTINCT</code>の実装に行の自動順序付けが含まれており、<code class="literal">ORDER BY</code>は不要です。
しかし、これは標準SQLにおける要求ではなく、現在の<span class="productname">PostgreSQL</span>では<code class="literal">DISTINCT</code>句が行の順序付けを行うことを保証していません。
      </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tutorial-populate.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="tutorial-sql.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="tutorial-join.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2.4. テーブルに行を挿入 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 2.6. テーブル間を結合</td></tr></table></div></body></html>