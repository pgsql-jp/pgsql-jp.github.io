<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.11. 幾何関数と演算子</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="functions-enum.html" title="9.10. 列挙型サポート関数" /><link rel="next" href="functions-net.html" title="9.12. ネットワークアドレス関数と演算子" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">9.11. 幾何関数と演算子</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-enum.html" title="9.10. 列挙型サポート関数">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="Chapter 9. 関数と演算子">Up</a></td><th width="60%" align="center">Chapter 9. 関数と演算子</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.5文書">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="functions-net.html" title="9.12. ネットワークアドレス関数と演算子">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="FUNCTIONS-GEOMETRY"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.11. 幾何関数と演算子</h2></div></div></div><p><code class="type">point</code>、<code class="type">box</code>、<code class="type">lseg</code>、<code class="type">line</code>、<code class="type">path</code>、<code class="type">polygon</code>、および<code class="type">circle</code>幾何データ型には、PostgreSQLが元々サポートしている関数と演算子が豊富に揃っています（<a class="xref" href="functions-geometry.html#FUNCTIONS-GEOMETRY-OP-TABLE" title="Table 9.33. 幾何データ演算子">Table 9.33</a>、<a class="xref" href="functions-geometry.html#FUNCTIONS-GEOMETRY-FUNC-TABLE" title="Table 9.34. 幾何データ型関数">Table 9.34</a>、および<a class="xref" href="functions-geometry.html#FUNCTIONS-GEOMETRY-CONV-TABLE" title="Table 9.35. 幾何型変換関数">Table 9.35</a>を参照してください）。
   </p><div class="caution"><h3 class="title">Caution</h3><p><span class="quote">“<span class="quote">同じを示す</span>”</span><code class="literal">~=</code>演算子は<code class="type">point</code>、<code class="type">box</code>、<code class="type">polygon</code>、および<code class="type">circle</code>型に対し通常の等価概念を示すことに注意してください。これらのいくつかの型は<code class="literal">=</code>演算子を持ちますが、<code class="literal">=</code>は<span class="emphasis"><em>面積</em></span>の等しさのみを比較します。その他のスカラー比較演算子（<code class="literal">&lt;=</code>など）は同様にこれらの型の面積を比較します。
    </p></div><div class="table" id="FUNCTIONS-GEOMETRY-OP-TABLE"><p class="title"><strong>Table 9.33. 幾何データ演算子</strong></p><div class="table-contents"><table class="table" summary="幾何データ演算子" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>演算子</th><th>説明</th><th>例</th></tr></thead><tbody><tr><td> <code class="literal">+</code> </td><td>平行移動</td><td><code class="literal">box '((0,0),(1,1))' + point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">-</code> </td><td>平行移動</td><td><code class="literal">box '((0,0),(1,1))' - point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">*</code> </td><td>拡大縮小/回転</td><td><code class="literal">box '((0,0),(1,1))' * point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">/</code> </td><td>拡大縮小/回転</td><td><code class="literal">box '((0,0),(2,2))' / point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">#</code> </td><td>交差点、交差矩形</td><td><code class="literal">box '((1,-1),(-1,1))' # box '((1,1),(-2,-2))'</code></td></tr><tr><td> <code class="literal">#</code> </td><td>経路もしくは多角形の点の数</td><td><code class="literal"># path '((1,0),(0,1),(-1,0))'</code></td></tr><tr><td> <code class="literal">@-@</code> </td><td>長さもしくは円周</td><td><code class="literal">@-@ path '((0,0),(1,0))'</code></td></tr><tr><td> <code class="literal">@@</code> </td><td>中心</td><td><code class="literal">@@ circle '((0,0),10)'</code></td></tr><tr><td> <code class="literal">##</code> </td><td>第2オペランド上の第1オペランドへの近接点</td><td><code class="literal">point '(0,0)' ## lseg '((2,0),(0,2))'</code></td></tr><tr><td> <code class="literal">&lt;-&gt;</code> </td><td>距離</td><td><code class="literal">circle '((0,0),1)' &lt;-&gt; circle '((5,0),1)'</code></td></tr><tr><td> <code class="literal">&amp;&amp;</code> </td><td>重なっているかどうか？(一つでも共通する点があれば真となります)</td><td><code class="literal">box '((0,0),(1,1))' &amp;&amp; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&lt;&lt;</code> </td><td>厳密に左側にあるか？</td><td><code class="literal">circle '((0,0),1)' &lt;&lt; circle '((5,0),1)'</code></td></tr><tr><td> <code class="literal">&gt;&gt;</code> </td><td>厳密に右側にあるか？</td><td><code class="literal">circle '((5,0),1)' &gt;&gt; circle '((0,0),1)'</code></td></tr><tr><td> <code class="literal">&amp;&lt;</code> </td><td>右側にはみ出さないか？</td><td><code class="literal">box '((0,0),(1,1))' &amp;&lt; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&amp;&gt;</code> </td><td>左側にはみ出さないか？</td><td><code class="literal">box '((0,0),(3,3))' &amp;&gt; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&lt;&lt;|</code> </td><td>厳密に下側にあるか？</td><td><code class="literal">box '((0,0),(3,3))' &lt;&lt;| box '((3,4),(5,5))'</code></td></tr><tr><td> <code class="literal">|&gt;&gt;</code> </td><td>厳密に上側にあるか？</td><td><code class="literal">box '((3,4),(5,5))' |&gt;&gt; box '((0,0),(3,3))'</code></td></tr><tr><td> <code class="literal">&amp;&lt;|</code> </td><td>上側に出ていないか？</td><td><code class="literal">box '((0,0),(1,1))' &amp;&lt;| box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">|&amp;&gt;</code> </td><td>下側に出ていないか？</td><td><code class="literal">box '((0,0),(3,3))' |&amp;&gt; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&lt;^</code> </td><td>（接触を許可し）下側にあるか？</td><td><code class="literal">circle '((0,0),1)' &lt;^ circle '((0,5),1)'</code></td></tr><tr><td> <code class="literal">&gt;^</code> </td><td>（接触を許可し）上側にあるか？</td><td><code class="literal">circle '((0,5),1)' &gt;^ circle '((0,0),1)'</code></td></tr><tr><td> <code class="literal">?#</code> </td><td>交わるか？</td><td><code class="literal">lseg '((-1,0),(1,0))' ?# box '((-2,-2),(2,2))'</code></td></tr><tr><td> <code class="literal">?-</code> </td><td>水平か？</td><td><code class="literal">?- lseg '((-1,0),(1,0))'</code></td></tr><tr><td> <code class="literal">?-</code> </td><td>水平方向に揃っているか？</td><td><code class="literal">point '(1,0)' ?- point '(0,0)'</code></td></tr><tr><td> <code class="literal">?|</code> </td><td>垂直か？</td><td><code class="literal">?| lseg '((-1,0),(1,0))'</code></td></tr><tr><td> <code class="literal">?|</code> </td><td>垂直方向に揃っているか？</td><td><code class="literal">point '(0,1)' ?| point '(0,0)'</code></td></tr><tr><td> <code class="literal">?-|</code> </td><td>直角をなしているか？</td><td><code class="literal">lseg '((0,0),(0,1))' ?-| lseg '((0,0),(1,0))'</code></td></tr><tr><td> <code class="literal">?||</code> </td><td>平行か？</td><td><code class="literal">lseg '((-1,0),(1,0))' ?|| lseg '((-1,2),(1,2))'</code></td></tr><tr><td> <code class="literal">@&gt;</code> </td><td>包含しているか？</td><td><code class="literal">circle '((0,0),2)' @&gt; point '(1,1)'</code></td></tr><tr><td> <code class="literal">&lt;@</code> </td><td>包含されているかもしくは境界上か？</td><td><code class="literal">point '(1,1)' &lt;@ circle '((0,0),2)'</code></td></tr><tr><td> <code class="literal">~=</code> </td><td>同等か？</td><td><code class="literal">polygon '((0,0),(1,1))' ~= polygon '((1,1),(0,0))'</code></td></tr></tbody></table></div></div><br class="table-break" /><div class="note"><h3 class="title">Note</h3><p><span class="productname">PostgreSQL</span>の8.2より前では、包含演算子<code class="literal">@&gt;</code>および<code class="literal">&lt;@</code>はそれぞれ<code class="literal">~</code>および<code class="literal">@</code>という名前でした。
これらの名前はまだ利用できますが、削除予定であり最終的にはなくなるでしょう。
    </p></div><a id="id-1.5.8.16.6" class="indexterm"></a><a id="id-1.5.8.16.7" class="indexterm"></a><a id="id-1.5.8.16.8" class="indexterm"></a><a id="id-1.5.8.16.9" class="indexterm"></a><a id="id-1.5.8.16.10" class="indexterm"></a><a id="id-1.5.8.16.11" class="indexterm"></a><a id="id-1.5.8.16.12" class="indexterm"></a><a id="id-1.5.8.16.13" class="indexterm"></a><a id="id-1.5.8.16.14" class="indexterm"></a><a id="id-1.5.8.16.15" class="indexterm"></a><a id="id-1.5.8.16.16" class="indexterm"></a><a id="id-1.5.8.16.17" class="indexterm"></a><div class="table" id="FUNCTIONS-GEOMETRY-FUNC-TABLE"><p class="title"><strong>Table 9.34. 幾何データ型関数</strong></p><div class="table-contents"><table class="table" summary="幾何データ型関数" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>関数</th><th>戻り値</th><th>説明</th><th>例</th></tr></thead><tbody><tr><td><code class="literal"><code class="function">area(<em class="replaceable"><code>object</code></em>)</code></code></td><td><code class="type">double precision</code></td><td>面積</td><td><code class="literal">area(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">center(<em class="replaceable"><code>object</code></em>)</code></code></td><td><code class="type">point</code></td><td>中心</td><td><code class="literal">center(box '((0,0),(1,2))')</code></td></tr><tr><td><code class="literal"><code class="function">diameter(<code class="type">circle</code>)</code></code></td><td><code class="type">double precision</code></td><td>円の直径</td><td><code class="literal">diameter(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">height(<code class="type">box</code>)</code></code></td><td><code class="type">double precision</code></td><td>矩形の高さ</td><td><code class="literal">height(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">isclosed(<code class="type">path</code>)</code></code></td><td><code class="type">boolean</code></td><td>閉経路か？</td><td><code class="literal">isclosed(path '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">isopen(<code class="type">path</code>)</code></code></td><td><code class="type">boolean</code></td><td>開経路か？</td><td><code class="literal">isopen(path '[(0,0),(1,1),(2,0)]')</code></td></tr><tr><td><code class="literal"><code class="function">length(<em class="replaceable"><code>object</code></em>)</code></code></td><td><code class="type">double precision</code></td><td>長さ</td><td><code class="literal">length(path '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">npoints(<code class="type">path</code>)</code></code></td><td><code class="type">int</code></td><td>点の数</td><td><code class="literal">npoints(path '[(0,0),(1,1),(2,0)]')</code></td></tr><tr><td><code class="literal"><code class="function">npoints(<code class="type">polygon</code>)</code></code></td><td><code class="type">int</code></td><td>点の数</td><td><code class="literal">npoints(polygon '((1,1),(0,0))')</code></td></tr><tr><td><code class="literal"><code class="function">pclose(<code class="type">path</code>)</code></code></td><td><code class="type">path</code></td><td>閉経路に変換</td><td><code class="literal">pclose(path '[(0,0),(1,1),(2,0)]')</code></td></tr><tr><td><code class="literal"><code class="function">popen(<code class="type">path</code>)</code></code></td><td><code class="type">path</code></td><td>開経路に変換</td><td><code class="literal">popen(path '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">radius(<code class="type">circle</code>)</code></code></td><td><code class="type">double precision</code></td><td>円の半径</td><td><code class="literal">radius(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">width(<code class="type">box</code>)</code></code></td><td><code class="type">double precision</code></td><td>矩形の幅</td><td><code class="literal">width(box '((0,0),(1,1))')</code></td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="FUNCTIONS-GEOMETRY-CONV-TABLE"><p class="title"><strong>Table 9.35. 幾何型変換関数</strong></p><div class="table-contents"><table class="table" summary="幾何型変換関数" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>関数</th><th>戻り値</th><th>説明</th><th>例</th></tr></thead><tbody><tr><td>         <a id="id-1.5.8.16.19.2.2.1.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">box(<code class="type">circle</code>)</code></code>
        </td><td><code class="type">box</code></td><td>円を矩形に変換</td><td><code class="literal">box(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">box(<code class="type">point</code>)</code></code></td><td><code class="type">box</code></td><td>点を空の矩形に変換</td><td><code class="literal">box(point '(0,0)')</code></td></tr><tr><td><code class="literal"><code class="function">box(<code class="type">point</code>, <code class="type">point</code>)</code></code></td><td><code class="type">box</code></td><td>座標点を矩形に変換</td><td><code class="literal">box(point '(0,0)', point '(1,1)')</code></td></tr><tr><td><code class="literal"><code class="function">box(<code class="type">polygon</code>)</code></code></td><td><code class="type">box</code></td><td>多角形を矩形に変換</td><td><code class="literal">box(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">bound_box(<code class="type">box</code>, <code class="type">box</code>)</code></code></td><td><code class="type">box</code></td><td>矩形を外接矩形に変換</td><td><code class="literal">bound_box(box '((0,0),(1,1))', box '((3,3),(4,4))')</code></td></tr><tr><td>         <a id="id-1.5.8.16.19.2.2.6.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">circle(<code class="type">box</code>)</code></code>
        </td><td><code class="type">circle</code></td><td>矩形を円に変換</td><td><code class="literal">circle(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">circle(<code class="type">point</code>, <code class="type">double precision</code>)</code></code></td><td><code class="type">circle</code></td><td>中心と半径から円に変換</td><td><code class="literal">circle(point '(0,0)', 2.0)</code></td></tr><tr><td><code class="literal"><code class="function">circle(<code class="type">polygon</code>)</code></code></td><td><code class="type">circle</code></td><td>多角形を円に変換</td><td><code class="literal">circle(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">line(<code class="type">point</code>, <code class="type">point</code>)</code></code></td><td><code class="type">line</code></td><td>座標点を直線に変換</td><td><code class="literal">line(point '(-1,0)', point '(1,0)')</code></td></tr><tr><td>         <a id="id-1.5.8.16.19.2.2.10.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">lseg(<code class="type">box</code>)</code></code>
        </td><td><code class="type">lseg</code></td><td>矩形の対角線を線分に変換</td><td><code class="literal">lseg(box '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">lseg(<code class="type">point</code>, <code class="type">point</code>)</code></code></td><td><code class="type">lseg</code></td><td>座標点を線分に変換</td><td><code class="literal">lseg(point '(-1,0)', point '(1,0)')</code></td></tr><tr><td>         <a id="id-1.5.8.16.19.2.2.12.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">path(<code class="type">polygon</code>)</code></code>
        </td><td><code class="type">path</code></td><td>多角形を経路に変換</td><td><code class="literal">path(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td>         <a id="id-1.5.8.16.19.2.2.13.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">point</code>(<code class="type">double
         precision</code>, <code class="type">double precision</code>)</code>
        </td><td><code class="type">point</code></td><td>座標点の構築</td><td><code class="literal">point(23.4, -44.5)</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">box</code>)</code></code></td><td><code class="type">point</code></td><td>矩形の中心</td><td><code class="literal">point(box '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">circle</code>)</code></code></td><td><code class="type">point</code></td><td>円の中心</td><td><code class="literal">point(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">lseg</code>)</code></code></td><td><code class="type">point</code></td><td>線分の中心</td><td><code class="literal">point(lseg '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">polygon</code>)</code></code></td><td><code class="type">point</code></td><td>多角形の中心</td><td><code class="literal">point(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td>         <a id="id-1.5.8.16.19.2.2.18.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">polygon(<code class="type">box</code>)</code></code>
        </td><td><code class="type">polygon</code></td><td>矩形を4頂点の多角形に変換</td><td><code class="literal">polygon(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">polygon(<code class="type">circle</code>)</code></code></td><td><code class="type">polygon</code></td><td>円を12角形に変換</td><td><code class="literal">polygon(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">polygon(<em class="replaceable"><code>npts</code></em>, <code class="type">circle</code>)</code></code></td><td><code class="type">polygon</code></td><td>円を<em class="replaceable"><code>npts</code></em>角形に変換</td><td><code class="literal">polygon(12, circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">polygon(<code class="type">path</code>)</code></code></td><td><code class="type">polygon</code></td><td>経路を多角形に変換</td><td><code class="literal">polygon(path '((0,0),(1,1),(2,0))')</code></td></tr></tbody></table></div></div><br class="table-break" /><p>あたかもpointは添字0、1を有する配列であるかのように、<code class="type">point</code>の２つの構成要素にアクセスすることができます。
例えば、<code class="literal">t.p</code>が<code class="type">point</code>列の場合、<code class="literal">SELECT p[0] FROM t</code>という式でX座標を抽出できます。また、<code class="literal">UPDATE t SET p[1] = ...</code>でY座標を変更できます。
同様に、<code class="type">box</code>型または<code class="type">lseg</code>型の値も、2つの<code class="type">point</code>型の値の配列のように扱えます。
    </p><p><code class="function">area</code>関数は、<code class="type">box</code>、<code class="type">circle</code>、<code class="type">path</code>型に対して動作します。
<code class="type">path</code>データ型に対する<code class="function">area</code>関数は、その<code class="type">path</code>が交差しない場合にのみ動作します。
例えば、<code class="literal">'((0,0),(0,1),(2,1),(2,2),(1,2),(1,0),(0,0))'::PATH</code>という<code class="type">path</code>は動作しません。しかし、見た目は同じですが、<code class="literal">'((0,0),(0,1),(1,1),(1,2),(2,2),(2,1),(1,1),(1,0),(0,0))'::PATH</code>という<code class="type">path</code>では動作します。
<code class="type">path</code>の交差する、しないという概念がよくわからなければ、上の2つの<code class="type">path</code>を並べてグラフ用紙に書いてみてください。
    </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-enum.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-net.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">9.10. 列挙型サポート関数 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 9.12. ネットワークアドレス関数と演算子</td></tr></table></div></body></html>